/**
 * Auryc JavaScript SDK v0.4.32, 1543882424092
 * (c) Copyright 2018, Auryc Inc. http://www.auryc.com
 */

!function(){"use strict";var win;win="undefined"==typeof window?{navigator:{},console:{},location:{},document:{}}:window;var windowNavigator=win.navigator,windowConsole=win.console,windowLocation=win.location,windowDocument=win.document;function log(e,t){}function warn(e){}function error(e){}function critical(e){}var logger={log:log,warn:warn,error:error,critical:critical},time={FULL_DAY:864e5,MAX_DOMLOAD_TIME:6e4,MIN_DOMLOAD_TIME:10},symbols={CANCELED:"ic",CANCELEDPERMANENT:"icp",SESSION:"SESS",DATA:"DATA",PERMANENT:"PERMANENT",EXPIRED:"expired",SESSIONID:"sessid",APITOKEN:"at",DEFINEDEVENTS:"DEFINEDEVENTS",FBTHANKYOU:"FBTHANKYOU",FEEDBACKCONTENT:"FEEDBACKCONTENT",FEEDBACKCONTENT_DESKTOP:"FEEDBACKCONTENT_DESKTOP",GLOBALSESSIONID:"gsid",UNDEFINED:"undefined",DEVICE:"auryc20160418",OVERRIDEFLAG:"aurycoverrideflag"},css={PX:"px",H1:"h1",TOP:"top",LEFT:"left",AUTO:"auto",FB_QB_CHOOSE:"auryc-feedback-question-select-choose",FB_TEXTAREA:"auryc-feedback-fbtarea",SELECT:"select",DEFAULT_HEIGHT:35,TEXT_LIMIT:1e3,FB_TOPIC:"auryc-visible--fbtopic",FB_QUESTION:"auryc-feedback-fbquestion",FBMODAL_CONTAINER:"auryc-fbmodal-container",FB_QID:"questionid",FB_QTYPE:"data-question-type",CHECKBOX:"CHECKBOX",RADIO:"RADIO",HIDDEN:"HIDDEN",REQUIRED:"REQUIRED",HEADING_H1:"auryc-feedback-fbform-headtag auryc-feedback-fbform-headtag-h1",FB_SUBMIT:"post-fb-resp-button",FB_TOPIC_SEL:"auryc-feedback-fbquestion .auryc-fb-questiongroup-selector"},keyCodes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},record={mutatationConfig:{ignoreNodeContentsList:["hr","script","title","br","meta","svg"],ignoreAttrList:["script","meta","title","data-ae_domuel","data-ae_domsib"]},tags:{SVG:"svg",SELECT:"select",IH:"innerHTML"},cache:{minLength:100,maxItems:500},throttler:{RESIZE:700,ORIENTATION_CHANGE:200,CURSOR_INFO_INTERVAL:500,SERIALIZE_INPUT_DELAY:100,SCROLL_INTERVAL:150,WIN_EVENT_THROTTLE:200,MOUSE_MOVE_INTERVAL:150,DOM_MUT_DELAY:20},timeOffset:{WIN_SIZE:-350},upload:{fragLength:1e5,delim:"__D__",defaultTransmitInterval:10,defaultMobileTransmitInterval:5,defaultMaxTransmitInterval:20,defaultMobileMaxTransmitInterval:10,initTimeOffset:15e3,wait:2e3,shortWait:200,pingWaitInterval:2e3},form:{inputTypes:"input, select, textarea"},attr:{FEC:"firstElementChild"}},events={PAGEVIEWTRIGGER:"pageViewTrigger",URLCHANGETRIGGER:"urlChangeTrigger",IDENTIFYTRIGGER:"identifyTrigger",PAGEVIEWTRACKER:"pageview",FEEDBACKTRIGGER:"feedbackTrigger",FEEDBACKTRACKER:"feedback",CLICKTRACKER:"click",CLICKTRIGGER:"clickTrigger",PINGTRACKER:"ping",IDENTIFYTRACKER:"identify",PINGTRIGGER:"pingTrigger",USERIDENTIFY:"userIdentify",USERPROP:"up",TRACKCUSTOMEVENT:"trackCustomEvent",SESSIONPROP:"_sp_",INTERNALSESSIONPROP:"_isp_",SESSIONTIME:"st",SESSIONDURATION:"session_duration",USERID:"userId",UBTINIT:"ubt_init",IDENTITYVALUE:"iv",UBT_INDEPENDENT:"ubt_independent",PV_START_TS:"pst",TRANSMITTING:"ut",WRITABLE:"ut",TRANSMIT_ENABLED:"ut",CANCELED:"uc",NEW_SESSION:"new_session",VISIT_DURATION:18e5,SESSION_EXP:"se",WIN_SIZE:"ws",CUSTOM_EVENT:"CUSTOM",READY:"ready",IDGEN:{behavior:50,sessions:64,interactions:0}},uba_event_type={CUSTOM_EVENT:"CUSTOM"},storage={DEFAULT_LIMIT:8e5,MAX_PACKET_SIZE:2e6,AJAX_URL_LIMIT:256,AJAX_RESPONSE_LIMIT:32,MAX_LATENCY:3e4,LATENCY_BUCKET_WIDTH:3e3,RETRY_LIMIT:10,SESSIONID:"sid",VIEWID:"vid",LASTVIEWID:"last_vid",USERID:"uid",HOST:"host",ACTIVE_VIEWID:"active_viewid",SESSION_METADATA:"session_md",TRANSMIT_ENABLED:"te",SESSION_STATE:"ss",PV:"pv",PVCT:"pv_count",IS_NEW:"isNew",DEFAULT_DATALAYER_PREFIX:"auryc.s",DEFAULT_COOKIE_DURATION:3650,SCOPE:{SESSION:{TAB:"TAB",BROWSER:"BROWSER"}},ID_LENGTH:32},features={PACKET_SPLIT:!1,AJAX:!1},ajax_proxy={type:{xhr:"xhr",fetch:"fetch"},readOnlyAttr:["readyState","responseURL","status","statusText","response","responseText","responseURL","responseXML","upload","timeout"]},pii={maskingAttributes:["value","src","data","alt"],maskingClassName:"_ar_hide_",ignoreAttributes:["data-ae_domuel"]},linkid={id:"_ar_id_",aurycMode:"_aurychash",editorHash:"_editorhash"},cookies={encoding:{BASE64:"base64",URI:"uri",NONE:"none"}},excluded={urls:[]},constants={time:time,symbols:symbols,events:events,uba_event_type:uba_event_type,storage:storage,features:features,ajax_proxy:ajax_proxy,css:css,record:record,keyCodes:keyCodes,pii:pii,cookies:cookies,linkid:linkid,excluded:excluded};function identity(e){return e}var identity_1=identity;function apply(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}var _apply=apply,nativeMax=Math.max;function overRest(s,a,o){return a=nativeMax(void 0===a?s.length-1:a,0),function(){for(var e=arguments,t=-1,i=nativeMax(e.length-a,0),n=Array(i);++t<i;)n[t]=e[a+t];t=-1;for(var r=Array(a+1);++t<a;)r[t]=e[t];return r[a]=o(n),_apply(s,this,r)}}var _overRest=overRest;function constant(e){return function(){return e}}var constant_1=constant,commonjsGlobal="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}var freeGlobal="object"==typeof commonjsGlobal&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,_freeGlobal=freeGlobal,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=_freeGlobal||freeSelf||Function("return this")(),_root=root,Symbol$1=_root.Symbol,_Symbol=Symbol$1,objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,nativeObjectToString=objectProto.toString,symToStringTag=_Symbol?_Symbol.toStringTag:void 0;function getRawTag(e){var t=hasOwnProperty.call(e,symToStringTag),i=e[symToStringTag];try{var n=!(e[symToStringTag]=void 0)}catch(e){}var r=nativeObjectToString.call(e);return n&&(t?e[symToStringTag]=i:delete e[symToStringTag]),r}var _getRawTag=getRawTag,objectProto$1=Object.prototype,nativeObjectToString$1=objectProto$1.toString;function objectToString(e){return nativeObjectToString$1.call(e)}var _objectToString=objectToString,nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag$1=_Symbol?_Symbol.toStringTag:void 0;function baseGetTag(e){return null==e?void 0===e?undefinedTag:nullTag:symToStringTag$1&&symToStringTag$1 in Object(e)?_getRawTag(e):_objectToString(e)}var _baseGetTag=baseGetTag;function isObject(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var isObject_1=isObject,asyncTag="[object AsyncFunction]",funcTag="[object Function]",genTag="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction(e){if(!isObject_1(e))return!1;var t=_baseGetTag(e);return t==funcTag||t==genTag||t==asyncTag||t==proxyTag}var isFunction_1=isFunction,coreJsData=_root["__core-js_shared__"],_coreJsData=coreJsData,maskSrcKey=(J=/[^.]+$/.exec(_coreJsData&&_coreJsData.keys&&_coreJsData.keys.IE_PROTO||""),J?"Symbol(src)_1."+J:""),J;function isMasked(e){return!!maskSrcKey&&maskSrcKey in e}var _isMasked=isMasked,funcProto=Function.prototype,funcToString=funcProto.toString;function toSource(e){if(null!=e){try{return funcToString.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var _toSource=toSource,reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto$1=Function.prototype,objectProto$2=Object.prototype,funcToString$1=funcProto$1.toString,hasOwnProperty$1=objectProto$2.hasOwnProperty,reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty$1).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(e){return!(!isObject_1(e)||_isMasked(e))&&(isFunction_1(e)?reIsNative:reIsHostCtor).test(_toSource(e))}var _baseIsNative=baseIsNative;function getValue(e,t){return null==e?void 0:e[t]}var _getValue=getValue;function getNative(e,t){var i=_getValue(e,t);return _baseIsNative(i)?i:void 0}var _getNative=getNative,defineProperty=function(){try{var e=_getNative(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),_defineProperty=defineProperty,baseSetToString=_defineProperty?function(e,t){return _defineProperty(e,"toString",{configurable:!0,enumerable:!1,value:constant_1(t),writable:!0})}:identity_1,_baseSetToString=baseSetToString,HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;function shortOut(i){var n=0,r=0;return function(){var e=nativeNow(),t=HOT_SPAN-(e-r);if(r=e,0<t){if(++n>=HOT_COUNT)return arguments[0]}else n=0;return i.apply(void 0,arguments)}}var _shortOut=shortOut,setToString=_shortOut(_baseSetToString),_setToString=setToString;function baseRest(e,t){return _setToString(_overRest(e,t,identity_1),e+"")}var _baseRest=baseRest,WeakMap=_getNative(_root,"WeakMap"),_WeakMap=WeakMap,metaMap=_WeakMap&&new _WeakMap,_metaMap=metaMap,baseSetData=_metaMap?function(e,t){return _metaMap.set(e,t),e}:identity_1,_baseSetData=baseSetData,objectCreate=Object.create,baseCreate=function(){function i(){}return function(e){if(!isObject_1(e))return{};if(objectCreate)return objectCreate(e);i.prototype=e;var t=new i;return i.prototype=void 0,t}}(),_baseCreate=baseCreate;function createCtor(n){return function(){var e=arguments;switch(e.length){case 0:return new n;case 1:return new n(e[0]);case 2:return new n(e[0],e[1]);case 3:return new n(e[0],e[1],e[2]);case 4:return new n(e[0],e[1],e[2],e[3]);case 5:return new n(e[0],e[1],e[2],e[3],e[4]);case 6:return new n(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new n(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var t=_baseCreate(n.prototype),i=n.apply(t,e);return isObject_1(i)?i:t}}var _createCtor=createCtor,WRAP_BIND_FLAG=1;function createBind(t,e,i){var n=e&WRAP_BIND_FLAG,r=_createCtor(t);return function e(){return(this&&this!==_root&&this instanceof e?r:t).apply(n?i:this,arguments)}}var _createBind=createBind,nativeMax$1=Math.max;function composeArgs(e,t,i,n){for(var r=-1,s=e.length,a=i.length,o=-1,c=t.length,l=nativeMax$1(s-a,0),u=Array(c+l),h=!n;++o<c;)u[o]=t[o];for(;++r<a;)(h||r<s)&&(u[i[r]]=e[r]);for(;l--;)u[o++]=e[r++];return u}var _composeArgs=composeArgs,nativeMax$2=Math.max;function composeArgsRight(e,t,i,n){for(var r=-1,s=e.length,a=-1,o=i.length,c=-1,l=t.length,u=nativeMax$2(s-o,0),h=Array(u+l),g=!n;++r<u;)h[r]=e[r];for(var d=r;++c<l;)h[d+c]=t[c];for(;++a<o;)(g||r<s)&&(h[d+i[a]]=e[r++]);return h}var _composeArgsRight=composeArgsRight;function countHolders(e,t){for(var i=e.length,n=0;i--;)e[i]===t&&++n;return n}var _countHolders=countHolders;function baseLodash(){}var _baseLodash=baseLodash,MAX_ARRAY_LENGTH=4294967295;function LazyWrapper(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=MAX_ARRAY_LENGTH,this.__views__=[]}LazyWrapper.prototype=_baseCreate(_baseLodash.prototype),LazyWrapper.prototype.constructor=LazyWrapper;var _LazyWrapper=LazyWrapper;function noop(){}var noop_1=noop,getData=_metaMap?function(e){return _metaMap.get(e)}:noop_1,_getData=getData,realNames={},_realNames=realNames,objectProto$3=Object.prototype,hasOwnProperty$2=objectProto$3.hasOwnProperty;function getFuncName(e){for(var t=e.name+"",i=_realNames[t],n=hasOwnProperty$2.call(_realNames,t)?i.length:0;n--;){var r=i[n],s=r.func;if(null==s||s==e)return r.name}return t}var _getFuncName=getFuncName;function LodashWrapper(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}LodashWrapper.prototype=_baseCreate(_baseLodash.prototype),LodashWrapper.prototype.constructor=LodashWrapper;var _LodashWrapper=LodashWrapper,isArray=Array.isArray,isArray_1=isArray;function isObjectLike(e){return null!=e&&"object"==typeof e}var isObjectLike_1=isObjectLike;function copyArray(e,t){var i=-1,n=e.length;for(t||(t=Array(n));++i<n;)t[i]=e[i];return t}var _copyArray=copyArray;function wrapperClone(e){if(e instanceof _LazyWrapper)return e.clone();var t=new _LodashWrapper(e.__wrapped__,e.__chain__);return t.__actions__=_copyArray(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var _wrapperClone=wrapperClone,objectProto$4=Object.prototype,hasOwnProperty$3=objectProto$4.hasOwnProperty;function lodash(e){if(isObjectLike_1(e)&&!isArray_1(e)&&!(e instanceof _LazyWrapper)){if(e instanceof _LodashWrapper)return e;if(hasOwnProperty$3.call(e,"__wrapped__"))return _wrapperClone(e)}return new _LodashWrapper(e)}lodash.prototype=_baseLodash.prototype,lodash.prototype.constructor=lodash;var wrapperLodash=lodash;function isLaziable(e){var t=_getFuncName(e),i=wrapperLodash[t];if("function"!=typeof i||!(t in _LazyWrapper.prototype))return!1;if(e===i)return!0;var n=_getData(i);return!!n&&e===n[0]}var _isLaziable=isLaziable,setData=_shortOut(_baseSetData),_setData=setData,reWrapDetails=/\{\n\/\* \[wrapped with (.+)\] \*/,reSplitDetails=/,? & /;function getWrapDetails(e){var t=e.match(reWrapDetails);return t?t[1].split(reSplitDetails):[]}var _getWrapDetails=getWrapDetails,reWrapComment=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;function insertWrapDetails(e,t){var i=t.length;if(!i)return e;var n=i-1;return t[n]=(1<i?"& ":"")+t[n],t=t.join(2<i?", ":" "),e.replace(reWrapComment,"{\n/* [wrapped with "+t+"] */\n")}var _insertWrapDetails=insertWrapDetails;function arrayEach(e,t){for(var i=-1,n=null==e?0:e.length;++i<n&&!1!==t(e[i],i,e););return e}var _arrayEach=arrayEach;function baseFindIndex(e,t,i,n){for(var r=e.length,s=i+(n?1:-1);n?s--:++s<r;)if(t(e[s],s,e))return s;return-1}var _baseFindIndex=baseFindIndex;function baseIsNaN(e){return e!=e}var _baseIsNaN=baseIsNaN;function strictIndexOf(e,t,i){for(var n=i-1,r=e.length;++n<r;)if(e[n]===t)return n;return-1}var _strictIndexOf=strictIndexOf;function baseIndexOf(e,t,i){return t==t?_strictIndexOf(e,t,i):_baseFindIndex(e,_baseIsNaN,i)}var _baseIndexOf=baseIndexOf;function arrayIncludes(e,t){return!!(null==e?0:e.length)&&-1<_baseIndexOf(e,t,0)}var _arrayIncludes=arrayIncludes,WRAP_BIND_FLAG$1=1,WRAP_BIND_KEY_FLAG=2,WRAP_CURRY_FLAG=8,WRAP_CURRY_RIGHT_FLAG=16,WRAP_PARTIAL_FLAG=32,WRAP_PARTIAL_RIGHT_FLAG=64,WRAP_ARY_FLAG=128,WRAP_REARG_FLAG=256,WRAP_FLIP_FLAG=512,wrapFlags=[["ary",WRAP_ARY_FLAG],["bind",WRAP_BIND_FLAG$1],["bindKey",WRAP_BIND_KEY_FLAG],["curry",WRAP_CURRY_FLAG],["curryRight",WRAP_CURRY_RIGHT_FLAG],["flip",WRAP_FLIP_FLAG],["partial",WRAP_PARTIAL_FLAG],["partialRight",WRAP_PARTIAL_RIGHT_FLAG],["rearg",WRAP_REARG_FLAG]];function updateWrapDetails(i,n){return _arrayEach(wrapFlags,function(e){var t="_."+e[0];n&e[1]&&!_arrayIncludes(i,t)&&i.push(t)}),i.sort()}var _updateWrapDetails=updateWrapDetails;function setWrapToString(e,t,i){var n=t+"";return _setToString(e,_insertWrapDetails(n,_updateWrapDetails(_getWrapDetails(n),i)))}var _setWrapToString=setWrapToString,WRAP_BIND_FLAG$2=1,WRAP_BIND_KEY_FLAG$1=2,WRAP_CURRY_BOUND_FLAG=4,WRAP_CURRY_FLAG$1=8,WRAP_PARTIAL_FLAG$1=32,WRAP_PARTIAL_RIGHT_FLAG$1=64;function createRecurry(e,t,i,n,r,s,a,o,c,l){var u=t&WRAP_CURRY_FLAG$1;t|=u?WRAP_PARTIAL_FLAG$1:WRAP_PARTIAL_RIGHT_FLAG$1,(t&=~(u?WRAP_PARTIAL_RIGHT_FLAG$1:WRAP_PARTIAL_FLAG$1))&WRAP_CURRY_BOUND_FLAG||(t&=~(WRAP_BIND_FLAG$2|WRAP_BIND_KEY_FLAG$1));var h=[e,t,r,u?s:void 0,u?a:void 0,u?void 0:s,u?void 0:a,o,c,l],g=i.apply(void 0,h);return _isLaziable(e)&&_setData(g,h),g.placeholder=n,_setWrapToString(g,e,t)}var _createRecurry=createRecurry;function getHolder(e){return e.placeholder}var _getHolder=getHolder,MAX_SAFE_INTEGER=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(e,t){var i=typeof e;return!!(t=null==t?MAX_SAFE_INTEGER:t)&&("number"==i||"symbol"!=i&&reIsUint.test(e))&&-1<e&&e%1==0&&e<t}var _isIndex=isIndex,nativeMin=Math.min;function reorder(e,t){for(var i=e.length,n=nativeMin(t.length,i),r=_copyArray(e);n--;){var s=t[n];e[n]=_isIndex(s,i)?r[s]:void 0}return e}var _reorder=reorder,PLACEHOLDER="__lodash_placeholder__";function replaceHolders(e,t){for(var i=-1,n=e.length,r=0,s=[];++i<n;){var a=e[i];a!==t&&a!==PLACEHOLDER||(e[i]=PLACEHOLDER,s[r++]=i)}return s}var _replaceHolders=replaceHolders,WRAP_BIND_FLAG$3=1,WRAP_BIND_KEY_FLAG$2=2,WRAP_CURRY_FLAG$2=8,WRAP_CURRY_RIGHT_FLAG$1=16,WRAP_ARY_FLAG$1=128,WRAP_FLIP_FLAG$1=512;function createHybrid(l,u,h,g,d,p,f,y,m,b){var I=u&WRAP_ARY_FLAG$1,v=u&WRAP_BIND_FLAG$3,A=u&WRAP_BIND_KEY_FLAG$2,C=u&(WRAP_CURRY_FLAG$2|WRAP_CURRY_RIGHT_FLAG$1),S=u&WRAP_FLIP_FLAG$1,w=A?void 0:_createCtor(l);return function e(){for(var t=arguments.length,i=Array(t),n=t;n--;)i[n]=arguments[n];if(C)var r=_getHolder(e),s=_countHolders(i,r);if(g&&(i=_composeArgs(i,g,d,C)),p&&(i=_composeArgsRight(i,p,f,C)),t-=s,C&&t<b){var a=_replaceHolders(i,r);return _createRecurry(l,u,createHybrid,e.placeholder,h,i,a,y,m,b-t)}var o=v?h:this,c=A?o[l]:l;return t=i.length,y?i=_reorder(i,y):S&&1<t&&i.reverse(),I&&m<t&&(i.length=m),this&&this!==_root&&this instanceof e&&(c=w||_createCtor(c)),c.apply(o,i)}}var _createHybrid=createHybrid;function createCurry(a,o,c){var l=_createCtor(a);return function e(){for(var t=arguments.length,i=Array(t),n=t,r=_getHolder(e);n--;)i[n]=arguments[n];var s=t<3&&i[0]!==r&&i[t-1]!==r?[]:_replaceHolders(i,r);return(t-=s.length)<c?_createRecurry(a,o,_createHybrid,e.placeholder,void 0,i,s,void 0,void 0,c-t):_apply(this&&this!==_root&&this instanceof e?l:a,this,i)}}var _createCurry=createCurry,WRAP_BIND_FLAG$4=1;function createPartial(o,e,c,l){var u=e&WRAP_BIND_FLAG$4,h=_createCtor(o);return function e(){for(var t=-1,i=arguments.length,n=-1,r=l.length,s=Array(r+i),a=this&&this!==_root&&this instanceof e?h:o;++n<r;)s[n]=l[n];for(;i--;)s[n++]=arguments[++t];return _apply(a,u?c:this,s)}}var _createPartial=createPartial,PLACEHOLDER$1="__lodash_placeholder__",WRAP_BIND_FLAG$5=1,WRAP_BIND_KEY_FLAG$3=2,WRAP_CURRY_BOUND_FLAG$1=4,WRAP_CURRY_FLAG$3=8,WRAP_ARY_FLAG$2=128,WRAP_REARG_FLAG$1=256,nativeMin$1=Math.min;function mergeData(e,t){var i=e[1],n=t[1],r=i|n,s=r<(WRAP_BIND_FLAG$5|WRAP_BIND_KEY_FLAG$3|WRAP_ARY_FLAG$2),a=n==WRAP_ARY_FLAG$2&&i==WRAP_CURRY_FLAG$3||n==WRAP_ARY_FLAG$2&&i==WRAP_REARG_FLAG$1&&e[7].length<=t[8]||n==(WRAP_ARY_FLAG$2|WRAP_REARG_FLAG$1)&&t[7].length<=t[8]&&i==WRAP_CURRY_FLAG$3;if(!s&&!a)return e;n&WRAP_BIND_FLAG$5&&(e[2]=t[2],r|=i&WRAP_BIND_FLAG$5?0:WRAP_CURRY_BOUND_FLAG$1);var o=t[3];if(o){var c=e[3];e[3]=c?_composeArgs(c,o,t[4]):o,e[4]=c?_replaceHolders(e[3],PLACEHOLDER$1):t[4]}return(o=t[5])&&(c=e[5],e[5]=c?_composeArgsRight(c,o,t[6]):o,e[6]=c?_replaceHolders(e[5],PLACEHOLDER$1):t[6]),(o=t[7])&&(e[7]=o),n&WRAP_ARY_FLAG$2&&(e[8]=null==e[8]?t[8]:nativeMin$1(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=r,e}var _mergeData=mergeData,symbolTag="[object Symbol]";function isSymbol(e){return"symbol"==typeof e||isObjectLike_1(e)&&_baseGetTag(e)==symbolTag}var isSymbol_1=isSymbol,NAN=NaN,reTrim=/^\s+|\s+$/g,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber(e){if("number"==typeof e)return e;if(isSymbol_1(e))return NAN;if(isObject_1(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=isObject_1(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(reTrim,"");var i=reIsBinary.test(e);return i||reIsOctal.test(e)?freeParseInt(e.slice(2),i?2:8):reIsBadHex.test(e)?NAN:+e}var toNumber_1=toNumber,INFINITY=1/0,MAX_INTEGER=17976931348623157e292;function toFinite(e){return e?(e=toNumber_1(e))!==INFINITY&&e!==-INFINITY?e==e?e:0:(e<0?-1:1)*MAX_INTEGER:0===e?e:0}var toFinite_1=toFinite;function toInteger(e){var t=toFinite_1(e),i=t%1;return t==t?i?t-i:t:0}var toInteger_1=toInteger,FUNC_ERROR_TEXT="Expected a function",WRAP_BIND_FLAG$6=1,WRAP_BIND_KEY_FLAG$4=2,WRAP_CURRY_FLAG$4=8,WRAP_CURRY_RIGHT_FLAG$2=16,WRAP_PARTIAL_FLAG$2=32,WRAP_PARTIAL_RIGHT_FLAG$2=64,nativeMax$3=Math.max;function createWrap(e,t,i,n,r,s,a,o){var c=t&WRAP_BIND_KEY_FLAG$4;if(!c&&"function"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT);var l=n?n.length:0;if(l||(t&=~(WRAP_PARTIAL_FLAG$2|WRAP_PARTIAL_RIGHT_FLAG$2),n=r=void 0),a=void 0===a?a:nativeMax$3(toInteger_1(a),0),o=void 0===o?o:toInteger_1(o),l-=r?r.length:0,t&WRAP_PARTIAL_RIGHT_FLAG$2){var u=n,h=r;n=r=void 0}var g=c?void 0:_getData(e),d=[e,t,i,n,r,u,h,s,a,o];if(g&&_mergeData(d,g),e=d[0],t=d[1],i=d[2],n=d[3],r=d[4],!(o=d[9]=void 0===d[9]?c?0:e.length:nativeMax$3(d[9]-l,0))&&t&(WRAP_CURRY_FLAG$4|WRAP_CURRY_RIGHT_FLAG$2)&&(t&=~(WRAP_CURRY_FLAG$4|WRAP_CURRY_RIGHT_FLAG$2)),t&&t!=WRAP_BIND_FLAG$6)p=t==WRAP_CURRY_FLAG$4||t==WRAP_CURRY_RIGHT_FLAG$2?_createCurry(e,t,o):t!=WRAP_PARTIAL_FLAG$2&&t!=(WRAP_BIND_FLAG$6|WRAP_PARTIAL_FLAG$2)||r.length?_createHybrid.apply(void 0,d):_createPartial(e,t,i,n);else var p=_createBind(e,t,i);return _setWrapToString((g?_baseSetData:_setData)(p,d),e,t)}var _createWrap=createWrap,WRAP_BIND_FLAG$7=1,WRAP_PARTIAL_FLAG$3=32,bind=_baseRest(function(e,t,i){var n=WRAP_BIND_FLAG$7;if(i.length){var r=_replaceHolders(i,_getHolder(bind));n|=WRAP_PARTIAL_FLAG$3}return _createWrap(e,n,t,i,r)});bind.placeholder={};var bind_1=bind;function listCacheClear(){this.__data__=[],this.size=0}var _listCacheClear=listCacheClear;function eq(e,t){return e===t||e!=e&&t!=t}var eq_1=eq;function assocIndexOf(e,t){for(var i=e.length;i--;)if(eq_1(e[i][0],t))return i;return-1}var _assocIndexOf=assocIndexOf,arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete(e){var t=this.__data__,i=_assocIndexOf(t,e);return!(i<0)&&(i==t.length-1?t.pop():splice.call(t,i,1),--this.size,!0)}var _listCacheDelete=listCacheDelete;function listCacheGet(e){var t=this.__data__,i=_assocIndexOf(t,e);return i<0?void 0:t[i][1]}var _listCacheGet=listCacheGet;function listCacheHas(e){return-1<_assocIndexOf(this.__data__,e)}var _listCacheHas=listCacheHas;function listCacheSet(e,t){var i=this.__data__,n=_assocIndexOf(i,e);return n<0?(++this.size,i.push([e,t])):i[n][1]=t,this}var _listCacheSet=listCacheSet;function ListCache(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}ListCache.prototype.clear=_listCacheClear,ListCache.prototype.delete=_listCacheDelete,ListCache.prototype.get=_listCacheGet,ListCache.prototype.has=_listCacheHas,ListCache.prototype.set=_listCacheSet;var _ListCache=ListCache;function stackClear(){this.__data__=new _ListCache,this.size=0}var _stackClear=stackClear;function stackDelete(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i}var _stackDelete=stackDelete;function stackGet(e){return this.__data__.get(e)}var _stackGet=stackGet;function stackHas(e){return this.__data__.has(e)}var _stackHas=stackHas,Map=_getNative(_root,"Map"),_Map=Map,nativeCreate=_getNative(Object,"create"),_nativeCreate=nativeCreate;function hashClear(){this.__data__=_nativeCreate?_nativeCreate(null):{},this.size=0}var _hashClear=hashClear;function hashDelete(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var _hashDelete=hashDelete,HASH_UNDEFINED="__lodash_hash_undefined__",objectProto$5=Object.prototype,hasOwnProperty$4=objectProto$5.hasOwnProperty;function hashGet(e){var t=this.__data__;if(_nativeCreate){var i=t[e];return i===HASH_UNDEFINED?void 0:i}return hasOwnProperty$4.call(t,e)?t[e]:void 0}var _hashGet=hashGet,objectProto$6=Object.prototype,hasOwnProperty$5=objectProto$6.hasOwnProperty;function hashHas(e){var t=this.__data__;return _nativeCreate?void 0!==t[e]:hasOwnProperty$5.call(t,e)}var _hashHas=hashHas,HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=_nativeCreate&&void 0===t?HASH_UNDEFINED$1:t,this}var _hashSet=hashSet;function Hash(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}Hash.prototype.clear=_hashClear,Hash.prototype.delete=_hashDelete,Hash.prototype.get=_hashGet,Hash.prototype.has=_hashHas,Hash.prototype.set=_hashSet;var _Hash=Hash;function mapCacheClear(){this.size=0,this.__data__={hash:new _Hash,map:new(_Map||_ListCache),string:new _Hash}}var _mapCacheClear=mapCacheClear;function isKeyable(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}var _isKeyable=isKeyable;function getMapData(e,t){var i=e.__data__;return _isKeyable(t)?i["string"==typeof t?"string":"hash"]:i.map}var _getMapData=getMapData;function mapCacheDelete(e){var t=_getMapData(this,e).delete(e);return this.size-=t?1:0,t}var _mapCacheDelete=mapCacheDelete;function mapCacheGet(e){return _getMapData(this,e).get(e)}var _mapCacheGet=mapCacheGet;function mapCacheHas(e){return _getMapData(this,e).has(e)}var _mapCacheHas=mapCacheHas;function mapCacheSet(e,t){var i=_getMapData(this,e),n=i.size;return i.set(e,t),this.size+=i.size==n?0:1,this}var _mapCacheSet=mapCacheSet;function MapCache(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}MapCache.prototype.clear=_mapCacheClear,MapCache.prototype.delete=_mapCacheDelete,MapCache.prototype.get=_mapCacheGet,MapCache.prototype.has=_mapCacheHas,MapCache.prototype.set=_mapCacheSet;var _MapCache=MapCache,LARGE_ARRAY_SIZE=200;function stackSet(e,t){var i=this.__data__;if(i instanceof _ListCache){var n=i.__data__;if(!_Map||n.length<LARGE_ARRAY_SIZE-1)return n.push([e,t]),this.size=++i.size,this;i=this.__data__=new _MapCache(n)}return i.set(e,t),this.size=i.size,this}var _stackSet=stackSet;function Stack(e){var t=this.__data__=new _ListCache(e);this.size=t.size}Stack.prototype.clear=_stackClear,Stack.prototype.delete=_stackDelete,Stack.prototype.get=_stackGet,Stack.prototype.has=_stackHas,Stack.prototype.set=_stackSet;var _Stack=Stack;function baseAssignValue(e,t,i){"__proto__"==t&&_defineProperty?_defineProperty(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}var _baseAssignValue=baseAssignValue;function assignMergeValue(e,t,i){(void 0===i||eq_1(e[t],i))&&(void 0!==i||t in e)||_baseAssignValue(e,t,i)}var _assignMergeValue=assignMergeValue;function createBaseFor(c){return function(e,t,i){for(var n=-1,r=Object(e),s=i(e),a=s.length;a--;){var o=s[c?a:++n];if(!1===t(r[o],o,r))break}return e}}var _createBaseFor=createBaseFor,baseFor=_createBaseFor(),_baseFor=baseFor,_cloneBuffer=createCommonjsModule(function(e,t){var i=t&&!t.nodeType&&t,n=i&&e&&!e.nodeType&&e,r=n&&n.exports===i?_root.Buffer:void 0,s=r?r.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var i=e.length,n=s?s(i):new e.constructor(i);return e.copy(n),n}}),Uint8Array$1=_root.Uint8Array,_Uint8Array=Uint8Array$1;function cloneArrayBuffer(e){var t=new e.constructor(e.byteLength);return new _Uint8Array(t).set(new _Uint8Array(e)),t}var _cloneArrayBuffer=cloneArrayBuffer;function cloneTypedArray(e,t){var i=t?_cloneArrayBuffer(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}var _cloneTypedArray=cloneTypedArray;function overArg(t,i){return function(e){return t(i(e))}}var _overArg=overArg,getPrototype=_overArg(Object.getPrototypeOf,Object),_getPrototype=getPrototype,objectProto$7=Object.prototype;function isPrototype(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||objectProto$7)}var _isPrototype=isPrototype;function initCloneObject(e){return"function"!=typeof e.constructor||_isPrototype(e)?{}:_baseCreate(_getPrototype(e))}var _initCloneObject=initCloneObject,argsTag="[object Arguments]";function baseIsArguments(e){return isObjectLike_1(e)&&_baseGetTag(e)==argsTag}var _baseIsArguments=baseIsArguments,objectProto$8=Object.prototype,hasOwnProperty$6=objectProto$8.hasOwnProperty,propertyIsEnumerable=objectProto$8.propertyIsEnumerable,isArguments=_baseIsArguments(function(){return arguments}())?_baseIsArguments:function(e){return isObjectLike_1(e)&&hasOwnProperty$6.call(e,"callee")&&!propertyIsEnumerable.call(e,"callee")},isArguments_1=isArguments,MAX_SAFE_INTEGER$1=9007199254740991;function isLength(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=MAX_SAFE_INTEGER$1}var isLength_1=isLength;function isArrayLike(e){return null!=e&&isLength_1(e.length)&&!isFunction_1(e)}var isArrayLike_1=isArrayLike;function isArrayLikeObject(e){return isObjectLike_1(e)&&isArrayLike_1(e)}var isArrayLikeObject_1=isArrayLikeObject;function stubFalse(){return!1}var stubFalse_1=stubFalse,isBuffer_1=createCommonjsModule(function(e,t){var i=t&&!t.nodeType&&t,n=i&&e&&!e.nodeType&&e,r=n&&n.exports===i?_root.Buffer:void 0,s=(r?r.isBuffer:void 0)||stubFalse_1;e.exports=s}),objectTag="[object Object]",funcProto$2=Function.prototype,objectProto$9=Object.prototype,funcToString$2=funcProto$2.toString,hasOwnProperty$7=objectProto$9.hasOwnProperty,objectCtorString=funcToString$2.call(Object);function isPlainObject(e){if(!isObjectLike_1(e)||_baseGetTag(e)!=objectTag)return!1;var t=_getPrototype(e);if(null===t)return!0;var i=hasOwnProperty$7.call(t,"constructor")&&t.constructor;return"function"==typeof i&&i instanceof i&&funcToString$2.call(i)==objectCtorString}var isPlainObject_1=isPlainObject,argsTag$1="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag$1="[object Function]",mapTag="[object Map]",numberTag="[object Number]",objectTag$1="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",typedArrayTags={};function baseIsTypedArray(e){return isObjectLike_1(e)&&isLength_1(e.length)&&!!typedArrayTags[_baseGetTag(e)]}typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0,typedArrayTags[argsTag$1]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dataViewTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag$1]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=!1;var _baseIsTypedArray=baseIsTypedArray;function baseUnary(t){return function(e){return t(e)}}var _baseUnary=baseUnary,_nodeUtil=createCommonjsModule(function(e,t){var i=t&&!t.nodeType&&t,n=i&&e&&!e.nodeType&&e,r=n&&n.exports===i&&_freeGlobal.process,s=function(){try{var e=n&&n.require&&n.require("util").types;return e||r&&r.binding&&r.binding("util")}catch(e){}}();e.exports=s}),nodeIsTypedArray=_nodeUtil&&_nodeUtil.isTypedArray,isTypedArray=nodeIsTypedArray?_baseUnary(nodeIsTypedArray):_baseIsTypedArray,isTypedArray_1=isTypedArray;function safeGet(e,t){if("__proto__"!=t)return e[t]}var _safeGet=safeGet,objectProto$10=Object.prototype,hasOwnProperty$8=objectProto$10.hasOwnProperty;function assignValue(e,t,i){var n=e[t];hasOwnProperty$8.call(e,t)&&eq_1(n,i)&&(void 0!==i||t in e)||_baseAssignValue(e,t,i)}var _assignValue=assignValue;function copyObject(e,t,i,n){var r=!i;i||(i={});for(var s=-1,a=t.length;++s<a;){var o=t[s],c=n?n(i[o],e[o],o,i,e):void 0;void 0===c&&(c=e[o]),r?_baseAssignValue(i,o,c):_assignValue(i,o,c)}return i}var _copyObject=copyObject;function baseTimes(e,t){for(var i=-1,n=Array(e);++i<e;)n[i]=t(i);return n}var _baseTimes=baseTimes,objectProto$11=Object.prototype,hasOwnProperty$9=objectProto$11.hasOwnProperty;function arrayLikeKeys(e,t){var i=isArray_1(e),n=!i&&isArguments_1(e),r=!i&&!n&&isBuffer_1(e),s=!i&&!n&&!r&&isTypedArray_1(e),a=i||n||r||s,o=a?_baseTimes(e.length,String):[],c=o.length;for(var l in e)!t&&!hasOwnProperty$9.call(e,l)||a&&("length"==l||r&&("offset"==l||"parent"==l)||s&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||_isIndex(l,c))||o.push(l);return o}var _arrayLikeKeys=arrayLikeKeys;function nativeKeysIn(e){var t=[];if(null!=e)for(var i in Object(e))t.push(i);return t}var _nativeKeysIn=nativeKeysIn,objectProto$12=Object.prototype,hasOwnProperty$10=objectProto$12.hasOwnProperty;function baseKeysIn(e){if(!isObject_1(e))return _nativeKeysIn(e);var t=_isPrototype(e),i=[];for(var n in e)("constructor"!=n||!t&&hasOwnProperty$10.call(e,n))&&i.push(n);return i}var _baseKeysIn=baseKeysIn;function keysIn(e){return isArrayLike_1(e)?_arrayLikeKeys(e,!0):_baseKeysIn(e)}var keysIn_1=keysIn;function toPlainObject(e){return _copyObject(e,keysIn_1(e))}var toPlainObject_1=toPlainObject;function baseMergeDeep(e,t,i,n,r,s,a){var o=_safeGet(e,i),c=_safeGet(t,i),l=a.get(c);if(l)_assignMergeValue(e,i,l);else{var u=s?s(o,c,i+"",e,t,a):void 0,h=void 0===u;if(h){var g=isArray_1(c),d=!g&&isBuffer_1(c),p=!g&&!d&&isTypedArray_1(c);u=c,g||d||p?u=isArray_1(o)?o:isArrayLikeObject_1(o)?_copyArray(o):d?_cloneBuffer(c,!(h=!1)):p?_cloneTypedArray(c,!(h=!1)):[]:isPlainObject_1(c)||isArguments_1(c)?isArguments_1(u=o)?u=toPlainObject_1(o):isObject_1(o)&&!isFunction_1(o)||(u=_initCloneObject(c)):h=!1}h&&(a.set(c,u),r(u,c,n,s,a),a.delete(c)),_assignMergeValue(e,i,u)}}var _baseMergeDeep=baseMergeDeep;function baseMerge(n,r,s,a,o){n!==r&&_baseFor(r,function(e,t){if(isObject_1(e))o||(o=new _Stack),_baseMergeDeep(n,r,t,s,baseMerge,a,o);else{var i=a?a(_safeGet(n,t),e,t+"",n,r,o):void 0;void 0===i&&(i=e),_assignMergeValue(n,t,i)}},keysIn_1)}var _baseMerge=baseMerge;function isIterateeCall(e,t,i){if(!isObject_1(i))return!1;var n=typeof t;return!!("number"==n?isArrayLike_1(i)&&_isIndex(t,i.length):"string"==n&&t in i)&&eq_1(i[t],e)}var _isIterateeCall=isIterateeCall;function createAssigner(o){return _baseRest(function(e,t){var i=-1,n=t.length,r=1<n?t[n-1]:void 0,s=2<n?t[2]:void 0;for(r=3<o.length&&"function"==typeof r?(n--,r):void 0,s&&_isIterateeCall(t[0],t[1],s)&&(r=n<3?void 0:r,n=1),e=Object(e);++i<n;){var a=t[i];a&&o(e,a,i,r)}return e})}var _createAssigner=createAssigner,merge=_createAssigner(function(e,t,i){_baseMerge(e,t,i)}),merge_1=merge;function baseExtremum(e,t,i){for(var n=-1,r=e.length;++n<r;){var s=e[n],a=t(s);if(null!=a&&(void 0===o?a==a&&!isSymbol_1(a):i(a,o)))var o=a,c=s}return c}var _baseExtremum=baseExtremum;function baseGt(e,t){return t<e}var _baseGt=baseGt;function max(e){return e&&e.length?_baseExtremum(e,identity_1,_baseGt):void 0}var max_1=max,reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(e,t){if(isArray_1(e))return!1;var i=typeof e;return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=e&&!isSymbol_1(e))||(reIsPlainProp.test(e)||!reIsDeepProp.test(e)||null!=t&&e in Object(t))}var _isKey=isKey,FUNC_ERROR_TEXT$1="Expected a function";function memoize(r,s){if("function"!=typeof r||null!=s&&"function"!=typeof s)throw new TypeError(FUNC_ERROR_TEXT$1);var a=function(){var e=arguments,t=s?s.apply(this,e):e[0],i=a.cache;if(i.has(t))return i.get(t);var n=r.apply(this,e);return a.cache=i.set(t,n)||i,n};return a.cache=new(memoize.Cache||_MapCache),a}memoize.Cache=_MapCache;var memoize_1=memoize,MAX_MEMOIZE_SIZE=500;function memoizeCapped(e){var t=memoize_1(e,function(e){return i.size===MAX_MEMOIZE_SIZE&&i.clear(),e}),i=t.cache;return t}var _memoizeCapped=memoizeCapped,rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=_memoizeCapped(function(e){var r=[];return 46===e.charCodeAt(0)&&r.push(""),e.replace(rePropName,function(e,t,i,n){r.push(i?n.replace(reEscapeChar,"$1"):t||e)}),r}),_stringToPath=stringToPath;function arrayMap(e,t){for(var i=-1,n=null==e?0:e.length,r=Array(n);++i<n;)r[i]=t(e[i],i,e);return r}var _arrayMap=arrayMap,INFINITY$1=1/0,symbolProto=_Symbol?_Symbol.prototype:void 0,symbolToString=symbolProto?symbolProto.toString:void 0;function baseToString(e){if("string"==typeof e)return e;if(isArray_1(e))return _arrayMap(e,baseToString)+"";if(isSymbol_1(e))return symbolToString?symbolToString.call(e):"";var t=e+"";return"0"==t&&1/e==-INFINITY$1?"-0":t}var _baseToString=baseToString;function toString(e){return null==e?"":_baseToString(e)}var toString_1=toString;function castPath(e,t){return isArray_1(e)?e:_isKey(e,t)?[e]:_stringToPath(toString_1(e))}var _castPath=castPath,INFINITY$2=1/0;function toKey(e){if("string"==typeof e||isSymbol_1(e))return e;var t=e+"";return"0"==t&&1/e==-INFINITY$2?"-0":t}var _toKey=toKey;function baseGet(e,t){for(var i=0,n=(t=_castPath(t,e)).length;null!=e&&i<n;)e=e[_toKey(t[i++])];return i&&i==n?e:void 0}var _baseGet=baseGet;function get(e,t,i){var n=null==e?void 0:_baseGet(e,t);return void 0===n?i:n}var get_1=get,now=function(){return _root.Date.now()},now_1=now,FUNC_ERROR_TEXT$2="Expected a function",nativeMax$4=Math.max,nativeMin$2=Math.min;function debounce(n,r,e){var s,a,o,c,l,u,h=0,g=!1,d=!1,t=!0;if("function"!=typeof n)throw new TypeError(FUNC_ERROR_TEXT$2);function p(e){var t=s,i=a;return s=a=void 0,h=e,c=n.apply(i,t)}function f(e){var t=e-u;return void 0===u||r<=t||t<0||d&&o<=e-h}function y(){var e,t,i=now_1();if(f(i))return m(i);l=setTimeout(y,(t=r-((e=i)-u),d?nativeMin$2(t,o-(e-h)):t))}function m(e){return l=void 0,t&&s?p(e):(s=a=void 0,c)}function i(){var e,t=now_1(),i=f(t);if(s=arguments,a=this,u=t,i){if(void 0===l)return h=e=u,l=setTimeout(y,r),g?p(e):c;if(d)return l=setTimeout(y,r),p(u)}return void 0===l&&(l=setTimeout(y,r)),c}return r=toNumber_1(r)||0,isObject_1(e)&&(g=!!e.leading,o=(d="maxWait"in e)?nativeMax$4(toNumber_1(e.maxWait)||0,r):o,t="trailing"in e?!!e.trailing:t),i.cancel=function(){void 0!==l&&clearTimeout(l),s=u=a=l=void(h=0)},i.flush=function(){return void 0===l?c:m(now_1())},i}var debounce_1=debounce,FUNC_ERROR_TEXT$3="Expected a function";function throttle(e,t,i){var n=!0,r=!0;if("function"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT$3);return isObject_1(i)&&(n="leading"in i?!!i.leading:n,r="trailing"in i?!!i.trailing:r),debounce_1(e,t,{leading:n,maxWait:t,trailing:r})}var throttle_1=throttle;function baseSlice(e,t,i){var n=-1,r=e.length;t<0&&(t=r<-t?0:r+t),(i=r<i?r:i)<0&&(i+=r),r=i<t?0:i-t>>>0,t>>>=0;for(var s=Array(r);++n<r;)s[n]=e[n+t];return s}var _baseSlice=baseSlice;function castSlice(e,t,i){var n=e.length;return i=void 0===i?n:i,!t&&n<=i?e:_baseSlice(e,t,i)}var _castSlice=castSlice;function charsEndIndex(e,t){for(var i=e.length;i--&&-1<_baseIndexOf(t,e[i],0););return i}var _charsEndIndex=charsEndIndex;function charsStartIndex(e,t){for(var i=-1,n=e.length;++i<n&&-1<_baseIndexOf(t,e[i],0););return i}var _charsStartIndex=charsStartIndex;function asciiToArray(e){return e.split("")}var _asciiToArray=asciiToArray,rsAstralRange="\\ud800-\\udfff",rsComboMarksRange="\\u0300-\\u036f",reComboHalfMarksRange="\\ufe20-\\ufe2f",rsComboSymbolsRange="\\u20d0-\\u20ff",rsComboRange=rsComboMarksRange+reComboHalfMarksRange+rsComboSymbolsRange,rsVarRange="\\ufe0e\\ufe0f",rsZWJ="\\u200d",reHasUnicode=RegExp("["+rsZWJ+rsAstralRange+rsComboRange+rsVarRange+"]");function hasUnicode(e){return reHasUnicode.test(e)}var _hasUnicode=hasUnicode,rsAstralRange$1="\\ud800-\\udfff",rsComboMarksRange$1="\\u0300-\\u036f",reComboHalfMarksRange$1="\\ufe20-\\ufe2f",rsComboSymbolsRange$1="\\u20d0-\\u20ff",rsComboRange$1=rsComboMarksRange$1+reComboHalfMarksRange$1+rsComboSymbolsRange$1,rsVarRange$1="\\ufe0e\\ufe0f",rsAstral="["+rsAstralRange$1+"]",rsCombo="["+rsComboRange$1+"]",rsFitz="\\ud83c[\\udffb-\\udfff]",rsModifier="(?:"+rsCombo+"|"+rsFitz+")",rsNonAstral="[^"+rsAstralRange$1+"]",rsRegional="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair="[\\ud800-\\udbff][\\udc00-\\udfff]",rsZWJ$1="\\u200d",reOptMod=rsModifier+"?",rsOptVar="["+rsVarRange$1+"]?",rsOptJoin="(?:"+rsZWJ$1+"(?:"+[rsNonAstral,rsRegional,rsSurrPair].join("|")+")"+rsOptVar+reOptMod+")*",rsSeq=rsOptVar+reOptMod+rsOptJoin,rsSymbol="(?:"+[rsNonAstral+rsCombo+"?",rsCombo,rsRegional,rsSurrPair,rsAstral].join("|")+")",reUnicode=RegExp(rsFitz+"(?="+rsFitz+")|"+rsSymbol+rsSeq,"g");function unicodeToArray(e){return e.match(reUnicode)||[]}var _unicodeToArray=unicodeToArray;function stringToArray(e){return _hasUnicode(e)?_unicodeToArray(e):_asciiToArray(e)}var _stringToArray=stringToArray,reTrim$1=/^\s+|\s+$/g;function trim(e,t,i){if((e=toString_1(e))&&(i||void 0===t))return e.replace(reTrim$1,"");if(!e||!(t=_baseToString(t)))return e;var n=_stringToArray(e),r=_stringToArray(t),s=_charsStartIndex(n,r),a=_charsEndIndex(n,r)+1;return _castSlice(n,s,a).join("")}var trim_1=trim,nativeKeys=_overArg(Object.keys,Object),_nativeKeys=nativeKeys,objectProto$13=Object.prototype,hasOwnProperty$11=objectProto$13.hasOwnProperty;function baseKeys(e){if(!_isPrototype(e))return _nativeKeys(e);var t=[];for(var i in Object(e))hasOwnProperty$11.call(e,i)&&"constructor"!=i&&t.push(i);return t}var _baseKeys=baseKeys;function keys(e){return isArrayLike_1(e)?_arrayLikeKeys(e):_baseKeys(e)}var keys_1=keys;function baseForOwn(e,t){return e&&_baseFor(e,t,keys_1)}var _baseForOwn=baseForOwn;function createBaseEach(s,a){return function(e,t){if(null==e)return e;if(!isArrayLike_1(e))return s(e,t);for(var i=e.length,n=a?i:-1,r=Object(e);(a?n--:++n<i)&&!1!==t(r[n],n,r););return e}}var _createBaseEach=createBaseEach,baseEach=_createBaseEach(_baseForOwn),_baseEach=baseEach;function castFunction(e){return"function"==typeof e?e:identity_1}var _castFunction=castFunction;function forEach(e,t){return(isArray_1(e)?_arrayEach:_baseEach)(e,_castFunction(t))}var forEach_1=forEach,assignIn=_createAssigner(function(e,t){_copyObject(t,keysIn_1(t),e)}),assignIn_1=assignIn,extend=assignIn_1,DataView$1=_getNative(_root,"DataView"),_DataView=DataView$1,Promise$1=_getNative(_root,"Promise"),_Promise=Promise$1,Set=_getNative(_root,"Set"),_Set=Set,mapTag$1="[object Map]",objectTag$2="[object Object]",promiseTag="[object Promise]",setTag$1="[object Set]",weakMapTag$1="[object WeakMap]",dataViewTag$1="[object DataView]",dataViewCtorString=_toSource(_DataView),mapCtorString=_toSource(_Map),promiseCtorString=_toSource(_Promise),setCtorString=_toSource(_Set),weakMapCtorString=_toSource(_WeakMap),getTag=_baseGetTag;(_DataView&&getTag(new _DataView(new ArrayBuffer(1)))!=dataViewTag$1||_Map&&getTag(new _Map)!=mapTag$1||_Promise&&getTag(_Promise.resolve())!=promiseTag||_Set&&getTag(new _Set)!=setTag$1||_WeakMap&&getTag(new _WeakMap)!=weakMapTag$1)&&(getTag=function(e){var t=_baseGetTag(e),i=t==objectTag$2?e.constructor:void 0,n=i?_toSource(i):"";if(n)switch(n){case dataViewCtorString:return dataViewTag$1;case mapCtorString:return mapTag$1;case promiseCtorString:return promiseTag;case setCtorString:return setTag$1;case weakMapCtorString:return weakMapTag$1}return t});var _getTag=getTag,stringTag$1="[object String]";function isString(e){return"string"==typeof e||!isArray_1(e)&&isObjectLike_1(e)&&_baseGetTag(e)==stringTag$1}var isString_1=isString;function iteratorToArray(e){for(var t,i=[];!(t=e.next()).done;)i.push(t.value);return i}var _iteratorToArray=iteratorToArray;function mapToArray(e){var i=-1,n=Array(e.size);return e.forEach(function(e,t){n[++i]=[t,e]}),n}var _mapToArray=mapToArray;function setToArray(e){var t=-1,i=Array(e.size);return e.forEach(function(e){i[++t]=e}),i}var _setToArray=setToArray;function baseValues(t,e){return _arrayMap(e,function(e){return t[e]})}var _baseValues=baseValues;function values(e){return null==e?[]:_baseValues(e,keys_1(e))}var values_1=values,mapTag$2="[object Map]",setTag$2="[object Set]",symIterator=_Symbol?_Symbol.iterator:void 0;function toArray(e){if(!e)return[];if(isArrayLike_1(e))return isString_1(e)?_stringToArray(e):_copyArray(e);if(symIterator&&e[symIterator])return _iteratorToArray(e[symIterator]());var t=_getTag(e);return(t==mapTag$2?_mapToArray:t==setTag$2?_setToArray:values_1)(e)}var toArray_1=toArray,mapTag$3="[object Map]",setTag$3="[object Set]",objectProto$14=Object.prototype,hasOwnProperty$12=objectProto$14.hasOwnProperty;function isEmpty(e){if(null==e)return!0;if(isArrayLike_1(e)&&(isArray_1(e)||"string"==typeof e||"function"==typeof e.splice||isBuffer_1(e)||isTypedArray_1(e)||isArguments_1(e)))return!e.length;var t=_getTag(e);if(t==mapTag$3||t==setTag$3)return!e.size;if(_isPrototype(e))return!_baseKeys(e).length;for(var i in e)if(hasOwnProperty$12.call(e,i))return!1;return!0}var isEmpty_1=isEmpty,dateTag$1="[object Date]";function baseIsDate(e){return isObjectLike_1(e)&&_baseGetTag(e)==dateTag$1}var _baseIsDate=baseIsDate,nodeIsDate=_nodeUtil&&_nodeUtil.isDate,isDate=nodeIsDate?_baseUnary(nodeIsDate):_baseIsDate,isDate_1=isDate,numberTag$1="[object Number]";function isNumber(e){return"number"==typeof e||isObjectLike_1(e)&&_baseGetTag(e)==numberTag$1}var isNumber_1=isNumber;function isNil(e){return null==e}var isNil_1=isNil;function isElement(e){return isObjectLike_1(e)&&1===e.nodeType&&!isPlainObject_1(e)}var isElement_1=isElement,objectProto$15=Object.prototype,hasOwnProperty$13=objectProto$15.hasOwnProperty;function baseHas(e,t){return null!=e&&hasOwnProperty$13.call(e,t)}var _baseHas=baseHas;function hasPath(e,t,i){for(var n=-1,r=(t=_castPath(t,e)).length,s=!1;++n<r;){var a=_toKey(t[n]);if(!(s=null!=e&&i(e,a)))break;e=e[a]}return s||++n!=r?s:!!(r=null==e?0:e.length)&&isLength_1(r)&&_isIndex(a,r)&&(isArray_1(e)||isArguments_1(e))}var _hasPath=hasPath;function has(e,t){return null!=e&&_hasPath(e,t,_baseHas)}var has_1=has,_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},createClass=function(){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}}(),defineProperty$2=function(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e},_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},objectWithoutProperties=function(e,t){var i={};for(var n in e)0<=t.indexOf(n)||Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n]);return i},toConsumableArray=function(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)},_={max:max_1,merge:merge_1,get:get_1,throttle:throttle_1,trim:trim_1,bind:bind_1,each:forEach_1,ext:merge_1,extend:extend,isArray:isArray_1,isFunction:isFunction_1,isObject:isObject_1,isArguments:isArguments_1,toArray:toArray_1,values:values_1,identity:identity_1,isEmpty:isEmpty_1,isEmptyObject:isEmpty_1,isString:isString_1,isDate:isDate_1,isNumber:isNumber_1,isElement:isElement_1,isNil:isNil_1,debounce:debounce_1,has:has_1},ArrayProto=Array.prototype,nativeIndexOf=ArrayProto.indexOf,breaker={},tm;_.bind_instance_methods=function(e){for(var t in e)"function"==typeof e[t]&&(e[t]=_.bind(e[t],e))},_.isDefined=function(e){return!_.isUndefined(e)},_.isUndefined=function(e){return null===e||(void 0===e?"undefined":_typeof(e))===constants.symbols.UNDEFINED},_.include=function(e,t){var i=!1;return null===e?i:nativeIndexOf&&e.indexOf===nativeIndexOf?-1!=e.indexOf(t):(_.each(e,function(e){if(i||(i=e===t))return breaker}),i)},_.includes=function(e,t){return-1!==e.indexOf(t)},_.timestamp=function(){return Date.now=Date.now||function(){return+new Date},Date.now()},_.now=_.timestamp,_.formatDate=function(e){function t(e){return e<10?"0"+e:e}return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())},_.strip_empty_properties=function(e){var i={};return _.each(e,function(e,t){_.isString(e)&&0<e.length&&(i[t]=e)}),i},_.UUID=(tm=function(){for(var e=1*new Date,t=0;e==1*new Date;)t++;return e.toString(16)+t.toString(16)},function(){var e=(screen.height*screen.width).toString(16);return tm()+"-"+Math.random().toString(16).replace(".","")+"-"+function(){var e,t,i=windowNavigator.userAgent,r=[],n=0;function s(e,t){var i,n=0;for(i=0;i<t.length;i++)n|=r[i]<<8*i;return e^n}for(e=0;e<i.length;e++)t=i.charCodeAt(e),r.unshift(255&t),4<=r.length&&(n=s(n,r),r=[]);return 0<r.length&&(n=s(n,r)),n.toString(16)}()+"-"+e+"-"+tm()}),_.isBlockedUA=function(e){return!!/(google web preview|baiduspider|yandexbot|bingbot|googlebot|yahoo! slurp)/i.test(e)&&(logger.warn("Blocked UA Agent:"+e),!0)},_.isBlockedUAComplex=function(e){return!!new RegExp("(googlebot/|Googlebot-Mobile|Googlebot-Image|Google favicon|Mediapartners-Google|bingbot|slurp|java|wget|curl|Commons-HttpClient|Python-urllib|libwww|httpunit|nutch|phpcrawl|msnbot|jyxobot|FAST-WebCrawler|FAST Enterprise Crawler|biglotron|teoma|convera|seekbot|gigablast|exabot|ngbot|ia_archiver|GingerCrawler|webmon |httrack|webcrawler|grub.org|UsineNouvelleCrawler|antibot|netresearchserver|speedy|fluffy|bibnum.bnf|findlink|msrbot|panscient|yacybot|AISearchBot|IOI|ips-agent|tagoobot|MJ12bot|dotbot|woriobot|yanga|buzzbot|mlbot|yandexbot|purebot|Linguee Bot|Voyager|CyberPatrol|voilabot|baiduspider|citeseerxbot|spbot|twengabot|postrank|turnitinbot|scribdbot|page2rss|sitebot|linkdex|Adidxbot|blekkobot|ezooms|dotbot|Mail.RU_Bot|discobot|heritrix|findthatfile|europarchive.org|NerdByNature.Bot|sistrix crawler|ahrefsbot|Aboundex|domaincrawler|wbsearchbot|summify|ccbot|edisterbot|seznambot|ec2linkfinder|gslfbot|aihitbot|intelium_bot|facebookexternalhit|yeti|RetrevoPageAnalyzer|lb-spider|sogou|lssbot|careerbot|wotbox|wocbot|ichiro|DuckDuckBot|lssrocketcrawler|drupact|webcompanycrawler|acoonbot|openindexspider|gnam gnam spider|web-archive-net.com.bot|backlinkcrawler|coccoc|integromedb|content crawler spider|toplistbot|seokicks-robot|it2media-domain-crawler|ip-web-crawler.com|siteexplorer.info|elisabot|proximic|changedetection|blexbot|arabot|WeSEE:Search|niki-bot|CrystalSemanticsBot|rogerbot|360Spider|psbot|InterfaxScanBot|Lipperhey SEO Service|CC Metadata Scaper|g00g1e.net|GrapeshotCrawler|urlappendbot|brainobot|fr-crawler|binlar|SimpleCrawler|Livelapbot|Twitterbot|cXensebot|smtbot|bnf.fr_bot|A6-Indexer|ADmantX|Facebot|Twitterbot|OrangeBot|memorybot|AdvBot|MegaIndex|SemanticScholarBot|ltx71|nerdybot|xovibot|BUbiNG|Qwantify|archive.org_bot|Applebot|TweetmemeBot|crawler4j|findxbot|SemrushBot|yoozBot|lipperhey|y!j-asr|Domain Re-Animator Bot|AddThis|PhantomJS)","i").test(windowNavigator.userAgent)&&(logger.warn("Blocked UA Agent Complex:"+e),!0)},_.domReady=function(i){var e,n=[],t=windowDocument,r=t.documentElement,s=r.doScroll,a="DOMContentLoaded",o="addEventListener",c="onreadystatechange",l="readyState",u=(s?/^loaded|^c/:/^loaded|c/).test(t[l]);function h(e){for(u=1,e=n.shift();e;)e(),e=n.shift()}return t[o]&&t[o](a,e=function(){t.removeEventListener(a,e,!1),h()},!1),s&&t.attachEvent(c,e=function(){/^c/.test(t[l])&&(t.detachEvent(c,e),h())}),i=s?function(t){self!=top?u?t():n.push(t):function(){try{r.doScroll("left")}catch(e){return setTimeout(function(){i(t)},50)}t()}()}:function(e){u?e():n.push(e)}},_.aurycOverride=function(e){var t=(""+window.location.hash).toLowerCase();return t&&8<t.length&&-1<t.indexOf("aurycoverride")&&-1<t.indexOf(e)},_.disableEvent=function(e){return!1},_.Diff=function(e,t){for(var i=_.max([e.length,t.length]),n=0,r=0,s=0;15<i-n;)s=i-Math.round((i-n)/2),e.substr(0,s)!=t.substr(0,s)?i=s:n=s;var a=t.substr(n);for(i=a.length;15<i-r;)s=i-Math.round((i-r)/2),a.substr(a.length-s)!==e.substr(e.length-s)?i=s:r=s;return{s:n,e:r,v:t.substring(n,t.length-r)}},_.addEventListener=function(e,t,i,n){"propertychange"!==t&&e.addEventListener?e.addEventListener(t,i,n):e.attachEvent&&e.attachEvent("on"+t,i)},_.inArray=function(e,t){var i=-1;for(var n in t)t[n]===e&&(i=n);return-1!=i},_.isValidColor=function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},_.isEmail=function(e){return/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(e)};var b64c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b64u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",b64pad="=";function decodeBase64(e){var t="";if(5<e.length){var i=e.length-5;t=e.substring(i)+e.substring(0,i)}return base64_decode(t)}function encodeBase64(e){var t=base64url_encode(e);if(5<t.length){var i=t.substring(0,5);t=t.substring(5)+i}return t}function base64_encode_data(e,t,i){var n,r="";for(n=0;n<=t-3;n+=3)r+=i.charAt(e.charCodeAt(n)>>>2),r+=i.charAt((3&e.charCodeAt(n))<<4|e.charCodeAt(n+1)>>>4),r+=i.charAt((15&e.charCodeAt(n+1))<<2|e.charCodeAt(n+2)>>>6),r+=i.charAt(63&e.charCodeAt(n+2));return t%3==2?(r+=i.charAt(e.charCodeAt(n)>>>2),r+=i.charAt((3&e.charCodeAt(n))<<4|e.charCodeAt(n+1)>>>4),r+=i.charAt((15&e.charCodeAt(n+1))<<2),r+=b64pad):t%3==1&&(r+=i.charAt(e.charCodeAt(n)>>>2),r+=i.charAt((3&e.charCodeAt(n))<<4),r+=b64pad,r+=b64pad),r}function base64_encode(e){var t=unescape(encodeURIComponent(e));return base64_encode_data(t,t.length,b64c)}function base64url_encode(e){var t=unescape(encodeURIComponent(e));return base64_encode_data(t,t.length,b64u)}function base64_charIndex(e){return"+"==e?62:"/"==e?63:b64u.indexOf(e)}function base64_decode(e){var t,i,n,r,s,a="",o=e.length;for(t=0;t<=o-2;t+=4)i=base64_charIndex(e.charAt(t+0)),n=base64_charIndex(e.charAt(t+1)),r=base64_charIndex(e.charAt(t+2)),s=base64_charIndex(e.charAt(t+3)),a+=String.fromCharCode(i<<2|n>>>4),t+2<o&&e.charAt(t+2)!==b64pad&&(a+=String.fromCharCode(n<<4&240|r>>>2&15)),t+3<o&&e.charAt(t+3)!==b64pad&&(a+=String.fromCharCode(r<<6&192|s));return a=decodeURIComponent(escape(a))}function sha1(e){var t,i,n,r,s,a,o,c,l,u,h=function(e,t){return e<<t|e>>>32-t},g=function(e){var t,i="";for(t=7;0<=t;t--)i+=(e>>>4*t&15).toString(16);return i},d=[],p=1732584193,f=4023233417,y=2562383102,m=271733878,b=3285377520,I=[];for(u=(e=unescape(encodeURIComponent(e))).length,i=0;i<u-3;i+=4)n=e.charCodeAt(i)<<24|e.charCodeAt(i+1)<<16|e.charCodeAt(i+2)<<8|e.charCodeAt(i+3),I.push(n);switch(3&u){case 0:i=2147483648;break;case 1:i=e.charCodeAt(u-1)<<24|8388608;break;case 2:i=e.charCodeAt(u-2)<<24|e.charCodeAt(u-1)<<16|32768;break;case 3:i=e.charCodeAt(u-3)<<24|e.charCodeAt(u-2)<<16|e.charCodeAt(u-1)<<8|128}for(I.push(i);14!=(15&I.length);)I.push(0);for(I.push(u>>>29),I.push(u<<3&4294967295),t=0;t<I.length;t+=16){for(i=0;i<16;i++)d[i]=I[t+i];for(i=16;i<=79;i++)d[i]=h(d[i-3]^d[i-8]^d[i-14]^d[i-16],1);for(r=p,s=f,a=y,o=m,c=b,i=0;i<=19;i++)l=h(r,5)+(s&a|~s&o)+c+d[i]+1518500249&4294967295,c=o,o=a,a=h(s,30),s=r,r=l;for(i=20;i<=39;i++)l=h(r,5)+(s^a^o)+c+d[i]+1859775393&4294967295,c=o,o=a,a=h(s,30),s=r,r=l;for(i=40;i<=59;i++)l=h(r,5)+(s&a|s&o|a&o)+c+d[i]+2400959708&4294967295,c=o,o=a,a=h(s,30),s=r,r=l;for(i=60;i<=79;i++)l=h(r,5)+(s^a^o)+c+d[i]+3395469782&4294967295,c=o,o=a,a=h(s,30),s=r,r=l;p=p+r&4294967295,f=f+s&4294967295,y=y+a&4294967295,m=m+o&4294967295,b=b+c&4294967295}return(l=g(p)+g(f)+g(y)+g(m)+g(b)).toLowerCase()}function hashCode(e){var t=0,i=0;if(0===e.length)return t;for(i=0;i<e.length;i++)t=(t<<5)-t+e.charCodeAt(i),t&=t;return t}function isValidBase64Char(e){return e===b64pad||0<b64c.indexOf(e)}function shiftString(e){if(e&&5<e.length){var t=e.substring(0,5);e=e.substring(e.length-5)+e.substring(5,e.length-5)+t}return e}var encoder={decodeBase64:decodeBase64,encodeBase64:encodeBase64,base64_decode_original:base64_encode,sha1:sha1,hashCode:hashCode,isValidBase64Char:isValidBase64Char,shiftString:shiftString};function hasFeature(e){var t=getExternalConfig()||{};return _.has(t,e)}function getExternalConfig(){return window.aurycJSSDKFE||window.aurycJSSDKEFE&&(window.aurycJSSDKFE=JSON.parse(encoder.decodeBase64(window.aurycJSSDKEFE))),window.aurycJSSDKFE}function getFeature(e){var t=getExternalConfig()||{};return _.get(t,e)}function isFeatureEnabled(t,e){if(e&&_.aurycOverride(e))return!0;try{if(hasFeature(t))return getFeature(t+".flag");var i=null,n=t.split(".");for(var r in n)if(0!==(r=Number(r))){var s=n.slice(0,-r);if(hasFeature(s)){s.push("flag");var a=getFeature(s);if(null===a)continue;i=a,s.pop(),n=s;break}}if(null===i)return i=!1;var o=n.join(".");return logger.warn("Feature Toggle ["+t+"] not defined, inherit ["+i+"] from parent ["+o+"]"),i}catch(e){return logger.warn("Exception occurred when fetching features for "+t),logger.warn(e),!1}}var featureToggle={hasFeature:hasFeature,getExternalConfig:getExternalConfig,getFeature:getFeature,isFeatureEnabled:isFeatureEnabled};function buildQuery(e,t,i){var r=[];return _.each(t,function(e,t){var i=encodeURIComponent(e.toString()),n=encodeURIComponent(t);r.push(n+"="+i)}),(e||"")+r.join(i||"&")}function asyncReq(e){var t=new window.XMLHttpRequest,i=e.type||e.method,n=e.url,r=e.data,s=e.contentType,a=e.onSuccess,o=e.onFailure;t.onload=function(){200<=t.status&&t.status<300?a&&a(this.responseText):(logger.log("The request failed!"),o&&o(this.responseText))},t.open(i,n),s&&t.setRequestHeader("Content-Type",s),r?t.send(r):t.send()}var uaParser=createCommonjsModule(function(C,S){!function(r,h){var g="function",e="undefined",t="model",i="name",n="type",s="vendor",a="version",o="architecture",c="console",l="mobile",u="tablet",d="smarttv",p="wearable",f={extend:function(e,t){var i={};for(var n in e)t[n]&&t[n].length%2==0?i[n]=t[n].concat(e[n]):i[n]=e[n];return i},has:function(e,t){return"string"==typeof e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return"string"==typeof e?e.replace(/[^\d\.]/g,"").split(".")[0]:h},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},y={rgx:function(e,t){for(var i,n,r,s,a,o,c=0;c<t.length&&!a;){var l=t[c],u=t[c+1];for(i=n=0;i<l.length&&!a;)if(a=l[i++].exec(e))for(r=0;r<u.length;r++)o=a[++n],"object"==typeof(s=u[r])&&0<s.length?2==s.length?typeof s[1]==g?this[s[0]]=s[1].call(this,o):this[s[0]]=s[1]:3==s.length?typeof s[1]!==g||s[1].exec&&s[1].test?this[s[0]]=o?o.replace(s[1],s[2]):h:this[s[0]]=o?s[1].call(this,o,s[2]):h:4==s.length&&(this[s[0]]=o?s[3].call(this,o.replace(s[1],s[2])):h):this[s]=o||h;c+=2}},str:function(e,t){for(var i in t)if("object"==typeof t[i]&&0<t[i].length){for(var n=0;n<t[i].length;n++)if(f.has(t[i][n],e))return"?"===i?h:i}else if(f.has(t[i],e))return"?"===i?h:i;return e}},m={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},b={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[i,a],[/(opios)[\/\s]+([\w\.]+)/i],[[i,"Opera Mini"],a],[/\s(opr)\/([\w\.]+)/i],[[i,"Opera"],a],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark)\/([\w\.-]+)/i],[i,a],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[i,"IE"],a],[/(edge|edgios|edga)\/((\d+)?[\w\.]+)/i],[[i,"Edge"],a],[/(yabrowser)\/([\w\.]+)/i],[[i,"Yandex"],a],[/(puffin)\/([\w\.]+)/i],[[i,"Puffin"],a],[/(focus)\/([\w\.]+)/i],[[i,"Firefox Focus"],a],[/(opt)\/([\w\.]+)/i],[[i,"Opera Touch"],a],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[i,"UCBrowser"],a],[/(comodo_dragon)\/([\w\.]+)/i],[[i,/_/g," "],a],[/(micromessenger)\/([\w\.]+)/i],[[i,"WeChat"],a],[/(brave)\/([\w\.]+)/i],[[i,"Brave"],a],[/(qqbrowserlite)\/([\w\.]+)/i],[i,a],[/(QQ)\/([\d\.]+)/i],[i,a],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[i,a],[/(BIDUBrowser)[\/\s]?([\w\.]+)/i],[i,a],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[i,a],[/(MetaSr)[\/\s]?([\w\.]+)/i],[i],[/(LBBROWSER)/i],[i],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[a,[i,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[a,[i,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[i,a],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[a,[i,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[i,/(.+)/,"$1 WebView"],a],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[i,/(.+(?:g|us))(.+)/,"$1 $2"],a],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[a,[i,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[i,a],[/(dolfin)\/([\w\.]+)/i],[[i,"Dolphin"],a],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[i,"Chrome"],a],[/(coast)\/([\w\.]+)/i],[[i,"Opera Coast"],a],[/fxios\/([\w\.-]+)/i],[a,[i,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[a,[i,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[a,i],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[i,"GSA"],a],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[i,[a,y.str,m.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[i,a],[/(navigator|netscape)\/([\w\.-]+)/i],[[i,"Netscape"],a],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[i,a]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[o,"amd64"]],[/(ia32(?=;))/i],[[o,f.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[o,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[o,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[o,/ower/,"",f.lowerize]],[/(sun4\w)[;\)]/i],[[o,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[o,f.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[t,s,[n,u]],[/applecoremedia\/[\w\.]+ \((ipad)/],[t,[s,"Apple"],[n,u]],[/(apple\s{0,1}tv)/i],[[t,"Apple TV"],[s,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[s,t,[n,u]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[t,[s,"Amazon"],[n,u]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[t,y.str,m.device.amazon.model],[s,"Amazon"],[n,l]],[/android.+aft([bms])\sbuild/i],[t,[s,"Amazon"],[n,d]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[t,s,[n,l]],[/\((ip[honed|\s\w*]+);/i],[t,[s,"Apple"],[n,l]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[s,t,[n,l]],[/\(bb10;\s(\w+)/i],[t,[s,"BlackBerry"],[n,l]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone)/i],[t,[s,"Asus"],[n,u]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[s,"Sony"],[t,"Xperia Tablet"],[n,u]],[/android.+\s([c-g]\d{4}|so[-l]\w+)\sbuild\//i],[t,[s,"Sony"],[n,l]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[s,t,[n,c]],[/android.+;\s(shield)\sbuild/i],[t,[s,"Nvidia"],[n,c]],[/(playstation\s[34portablevi]+)/i],[t,[s,"Sony"],[n,c]],[/(sprint\s(\w+))/i],[[s,y.str,m.device.sprint.vendor],[t,y.str,m.device.sprint.model],[n,l]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[s,t,[n,u]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[s,[t,/_/g," "],[n,l]],[/(nexus\s9)/i],[t,[s,"HTC"],[n,u]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p)/i],[t,[s,"Huawei"],[n,l]],[/(microsoft);\s(lumia[\s\w]+)/i],[s,t,[n,l]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[t,[s,"Microsoft"],[n,c]],[/(kin\.[onetw]{3})/i],[[t,/\./g," "],[s,"Microsoft"],[n,l]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[t,[s,"Motorola"],[n,l]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[t,[s,"Motorola"],[n,u]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[s,f.trim],[t,f.trim],[n,d]],[/hbbtv.+maple;(\d+)/i],[[t,/^/,"SmartTV"],[s,"Samsung"],[n,d]],[/\(dtv[\);].+(aquos)/i],[t,[s,"Sharp"],[n,d]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[s,"Samsung"],t,[n,u]],[/smart-tv.+(samsung)/i],[s,[n,d],t],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[s,"Samsung"],t,[n,l]],[/sie-(\w*)/i],[t,[s,"Siemens"],[n,l]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[s,"Nokia"],t,[n,l]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[t,[s,"Acer"],[n,u]],[/android.+([vl]k\-?\d{3})\s+build/i],[t,[s,"LG"],[n,u]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[s,"LG"],t,[n,u]],[/(lg) netcast\.tv/i],[s,t,[n,d]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[t,[s,"LG"],[n,l]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[t,[s,"Lenovo"],[n,u]],[/linux;.+((jolla));/i],[s,t,[n,l]],[/((pebble))app\/[\d\.]+\s/i],[s,t,[n,p]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[s,t,[n,l]],[/crkey/i],[[t,"Chromecast"],[s,"Google"]],[/android.+;\s(glass)\s\d/i],[t,[s,"Google"],[n,p]],[/android.+;\s(pixel c)[\s)]/i],[t,[s,"Google"],[n,u]],[/android.+;\s(pixel( [23])?( xl)?)\s/i],[t,[s,"Google"],[n,l]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[t,/_/g," "],[s,"Xiaomi"],[n,l]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[t,/_/g," "],[s,"Xiaomi"],[n,u]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[t,[s,"Meizu"],[n,u]],[/(mz)-([\w-]{2,})/i],[[s,"Meizu"],t,[n,l]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})\s+build/i],[t,[s,"OnePlus"],[n,l]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[t,[s,"RCA"],[n,u]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[t,[s,"Dell"],[n,u]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[t,[s,"Verizon"],[n,u]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[s,"Barnes & Noble"],t,[n,u]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[t,[s,"NuVision"],[n,u]],[/android.+;\s(k88)\sbuild/i],[t,[s,"ZTE"],[n,u]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[t,[s,"Swiss"],[n,l]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[t,[s,"Swiss"],[n,u]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[t,[s,"Zeki"],[n,u]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[s,"Dragon Touch"],t,[n,u]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[t,[s,"Insignia"],[n,u]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[t,[s,"NextBook"],[n,u]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[s,"Voice"],t,[n,l]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[s,"LvTel"],t,[n,l]],[/android.+;\s(PH-1)\s/i],[t,[s,"Essential"],[n,l]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[t,[s,"Envizen"],[n,u]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[s,t,[n,u]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[t,[s,"MachSpeed"],[n,u]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[s,t,[n,u]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[t,[s,"Rotor"],[n,u]],[/android.+(KS(.+))\s+build/i],[t,[s,"Amazon"],[n,u]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[s,t,[n,u]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[n,f.lowerize],s,t],[/(android[\w\.\s\-]{0,9});.+build/i],[t,[s,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[a,[i,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[i,a],[/rv\:([\w\.]{1,9}).+(gecko)/i],[a,i]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[i,a],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[i,[a,y.str,m.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[i,"Windows"],[a,y.str,m.os.windows.version]],[/\((bb)(10);/i],[[i,"BlackBerry"],a],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]*)/i,/linux;.+(sailfish);/i],[i,a],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[i,"Symbian"],a],[/\((series40);/i],[i],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[i,"Firefox OS"],a],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[i,a],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[i,"Chromium OS"],a],[/(sunos)\s?([\w\.\d]*)/i],[[i,"Solaris"],a],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[i,a],[/(haiku)\s(\w+)/i],[i,a],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[a,/_/g,"."],[i,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[i,"Mac OS"],[a,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[i,a]]},I=function(e,t){if("object"==typeof e&&(t=e,e=h),!(this instanceof I))return new I(e,t).getResult();var i=e||(r&&r.navigator&&r.navigator.userAgent?r.navigator.userAgent:""),n=t?f.extend(b,t):b;return this.getBrowser=function(){var e={name:h,version:h};return y.rgx.call(e,i,n.browser),e.major=f.major(e.version),e},this.getCPU=function(){var e={architecture:h};return y.rgx.call(e,i,n.cpu),e},this.getDevice=function(){var e={vendor:h,model:h,type:h};return y.rgx.call(e,i,n.device),e},this.getEngine=function(){var e={name:h,version:h};return y.rgx.call(e,i,n.engine),e},this.getOS=function(){var e={name:h,version:h};return y.rgx.call(e,i,n.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(e){return i=e,this},this};I.VERSION="0.7.19",I.BROWSER={NAME:i,MAJOR:"major",VERSION:a},I.CPU={ARCHITECTURE:o},I.DEVICE={MODEL:t,VENDOR:s,TYPE:n,CONSOLE:c,MOBILE:l,SMARTTV:d,TABLET:u,WEARABLE:p,EMBEDDED:"embedded"},I.ENGINE={NAME:i,VERSION:a},I.OS={NAME:i,VERSION:a},C.exports&&(S=C.exports=I),S.UAParser=I;var v=r&&(r.jQuery||r.Zepto);if(typeof v!==e&&!v.ua){var A=new I;v.ua=A.getResult(),v.ua.get=function(){return A.getUA()},v.ua.set=function(e){A.setUA(e);var t=A.getResult();for(var i in t)v.ua[i]=t[i]}}}("object"==typeof window?window:commonjsGlobal)}),uaParser_1=uaParser.UAParser,PubSubTopic=function(){function e(){classCallCheck(this,e),this.listeners=[]}return createClass(e,[{key:"addListener",value:function(e){this.listeners.push(e)}},{key:"publishTopic",value:function(){for(var e=0;e<this.listeners.length;e++)this.listeners[e].apply(this,arguments)}}]),e}(),PubSub=function(){function e(){classCallCheck(this,e),this.topics={},this.topicId=-1}return createClass(e,[{key:"addListener",value:function(e,t){if("function"!=typeof t||"string"!=typeof e)return!1;this.topics.hasOwnProperty(e)||(this.topics[e]=new PubSubTopic(e)),this.topics[e].addListener(t)}},{key:"publish",value:function(e,t){if(!this.topics.hasOwnProperty(e))return!1;try{this.topics[e].publishTopic(t)}catch(e){return logger.log("publish event error: ",e),!0}return!0}},{key:"findTopic",value:function(e){return!!this.topics.hasOwnProperty(e)}}]),e}(),AurycPubSub=new PubSub;function getQueryParam(e,t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(e);return null===i||i&&"string"!=typeof i[1]&&i[1].length?"":decodeURIComponent(i[1]).replace(/\+/g," ")}function getHashParam(e,t){var i=e.match(new RegExp(t+"=([^&]*)"));return i?decodeURIComponent(i[1]):null}function isPrivateIP(e){return!(!e||!(-1<e.indexOf("localhost")||/(^127\.)|(^192\.168\.)|(^10\.)|(^172\.1[6-9]\.)|(^172\.2[0-9]\.)|(^172\.3[0-1]\.)|(^::1$)|(^[fF][cCdD])/.test(e)))&&(logger.log("found private ip:"+e),!0)}function isSameDomain(e,t){var i=windowDocument.createElement("a");i.href=windowLocation.href;var n=i.hostname,r=i.protocol;i.href=e;var s=i.hostname||n,a=0===i.protocol.indexOf("http")?i.protocol:r;i.href=t;var o=i.hostname||n,c=0===i.protocol.indexOf("http")?i.protocol:r;return s.toLowerCase()===o.toLowerCase()&&a.toLowerCase()===c.toLowerCase()}function getRootDomain(e){var t=getTopDomain();return t?(logger.log("domain 1: "+t),t):isPrivateIP(e)?"localhost":e.toLowerCase().split(".").slice(-2).join(".")}function getTopDomain(){var e,t,i="weird_get_top_level_domain=cookie",n=document.location.hostname.split(".");for(e=n.length-1;0<=e;e--)if(t=n.slice(e).join("."),document.cookie=i+";domain=."+t+";",-1<document.cookie.indexOf(i))return document.cookie=i.split("=")[0]+"=;domain=."+t+";expires=Thu, 01 Jan 1970 00:00:01 GMT;",t}function matchSingleUrl(t,e){t=t.toLowerCase();var i="is";if(0<(e=e.toLowerCase()).indexOf("*")?(i="starts",e=e.replace(/\*/g,"")):0===e.indexOf("*")&&(i="contains",e=e.replace(/\*/g,"")),"is"===i)return t===e;if("starts"!==i)return!e.split(",").find(function(e){return t.indexOf(e.trim())<0});if(t.length<e.length)return!1;for(var n=0;n<e.length;n++)if(t.charCodeAt(n)!==e.charCodeAt(n))return!1;return!0}function containsUrl(e,t){for(var i=0;i<t.length;i++)if(matchSingleUrl(e,t[i]))return!0;return!1}function campaignParams(){var e="utm_source utm_medium utm_campaign utm_content utm_term".split(" "),t="",i={};return _.each(e,function(e){(t=_.trim(getQueryParam(document.URL,e))).length&&(i[e]=t)}),i}function getLinkidParams(){var e=[];e.push(constants.linkid.id);var t="",i={};return _.each(e,function(e){(t=_.trim(getQueryParam(document.URL,e))).length&&(i[e]=t)}),i}function searchEngine(e){return 0===e.search("https?://(.*)google.([^/?]*)")?"google":0===e.search("https?://(.*)bing.com")?"bing":0===e.search("https?://(.*)yahoo.com")?"yahoo":0===e.search("https?://(.*)duckduckgo.com")?"duckduckgo":null}function browser(e,t,i){return t=t||window.navigator.vendor||"",i||_.includes(e," OPR/")?_.includes(e,"Mini")?"Opera Mini":"Opera":/(BlackBerry|PlayBook|BB10)/i.test(e)?"BlackBerry":_.includes(e,"IEMobile")||_.includes(e,"WPDesktop")?"Internet Explorer Mobile":_.includes(e,"Edge")?"Microsoft Edge":_.includes(e,"FBIOS")?"Facebook Mobile":_.includes(e,"Chrome")?"Chrome":_.includes(e,"CriOS")?"Chrome iOS":_.includes(e,"FxiOS")?"Firefox iOS":/Version\/([0-9\.]*)[\w\W]*Safari/i.test(e)?"Safari":_.includes(e,"Android")?"Android Mobile":_.includes(e,"Konqueror")?"Konqueror":_.includes(e,"Firefox")?"Firefox":_.includes(e,"MSIE")||_.includes(e,"Trident/")?"Internet Explorer":_.includes(e,"Gecko")?"Mozilla":""}function browserVersion(e,t,i){return browserAndVersion(e,t,i).version}function browserAndVersion(e,t,i){var n=browser(e=e||window.navigator.userAgent,t=t||window.navigator.vendor,i),r=null,s={"Internet Explorer Mobile":/rv:(\d+(\.\d+)?)/,"Microsoft Edge":/Edge\/(\d+(\.\d+)?)/,Chrome:/Chrome\/(\d+(\.\d+)?)/,"Chrome iOS":/CriOS\/(\d+(\.\d+)?)/,Safari:/Version\/(\d+(\.\d+)?)/,"Mobile Safari":/Version\/(\d+(\.\d+)?)/,Opera:/(Opera|OPR)\/(\d+(\.\d+)?)/,Firefox:/Firefox\/(\d+(\.\d+)?)/,"Firefox iOS":/FxiOS\/(\d+(\.\d+)?)/,Konqueror:/Konqueror:(\d+(\.\d+)?)/,BlackBerry:/BlackBerry (\d+(\.\d+)?)/,"Android Mobile":/android\s(\d+(\.\d+)?)/,"Internet Explorer":/(rv:|MSIE )(\d+(\.\d+)?)/,Mozilla:/rv:(\d+(\.\d+)?)/}[n];if(void 0===s)r=null;else{var a=e.match(s);r=a?parseFloat(a[a.length-2]):null}return{name:n,version:r}}function osVersion(e){return new uaParser(e||window.navigator.userAgent).getResult().os.version}function device(e){return/Windows Phone/i.test(e)||/WPDesktop/.test(e)?"Windows Phone":/iPad/.test(e)?"iPad":/iPod/.test(e)?"iPod Touch":/iPhone/.test(e)?"iPhone":/(BlackBerry|PlayBook|BB10)/i.test(e)?"BlackBerry":/Android/.test(e)?"Android":""}function isMobile(e){return/IEMobile|android|blackberry|ipad|iphone|ipod|kindle|mini|nokia|silk|ucweb|windows ce|windows phone/i.test(e)}function isTablet(e){return/tablet|ipad|playbook|silk|(android(?!.*mobile))/i.test(e)}function isSmartphone(e){return isMobile(e)&&!isTablet(e)}function isIOS(e){return/ipad|iphone/i.test(e)}function isWindowsPhone(e){return/windows ce|IEMobile|windows phone/i.test(e)}function visibilityEventPrefix(){var e=null;if(void 0!==document.hidden)e="";else for(var t=["webkit","moz","ms","o"],i=0;i<t.length;i++)if(void 0!==document[t[i]+"Hidden"]){e=t[i];break}return e}function isSafari(){var e=browser(windowNavigator.userAgent,windowNavigator.vendor);return _.includes(e,"Safari")}function isInternetExp(){var e=browser(windowNavigator.userAgent,windowNavigator.vendor);return _.includes(e,"Internet Explorer")}function canUseVisibilityChange(){var e=browser(windowNavigator.userAgent,windowNavigator.vendor);return!!e&&(-1<e.indexOf("Firefox")||-1<e.indexOf("Chrome")?null!==visibilityEventPrefix():-1<e.indexOf("Safari")&&isMobile(windowNavigator.userAgent))}function referringDomain(e){var t=e.split("/");return 3<=t.length?t[2]:""}function isTouchDevice(){return"ontouchstart"in document.documentElement}function properties(){return _.extend(_.strip_empty_properties({$os:config.os(),$browser:browser(windowNavigator.userAgent,windowNavigator.vendor,win.opera),$referrer:document.referrer,$referring_domain:referringDomain(document.referrer),$device:device(windowNavigator.userAgent)}),{$current_url:windowLocation.href,$browser_version:browserVersion(windowNavigator.userAgent,windowNavigator.vendor,win.opera),$screen_height:screen.height,$screen_width:screen.width,$lib_version:config.getConfig("code_version")})}function locationInfo(){var e=windowLocation.protocol,t=":"===e.slice(-1)?e.slice(0,-1):e;return _.strip_empty_properties({protocol:t,domain:windowLocation.hostname&&windowLocation.hostname.toLowerCase(),port:windowLocation.port,path:windowLocation.pathname&&windowLocation.pathname.toLowerCase(),query:windowLocation.search&&windowLocation.search.toLowerCase(),hash:windowLocation.hash&&windowLocation.hash.toLowerCase()})}function pageviewInfo(e){return _.strip_empty_properties({page:e,referrer:document.referrer,browser:browser(windowNavigator.userAgent,windowNavigator.vendor,win.opera),platform:config.os()})}function addDomEvent(e,t,i,n){e.attachEvent?e.attachEvent("on"+t,i):e.addEventListener(t,i,n)}function removeDomEvent(e,t,i){e.detachEvent?e.detachEvent("on"+t,i):e.removeEventListener(t,i)}function getWinSize(e){return{w:e.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,h:e.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}}function getWinScrlPos(e){return{x:e.pageXOffset||e.document.documentElement.scrollLeft,y:e.pageYOffset||e.document.documentElement.scrollTop}}function getWinScrRes(e){return{w:(e=e||window).screen.width||0,h:e.screen.height||0}}var Browser=function(){function t(e){classCallCheck(this,t),this.brAvailEvent=new PubSubTopic,this.isAvail=!1,this.init(e||window.navigator.userAgent)}return createClass(t,[{key:"init",value:function(e){this.features={mobile:isMobile(e),smartphone:isSmartphone(e),tablet:isTablet(e),ios:isIOS(e),winphone:isWindowsPhone(e),deviceType:isMobile(e)?isTablet(e)?"Tablet":"Smartphone":"Desktop",isInternetExp:!1},this.browser={},this.os={},this.analyzeDetails(e)}},{key:"isInternetExp",value:function(){return this.features.isInternetExp}},{key:"initClientSide",value:function(e){var t=browserAndVersion();this.browser.name=t.name,this.browser.version=t.version,this.os.name=config.os(e),this.os.version=osVersion(e),this.features.isInternetExp="Internet Explorer"===this.browser.name,this.isAvail=!0,this.brAvailEvent.publishTopic()}},{key:"saveCurrBrData",value:function(e){var t=JSON.parse(e);this.browser.name=t.browser.name;var i=t.browser.version.split(".")[0];this.browser.version=i,this.os={name:t.os.name,version:t.os.version};var n=t.device&&t.device.type;this.features=_extends({},this.features,{mobile:"Tablet"===n||"Smartphone"===n||"Feature Phone"===n||"Other Mobile"===n,tablet:"Tablet"===n,deviceType:n}),this.isAvail=!0,this.brAvailEvent.publishTopic()}},{key:"clientSideDetectable",value:function(){return!0!==config.getConfig("ua_detect","behavior")||!this.features.mobile||this.features.ios||this.features.tablet||this.features.winphone}},{key:"getDT",value:function(){return this.features.deviceType}},{key:"analyzeDetails",value:function(e){var t=this,i="//"+(config.getConfig("device_uri")||"uba-detector.userty.com/useragent/")+"?accessToken=";if(this.clientSideDetectable())this.initClientSide(e);else{var n="_ar_br_",r=localStorage?localStorage.getItem(n):null;if(r)this.saveCurrBrData(r);else{var s={type:"GET"};s.url=i+constants.symbols.DEVICE+"&ua="+e,s.contentType="application/x-www-form-urlencoded",s.onSuccess=function(e){localStorage&&localStorage.setItem(n,e),t.saveCurrBrData(e)},s.failure=function(){t.initClientSide(e)},asyncReq(s)}}}},{key:"isPhone",value:function(){return this.features.winphone||this.features.mobile&&!this.features.tablet}},{key:"isPhoneOrTablet",value:function(){return this.features.mobile}}]),t}(),browserObj=null;function getInstance(){return null===browserObj&&(browserObj=new Browser),browserObj}function addDomMethods(i){return i.sel=function(e){return i.querySelectorAll(e)},i.addCssCls=function(e){-1===i.className.indexOf(e)&&(i.className&&(i.className+=" "),i.className+=e)},i.replaceCssCls=function(e,t){i.removeCssCls(e),i.addCssCls(t)},i.removeCssCls=function(e){i.className=(i.className||"").replace(e,"")},i.getStyle=function(e){return window.getComputedStyle?window.getComputedStyle(i)[e]:i.currentStyle?i.currentStyle[e]:void 0},i.css=function(e){for(var t in e)e.hasOwnProperty(t)&&(i.style[t]=e[t])},i}function toDomNode(e){if(!e)return null;var t=e;if(_.isString(e)&&""!==e){var i=document.createElement("div");i[constants.record.tags.IH]=e,t=i[constants.record.attr.FEC]}return addDomMethods(t)}function getMaxWinHeight(){var e=document.documentElement,t=Math.max(e.clientHeight,e.scrollHeight,e.offsetHeight),i=document.body,n=Math.max(i.scrollHeight,i.offsetHeight);return Math.max(t,n)}var brUtils={getHashParam:getHashParam,isPrivateIP:isPrivateIP,isSameDomain:isSameDomain,getRootDomain:getRootDomain,getTopDomain:getTopDomain,containsUrl:containsUrl,campaignParams:campaignParams,searchEngine:searchEngine,browser:browser,browserVersion:browserVersion,browserAndVersion:browserAndVersion,device:device,isMobile:isMobile,visibilityEventPrefix:visibilityEventPrefix,isSafari:isSafari,isInternetExp:isInternetExp,canUseVisibilityChange:canUseVisibilityChange,referringDomain:referringDomain,isTouchDevice:isTouchDevice,properties:properties,locationInfo:locationInfo,pageviewInfo:pageviewInfo,addDomEvent:addDomEvent,removeDomEvent:removeDomEvent,getWinSize:getWinSize,getScroll:getWinScrlPos,getScreenResolution:getWinScrRes,Browser:Browser,getInstance:getInstance,toDomNode:toDomNode,getQueryParam:getQueryParam,getLinkidParams:getLinkidParams},Cookie=function(){function o(e){classCallCheck(this,o),this.defaultConfigs=e||{}}return createClass(o,[{key:"isPrivateIP",value:function(e){return e&&(-1<e.indexOf("localhost")||/(^127\.)|(^192\.168\.)|(^10\.)|(^172\.1[6-9]\.)|(^172\.2[0-9]\.)|(^172\.3[0-1]\.)|(^::1$)|(^[fF][cCdD])/.test(e))}},{key:"setVal",value:function(e,t){var i=this.defaultConfigs;for(var n in e=encodeURIComponent(e),t=o.EncodeValue(i,t),i.duration&&(t+=";expires="+new Date(_.now()+i.duration*constants.time.FULL_DAY).toUTCString(),delete i.duration),i.domain&&this.isPrivateIP(i.domain)&&delete i.domain,i)i[n]&&(t+=";"+n+"="+i[n]);var r=e+"="+t;return document.cookie=r}},{key:"deleteCookie",value:function(e){document.cookie=e+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;"}},{key:"get",value:function(e){return o.Get(e)}},{key:"parse",value:function(e){return o.Parse(e)}}],[{key:"EncodeValue",value:function(e,t){return e.encode===constants.cookies.encoding.URI?t=encodeURIComponent(t):e.encode===constants.cookies.encoding.BASE64?t="__"+encoder.encodeBase64(t):_.isDefined(e.encode)&&(t="__"+encoder.encodeBase64(t)),t}},{key:"DecodeValue",value:function(e){if(!e||0===e.length)return e;var t=constants.cookies.encoding.BASE64;return"%"===e.charAt(0)?t=constants.cookies.encoding.URI:"_"===e.charAt(0)&&"_"===e.charAt(1)?(t=constants.cookies.encoding.BASE64,e=e.slice(2)):t=constants.cookies.encoding.NONE,t===constants.cookies.encoding.URI?decodeURIComponent(e):t===constants.cookies.encoding.BASE64?encoder.decodeBase64(e):e}},{key:"Replace",value:function(e,t,i,n){var r=o.Get(e),s=o.Get(t),a=new o(i);return null!==r&&null===s&&(a.setVal(t,r),n&&a.deleteCookie(e)),a}},{key:"GetSize",value:function(){return windowDocument.cookie.length}},{key:"Get",value:function(e){for(var t=e+"=",i=windowDocument.cookie.split(";"),n=0;n<i.length;n++){for(var r=i[n];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return o.DecodeValue(r.substring(t.length,r.length))}return null}},{key:"Parse",value:function(e){var t={};try{t=JSON.parse(o.Get(e))||{}}catch(e){}return t}}]),o}(),DataLayerImpl=function(){function r(e){classCallCheck(this,r);var t={};if(t.domain=brUtils.getRootDomain(window.location.hostname),t.path="/",t.encode=constants.cookies.encoding.BASE64,e.persistence!==constants.symbols.SESSION){var i=e.duration||constants.storage.DEFAULT_COOKIE_DURATION,n=new Date;n.setTime(n.getTime()+864e5*i),t.expires=n.toUTCString()}this.dlNS=e.namespace||constants.storage.DEFAULT_DATALAYER_PREFIX,this.userDataNS=this.dlNS+".u",this.dlBackend=null,e.replace?this.dlBackend=Cookie.Replace(e.replace,this.dlNS,t,!!e.killOld):(this.dlBackend=new Cookie(t),window.localStorage.removeItem(this.userDataNS)),this.dlObject=this.dlBackend.parse(this.dlNS),this.cachedUserProp={},window.localStorage.getItem(this.userDataNS)&&(this.cachedUserProp=JSON.parse(window.localStorage.getItem(this.userDataNS)))}return createClass(r,[{key:"setSessionByKey",value:function(e,t,i){i===constants.storage.SCOPE.SESSION.TAB?sessionStorage.setItem(e,JSON.stringify(t)):this.setByKey(e,t)}},{key:"setTabByKey",value:function(e,t){this.setSessionByKey(e,t,constants.storage.SCOPE.SESSION.TAB)}},{key:"setByKey",value:function(e,t){this.dlObject=this.dlBackend.parse(this.dlNS),this.dlObject[e]=t,this.commit()}},{key:"getByKeyFromMem",value:function(e){return this.dlObject[e]}},{key:"getByKey",value:function(e){var t=sessionStorage&&sessionStorage.getItem(e);return _.isDefined(t)&&!_.isNil(t)?JSON.parse(t):this.getFromCookie(e)}},{key:"getByKeyList",value:function(e){var i={},n=[];if(e.forEach(function(e){var t=sessionStorage&&sessionStorage.getItem(e);_.isDefined(t)&&!_.isNil(t)?i[e]=t:n.push(e)}),0<n.length){var t=this.getFromCookieMulti(n);return _extends({},i,t)}return i}},{key:"getFromCookieMulti",value:function(e){var t=this;try{this.dlObject=this.dlBackend.parse(this.dlNS);var i={};return e.forEach(function(e){t.dlObject[e]&&(i[e]=t.dlObject[e])}),i}catch(e){return{}}}},{key:"getFromCookie",value:function(e){try{return this.dlObject=this.dlBackend.parse(this.dlNS),this.dlObject[e]}catch(e){return null}}},{key:"commit",value:function(){var e=JSON.stringify(this.dlObject);this.dlBackend.setVal(this.dlNS,e)}},{key:"replace",value:function(e){this.dlBackend.setVal(this.dlNS,e)}},{key:"setUserProp",value:function(e,t){this.cachedUserProp[e]=t,localStorage.setItem(this.userDataNS,JSON.stringify(this.cachedUserProp))}},{key:"getUserProp",value:function(e){return this.cachedUserProp[e]}},{key:"resetUserProp",value:function(){this.cachedUserProp={},window.localStorage&&window.localStorage.removeItem(this.userDataNS)}},{key:"removeByKey",value:function(e){this.dlObject=this.dlBackend.parse(this.dlNS);var t=0;this.dlObject[e]&&(delete this.dlObject[e],t=1),1===t&&this.dlBackend.setVal(this.dlNS,JSON.stringify(this.dlObject)),null!==sessionStorage.getItem(e)&&sessionStorage.removeItem(e)}},{key:"isEmpty",value:function(){return _.isEmptyObject(this.dlObject)}},{key:"getSize",value:function(){return Cookie.GetSize()}},{key:"getStorageSize",value:function(){var e=0;for(var t in window.localStorage)window.localStorage.hasOwnProperty(t)&&(e+=2*(t.length+window.localStorage.getItem(t).length));return e}}]),r}(),winNameSingleton=null,WinNameDataLayer=function(){function t(e){classCallCheck(this,t),this.prefix=e||"",this.initObj("_auryc_"+this.prefix),this.initString("_auryc_"+this.prefix),this.reload()}return createClass(t,[{key:"initObj",value:function(e){this.objSize=0,this.objStart=e+"_OS_",this.objFinish=e+"_OF_",this.obj={}}},{key:"initString",value:function(e){this.strSize=0,this.strStart=e+"_SS_",this.strFinish=e+"_SF_",this.str=""}},{key:"clear",value:function(){this.initObj("_auryc_"+this.prefix),this.initString("_auryc_"+this.prefix)}},{key:"reload",value:function(){var e=_.isDefined(window.name)?window.name:"",t="",i=e.indexOf(this.objStart);if(-1<i){var n=i+this.objStart.length,r=e.indexOf(this.objFinish)-n;t=e.substr(n,r)}try{0<t.length&&(this.obj=JSON.parse(t),this.objSize=t.length)}catch(e){}var s="",a=e.indexOf(this.strStart);if(-1<a){var o=a+this.strStart.length,c=e.indexOf(this.strFinish)-o;s=e.substr(o,c)}try{0<s.length&&(this.str=s,this.strSize=s.length)}catch(e){}}},{key:"removeByKey",value:function(e){delete this.obj[e],this.objSize=JSON.stringify(this.obj).length}},{key:"getByKey",value:function(e){return this.obj[e]}},{key:"getStr",value:function(){return this.str}},{key:"setStr",value:function(e){_.isUndefined(e)||(this.str=e,this.strSize=e.length)}},{key:"setStrAndCommit",value:function(e){_.isUndefined(e)||(this.setStr(e),this.commit())}},{key:"setByKey",value:function(e,t){_.isDefined(e)&&_.isDefined(t)&&(this.obj[e]=t,this.objSize=JSON.stringify(this.obj).length)}},{key:"commit",value:function(){try{var e=_.isDefined(window.name)?window.name:"",t=e.indexOf(this.objStart),i=JSON.stringify(this.obj),n=this.objStart+i+this.objFinish;-1<t?e=e.substring(0,t)+n+e.substr(e.indexOf(this.objFinish)+this.objFinish.length):e+=n;var r=e.indexOf(this.strStart),s=this.strStart+this.str+this.strFinish;-1<r?e=e.substring(0,r)+s+e.substr(e.indexOf(this.strFinish)+this.strFinish.length):e+=s,window.name=e}catch(e){}}},{key:"purge",value:function(){this.initObj("_auryc_"+this.prefix),this.initString("_auryc_"+this.prefix),this.commit()}}],[{key:"getInstance",value:function(e){return winNameSingleton||(winNameSingleton=new t(e)),winNameSingleton}}]),t}(),globalSessStg=null,globalPersistStg=null,DataLayer=function(){function i(){classCallCheck(this,i)}return createClass(i,null,[{key:"getInstance",value:function(e,t){return i._getInstance()(e,t)}},{key:"_getInstance",value:function(){return function(e,t){var i,n,r=e===constants.symbols.SESSION?"s":"p",s={namespace:"userty."+(t=t||"core")+"."+(r+"."+encoder.sha1(config.getSiteid()).slice(0,6)),replace:"userty."+t+"."+r};return e===constants.symbols.SESSION?(null===globalSessStg&&(i=s,n={namespace:_.get(i,"namespace","userty.s"),persistence:constants.symbols.SESSION},i.replace&&(n.replace=i.replace,n.killOld=!0),globalSessStg=new DataLayerImpl(n)),globalSessStg):(s.duration=constants.storage.DEFAULT_COOKIE_DURATION,null===globalPersistStg&&(globalPersistStg=function(e){e=e||{};var t={namespace:_.get(e,"namespace","userty.p"),persistence:constants.symbols.PERMANENT,duration:_.get(e,"duration",constants.storage.DEFAULT_COOKIE_DURATION)};return e.replace&&(t.replace=e.replace),new DataLayerImpl(t)}(s)),globalPersistStg)}}}]),i}(),StorageDataLayer=function(){function t(e){classCallCheck(this,t),this.stgPrefix="aurycStg_"+(e||""),this.storageLimit=4e6,this.clear(),this.reload(),this.clearHistoryStorage()}return createClass(t,[{key:"clearHistoryStorage",value:function(){window.sessionStorage.removeItem(this.stgPrefix+"_BLOB"),window.sessionStorage.removeItem(this.stgPrefix+"_OBJ")}},{key:"removeByKey",value:function(e){this.objData[e]&&(delete this.objData[e],this.storageBytesObj=JSON.stringify(this.objData).length)}},{key:"clear",value:function(){this.storageBytesObj=0,this.storageBytesBlob=0,this.objData={},this.blobData=""}},{key:"getByKey",value:function(e){return this.objData[e]}},{key:"getStr",value:function(){return this.blobData}},{key:"setByKey",value:function(e,t){t&&(this.objData[e]=t,this.storageBytesObj=JSON.stringify(this.objData).length)}},{key:"setStr",value:function(e){this.blobData=e,this.storageBytesBlob=this.blobData.length}},{key:"isSupported",value:function(){return!!sessionStorage}},{key:"reload",value:function(){var e;try{(e=sessionStorage.getItem(this.stgPrefix+"_OBJ"))&&0<e.length&&(this.objData=JSON.parse(e),this.storageBytesObj=e.length)}catch(e){}try{(e=sessionStorage.getItem(this.stgPrefix+"_BLOB"))&&0<e.length&&(this.blobData=e,this.storageBytesBlob=e.length)}catch(e){}}},{key:"commit",value:function(){try{sessionStorage.setItem(this.stgPrefix+"_OBJ",JSON.stringify(this.objData)),sessionStorage.setItem(this.stgPrefix+"_BLOB",this.blobData)}catch(e){}}},{key:"setStrAndCommit",value:function(e){_.isUndefined(e)||e.length<this.storageLimit&&(this.setStr(e),this.commit())}},{key:"purge",value:function(){this.clear(),this.commit()}}],[{key:"getInstance",value:function(e){return t.instance||(t.instance=new t(e)),t.instance}}]),t}(),StorageManager=function(){function e(){classCallCheck(this,e)}return createClass(e,null,[{key:"getInstance",value:function(e){return config.getConfig("disableWinName","behavior")?StorageDataLayer.getInstance(e):WinNameDataLayer.getInstance(e)}}]),e}(),replay_samplelist="2redbeans.com:1,thredup.com:0.1,arenasolutions.com:1,lovewithfood.com:1",token_url="services.auryc.com/cc-services/sites",tracking_url_proxy="https://tracking.api.auryc.com:4433",inspectlet_wid="1309714722",device_detector_domain="uba-detector.userty.com/useragent",editor_url="//visualeditor.auryc.com",services_url="https://services.auryc.com",tracking_url="tracking.auryc.com",fb_view_uri="https://feedback-api.auryc.com/view/feedback-json",auto_tracking_url="uba-tracking.auryc.com",inspectlet_blacklist="auryc.com,localhost",record_uri="https://uba-tracking.auryc.com/rec/",uba_api_url="uba-api.auryc.com",portal_replay_url="https://portal.auryc.com/auth/replay/playback?q=",domain_name="userty",fb_submit_uri="https://feedback-api.auryc.com/submit-feedback",configServerJson={replay_samplelist:replay_samplelist,token_url:token_url,tracking_url_proxy:tracking_url_proxy,inspectlet_wid:inspectlet_wid,device_detector_domain:device_detector_domain,editor_url:editor_url,services_url:services_url,tracking_url:tracking_url,fb_view_uri:fb_view_uri,auto_tracking_url:auto_tracking_url,inspectlet_blacklist:inspectlet_blacklist,record_uri:record_uri,uba_api_url:uba_api_url,portal_replay_url:portal_replay_url,domain_name:domain_name,fb_submit_uri:fb_submit_uri};function getCfg(e,t,i,n){i||(i="base");var r=_.get(e,i+"["+t+"]",null);if(n||"base"===i)return r;var s=_.get(e,"base["+t+"]",null),a=_.get(e,t,null);return null!==r?r:null!==s?r:a}function isCookieSupported$1(){var e=windowNavigator.cookieEnabled;return e||(window.cookie="testcookie",e=-1!==window.cookie.indexOf("testcookie")),e}function getOverrideParams(e,t){return t=t||"behavior",_.get(window,"__AURYC_PARAMS_OVERRIDE__["+t+"]["+e+"]",null)}function getConfig(e,t,i){var n=getCfg(window.aurycJsLibConfig||{},e,t,i),r=getOverrideParams(e,t);return null==r?n:r}function getProductConfig(e,t){var i=window.aurycJsLibConfig||{};return i[e]?i[e]:t?i.base||i:{}}function isVisualEditorMode(){var e=window.location.hash;if(e&&getHashParam$1(e,"mode")&&"editor"===getHashParam$1(e,"mode"))return!0;return"editor"===DataLayer.getInstance(constants.symbols.SESSION).getByKey("_aurychash")}function getHashParam$1(e,t){var i=e.match(new RegExp(t+"=([^&]*)"));return i?i[1]:null}function os(e){var t=e;return/Windows/i.test(t)?/Phone/.test(t)||/WPDesktop/.test(t)?"Windows Phone":"Windows":/(iPhone|iPad|iPod)/.test(t)?"iOS":/Android/.test(t)?"Android":/(BlackBerry|PlayBook|BB10)/i.test(t)?"BlackBerry":/Mac/i.test(t)?"Mac OS X":/Linux/.test(t)?"Linux":""}function isSPAEnabled(){var e=getConfig("spaUnsupported","behavior"),t=os(windowNavigator.userAgent);if(e&&e.os&&t)for(var i=0;i<e.os.length;i++)if(t===e.os[i])return!1;return!0}function isAppcueBuilderEnabled(){return document.getElementsByTagName("appcues-crx")&&0<document.getElementsByTagName("appcues-crx").length}function hasConflicting3PJS(){return isAppcueBuilderEnabled()}function isProductEnabled(e,t){if(!window.JSON)return!1;if(_.isBlockedUAComplex(windowNavigator.userAgent))return logger.warn(e+" disabled. UA not supported: "+windowNavigator.userAgent),!1;if(hasConflicting3PJS())return logger.warn(e+" disabled. Found conflicting 3rd part JS"),!1;if(!isCookieSupported$1())return logger.warn(e+" disabled. cookie is not supported"),!1;if(_.aurycOverride(e))return logger.warn(e+" enabled as per aurycOverride"),!0;if(!getConfig("enabled",e,!0))return logger.warn(e+" disabled as per client config"),!1;if(t&&!featureToggle.isFeatureEnabled(t))return logger.warn(e+" disabled as per feature flag"),!1;var i=!0,n=getConfig("sampling","behavior");if(logger.log("sampling rate: "+n+", typeof: "+(void 0===n?"undefined":_typeof(n))),void 0===n||"number"!=typeof n||null===n)return logger.log("sampling undefined. enabled: "+i),i;if(0===n)i=!1;else{var r=DataLayer.getInstance(constants.symbols.SESSION),s=r.getByKey("p");if(logger.log("check sampling, session data: "+s),s)i="t"===s,logger.log("check sampling enabled: "+i);else{var a=100*Math.random();i=a<n,logger.log("random: "+a+", sampling:"+n+", enabled: "+i),r.setSessionByKey("p",i?"t":"f")}}return i}function getSiteid(){var e=getConfig("siteid","base")||getConfig("siteid","behavior")||getConfig("siteid","feedback");return!1===e&&(e=getConfig("site_id","base")||getConfig("site_id","behavior")||getConfig("site_id","feedback")),!1===e&&logger.critical("Unable to find a siteid"),e}function isSnapshotEnabled(){var e=getConfig("spEnabled","behavior");if(!e)return!1;for(var t=(window.location.href||"about:blank").toLowerCase(),i=0;i<e.length;i++){if(new RegExp(e[i],"i").test(t))return!0}return!1}function getBaseBlockedEls(){var e=getConfig("doNotTrack","behavior");return e&&e.blocked?e.blocked:null}function getEventSamplingRate(e){var t=getConfig("eventSampling","behavior"),i=100;return t&&(0===(i=t[e])||i||(i=100)),i}function isAjaxProxyEnabled(){return!0===constants.features.AJAX||!0===getConfig("ajax","behavior")}function compress(i){if(!i.comp)return i;delete i.comp;var n={};return Object.keys(i).forEach(function(e){var t=e.split(":").map(function(e){switch(e){case"z":return"a";case"Z":return"A";default:return String.fromCharCode(1+e.charCodeAt(0))}}).join("");n[t]=i[e]}),n}function init(){var e=configServerJson;if(_.isUndefined(win.aurycJsLibConfig))return logger.critical("Unable to initialize. Missing aurycConfig"),void(win.aurycJsLibConfig={base:{enabled:!1},behavior:{enabled:!1},feedback:{enabled:!0}});var baseConfig={enabled:!0,code_version:"0.4.32",device_uri:e.device_detector_domain,services_url:e.services_url,tracking_uri:e.tracking_url,tracking_uri_proxy:e.tracking_url_proxy,uba_api_uri:e.uba_api_url,token_uri:e.token_url,auto_tracking_uri:e.auto_tracking_url,record_uri:e.record_uri,editor_uri:e.editor_url,replay_url:e.portal_replay_url,fb_view_url:e.fb_view_uri,fb_submit_url:e.fb_submit_uri};win.aurycJsLibConfig.feedback.enabled=!0,win.aurycJsLibConfig.base=_.extend(win.aurycJsLibConfig.base,baseConfig)}var config={getConfig:getConfig,isSPAEnabled:isSPAEnabled,hasConflicting3PJS:hasConflicting3PJS,isProductEnabled:isProductEnabled,getSiteid:getSiteid,isVisualEditorMode:isVisualEditorMode,getProductConfig:getProductConfig,isSnapshotEnabled:isSnapshotEnabled,init:init,getBaseBlockedEls:getBaseBlockedEls,isCookieSupported:isCookieSupported$1,os:os,isAjaxProxyEnabled:isAjaxProxyEnabled,compress:compress,getEventSamplingRate:getEventSamplingRate},AurycPublicApi=function(){function s(e,t,i,n,r){classCallCheck(this,s),_.merge(this,e),_.merge(this,t),_.merge(this,i),this.mergeAPI(e),this.mergeAPI(t),this.mergeAPI(n),this.mergeAPI(r)}return createClass(s,[{key:"mergeAPI",value:function(t){for(var i=this;t=Object.getPrototypeOf(t);){Object.getOwnPropertyNames(t).forEach(function(e){"constructor"!==e&&"__proto__"!==e&&(i[e]=t[e])})}}}]),s}(),sha256=createCommonjsModule(function(module){!function(){var ERROR="input is invalid type",WINDOW="object"==typeof window,root=WINDOW?window:{};root.JS_SHA256_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&"object"==typeof self,NODE_JS=!root.JS_SHA256_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;NODE_JS?root=commonjsGlobal:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_SHA256_NO_COMMON_JS&&module.exports,AMD=!1,ARRAY_BUFFER=!root.JS_SHA256_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[];!root.JS_SHA256_NO_NODE_JS&&Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),!ARRAY_BUFFER||!root.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return"object"==typeof e&&e.buffer&&e.buffer.constructor===ArrayBuffer});var createOutputMethod=function(t,i){return function(e){return new Sha256(i,!0).update(e)[t]()}},createMethod=function(e){var t=createOutputMethod("hex",e);NODE_JS&&(t=nodeWrap(t,e)),t.create=function(){return new Sha256(e)},t.update=function(e){return t.create().update(e)};for(var i=0;i<OUTPUT_TYPES.length;++i){var n=OUTPUT_TYPES[i];t[n]=createOutputMethod(n,e)}return t},nodeWrap=function(method,is224){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),algorithm=is224?"sha224":"sha256",nodeMethod=function(e){if("string"==typeof e)return crypto.createHash(algorithm).update(e,"utf8").digest("hex");if(null==e)throw new Error(ERROR);return e.constructor===ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||ArrayBuffer.isView(e)||e.constructor===Buffer?crypto.createHash(algorithm).update(new Buffer(e)).digest("hex"):method(e)};return nodeMethod},createHmacOutputMethod=function(i,n){return function(e,t){return new HmacSha256(e,n,!0).update(t)[i]()}},createHmacMethod=function(t){var i=createHmacOutputMethod("hex",t);i.create=function(e){return new HmacSha256(e,t)},i.update=function(e,t){return i.create(e).update(t)};for(var e=0;e<OUTPUT_TYPES.length;++e){var n=OUTPUT_TYPES[e];i[n]=createHmacOutputMethod(n,t)}return i};function Sha256(e,t){this.blocks=t?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,blocks):[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h7=e?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=e}function HmacSha256(e,t,i){var n,r=typeof e;if("string"===r){var s,a=[],o=e.length,c=0;for(n=0;n<o;++n)s=e.charCodeAt(n),a[c++]=s<128?s:(a[c++]=s<2048?192|s>>6:(a[c++]=s<55296||57344<=s?224|s>>12:(s=65536+((1023&s)<<10|1023&e.charCodeAt(++n)),a[c++]=240|s>>18,128|s>>12&63),128|s>>6&63),128|63&s);e=a}else{if("object"!==r)throw new Error(ERROR);if(null===e)throw new Error(ERROR);if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||ARRAY_BUFFER&&ArrayBuffer.isView(e)))throw new Error(ERROR)}64<e.length&&(e=new Sha256(t,!0).update(e).array());var l=[],u=[];for(n=0;n<64;++n){var h=e[n]||0;l[n]=92^h,u[n]=54^h}Sha256.call(this,t,i),this.update(u),this.oKeyPad=l,this.inner=!0,this.sharedMemory=i}Sha256.prototype.update=function(e){if(!this.finalized){var t,i=typeof e;if("string"!==i){if("object"!==i)throw new Error(ERROR);if(null===e)throw new Error(ERROR);if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||ARRAY_BUFFER&&ArrayBuffer.isView(e)))throw new Error(ERROR);t=!0}for(var n,r,s=0,a=e.length,o=this.blocks;s<a;){if(this.hashed&&(this.hashed=!1,o[0]=this.block,o[16]=o[1]=o[2]=o[3]=o[4]=o[5]=o[6]=o[7]=o[8]=o[9]=o[10]=o[11]=o[12]=o[13]=o[14]=o[15]=0),t)for(r=this.start;s<a&&r<64;++s)o[r>>2]|=e[s]<<SHIFT[3&r++];else for(r=this.start;s<a&&r<64;++s)(n=e.charCodeAt(s))<128?o[r>>2]|=n<<SHIFT[3&r++]:(n<2048?o[r>>2]|=(192|n>>6)<<SHIFT[3&r++]:(n<55296||57344<=n?o[r>>2]|=(224|n>>12)<<SHIFT[3&r++]:(n=65536+((1023&n)<<10|1023&e.charCodeAt(++s)),o[r>>2]|=(240|n>>18)<<SHIFT[3&r++],o[r>>2]|=(128|n>>12&63)<<SHIFT[3&r++]),o[r>>2]|=(128|n>>6&63)<<SHIFT[3&r++]),o[r>>2]|=(128|63&n)<<SHIFT[3&r++]);this.lastByteIndex=r,this.bytes+=r-this.start,64<=r?(this.block=o[16],this.start=r-64,this.hash(),this.hashed=!0):this.start=r}return 4294967295<this.bytes&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Sha256.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>2]|=EXTRA[3&t],this.block=e[16],56<=t&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},Sha256.prototype.hash=function(){var e,t,i,n,r,s,a,o,c,l=this.h0,u=this.h1,h=this.h2,g=this.h3,d=this.h4,p=this.h5,f=this.h6,y=this.h7,m=this.blocks;for(e=16;e<64;++e)t=((r=m[e-15])>>>7|r<<25)^(r>>>18|r<<14)^r>>>3,i=((r=m[e-2])>>>17|r<<15)^(r>>>19|r<<13)^r>>>10,m[e]=m[e-16]+t+m[e-7]+i<<0;for(c=u&h,e=0;e<64;e+=4)this.first?(g=this.is224?(s=300032,y=(r=m[0]-1413257819)-150054599<<0,r+24177077<<0):(s=704751109,y=(r=m[0]-210244248)-1521486534<<0,r+143694565<<0),this.first=!1):(t=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),n=(s=l&u)^l&h^c,y=g+(r=y+(i=(d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7))+(d&p^~d&f)+K[e]+m[e])<<0,g=r+(t+n)<<0),t=(g>>>2|g<<30)^(g>>>13|g<<19)^(g>>>22|g<<10),n=(a=g&l)^g&u^s,f=h+(r=f+(i=(y>>>6|y<<26)^(y>>>11|y<<21)^(y>>>25|y<<7))+(y&d^~y&p)+K[e+1]+m[e+1])<<0,t=((h=r+(t+n)<<0)>>>2|h<<30)^(h>>>13|h<<19)^(h>>>22|h<<10),n=(o=h&g)^h&l^a,p=u+(r=p+(i=(f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7))+(f&y^~f&d)+K[e+2]+m[e+2])<<0,t=((u=r+(t+n)<<0)>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),n=(c=u&h)^u&g^o,d=l+(r=d+(i=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7))+(p&f^~p&y)+K[e+3]+m[e+3])<<0,l=r+(t+n)<<0;this.h0=this.h0+l<<0,this.h1=this.h1+u<<0,this.h2=this.h2+h<<0,this.h3=this.h3+g<<0,this.h4=this.h4+d<<0,this.h5=this.h5+p<<0,this.h6=this.h6+f<<0,this.h7=this.h7+y<<0},Sha256.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,i=this.h2,n=this.h3,r=this.h4,s=this.h5,a=this.h6,o=this.h7,c=HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[15&t]+HEX_CHARS[i>>28&15]+HEX_CHARS[i>>24&15]+HEX_CHARS[i>>20&15]+HEX_CHARS[i>>16&15]+HEX_CHARS[i>>12&15]+HEX_CHARS[i>>8&15]+HEX_CHARS[i>>4&15]+HEX_CHARS[15&i]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[15&n]+HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[15&r]+HEX_CHARS[s>>28&15]+HEX_CHARS[s>>24&15]+HEX_CHARS[s>>20&15]+HEX_CHARS[s>>16&15]+HEX_CHARS[s>>12&15]+HEX_CHARS[s>>8&15]+HEX_CHARS[s>>4&15]+HEX_CHARS[15&s]+HEX_CHARS[a>>28&15]+HEX_CHARS[a>>24&15]+HEX_CHARS[a>>20&15]+HEX_CHARS[a>>16&15]+HEX_CHARS[a>>12&15]+HEX_CHARS[a>>8&15]+HEX_CHARS[a>>4&15]+HEX_CHARS[15&a];return this.is224||(c+=HEX_CHARS[o>>28&15]+HEX_CHARS[o>>24&15]+HEX_CHARS[o>>20&15]+HEX_CHARS[o>>16&15]+HEX_CHARS[o>>12&15]+HEX_CHARS[o>>8&15]+HEX_CHARS[o>>4&15]+HEX_CHARS[15&o]),c},Sha256.prototype.toString=Sha256.prototype.hex,Sha256.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,i=this.h2,n=this.h3,r=this.h4,s=this.h5,a=this.h6,o=this.h7,c=[e>>24&255,e>>16&255,e>>8&255,255&e,t>>24&255,t>>16&255,t>>8&255,255&t,i>>24&255,i>>16&255,i>>8&255,255&i,n>>24&255,n>>16&255,n>>8&255,255&n,r>>24&255,r>>16&255,r>>8&255,255&r,s>>24&255,s>>16&255,s>>8&255,255&s,a>>24&255,a>>16&255,a>>8&255,255&a];return this.is224||c.push(o>>24&255,o>>16&255,o>>8&255,255&o),c},Sha256.prototype.array=Sha256.prototype.digest,Sha256.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(this.is224?28:32),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),t.setUint32(20,this.h5),t.setUint32(24,this.h6),this.is224||t.setUint32(28,this.h7),e},HmacSha256.prototype=new Sha256,HmacSha256.prototype.finalize=function(){if(Sha256.prototype.finalize.call(this),this.inner){this.inner=!1;var e=this.array();Sha256.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(e),Sha256.prototype.finalize.call(this)}};var exports=createMethod();exports.sha256=exports,exports.sha224=createMethod(!0),exports.sha256.hmac=createHmacMethod(),exports.sha224.hmac=createHmacMethod(!0),COMMON_JS?module.exports=exports:(root.sha256=exports.sha256,root.sha224=exports.sha224,AMD&&(void 0)(function(){return exports}))}()});function idGen(e){e=sha256.sha256(e);for(var t="",i=0;i<e.length;){for(var n=0,r=i;r<i+16&&r<e.length;r++){n=(n<<5)-n+e.charCodeAt(r),n&=n}t+=(n=0<n?n:-n).toString(16),i+=16}return t.length<constants.storage.ID_LENGTH?t+=t.substr(0,constants.storage.ID_LENGTH-t.length):t=t.substr(0,constants.storage.ID_LENGTH),t}function generateSessionId(e,t){var i=config.getSiteid();return!1===i?(logger.log("siteid is false. using old global session id"),idGen(_.UUID())):e&&t?idGen(i+e+t):(logger.log("userId or lastvisitTS is false. using old global session id"),idGen(_.UUID()))}function generateViewId(){return idGen(_.UUID())}function generateUserId(){return idGen(config.getSiteid()+"-"+_.UUID())}function generateGUID(){return _.UUID()}var idGen$1={generateSessionId:generateSessionId,generateViewId:generateViewId,generateUserId:generateUserId,generateGUID:generateGUID},SessionTracker=function(){function i(e,t){classCallCheck(this,i),this.sessStg=e,this.persStg=t,this.prevSessionId=null,this.siteid=config.getSiteid(),this.duration=1e3*config.getConfig("sessionDuration","behavior"),this.timeoutId=null,this.heartbeatTracker=null,this.isNew=!0,this.heartbeatInterval=1e3*(config.getConfig("heartbeatInterval","behavior")||60),this.pvCount=0,this.host=window.location.protocol+"//"+window.location.host,this.stg=StorageManager.getInstance(this.siteid),this.crossDomain=!1}return createClass(i,[{key:"getPrevSessionId",value:function(){return this.prevSessionId}},{key:"setPrevSessionId",value:function(e){this.prevSessionId=e}},{key:"removeUser",value:function(){this.persStg.removeByKey(constants.events.USERID),this.persStg.removeByKey(constants.events.IDENTITYVALUE),this.persStg.resetUserProp(),this.stg.purge(),this.endSession(!0)}},{key:"setSessionIds",value:function(e,t,i,n){var r=constants.storage.SESSIONID,s=constants.storage.VIEWID,a=constants.events.USERID,o=i||idGen$1.generateSessionId(e,t);this.setPrevSessionId(o);var c=n||idGen$1.generateViewId();return logger.log("userid: "+e+", time:"+t+" sid: "+o+", vid: "+c),this.sessStg.setSessionByKey(s,c,constants.storage.SCOPE.SESSION.TAB),this.sessStg.setSessionByKey(r,o),this.sessStg.setSessionByKey(constants.events.SESSIONTIME,t),this.stg.setByKey(s,c),this.stg.setByKey(r,o),this.stg.setByKey(a,e),this.stg.setByKey(constants.events.SESSIONTIME,t),this.stg.commit(),{sessionId:o,viewId:c}}},{key:"isCanceled",value:function(){return this.sessStg.getByKey(constants.symbols.CANCELED)}},{key:"setCancel",value:function(e){this.sessStg.setSessionByKey(constants.symbols.CANCELED,e,constants.storage.SCOPE.SESSION.TAB)}},{key:"setSessionValues",value:function(i){var n=this;return Object.keys(i).forEach(function(e){var t=i[e];void 0!==t&&(n.sessStg.setSessionByKey(e,t),n.stg.setByKey(e,t))}),this.stg.commit(),this.sessStg}},{key:"isNewTab",value:function(){var e=constants.storage.IS_NEW,t=this.stg.getByKey(e)||this.sessStg.getByKey(e);return t||(t="true",this.sessStg.setSessionByKey(e,t,constants.storage.SCOPE.SESSION.TAB),this.stg.setByKey(e,t),this.stg.commit()),t}},{key:"getSessionMetadata",value:function(){var e=[constants.storage.SESSIONID,constants.events.SESSIONTIME],t=this.sessStg.getByKeyList(e),i=t[constants.storage.SESSIONID],n=t[constants.events.SESSIONTIME],r=this.persStg.getByKey(constants.events.USERID),s=this.stg.getByKey(constants.linkid.aurycMode),a=this.stg.getByKey(constants.linkid.editorHash),o=constants.storage.VIEWID,c=this.stg.getByKey(o)?this.stg.getByKey(o):this.sessStg.getByKey(o);return c&&!this.stg.getByKey(o)&&(this.stg.setByKey(o,c),this.stg.commit()),this.isSessionOver()?{sessionId:i,viewId:c,userId:r,sessionTime:n,siteId:this.siteid,aurycMode:s,editorHash:a,isOver:!0}:(this.getPrevSessionId()||this.setPrevSessionId(i),i!==this.getPrevSessionId()?(c=idGen$1.generateViewId(),this.setPrevSessionId(i),this.sessStg.setSessionByKey(o,c,constants.storage.SCOPE.SESSION.TAB),this.sessStg.setSessionByKey(constants.storage.IS_NEW,"false",constants.storage.SCOPE.SESSION.TAB),this.stg.setByKey(constants.storage.VIEWID,c),this.stg.setByKey(constants.storage.IS_NEW,"false"),this.initSessionOrPV()):(c||(c=idGen$1.generateViewId(),this.sessStg.setSessionByKey(o,c,constants.storage.SCOPE.SESSION.TAB),this.stg.setByKey(o,c),this.stg.commit(),this.initSessionOrPV()),window.opener&&window.opener!==window.self&&"true"===this.isNewTab()&&(c=idGen$1.generateViewId(),this.sessStg.setSessionByKey(o,c,constants.storage.SCOPE.SESSION.TAB),this.sessStg.setSessionByKey(constants.storage.IS_NEW,"false",constants.storage.SCOPE.SESSION.TAB),this.stg.setByKey(constants.storage.VIEWID,c),this.stg.setByKey(constants.storage.IS_NEW,"false"),this.stg.commit())),logger.log("userid: "+r+", time:"+n+" sessionId: "+i+", viewId: "+c),{sessionId:i,viewId:c,userId:r,sessionTime:n,siteId:this.siteid,aurycMode:s,editorHash:a,isOver:!1})}},{key:"isCrossDomain",value:function(){if(this.crossDomain)return!0;var e=this.stg.getByKey(constants.storage.HOST);return!!e&&this.host!==e}},{key:"renewSession",value:function(){this.beginSession()}},{key:"beginSession",value:function(){var e=window.aurycLoadedTime?Math.max(_.now(),window.aurycLoadedTime):_.now(),t=e+this.duration;this.sessStg.setSessionByKey(constants.events.SESSION_EXP,t),logger.warn("begin a new session: "+e+" exp: "+(e+this.duration));var i=this.stg.getByKey(constants.events.USERID);if(this.isCrossDomain()&&i){var n=this.stg.getByKey(constants.storage.VIEWID),r=this.stg.getByKey(constants.storage.SESSIONID),s=this.stg.getByKey(constants.events.SESSIONTIME);s||(s=e),this.initPV(),this.setSessionIds(i,s,r,n)}else{(i=this.persStg.getByKey(constants.events.USERID))||(i=idGen$1.generateUserId());var a=this.setSessionIds(i,e);logger.log("exp: "+this.sessStg.getByKey(constants.events.SESSION_EXP)),this.resetPV(),AurycPubSub.publish(constants.events.NEW_SESSION,{sessionId:a.sessionId,viewId:a.viewId}),this.incPV()}this.persStg.setSessionByKey(constants.events.USERID,i),this.resetTimer(t),AurycPubSub.publish(constants.events.PAGEVIEWTRACKER),config.getConfig("sessionPropertyInherit","behavior")&&this.reSendSessionProperty(i),logger.log("published new session event"),this.syncWindowStg()}},{key:"reSendSessionProperty",value:function(e){var t=e+constants.events.INTERNALSESSIONPROP,i=e+constants.events.SESSIONPROP,n=localStorage.getItem(t);n&&AurycPubSub.publish(constants.events.USERIDENTIFY,{internalSessionProperties:JSON.parse(n)}),(n=localStorage.getItem(i))&&AurycPubSub.publish(constants.events.USERIDENTIFY,{sessionProperties:JSON.parse(n)})}},{key:"incPV",value:function(){var e=this.getPVFromSessStorage();null==e&&(e=this.stg.getByKey(constants.storage.PVCT)),null==e?e=0:e++,this.pvCount=e,this.setPVInStorage(e)}},{key:"resetPV",value:function(){this.sessStg.removeByKey(constants.storage.PV),this.stg.removeByKey(constants.storage.PVCT),this.pvCount=0}},{key:"getPV",value:function(){return this.pvCount}},{key:"getPVFromSessStorage",value:function(){return this.sessStg.getByKey(constants.storage.PV)}},{key:"setPVInStorage",value:function(e){this.sessStg.setSessionByKey(constants.storage.PV,e),this.stg.setByKey(constants.storage.PVCT,this.pvCount)}},{key:"endSession",value:function(e){this.isSessionOver()||e?(logger.warn("end a session. now:"+_.now()+", exp:"+this.sessStg.getByKey(constants.events.SESSION_EXP)),this.sessStg.removeByKey(constants.events.SESSION_EXP),this.sessStg.removeByKey(constants.storage.VIEWID),this.stg.removeByKey(constants.storage.VIEWID),this.stg.commit()):logger.log("session still alive. now:"+_.now()+", exp:"+this.sessStg.getByKey(constants.events.SESSION_EXP))}},{key:"isSessionOver",value:function(){var e=this.sessStg.getByKeyFromMem(constants.events.SESSION_EXP),t=_.now();(!e||e<t)&&(e=this.sessStg.getByKey(constants.events.SESSION_EXP));var i=!0;return!e||e<t?(i=!0,logger.log("session id:"+this.sessStg.getByKey(constants.storage.SESSIONID)+", session is over. now: "+t+", exp: "+e)):i=!1,i}},{key:"resetTimer",value:function(e){window.clearTimeout(this.timeoutId);var t=this;if(this.timeoutId=window.setTimeout(function(){t.endSession()},this.duration),!e){var i=_.now()+this.duration;this.sessStg.setSessionByKey(constants.events.SESSION_EXP,i)}}},{key:"startTrackingHeartbeat",value:function(){var e=this;config.isVisualEditorMode()||this.heartbeatTracker||(this.heartbeatTracker=setInterval(function(){e.sendHeartbeat()},this.heartbeatInterval))}},{key:"stopTrackingHeartbeat",value:function(){!config.isVisualEditorMode()&&this.heartbeatTracker&&clearInterval(this.heartbeatTracker)}},{key:"sendHeartbeat",value:function(){this.isSessionOver()?(logger.log("session is over. skip ping"),this.endSession()):AurycPubSub.publish(constants.events.PINGTRIGGER)}},{key:"handleUnload",value:function(){var e=brUtils.visibilityEventPrefix();null!==e?document.addEventListener(e+"visibilitychange",_.bind(function(){"hidden"===document[(""===e?"v":e+"V")+"isibilityState"]&&(logger.log("visibility hidden. ping"),this.sendHeartbeat(),this.stg&&this.stg.commit())},this)):brUtils.isPhoneOrTablet()?window.addEventListener("unload",_.bind(function(){logger.log("unload fires. ping"),this.stg&&this.stg.commit(),this.sendHeartbeat()},this)):window.addEventListener("beforeunload",_.bind(function(){logger.log("befoerunload fires. ping"),this.stg&&this.stg.commit(),this.sendHeartbeat()},this))}},{key:"bindEvent",value:function(){var t=this;"pointerover pointerenter pointerdown pointermove pointerup pointercancel pointerout pointerleave".split(" ").forEach(function(e){brUtils.addDomEvent(window,e,_.throttle(function(){t.isSessionOver()?(logger.log("create a new session"),t.beginSession()):t.resetTimer()},1e3,{leading:!0,trailing:!1}))});var e=brUtils.visibilityEventPrefix();null!==e&&document.addEventListener(e+"visibilitychange",function(){"visible"===document[(""===e?"v":e+"V")+"isibilityState"]&&(logger.log("visibility visible"),t.isSessionOver()?(logger.log("create a new session"),t.beginSession()):t.resetTimer())})}},{key:"syncWindowStg",value:function(){var e=constants.storage.HOST,t=[constants.storage.SESSIONID,constants.events.SESSIONTIME],i=this.sessStg.getByKeyList(t),n=i[constants.storage.SESSIONID],r=i[constants.events.SESSIONTIME];this.stg.setByKey(constants.events.SESSIONTIME,r),this.stg.setByKey(constants.storage.SESSIONID,n);var s=this.persStg.getByKey(constants.events.USERID);this.stg.setByKey(constants.events.USERID,s),this.stg.setByKey(e,this.host),this.stg.commit()}},{key:"initSessionOrPV",value:function(){if(logger.log("init session called"),!this.isCanceled()){var e=brUtils.getLinkidParams();if(0<Object.keys(e).length){var t=e[constants.linkid.id];if(2===(t=t.split("_")).length){var i=encoder.shiftString(t[0]),n=encoder.shiftString(t[1]);this.persStg.setSessionByKey(constants.events.USERID,i),this.stg.setByKey(constants.events.USERID,i),this.stg.setByKey(constants.storage.SESSIONID,n),this.sessStg.setSessionByKey(constants.storage.SESSIONID,n),this.setPrevSessionId(n),this.crossDomain=!0}}this.isSessionOver()?this.beginSession():(this.initPV(),AurycPubSub.publish(constants.events.PAGEVIEWTRACKER),this.resetTimer(),this.syncWindowStg()),this.bindEvent(),this.startTrackingHeartbeat()}}},{key:"initPV",value:function(){var e=window.aurycLoadedTime?Math.max(_.now(),window.aurycLoadedTime):_.now();logger.log("create a new pv. setting startTS:"+e),this.sessStg.setSessionByKey(constants.events.PV_START_TS,e,constants.storage.SCOPE.SESSION.TAB);var t=brUtils.getWinSize(window);this.sessStg.setByKey(constants.events.WIN_SIZE,JSON.stringify(t),constants.storage.SCOPE.SESSION.TAB),this.stg.setByKey(constants.events.PV_START_TS,e),this.stg.setByKey(constants.events.WIN_SIZE,JSON.stringify(t)),this.stg.commit(),this.incPV()}},{key:"getPVStartTS",value:function(){var e=this.stg.getByKey(constants.events.PV_START_TS)||this.sessStg.getByKey(constants.events.PV_START_TS);return e?(logger.log("Getting start ts from storage: "+e),e):(logger.log("Not getting start ts from storage. using now()"),_.now())}},{key:"getWinSize",value:function(){return this.stg.getByKey(constants.events.WIN_SIZE)||this.sessStg.getByKey(constants.events.WIN_SIZE)}},{key:"getSessionStorage",value:function(){return this.sessStg}},{key:"getSession",value:function(i){var n=this;return i&&Object.keys(i).forEach(function(e){var t=n.stg.getByKey(i[e]);void 0!==t&&n.sessStg.setSessionByKey(i[e],t)}),this.sessStg}}]),i}(),globalSessionTracker=new SessionTracker(DataLayer.getInstance(constants.symbols.SESSION),DataLayer.getInstance(constants.symbols.PERMANENT)),LinkId=function(){function e(){classCallCheck(this,e),this.id=constants.linkid.id,this.parseConfig()}return createClass(e,[{key:"parseConfig",value:function(){var e=config.getConfig("crossDomain","behavior");this.rules="",e&&e.property&&e.property.cssSelector&&(this.rules=e.property.cssSelector.split(" ").join(","))}},{key:"process",value:function(e){var s=this;e&&(this.rules=e.split(" ").join(","));var t=window.document;if(0<this.rules.length){var i=t.querySelectorAll(this.rules);[].forEach.call(i,function(e,t){if("a"===e.tagName.toLowerCase()||"form"===e.tagName.toLowerCase())s.addLinkId(e);else for(var i=e.querySelectorAll("a,form"),n=i.length-1;0<=n;n--){var r=i[n];s.addLinkId(r)}})}}},{key:"getAurycLinkId",value:function(){var e=globalSessionTracker.getSessionMetadata(),t=encoder.shiftString(e.userId)+"_"+encoder.shiftString(e.sessionId);return e.aurycMode&&(t="editor#mode="+e.aurycMode+"&t="+e.editorHash),t}},{key:"addLinkId",value:function(e){var t=e.getAttribute("href")||e.getAttribute("action");if(t){var i=globalSessionTracker.getSessionMetadata(),n="?";-1!==t.indexOf("?")&&(n="&");var r=void 0;i.aurycMode?(r=i.aurycMode,-1==t.indexOf("#mode")&&(t+="#mode="+r+"&t="+i.editorHash)):-1==t.indexOf(this.id)&&(r=encoder.shiftString(i.userId)+"_"+encoder.shiftString(i.sessionId),t+=n+this.id+"="+r),e.getAttribute("href")?e.setAttribute("href",t):e.setAttribute("action",t)}}}]),e}(),globalLinkIdHandler=null;function getLinkIdHandler(){return globalLinkIdHandler||(globalLinkIdHandler=new LinkId),globalLinkIdHandler}var LinkidAPI=function(){function e(){classCallCheck(this,e)}return createClass(e,[{key:"addLinkId",value:function(e){getLinkIdHandler().process(e)}},{key:"getAurycLinkId",value:function(){return getLinkIdHandler().getAurycLinkId()}}]),e}(),CacheObj=function(){function e(){classCallCheck(this,e),this.domPathCache={}}return createClass(e,[{key:"getPositionOfNode",value:function(e){var t=!1,i=1,n=e.nodeName,r=e;if(e.previousSibling)for(r=e.previousSibling;r;)r.nodeType===Node.ELEMENT_NODE&&r.tagName===n&&(t||(t=!0),i+=1),r=r.previousSibling;if(!t){for(r=e.nextSibling;!t&&r;)r.nodeType===Node.ELEMENT_NODE&&r.tagName===n&&(t=!0),r=r.nextSibling;t&&(i=1)}return t||(i=0),i}},{key:"getNodeXPath",value:function(e,t){var i=e.parentNode?this.getNodeXPath(e.parentNode):[];if(e.nodeType!==Node.ELEMENT_NODE)return i;var n=this.getPositionOfNode(e),r=e.tagName.toLowerCase(),s="",a=e.getAttribute("id");return s=t&&"id"!==t&&a?(0===n&&(n=1),r+"[@id='"+a+"']["+n+"]"):r+(0<n?"["+n+"]":""),i.push(s),i}}]),e}(),globalCacheObj=new CacheObj,DataCache=function(){function e(){classCallCheck(this,e),this.caches=[]}return createClass(e,[{key:"clearCache",value:function(){this.caches=[]}},{key:"getObject",value:function(e,t,i){t=t.join(",");for(var n={},r=this.caches,s=this.caches.length-1;0<=s;s--)if(r[s].v===e){n=r[s];break}if(!_.isDefined(n.id)){if(n.id=_.UUID(),(n.kl=t)&&e.length>constants.record.cache.minLength)for(var a=this.caches.length-1;0<=a;a--)if(r[a].kl===t){var o=_.Diff(r[a].v,e);n.diff={id:r[a].id,df:o};break}if(_.isDefined(n.diff)){if(!getInstance().isPhoneOrTablet()||this.caches.length<constants.record.cache.maxItems){var c={};c.v=e,c.id=n.id,c.kl=n.kl,this.caches.push(c)}}else n.v=e,(!getInstance().isPhoneOrTablet()||this.caches.length<constants.record.cache.maxItems)&&this.caches.push(n)}return i&&delete n[i],n}}]),e}(),globalDataCache=new DataCache;function testSameDomain(e,t){if(!e||!t)return!1;var i=getLocation(e),n=getLocation(t);if(!i||!n)return!1;var r=i.protocol||window.location.protocol,s=n.protocol||window.location.protocol,a=i.port||"80",o=n.port||"80";return r===s&&a===o&&i.hostname===n.hostname}function isPrivateIP$1(e){return!(!e||!(-1<e.indexOf("localhost")||/(^127\.)|(^192\.168\.)|(^10\.)|(^172\.1[6-9]\.)|(^172\.2[0-9]\.)|(^172\.3[0-1]\.)|(^::1$)|(^[fF][cCdD])/.test(e)))&&(logger.log("found private ip:"+e),!0)}function getRootDomain$1(e){var t=getTopDomain$1();return t?(logger.log("domain 1: "+t),t):isPrivateIP$1(e)?"localhost":e.toLowerCase().split(".").slice(-2).join(".")}function getTopDomain$1(){var e,t,i="weird_get_top_level_domain=cookie",n=document.location.hostname.split(".");for(e=n.length-1;0<=e;e--)if(t=n.slice(e).join("."),document.cookie=i+";domain=."+t+";",-1<document.cookie.indexOf(i))return document.cookie=i.split("=")[0]+"=;domain=."+t+";expires=Thu, 01 Jan 1970 00:00:01 GMT;",t}function isSubDomain(){if(config.getConfig("crossDomain","behavior"))for(var e=config.getConfig("rootDomain","behavior"),t=window.location.host,i=e.split("|"),n=0;n<i.length;n++){var r=i[n];if(r=r.replace(/\*./g,".*"),new RegExp(r,"i").test(t))return!0}return!1}function isAjaxProxyEnabled$1(e){if(new RegExp(".*auryc.com","i").test(e)){var t=config.getConfig("ajax_whitelist","behavior");if(t)for(var i=t.split(","),n=0;n<i.length;n++){var r=i[n];if(new RegExp(r,"i").test(e))return!0}return!1}return!0}function getLocation(e){var t=e.match(/^(https?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)([\/]{0,1}[^?#]*)(\?[^#]*|)(#.*|)$/);return t&&{href:e,protocol:t[1],domain:t[2],hostname:t[3],port:t[4],path:t[5],query:t[6],hash:t[7]}}var urls={testSameDomain:testSameDomain,isPrivateIP:isPrivateIP$1,getRootDomain:getRootDomain$1,getTopDomain:getTopDomain$1,isSubDomain:isSubDomain,isAjaxProxyEnabled:isAjaxProxyEnabled$1,getLocation:getLocation},RcFrame=function(){function e(){classCallCheck(this,e),this.childrenIframes={}}return createClass(e,[{key:"loadFrame",value:function(e,t){this.bindToFrameLoad(e,t)}},{key:"handleIframe",value:function(t,e){for(var i=this,n=(e||t.getDocObj()).querySelectorAll("iframe"),r=0;r<n.length;r++){var s=n[r];if(!s._arB||!this.childrenIframes[globalCacheObj.getNodeXPath(s)]){if(this.childrenIframes[globalCacheObj.getNodeXPath(s)]=!0,s._arB=!0,this.testFrameSrc(s)&&this.testFrameOrigin(s)){var a=this.getFrameWindow(s);if(!a)return;var o=this.getFrameDocument(a,!1),c=!1;if(o){this.unbindInternalIframes(o);try{"complete"!==o.readyState&&"loaded"!==o.readyState||(c=!0)}catch(e){}c&&(_.isDefined(a.processor)?a.processor.generateHTML():(a.processor=new ReplayProcessor(a,globalCacheObj.getNodeXPath(s),t),a.processor.generateHTML(),t.addChildProc(a.processor)))}}_.addEventListener(s,"load",function(e){return i.loadFrame(e,t)})}}}},{key:"bindToFrameLoad",value:function(e,t){var i=e.target||e.srcElement||e.originalTarget;if(t&&i&&this.testFrameSrc(i)&&this.testFrameOrigin(i)){var n=this.getFrameWindow(i);this.getFrameDocument(n)&&(_.isDefined(n.processor)||(n.processor=new ReplayProcessor(n,globalCacheObj.getNodeXPath(i),t),n.processor.generateHTML(),t.addChildProc(n.processor)))}}},{key:"testFrameSrc",value:function(e){for(var t=["javascript:","shim.gif","about:blank"],i=0;i<t.length;i++)if(e.src&&-1<e.src.indexOf(t[i]))return!1;return!0}},{key:"testFrameOrigin",value:function(e,t){var i=e.getAttribute("src");if(!i||0===i.indexOf(" "))return!1;var n=e.src;return urls.testSameDomain(t||window.location.href,n)}},{key:"unbindInternalIframes",value:function(e){for(var t=e.querySelectorAll("iframe[_arB='true']"),i=0;i<t.length;i++)t[i]._arB=!1}},{key:"getFrameWindow",value:function(e){var t=void 0;return e&&e.contentWindow?t=e.contentWindow:e&&e.contentDocument&&e.contentDocument.defaultView&&(t=e.contentDocument.defaultView),t&&t!==t.top?t:null}},{key:"getFrameDocument",value:function(e){try{return e.document}catch(e){return!1}}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),hammer=createCommonjsModule(function(Ze){!function(s,o,e,f){var a,c=["","webkit","Moz","MS","ms","o"],t=o.createElement("div"),i="function",l=Math.round,y=Math.abs,m=Date.now;function u(e,t,i){return setTimeout(b(e,i),t)}function n(e,t,i){return!!Array.isArray(e)&&(h(e,i[t],i),!0)}function h(e,t,i){var n;if(e)if(e.forEach)e.forEach(t,i);else if(e.length!==f)for(n=0;n<e.length;)t.call(i,e[n],n,e),n++;else for(n in e)e.hasOwnProperty(n)&&t.call(i,e[n],n,e)}function r(n,e,t){var r="DEPRECATED METHOD: "+e+"\n"+t+" AT \n";return function(){var e=new Error("get-stack-trace"),t=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",i=s.console&&(s.console.warn||s.console.log);return i&&i.call(s.console,r,t),n.apply(this,arguments)}}a="function"!=typeof Object.assign?function(e){if(e===f||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),i=1;i<arguments.length;i++){var n=arguments[i];if(n!==f&&null!==n)for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])}return t}:Object.assign;var g=r(function(e,t,i){for(var n=Object.keys(t),r=0;r<n.length;)(!i||i&&e[n[r]]===f)&&(e[n[r]]=t[n[r]]),r++;return e},"extend","Use `assign`."),d=r(function(e,t){return g(e,t,!0)},"merge","Use `assign`.");function p(e,t,i){var n,r=t.prototype;(n=e.prototype=Object.create(r)).constructor=e,n._super=r,i&&a(n,i)}function b(e,t){return function(){return e.apply(t,arguments)}}function I(e,t){return typeof e==i?e.apply(t&&t[0]||f,t):e}function v(e,t){return e===f?t:e}function A(t,e,i){h(E(e),function(e){t.addEventListener(e,i,!1)})}function C(t,e,i){h(E(e),function(e){t.removeEventListener(e,i,!1)})}function S(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function w(e,t){return-1<e.indexOf(t)}function E(e){return e.trim().split(/\s+/g)}function x(e,t,i){if(e.indexOf&&!i)return e.indexOf(t);for(var n=0;n<e.length;){if(i&&e[n][i]==t||!i&&e[n]===t)return n;n++}return-1}function T(e){return Array.prototype.slice.call(e,0)}function R(e,i,t){for(var n=[],r=[],s=0;s<e.length;){var a=i?e[s][i]:e[s];x(r,a)<0&&n.push(e[s]),r[s]=a,s++}return t&&(n=i?n.sort(function(e,t){return e[i]>t[i]}):n.sort()),n}function F(e,t){for(var i,n,r=t[0].toUpperCase()+t.slice(1),s=0;s<c.length;){if((n=(i=c[s])?i+r:t)in e)return n;s++}return f}var k=1;function P(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||s}var _="ontouchstart"in s,N=F(s,"PointerEvent")!==f,B=_&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),D="touch",U="mouse",O=25,V=1,J=4,H=8,W=1,j=2,L=4,M=8,K=16,Z=j|L,G=M|K,Y=Z|G,X=["x","y"],z=["clientX","clientY"];function q(t,e){var i=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){I(t.options.enable,[t])&&i.handler(e)},this.init()}function $(e,t,i){var n=i.pointers.length,r=i.changedPointers.length,s=t&V&&n-r==0,a=t&(J|H)&&n-r==0;i.isFirst=!!s,i.isFinal=!!a,s&&(e.session={}),i.eventType=t,function(e,t){var i=e.session,n=t.pointers,r=n.length;i.firstInput||(i.firstInput=Q(t));1<r&&!i.firstMultiple?i.firstMultiple=Q(t):1===r&&(i.firstMultiple=!1);var s=i.firstInput,a=i.firstMultiple,o=a?a.center:s.center,c=t.center=ee(n);t.timeStamp=m(),t.deltaTime=t.timeStamp-s.timeStamp,t.angle=re(o,c),t.distance=ne(o,c),function(e,t){var i=t.center,n=e.offsetDelta||{},r=e.prevDelta||{},s=e.prevInput||{};t.eventType!==V&&s.eventType!==J||(r=e.prevDelta={x:s.deltaX||0,y:s.deltaY||0},n=e.offsetDelta={x:i.x,y:i.y});t.deltaX=r.x+(i.x-n.x),t.deltaY=r.y+(i.y-n.y)}(i,t),t.offsetDirection=ie(t.deltaX,t.deltaY);var l=te(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=l.x,t.overallVelocityY=l.y,t.overallVelocity=y(l.x)>y(l.y)?l.x:l.y,t.scale=a?(g=a.pointers,d=n,ne(d[0],d[1],z)/ne(g[0],g[1],z)):1,t.rotation=a?(u=a.pointers,h=n,re(h[1],h[0],z)+re(u[1],u[0],z)):0,t.maxPointers=i.prevInput?t.pointers.length>i.prevInput.maxPointers?t.pointers.length:i.prevInput.maxPointers:t.pointers.length,function(e,t){var i,n,r,s,a=e.lastInterval||t,o=t.timeStamp-a.timeStamp;if(t.eventType!=H&&(O<o||a.velocity===f)){var c=t.deltaX-a.deltaX,l=t.deltaY-a.deltaY,u=te(o,c,l);n=u.x,r=u.y,i=y(u.x)>y(u.y)?u.x:u.y,s=ie(c,l),e.lastInterval=t}else i=a.velocity,n=a.velocityX,r=a.velocityY,s=a.direction;t.velocity=i,t.velocityX=n,t.velocityY=r,t.direction=s}(i,t);var u,h;var g,d;var p=e.element;S(t.srcEvent.target,p)&&(p=t.srcEvent.target);t.target=p}(e,i),e.emit("hammer.input",i),e.recognize(i),e.session.prevInput=i}function Q(e){for(var t=[],i=0;i<e.pointers.length;)t[i]={clientX:l(e.pointers[i].clientX),clientY:l(e.pointers[i].clientY)},i++;return{timeStamp:m(),pointers:t,center:ee(t),deltaX:e.deltaX,deltaY:e.deltaY}}function ee(e){var t=e.length;if(1===t)return{x:l(e[0].clientX),y:l(e[0].clientY)};for(var i=0,n=0,r=0;r<t;)i+=e[r].clientX,n+=e[r].clientY,r++;return{x:l(i/t),y:l(n/t)}}function te(e,t,i){return{x:t/e||0,y:i/e||0}}function ie(e,t){return e===t?W:y(e)>=y(t)?e<0?j:L:t<0?M:K}function ne(e,t,i){i||(i=X);var n=t[i[0]]-e[i[0]],r=t[i[1]]-e[i[1]];return Math.sqrt(n*n+r*r)}function re(e,t,i){i||(i=X);var n=t[i[0]]-e[i[0]],r=t[i[1]]-e[i[1]];return 180*Math.atan2(r,n)/Math.PI}q.prototype={handler:function(){},init:function(){this.evEl&&A(this.element,this.evEl,this.domHandler),this.evTarget&&A(this.target,this.evTarget,this.domHandler),this.evWin&&A(P(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&C(this.element,this.evEl,this.domHandler),this.evTarget&&C(this.target,this.evTarget,this.domHandler),this.evWin&&C(P(this.element),this.evWin,this.domHandler)}};var se={mousedown:V,mousemove:2,mouseup:J},ae="mousedown",oe="mousemove mouseup";function ce(){this.evEl=ae,this.evWin=oe,this.pressed=!1,q.apply(this,arguments)}p(ce,q,{handler:function(e){var t=se[e.type];t&V&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=J),this.pressed&&(t&J&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:U,srcEvent:e}))}});var le={pointerdown:V,pointermove:2,pointerup:J,pointercancel:H,pointerout:H},ue={2:D,3:"pen",4:U,5:"kinect"},he="pointerdown",ge="pointermove pointerup pointercancel";function de(){this.evEl=he,this.evWin=ge,q.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}s.MSPointerEvent&&!s.PointerEvent&&(he="MSPointerDown",ge="MSPointerMove MSPointerUp MSPointerCancel"),p(de,q,{handler:function(e){var t=this.store,i=!1,n=e.type.toLowerCase().replace("ms",""),r=le[n],s=ue[e.pointerType]||e.pointerType,a=s==D,o=x(t,e.pointerId,"pointerId");r&V&&(0===e.button||a)?o<0&&(t.push(e),o=t.length-1):r&(J|H)&&(i=!0),o<0||(t[o]=e,this.callback(this.manager,r,{pointers:t,changedPointers:[e],pointerType:s,srcEvent:e}),i&&t.splice(o,1))}});var pe={touchstart:V,touchmove:2,touchend:J,touchcancel:H};function fe(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,q.apply(this,arguments)}p(fe,q,{handler:function(e){var t=pe[e.type];if(t===V&&(this.started=!0),this.started){var i=function(e,t){var i=T(e.touches),n=T(e.changedTouches);t&(J|H)&&(i=R(i.concat(n),"identifier",!0));return[i,n]}.call(this,e,t);t&(J|H)&&i[0].length-i[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:i[0],changedPointers:i[1],pointerType:D,srcEvent:e})}}});var ye={touchstart:V,touchmove:2,touchend:J,touchcancel:H},me="touchstart touchmove touchend touchcancel";function be(){this.evTarget=me,this.targetIds={},q.apply(this,arguments)}p(be,q,{handler:function(e){var t=ye[e.type],i=function(e,t){var i=T(e.touches),n=this.targetIds;if(t&(2|V)&&1===i.length)return n[i[0].identifier]=!0,[i,i];var r,s,a=T(e.changedTouches),o=[],c=this.target;if(s=i.filter(function(e){return S(e.target,c)}),t===V)for(r=0;r<s.length;)n[s[r].identifier]=!0,r++;r=0;for(;r<a.length;)n[a[r].identifier]&&o.push(a[r]),t&(J|H)&&delete n[a[r].identifier],r++;return o.length?[R(s.concat(o),"identifier",!0),o]:void 0}.call(this,e,t);i&&this.callback(this.manager,t,{pointers:i[0],changedPointers:i[1],pointerType:D,srcEvent:e})}});var Ie=2500;function ve(){q.apply(this,arguments);var e=b(this.handler,this);this.touch=new be(this.manager,e),this.mouse=new ce(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function Ae(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var i={x:t.clientX,y:t.clientY};this.lastTouches.push(i);var n=this.lastTouches;setTimeout(function(){var e=n.indexOf(i);-1<e&&n.splice(e,1)},Ie)}}p(ve,q,{handler:function(e,t,i){var n=i.pointerType==D,r=i.pointerType==U;if(!(r&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if(n)(function(e,t){e&V?(this.primaryTouch=t.changedPointers[0].identifier,Ae.call(this,t)):e&(J|H)&&Ae.call(this,t)}).call(this,t,i);else if(r&&function(e){for(var t=e.srcEvent.clientX,i=e.srcEvent.clientY,n=0;n<this.lastTouches.length;n++){var r=this.lastTouches[n],s=Math.abs(t-r.x),a=Math.abs(i-r.y);if(s<=25&&a<=25)return!0}return!1}.call(this,i))return;this.callback(e,t,i)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Ce=F(t.style,"touchAction"),Se=Ce!==f,we="compute",Ee="manipulation",xe="none",Te="pan-x",Re="pan-y",Fe=function(){if(!Se)return!1;var t={},i=s.CSS&&s.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(e){t[e]=!i||s.CSS.supports("touch-action",e)}),t}();function ke(e,t){this.manager=e,this.set(t)}ke.prototype={set:function(e){e==we&&(e=this.compute()),Se&&this.manager.element.style&&Fe[e]&&(this.manager.element.style[Ce]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return h(this.manager.recognizers,function(e){I(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),function(e){if(w(e,xe))return xe;var t=w(e,Te),i=w(e,Re);if(t&&i)return xe;if(t||i)return t?Te:Re;if(w(e,Ee))return Ee;return"auto"}(t.join(" "))},preventDefaults:function(e){var t=e.srcEvent,i=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var n=this.actions,r=w(n,xe)&&!Fe[xe],s=w(n,Re)&&!Fe[Re],a=w(n,Te)&&!Fe[Te];if(r){var o=1===e.pointers.length,c=e.distance<2,l=e.deltaTime<250;if(o&&c&&l)return}if(!a||!s)return r||s&&i&Z||a&&i&G?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var Pe=1;function _e(e){this.options=a({},this.defaults,e||{}),this.id=k++,this.manager=null,this.options.enable=v(this.options.enable,!0),this.state=Pe,this.simultaneous={},this.requireFail=[]}function Ne(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function Be(e){return e==K?"down":e==M?"up":e==j?"left":e==L?"right":""}function De(e,t){var i=t.manager;return i?i.get(e):e}function Ue(){_e.apply(this,arguments)}function Oe(){Ue.apply(this,arguments),this.pX=null,this.pY=null}function Ve(){Ue.apply(this,arguments)}function Je(){_e.apply(this,arguments),this._timer=null,this._input=null}function He(){Ue.apply(this,arguments)}function We(){Ue.apply(this,arguments)}function je(){_e.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Le(e,t){return(t=t||{}).recognizers=v(t.recognizers,Le.defaults.preset),new Me(e,t)}_e.prototype={defaults:{},set:function(e){return a(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(n(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=De(e,this)).id]||(t[e.id]=e).recognizeWith(this),this},dropRecognizeWith:function(e){return n(e,"dropRecognizeWith",this)||(e=De(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(n(e,"requireFailure",this))return this;var t=this.requireFail;return-1===x(t,e=De(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(n(e,"dropRequireFailure",this))return this;e=De(e,this);var t=x(this.requireFail,e);return-1<t&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return 0<this.requireFail.length},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(t){var i=this,e=this.state;function n(e){i.manager.emit(e,t)}e<8&&n(i.options.event+Ne(e)),n(i.options.event),t.additionalEvent&&n(t.additionalEvent),8<=e&&n(i.options.event+Ne(e))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=32},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(this.requireFail[e].state&(32|Pe)))return!1;e++}return!0},recognize:function(e){var t=a({},e);if(!I(this.options.enable,[this,t]))return this.reset(),void(this.state=32);56&this.state&&(this.state=Pe),this.state=this.process(t),30&this.state&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},p(Ue,_e,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,i=e.eventType,n=6&t,r=this.attrTest(e);return n&&(i&H||!r)?16|t:n||r?i&J?8|t:2&t?4|t:2:32}}),p(Oe,Ue,{defaults:{event:"pan",threshold:10,pointers:1,direction:Y},getTouchAction:function(){var e=this.options.direction,t=[];return e&Z&&t.push(Re),e&G&&t.push(Te),t},directionTest:function(e){var t=this.options,i=!0,n=e.distance,r=e.direction,s=e.deltaX,a=e.deltaY;return r&t.direction||(n=t.direction&Z?(r=0===s?W:s<0?j:L,i=s!=this.pX,Math.abs(e.deltaX)):(r=0===a?W:a<0?M:K,i=a!=this.pY,Math.abs(e.deltaY))),e.direction=r,i&&n>t.threshold&&r&t.direction},attrTest:function(e){return Ue.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=Be(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),p(Ve,Ue,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[xe]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),p(Je,_e,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(e){var t=this.options,i=e.pointers.length===t.pointers,n=e.distance<t.threshold,r=e.deltaTime>t.time;if(this._input=e,!n||!i||e.eventType&(J|H)&&!r)this.reset();else if(e.eventType&V)this.reset(),this._timer=u(function(){this.state=8,this.tryEmit()},t.time,this);else if(e.eventType&J)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(e){8===this.state&&(e&&e.eventType&J?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=m(),this.manager.emit(this.options.event,this._input)))}}),p(He,Ue,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[xe]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}}),p(We,Ue,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Z|G,pointers:1},getTouchAction:function(){return Oe.prototype.getTouchAction.call(this)},attrTest:function(e){var t,i=this.options.direction;return i&(Z|G)?t=e.overallVelocity:i&Z?t=e.overallVelocityX:i&G&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&i&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&y(t)>this.options.velocity&&e.eventType&J},emit:function(e){var t=Be(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),p(je,_e,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ee]},process:function(e){var t=this.options,i=e.pointers.length===t.pointers,n=e.distance<t.threshold,r=e.deltaTime<t.time;if(this.reset(),e.eventType&V&&0===this.count)return this.failTimeout();if(n&&r&&i){if(e.eventType!=J)return this.failTimeout();var s=!this.pTime||e.timeStamp-this.pTime<t.interval,a=!this.pCenter||ne(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,a&&s?this.count+=1:this.count=1,this._input=e,0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=u(function(){this.state=8,this.tryEmit()},t.interval,this),2):8}return 32},failTimeout:function(){return this._timer=u(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Le.VERSION="2.0.7",Le.defaults={domEvents:!1,touchAction:we,enable:!0,inputTarget:null,inputClass:null,preset:[[He,{enable:!1}],[Ve,{enable:!1},["rotate"]],[We,{direction:Z}],[Oe,{direction:Z},["swipe"]],[je],[je,{event:"doubletap",taps:2},["tap"]],[Je]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function Me(e,t){var i;this.options=a({},Le.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new((i=this).options.inputClass||(N?de:B?be:_?ve:ce))(i,$),this.touchAction=new ke(this,this.options.touchAction),Ke(this,!0),h(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function Ke(i,n){var r,s=i.element;s.style&&(h(i.options.cssProps,function(e,t){r=F(s.style,t),s.style[r]=n?(i.oldCssProps[r]=s.style[r],e):i.oldCssProps[r]||""}),n||(i.oldCssProps={}))}Me.prototype={set:function(e){return a(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var i;this.touchAction.preventDefaults(e);var n=this.recognizers,r=t.curRecognizer;(!r||r&&8&r.state)&&(r=t.curRecognizer=null);for(var s=0;s<n.length;)i=n[s],2===t.stopped||r&&i!=r&&!i.canRecognizeWith(r)?i.reset():i.recognize(e),!r&&14&i.state&&(r=t.curRecognizer=i),s++}},get:function(e){if(e instanceof _e)return e;for(var t=this.recognizers,i=0;i<t.length;i++)if(t[i].options.event==e)return t[i];return null},add:function(e){if(n(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),(e.manager=this).touchAction.update(),e},remove:function(e){if(n(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,i=x(t,e);-1!==i&&(t.splice(i,1),this.touchAction.update())}return this},on:function(e,t){if(e!==f&&t!==f){var i=this.handlers;return h(E(e),function(e){i[e]=i[e]||[],i[e].push(t)}),this}},off:function(e,t){if(e!==f){var i=this.handlers;return h(E(e),function(e){t?i[e]&&i[e].splice(x(i[e],t),1):delete i[e]}),this}},emit:function(e,t){var i,n,r;this.options.domEvents&&(i=e,n=t,(r=o.createEvent("Event")).initEvent(i,!0,!0),(r.gesture=n).target.dispatchEvent(r));var s=this.handlers[e]&&this.handlers[e].slice();if(s&&s.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var a=0;a<s.length;)s[a](t),a++}},destroy:function(){this.element&&Ke(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},a(Le,{INPUT_START:V,INPUT_MOVE:2,INPUT_END:J,INPUT_CANCEL:H,STATE_POSSIBLE:Pe,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:W,DIRECTION_LEFT:j,DIRECTION_RIGHT:L,DIRECTION_UP:M,DIRECTION_DOWN:K,DIRECTION_HORIZONTAL:Z,DIRECTION_VERTICAL:G,DIRECTION_ALL:Y,Manager:Me,Input:q,TouchAction:ke,TouchInput:be,MouseInput:ce,PointerEventInput:de,TouchMouseInput:ve,SingleTouchInput:fe,Recognizer:_e,AttrRecognizer:Ue,Tap:je,Pan:Oe,Swipe:We,Pinch:Ve,Rotate:He,Press:Je,on:A,off:C,each:h,merge:d,extend:g,assign:a,inherit:p,bindFn:b,prefixed:F}),(void 0!==s?s:"undefined"!=typeof self?self:{}).Hammer=Le,"function"==typeof f&&f.amd?f(function(){return Le}):Ze.exports?Ze.exports=Le:s.Hammer=Le}(window,document)}),eventTypes={},EventType=function(){function e(){classCallCheck(this,e)}return createClass(e,null,[{key:"init",value:function(){var t=constants.events.IDGEN.behavior;["HeartbeatT","UserProfileT","SessionPropT","IdentifyUserT","SessionStartT","SessionEndT","ViewStartT","ViewEndT","DeviceInfoT"].forEach(function(e){eventTypes[e]=t++}),t=constants.events.IDGEN.sessions,["ViewChangeT","InternalSessionPropT","MergeSessionT"].forEach(function(e){eventTypes[e]=t++}),t=constants.events.IDGEN.interactions,["ResEvt1T","HTMLTextT","NodeDictionaryT","WindowDimT","SclWindowT","MouseMoveT","MouseLeaveEntryT","FormInputT","DblClickT","KeyStrokeDownT","InputPosT","InputValChangedT","MutNodeTextT","PropChangeT","JSExceptionT","MouseClickT","ResEvt4T","ResEvt5T","PVT","HTMLDimT","SclInNodeT","DownloadedT","FormSubmitT","ResEvt7T","ResEvt8T","ResizeT","MutInsertT","MutRemoveT","TouchStartT","TouchEndT","CustomEventT","ErrorT","TapT","PressT","SwipeT","PinchT"].forEach(function(e){eventTypes[e]=t++})}},{key:"CustomEventT",value:function(){return eventTypes.CustomEventT}},{key:"DblClickT",value:function(){return eventTypes.DblClickT}},{key:"DeviceInfoT",value:function(){return eventTypes.DeviceInfoT}},{key:"HTMLDimT",value:function(){return eventTypes.HTMLDimT}},{key:"NodeDictionaryT",value:function(){return eventTypes.NodeDictionaryT}},{key:"DownloadedT",value:function(){return eventTypes.DownloadedT}},{key:"ErrorT",value:function(){return eventTypes.ErrorT}},{key:"FormSubmitT",value:function(){return eventTypes.FormSubmitT}},{key:"HTMLTextT",value:function(){return eventTypes.HTMLTextT}},{key:"PropChangeT",value:function(){return eventTypes.PropChangeT}},{key:"InputPosT",value:function(){return eventTypes.InputPosT}},{key:"HeartbeatT",value:function(){return eventTypes.HeartbeatT}},{key:"IdentifyUserT",value:function(){return eventTypes.IdentifyUserT}},{key:"FormInputT",value:function(){return eventTypes.FormInputT}},{key:"InternalSessionPropT",value:function(){return eventTypes.InternalSessionPropT}},{key:"JSExceptionT",value:function(){return eventTypes.JSExceptionT}},{key:"KeyStrokeDownT",value:function(){return eventTypes.KeyStrokeDownT}},{key:"MergeSessionT",value:function(){return eventTypes.MergeSessionT}},{key:"MouseClickT",value:function(){return eventTypes.MouseClickT}},{key:"MouseMoveT",value:function(){return eventTypes.MouseMoveT}},{key:"MouseLeaveEntryT",value:function(){return eventTypes.MouseLeaveEntryT}},{key:"SclInNodeT",value:function(){return eventTypes.SclInNodeT}},{key:"PVT",value:function(){return eventTypes.PVT}},{key:"PinchT",value:function(){return eventTypes.PinchT}},{key:"PressT",value:function(){return eventTypes.PressT}},{key:"SessionEndT",value:function(){return eventTypes.SessionEndT}},{key:"SessionStartT",value:function(){return eventTypes.SessionStartT}},{key:"SwipeT",value:function(){return eventTypes.SwipeT}},{key:"TapT",value:function(){return eventTypes.TapT}},{key:"TouchEndT",value:function(){return eventTypes.TouchEndT}},{key:"TouchStartT",value:function(){return eventTypes.TouchStartT}},{key:"UserProfileT",value:function(){return eventTypes.UserProfileT}},{key:"InputValChangedT",value:function(){return eventTypes.InputValChangedT}},{key:"ViewChangeT",value:function(){return eventTypes.ViewChangeT}},{key:"ViewEndT",value:function(){return eventTypes.ViewEndT}},{key:"ViewStartT",value:function(){return eventTypes.ViewStartT}},{key:"MutNodeTextT",value:function(){return eventTypes.MutNodeTextT}},{key:"MutInsertT",value:function(){return eventTypes.MutInsertT}},{key:"MutRemoveT",value:function(){return eventTypes.MutRemoveT}},{key:"SessionPropT",value:function(){return eventTypes.SessionPropT}},{key:"SclWindowT",value:function(){return eventTypes.SclWindowT}},{key:"WindowDimT",value:function(){return eventTypes.WindowDimT}},{key:"ResizeT",value:function(){return eventTypes.ResizeT}}]),e}(),aspromise=asPromise;function asPromise(e,t){for(var i=new Array(arguments.length-1),s=0,n=2,a=!0;n<arguments.length;)i[s++]=arguments[n++];return new Promise(function(n,r){i[s]=function(e){if(a)if(a=!1,e)r(e);else{for(var t=new Array(arguments.length-1),i=0;i<t.length;)t[i++]=arguments[i];n.apply(null,t)}};try{e.apply(t||null,i)}catch(e){a&&(a=!1,r(e))}})}var base64_1=createCommonjsModule(function(e,t){var i=t;i.length=function(e){var t=e.length;if(!t)return 0;for(var i=0;1<--t%4&&"="===e.charAt(t);)++i;return Math.ceil(3*e.length)/4-i};for(var l=new Array(64),c=new Array(123),n=0;n<64;)c[l[n]=n<26?n+65:n<52?n+71:n<62?n-4:n-59|43]=n++;i.encode=function(e,t,i){for(var n,r=null,s=[],a=0,o=0;t<i;){var c=e[t++];switch(o){case 0:s[a++]=l[c>>2],n=(3&c)<<4,o=1;break;case 1:s[a++]=l[n|c>>4],n=(15&c)<<2,o=2;break;case 2:s[a++]=l[n|c>>6],s[a++]=l[63&c],o=0}8191<a&&((r||(r=[])).push(String.fromCharCode.apply(String,s)),a=0)}return o&&(s[a++]=l[n],s[a++]=61,1===o&&(s[a++]=61)),r?(a&&r.push(String.fromCharCode.apply(String,s.slice(0,a))),r.join("")):String.fromCharCode.apply(String,s.slice(0,a))};var u="invalid encoding";i.decode=function(e,t,i){for(var n,r=i,s=0,a=0;a<e.length;){var o=e.charCodeAt(a++);if(61===o&&1<s)break;if(void 0===(o=c[o]))throw Error(u);switch(s){case 0:n=o,s=1;break;case 1:t[i++]=n<<2|(48&o)>>4,n=o,s=2;break;case 2:t[i++]=(15&n)<<4|(60&o)>>2,n=o,s=3;break;case 3:t[i++]=(3&n)<<6|o,s=0}}if(1===s)throw Error(u);return i-r},i.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}}),eventemitter=EventEmitter;function EventEmitter(){this._listeners={}}EventEmitter.prototype.on=function(e,t,i){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:i||this}),this},EventEmitter.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var i=this._listeners[e],n=0;n<i.length;)i[n].fn===t?i.splice(n,1):++n;return this},EventEmitter.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var i=[],n=1;n<arguments.length;)i.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,i)}return this};var float_1=factory(factory);function factory(o){return"undefined"!=typeof Float32Array?function(){var n=new Float32Array([-0]),r=new Uint8Array(n.buffer),e=128===r[3];function t(e,t,i){n[0]=e,t[i]=r[0],t[i+1]=r[1],t[i+2]=r[2],t[i+3]=r[3]}function i(e,t,i){n[0]=e,t[i]=r[3],t[i+1]=r[2],t[i+2]=r[1],t[i+3]=r[0]}function s(e,t){return r[0]=e[t],r[1]=e[t+1],r[2]=e[t+2],r[3]=e[t+3],n[0]}function a(e,t){return r[3]=e[t],r[2]=e[t+1],r[1]=e[t+2],r[0]=e[t+3],n[0]}o.writeFloatLE=e?t:i,o.writeFloatBE=e?i:t,o.readFloatLE=e?s:a,o.readFloatBE=e?a:s}():function(){function e(e,t,i,n){var r=t<0?1:0;if(r&&(t=-t),0===t)e(0<1/t?0:2147483648,i,n);else if(isNaN(t))e(2143289344,i,n);else if(34028234663852886e22<t)e((r<<31|2139095040)>>>0,i,n);else if(t<11754943508222875e-54)e((r<<31|Math.round(t/1401298464324817e-60))>>>0,i,n);else{var s=Math.floor(Math.log(t)/Math.LN2);e((r<<31|s+127<<23|8388607&Math.round(t*Math.pow(2,-s)*8388608))>>>0,i,n)}}function t(e,t,i){var n=e(t,i),r=2*(n>>31)+1,s=n>>>23&255,a=8388607&n;return 255===s?a?NaN:r*(1/0):0===s?1401298464324817e-60*r*a:r*Math.pow(2,s-150)*(a+8388608)}o.writeFloatLE=e.bind(null,writeUintLE),o.writeFloatBE=e.bind(null,writeUintBE),o.readFloatLE=t.bind(null,readUintLE),o.readFloatBE=t.bind(null,readUintBE)}(),"undefined"!=typeof Float64Array?function(){var n=new Float64Array([-0]),r=new Uint8Array(n.buffer),e=128===r[7];function t(e,t,i){n[0]=e,t[i]=r[0],t[i+1]=r[1],t[i+2]=r[2],t[i+3]=r[3],t[i+4]=r[4],t[i+5]=r[5],t[i+6]=r[6],t[i+7]=r[7]}function i(e,t,i){n[0]=e,t[i]=r[7],t[i+1]=r[6],t[i+2]=r[5],t[i+3]=r[4],t[i+4]=r[3],t[i+5]=r[2],t[i+6]=r[1],t[i+7]=r[0]}function s(e,t){return r[0]=e[t],r[1]=e[t+1],r[2]=e[t+2],r[3]=e[t+3],r[4]=e[t+4],r[5]=e[t+5],r[6]=e[t+6],r[7]=e[t+7],n[0]}function a(e,t){return r[7]=e[t],r[6]=e[t+1],r[5]=e[t+2],r[4]=e[t+3],r[3]=e[t+4],r[2]=e[t+5],r[1]=e[t+6],r[0]=e[t+7],n[0]}o.writeDoubleLE=e?t:i,o.writeDoubleBE=e?i:t,o.readDoubleLE=e?s:a,o.readDoubleBE=e?a:s}():function(){function e(e,t,i,n,r,s){var a=n<0?1:0;if(a&&(n=-n),0===n)e(0,r,s+t),e(0<1/n?0:2147483648,r,s+i);else if(isNaN(n))e(0,r,s+t),e(2146959360,r,s+i);else if(17976931348623157e292<n)e(0,r,s+t),e((a<<31|2146435072)>>>0,r,s+i);else{var o;if(n<22250738585072014e-324)e((o=n/5e-324)>>>0,r,s+t),e((a<<31|o/4294967296)>>>0,r,s+i);else{var c=Math.floor(Math.log(n)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(o=n*Math.pow(2,-c))>>>0,r,s+t),e((a<<31|c+1023<<20|1048576*o&1048575)>>>0,r,s+i)}}}function t(e,t,i,n,r){var s=e(n,r+t),a=e(n,r+i),o=2*(a>>31)+1,c=a>>>20&2047,l=4294967296*(1048575&a)+s;return 2047===c?l?NaN:o*(1/0):0===c?5e-324*o*l:o*Math.pow(2,c-1075)*(l+4503599627370496)}o.writeDoubleLE=e.bind(null,writeUintLE,0,4),o.writeDoubleBE=e.bind(null,writeUintBE,4,0),o.readDoubleLE=t.bind(null,readUintLE,0,4),o.readDoubleBE=t.bind(null,readUintBE,4,0)}(),o}function writeUintLE(e,t,i){t[i]=255&e,t[i+1]=e>>>8&255,t[i+2]=e>>>16&255,t[i+3]=e>>>24}function writeUintBE(e,t,i){t[i]=e>>>24,t[i+1]=e>>>16&255,t[i+2]=e>>>8&255,t[i+3]=255&e}function readUintLE(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function readUintBE(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}var inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}var utf8_1=createCommonjsModule(function(e,t){var i=t;i.length=function(e){for(var t=0,i=0,n=0;n<e.length;++n)(i=e.charCodeAt(n))<128?t+=1:i<2048?t+=2:55296==(64512&i)&&56320==(64512&e.charCodeAt(n+1))?(++n,t+=4):t+=3;return t},i.read=function(e,t,i){if(i-t<1)return"";for(var n,r=null,s=[],a=0;t<i;)n=e[t++],s[a++]=n<128?n:191<n&&n<224?(31&n)<<6|63&e[t++]:239<n&&n<365?(n=((7&n)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,s[a++]=55296+(n>>10),56320+(1023&n)):(15&n)<<12|(63&e[t++])<<6|63&e[t++],8191<a&&((r||(r=[])).push(String.fromCharCode.apply(String,s)),a=0);return r?(a&&r.push(String.fromCharCode.apply(String,s.slice(0,a))),r.join("")):String.fromCharCode.apply(String,s.slice(0,a))},i.write=function(e,t,i){for(var n,r,s=i,a=0;a<e.length;++a)n=e.charCodeAt(a),t[i++]=n<128?n:(t[i++]=n<2048?n>>6|192:(55296==(64512&n)&&56320==(64512&(r=e.charCodeAt(a+1)))?(n=65536+((1023&n)<<10)+(1023&r),++a,t[i++]=n>>18|240,t[i++]=n>>12&63|128):t[i++]=n>>12|224,n>>6&63|128),63&n|128);return i-s}}),pool_1=pool;function pool(i,n,e){var r=e||8192,s=r>>>1,a=null,o=r;return function(e){if(e<1||s<e)return i(e);r<o+e&&(a=i(r),o=0);var t=n.call(a,o,o+=e);return 7&o&&(o=1+(7|o)),t}}var longbits=LongBits;function LongBits(e,t){this.lo=e>>>0,this.hi=t>>>0}var zero=LongBits.zero=new LongBits(0,0);zero.toNumber=function(){return 0},zero.zzEncode=zero.zzDecode=function(){return this},zero.length=function(){return 1};var zeroHash=LongBits.zeroHash="\0\0\0\0\0\0\0\0";LongBits.fromNumber=function(e){if(0===e)return zero;var t=e<0;t&&(e=-e);var i=e>>>0,n=(e-i)/4294967296>>>0;return t&&(n=~n>>>0,i=~i>>>0,4294967295<++i&&(i=0,4294967295<++n&&(n=0))),new LongBits(i,n)},LongBits.from=function(e){if("number"==typeof e)return LongBits.fromNumber(e);if(minimal.isString(e)){if(!minimal.Long)return LongBits.fromNumber(parseInt(e,10));e=minimal.Long.fromString(e)}return e.low||e.high?new LongBits(e.low>>>0,e.high>>>0):zero},LongBits.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,i=~this.hi>>>0;return t||(i=i+1>>>0),-(t+4294967296*i)}return this.lo+4294967296*this.hi},LongBits.prototype.toLong=function(e){return minimal.Long?new minimal.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var charCodeAt=String.prototype.charCodeAt;LongBits.fromHash=function(e){return e===zeroHash?zero:new LongBits((charCodeAt.call(e,0)|charCodeAt.call(e,1)<<8|charCodeAt.call(e,2)<<16|charCodeAt.call(e,3)<<24)>>>0,(charCodeAt.call(e,4)|charCodeAt.call(e,5)<<8|charCodeAt.call(e,6)<<16|charCodeAt.call(e,7)<<24)>>>0)},LongBits.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},LongBits.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},LongBits.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},LongBits.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,i=this.hi>>>24;return 0===i?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:i<128?9:10};var minimal=createCommonjsModule(function(e,t){var n=t;function r(e,t,i){for(var n=Object.keys(t),r=0;r<n.length;++r)void 0!==e[n[r]]&&i||(e[n[r]]=t[n[r]]);return e}function i(e){function i(e,t){if(!(this instanceof i))return new i(e,t);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,i):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),t&&r(this,t)}return(i.prototype=Object.create(Error.prototype)).constructor=i,Object.defineProperty(i.prototype,"name",{get:function(){return e}}),i.prototype.toString=function(){return this.name+": "+this.message},i}n.asPromise=aspromise,n.base64=base64_1,n.EventEmitter=eventemitter,n.float=float_1,n.inquire=inquire_1,n.utf8=utf8_1,n.pool=pool_1,n.LongBits=longbits,n.global="undefined"!=typeof window&&window||void 0!==commonjsGlobal&&commonjsGlobal||"undefined"!=typeof self&&self||commonjsGlobal,n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isNode=Boolean(n.global.process&&n.global.process.versions&&n.global.process.versions.node),n.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},n.isString=function(e){return"string"==typeof e||e instanceof String},n.isObject=function(e){return e&&"object"==typeof e},n.isset=n.isSet=function(e,t){var i=e[t];return!(null==i||!e.hasOwnProperty(t))&&("object"!=typeof i||0<(Array.isArray(i)?i.length:Object.keys(i).length))},n.Buffer=function(){try{var e=n.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(e){return"number"==typeof e?n.Buffer?n._Buffer_allocUnsafe(e):new n.Array(e):n.Buffer?n._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},n.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,n.Long=n.global.dcodeIO&&n.global.dcodeIO.Long||n.global.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(e){return e?n.LongBits.from(e).toHash():n.LongBits.zeroHash},n.longFromHash=function(e,t){var i=n.LongBits.fromHash(e);return n.Long?n.Long.fromBits(i.lo,i.hi,t):i.toNumber(Boolean(t))},n.merge=r,n.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},n.newError=i,n.ProtocolError=i("ProtocolError"),n.oneOfGetter=function(e){for(var i={},t=0;t<e.length;++t)i[e[t]]=1;return function(){for(var e=Object.keys(this),t=e.length-1;-1<t;--t)if(1===i[e[t]]&&void 0!==this[e[t]]&&null!==this[e[t]])return e[t]}},n.oneOfSetter=function(i){return function(e){for(var t=0;t<i.length;++t)i[t]!==e&&delete this[i[t]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var i=n.Buffer;i?(n._Buffer_from=i.from!==Uint8Array.from&&i.from||function(e,t){return new i(e,t)},n._Buffer_allocUnsafe=i.allocUnsafe||function(e){return new i(e)}):n._Buffer_from=n._Buffer_allocUnsafe=null}}),writer=Writer,BufferWriter,LongBits$1=minimal.LongBits,base64=minimal.base64,utf8=minimal.utf8;function Op(e,t,i){this.fn=e,this.len=t,this.next=void 0,this.val=i}function noop$2(){}function State(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function Writer(){this.len=0,this.head=new Op(noop$2,0,0),this.tail=this.head,this.states=null}function writeByte(e,t,i){t[i]=255&e}function writeVarint32(e,t,i){for(;127<e;)t[i++]=127&e|128,e>>>=7;t[i]=e}function VarintOp(e,t){this.len=e,this.next=void 0,this.val=t}function writeVarint64(e,t,i){for(;e.hi;)t[i++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;127<e.lo;)t[i++]=127&e.lo|128,e.lo=e.lo>>>7;t[i++]=e.lo}function writeFixed32(e,t,i){t[i]=255&e,t[i+1]=e>>>8&255,t[i+2]=e>>>16&255,t[i+3]=e>>>24}Writer.create=minimal.Buffer?function(){return(Writer.create=function(){return new BufferWriter})()}:function(){return new Writer},Writer.alloc=function(e){return new minimal.Array(e)},minimal.Array!==Array&&(Writer.alloc=minimal.pool(Writer.alloc,minimal.Array.prototype.subarray)),Writer.prototype._push=function(e,t,i){return this.tail=this.tail.next=new Op(e,t,i),this.len+=t,this},VarintOp.prototype=Object.create(Op.prototype),VarintOp.prototype.fn=writeVarint32,Writer.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new VarintOp((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},Writer.prototype.int32=function(e){return e<0?this._push(writeVarint64,10,LongBits$1.fromNumber(e)):this.uint32(e)},Writer.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},Writer.prototype.uint64=function(e){var t=LongBits$1.from(e);return this._push(writeVarint64,t.length(),t)},Writer.prototype.int64=Writer.prototype.uint64,Writer.prototype.sint64=function(e){var t=LongBits$1.from(e).zzEncode();return this._push(writeVarint64,t.length(),t)},Writer.prototype.bool=function(e){return this._push(writeByte,1,e?1:0)},Writer.prototype.fixed32=function(e){return this._push(writeFixed32,4,e>>>0)},Writer.prototype.sfixed32=Writer.prototype.fixed32,Writer.prototype.fixed64=function(e){var t=LongBits$1.from(e);return this._push(writeFixed32,4,t.lo)._push(writeFixed32,4,t.hi)},Writer.prototype.sfixed64=Writer.prototype.fixed64,Writer.prototype.float=function(e){return this._push(minimal.float.writeFloatLE,4,e)},Writer.prototype.double=function(e){return this._push(minimal.float.writeDoubleLE,8,e)};var writeBytes=minimal.Array.prototype.set?function(e,t,i){t.set(e,i)}:function(e,t,i){for(var n=0;n<e.length;++n)t[i+n]=e[n]};Writer.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(writeByte,1,0);if(minimal.isString(e)){var i=Writer.alloc(t=base64.length(e));base64.decode(e,i,0),e=i}return this.uint32(t)._push(writeBytes,t,e)},Writer.prototype.string=function(e){var t=utf8.length(e);return t?this.uint32(t)._push(utf8.write,t,e):this._push(writeByte,1,0)},Writer.prototype.fork=function(){return this.states=new State(this),this.head=this.tail=new Op(noop$2,0,0),this.len=0,this},Writer.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop$2,0,0),this.len=0),this},Writer.prototype.ldelim=function(){var e=this.head,t=this.tail,i=this.len;return this.reset().uint32(i),i&&(this.tail.next=e.next,this.tail=t,this.len+=i),this},Writer.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),i=0;e;)e.fn(e.val,t,i),i+=e.len,e=e.next;return t},Writer._configure=function(e){BufferWriter=e};var writer_buffer=BufferWriter$1;(BufferWriter$1.prototype=Object.create(writer.prototype)).constructor=BufferWriter$1;var Buffer$1=minimal.Buffer;function BufferWriter$1(){writer.call(this)}BufferWriter$1.alloc=function(e){return(BufferWriter$1.alloc=minimal._Buffer_allocUnsafe)(e)};var writeBytesBuffer=Buffer$1&&Buffer$1.prototype instanceof Uint8Array&&"set"===Buffer$1.prototype.set.name?function(e,t,i){t.set(e,i)}:function(e,t,i){if(e.copy)e.copy(t,i,0,e.length);else for(var n=0;n<e.length;)t[i++]=e[n++]};function writeStringBuffer(e,t,i){e.length<40?minimal.utf8.write(e,t,i):t.utf8Write(e,i)}BufferWriter$1.prototype.bytes=function(e){minimal.isString(e)&&(e=minimal._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(writeBytesBuffer,t,e),this},BufferWriter$1.prototype.string=function(e){var t=Buffer$1.byteLength(e);return this.uint32(t),t&&this._push(writeStringBuffer,t,e),this};var reader=Reader,BufferReader,LongBits$2=minimal.LongBits,utf8$1=minimal.utf8;function indexOutOfRange(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function Reader(e){this.buf=e,this.pos=0,this.len=e.length}var create_array="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Reader(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Reader(e);throw Error("illegal buffer")},IU;function readLongVarint(){var e=new LongBits$2(0,0),t=0;if(!(4<this.len-this.pos)){for(;t<3;++t){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,4<this.len-this.pos){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function readFixed32_end(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new LongBits$2(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader.create=minimal.Buffer?function(e){return(Reader.create=function(e){return minimal.Buffer.isBuffer(e)?new BufferReader(e):create_array(e)})(e)}:create_array,Reader.prototype._slice=minimal.Array.prototype.subarray||minimal.Array.prototype.slice,Reader.prototype.uint32=(IU=4294967295,function(){if(IU=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return IU;if(IU=(IU|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return IU;if(IU=(IU|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return IU;if(IU=(IU|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return IU;if(IU=(IU|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return IU;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return IU}),Reader.prototype.int32=function(){return 0|this.uint32()},Reader.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},Reader.prototype.bool=function(){return 0!==this.uint32()},Reader.prototype.fixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)},Reader.prototype.sfixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return 0|readFixed32_end(this.buf,this.pos+=4)},Reader.prototype.float=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var e=minimal.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},Reader.prototype.double=function(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var e=minimal.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},Reader.prototype.bytes=function(){var e=this.uint32(),t=this.pos,i=this.pos+e;if(i>this.len)throw indexOutOfRange(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,i):t===i?new this.buf.constructor(0):this._slice.call(this.buf,t,i)},Reader.prototype.string=function(){var e=this.bytes();return utf8$1.read(e,0,e.length)},Reader.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw indexOutOfRange(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw indexOutOfRange(this)}while(128&this.buf[this.pos++]);return this},Reader.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},Reader._configure=function(e){BufferReader=e;var t=minimal.Long?"toLong":"toNumber";minimal.merge(Reader.prototype,{int64:function(){return readLongVarint.call(this)[t](!1)},uint64:function(){return readLongVarint.call(this)[t](!0)},sint64:function(){return readLongVarint.call(this).zzDecode()[t](!1)},fixed64:function(){return readFixed64.call(this)[t](!0)},sfixed64:function(){return readFixed64.call(this)[t](!1)}})};var reader_buffer=BufferReader$1;function BufferReader$1(e){reader.call(this,e)}(BufferReader$1.prototype=Object.create(reader.prototype)).constructor=BufferReader$1,minimal.Buffer&&(BufferReader$1.prototype._slice=minimal.Buffer.prototype.slice),BufferReader$1.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len))};var service=Service;function Service(e,t,i){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");minimal.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(i)}(Service.prototype=Object.create(minimal.EventEmitter.prototype)).constructor=Service,Service.prototype.rpcCall=function e(i,t,n,r,s){if(!r)throw TypeError("request must be specified");var a=this;if(!s)return minimal.asPromise(e,a,i,t,n,r);if(a.rpcImpl)try{return a.rpcImpl(i,t[a.requestDelimited?"encodeDelimited":"encode"](r).finish(),function(e,t){if(e)return a.emit("error",e,i),s(e);if(null!==t){if(!(t instanceof n))try{t=n[a.responseDelimited?"decodeDelimited":"decode"](t)}catch(e){return a.emit("error",e,i),s(e)}return a.emit("data",t,i),s(null,t)}a.end(!0)})}catch(e){return a.emit("error",e,i),void setTimeout(function(){s(e)},0)}else setTimeout(function(){s(Error("already ended"))},0)},Service.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};for(var rpc_1=createCommonjsModule(function(e,t){t.Service=service}),roots={},indexMinimal=createCommonjsModule(function(e,t){var i=t;function n(){i.Reader._configure(i.BufferReader),i.util._configure()}i.build="minimal",i.Writer=writer,i.BufferWriter=writer_buffer,i.Reader=reader,i.BufferReader=reader_buffer,i.util=minimal,i.rpc=rpc_1,i.roots=roots,i.configure=n,i.Writer._configure(i.BufferWriter),n()}),minimal$2=indexMinimal,minimal_1=minimal$2.util,minimal_2=minimal$2.Writer,minimal_3=minimal$2.Reader,$Reader=minimal_3,$Writer=minimal_2,$util=minimal_1,$root={},com=$root.com=(MV={},MV.auryc=((NV={}).ubi=((OV={}).core=((PV={}).model=((QV={}).Message=function(){function t(e){if(this.packet=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return t.prototype.cid="",t.prototype.uid="",t.prototype.sid="",t.prototype.domain="",t.prototype.context=null,t.prototype.packet=$util.emptyArray,t.create=function(e){return new t(e)},t.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.cid&&e.hasOwnProperty("cid")&&t.uint32(10).string(e.cid),null!=e.uid&&e.hasOwnProperty("uid")&&t.uint32(18).string(e.uid),null!=e.sid&&e.hasOwnProperty("sid")&&t.uint32(26).string(e.sid),null!=e.domain&&e.hasOwnProperty("domain")&&t.uint32(34).string(e.domain),null!=e.context&&e.hasOwnProperty("context")&&$root.com.auryc.ubi.core.model.Message.MessageContext.encode(e.context,t.uint32(42).fork()).ldelim(),null!=e.packet&&e.packet.length)for(var i=0;i<e.packet.length;++i)$root.com.auryc.ubi.core.model.Message.MessagePacket.encode(e.packet[i],t.uint32(50).fork()).ldelim();return t},t.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},t.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var i=void 0===t?e.len:e.pos+t,n=new $root.com.auryc.ubi.core.model.Message;e.pos<i;){var r=e.uint32();switch(r>>>3){case 1:n.cid=e.string();break;case 2:n.uid=e.string();break;case 3:n.sid=e.string();break;case 4:n.domain=e.string();break;case 5:n.context=$root.com.auryc.ubi.core.model.Message.MessageContext.decode(e,e.uint32());break;case 6:n.packet&&n.packet.length||(n.packet=[]),n.packet.push($root.com.auryc.ubi.core.model.Message.MessagePacket.decode(e,e.uint32()));break;default:e.skipType(7&r)}}return n},t.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},t.verify=function(e){if("object"!==(void 0===e?"undefined":_typeof(e))||null===e)return"object expected";if(null!=e.cid&&e.hasOwnProperty("cid")&&!$util.isString(e.cid))return"cid: string expected";if(null!=e.uid&&e.hasOwnProperty("uid")&&!$util.isString(e.uid))return"uid: string expected";if(null!=e.sid&&e.hasOwnProperty("sid")&&!$util.isString(e.sid))return"sid: string expected";if(null!=e.domain&&e.hasOwnProperty("domain")&&!$util.isString(e.domain))return"domain: string expected";if(null!=e.context&&e.hasOwnProperty("context")){var t=$root.com.auryc.ubi.core.model.Message.MessageContext.verify(e.context);if(t)return"context."+t}if(null!=e.packet&&e.hasOwnProperty("packet")){if(!Array.isArray(e.packet))return"packet: array expected";for(var i=0;i<e.packet.length;++i){var n=$root.com.auryc.ubi.core.model.Message.MessagePacket.verify(e.packet[i]);if(n)return"packet."+n}}return null},t.fromObject=function(e){if(e instanceof $root.com.auryc.ubi.core.model.Message)return e;var t=new $root.com.auryc.ubi.core.model.Message;if(null!=e.cid&&(t.cid=String(e.cid)),null!=e.uid&&(t.uid=String(e.uid)),null!=e.sid&&(t.sid=String(e.sid)),null!=e.domain&&(t.domain=String(e.domain)),null!=e.context){if("object"!==_typeof(e.context))throw TypeError(".com.auryc.ubi.core.model.Message.context: object expected");t.context=$root.com.auryc.ubi.core.model.Message.MessageContext.fromObject(e.context)}if(e.packet){if(!Array.isArray(e.packet))throw TypeError(".com.auryc.ubi.core.model.Message.packet: array expected");t.packet=[];for(var i=0;i<e.packet.length;++i){if("object"!==_typeof(e.packet[i]))throw TypeError(".com.auryc.ubi.core.model.Message.packet: object expected");t.packet[i]=$root.com.auryc.ubi.core.model.Message.MessagePacket.fromObject(e.packet[i])}}return t},t.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.packet=[]),t.defaults&&(i.cid="",i.uid="",i.sid="",i.domain="",i.context=null),null!=e.cid&&e.hasOwnProperty("cid")&&(i.cid=e.cid),null!=e.uid&&e.hasOwnProperty("uid")&&(i.uid=e.uid),null!=e.sid&&e.hasOwnProperty("sid")&&(i.sid=e.sid),null!=e.domain&&e.hasOwnProperty("domain")&&(i.domain=e.domain),null!=e.context&&e.hasOwnProperty("context")&&(i.context=$root.com.auryc.ubi.core.model.Message.MessageContext.toObject(e.context,t)),e.packet&&e.packet.length){i.packet=[];for(var n=0;n<e.packet.length;++n)i.packet[n]=$root.com.auryc.ubi.core.model.Message.MessagePacket.toObject(e.packet[n],t)}return i},t.prototype.toJSON=function(){return this.constructor.toObject(this,minimal_1.toJSONOptions)},t.MessageContext=function(){function t(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return t.prototype.ln="",t.prototype.lv="",t.prototype.ip="",t.prototype.ref="",t.prototype.ua="",t.create=function(e){return new t(e)},t.encode=function(e,t){return t||(t=$Writer.create()),null!=e.ln&&e.hasOwnProperty("ln")&&t.uint32(10).string(e.ln),null!=e.lv&&e.hasOwnProperty("lv")&&t.uint32(18).string(e.lv),null!=e.ip&&e.hasOwnProperty("ip")&&t.uint32(26).string(e.ip),null!=e.ref&&e.hasOwnProperty("ref")&&t.uint32(34).string(e.ref),null!=e.ua&&e.hasOwnProperty("ua")&&t.uint32(42).string(e.ua),t},t.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},t.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var i=void 0===t?e.len:e.pos+t,n=new $root.com.auryc.ubi.core.model.Message.MessageContext;e.pos<i;){var r=e.uint32();switch(r>>>3){case 1:n.ln=e.string();break;case 2:n.lv=e.string();break;case 3:n.ip=e.string();break;case 4:n.ref=e.string();break;case 5:n.ua=e.string();break;default:e.skipType(7&r)}}return n},t.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},t.verify=function(e){return"object"!==(void 0===e?"undefined":_typeof(e))||null===e?"object expected":null!=e.ln&&e.hasOwnProperty("ln")&&!$util.isString(e.ln)?"ln: string expected":null!=e.lv&&e.hasOwnProperty("lv")&&!$util.isString(e.lv)?"lv: string expected":null!=e.ip&&e.hasOwnProperty("ip")&&!$util.isString(e.ip)?"ip: string expected":null!=e.ref&&e.hasOwnProperty("ref")&&!$util.isString(e.ref)?"ref: string expected":null!=e.ua&&e.hasOwnProperty("ua")&&!$util.isString(e.ua)?"ua: string expected":null},t.fromObject=function(e){if(e instanceof $root.com.auryc.ubi.core.model.Message.MessageContext)return e;var t=new $root.com.auryc.ubi.core.model.Message.MessageContext;return null!=e.ln&&(t.ln=String(e.ln)),null!=e.lv&&(t.lv=String(e.lv)),null!=e.ip&&(t.ip=String(e.ip)),null!=e.ref&&(t.ref=String(e.ref)),null!=e.ua&&(t.ua=String(e.ua)),t},t.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.ln="",i.lv="",i.ip="",i.ref="",i.ua=""),null!=e.ln&&e.hasOwnProperty("ln")&&(i.ln=e.ln),null!=e.lv&&e.hasOwnProperty("lv")&&(i.lv=e.lv),null!=e.ip&&e.hasOwnProperty("ip")&&(i.ip=e.ip),null!=e.ref&&e.hasOwnProperty("ref")&&(i.ref=e.ref),null!=e.ua&&e.hasOwnProperty("ua")&&(i.ua=e.ua),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,minimal_1.toJSONOptions)},t}(),t.MessagePacket=function(){function t(e){if(this.payload={},e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return t.prototype.vid="",t.prototype.ts=$util.Long?$util.Long.fromBits(0,0,!1):0,t.prototype.status=0,t.prototype.size=0,t.prototype.data=$util.newBuffer([]),t.prototype.payload=$util.emptyObject,t.create=function(e){return new t(e)},t.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.vid&&e.hasOwnProperty("vid")&&t.uint32(10).string(e.vid),null!=e.ts&&e.hasOwnProperty("ts")&&t.uint32(16).int64(e.ts),null!=e.status&&e.hasOwnProperty("status")&&t.uint32(24).int32(e.status),null!=e.size&&e.hasOwnProperty("size")&&t.uint32(32).int32(e.size),null!=e.data&&e.hasOwnProperty("data")&&t.uint32(42).bytes(e.data),null!=e.payload&&e.hasOwnProperty("payload"))for(var i=Object.keys(e.payload),n=0;n<i.length;++n)t.uint32(50).fork().uint32(10).string(i[n]).uint32(18).bytes(e.payload[i[n]]).ldelim();return t},t.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},t.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var i=void 0===t?e.len:e.pos+t,n=new $root.com.auryc.ubi.core.model.Message.MessagePacket,r=void 0;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:n.vid=e.string();break;case 2:n.ts=e.int64();break;case 3:n.status=e.int32();break;case 4:n.size=e.int32();break;case 5:n.data=e.bytes();break;case 6:e.skip().pos++,n.payload===$util.emptyObject&&(n.payload={}),r=e.string(),e.pos++,n.payload[r]=e.bytes();break;default:e.skipType(7&s)}}return n},t.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},t.verify=function(e){if("object"!==(void 0===e?"undefined":_typeof(e))||null===e)return"object expected";if(null!=e.vid&&e.hasOwnProperty("vid")&&!$util.isString(e.vid))return"vid: string expected";if(null!=e.ts&&e.hasOwnProperty("ts")&&!($util.isInteger(e.ts)||e.ts&&$util.isInteger(e.ts.low)&&$util.isInteger(e.ts.high)))return"ts: integer|Long expected";if(null!=e.status&&e.hasOwnProperty("status")&&!$util.isInteger(e.status))return"status: integer expected";if(null!=e.size&&e.hasOwnProperty("size")&&!$util.isInteger(e.size))return"size: integer expected";if(null!=e.data&&e.hasOwnProperty("data")&&!(e.data&&"number"==typeof e.data.length||$util.isString(e.data)))return"data: buffer expected";if(null!=e.payload&&e.hasOwnProperty("payload")){if(!$util.isObject(e.payload))return"payload: object expected";for(var t=Object.keys(e.payload),i=0;i<t.length;++i)if(!(e.payload[t[i]]&&"number"==typeof e.payload[t[i]].length||$util.isString(e.payload[t[i]])))return"payload: buffer{k:string} expected"}return null},t.fromObject=function(e){if(e instanceof $root.com.auryc.ubi.core.model.Message.MessagePacket)return e;var t=new $root.com.auryc.ubi.core.model.Message.MessagePacket;if(null!=e.vid&&(t.vid=String(e.vid)),null!=e.ts&&($util.Long?(t.ts=$util.Long.fromValue(e.ts)).unsigned=!1:"string"==typeof e.ts?t.ts=parseInt(e.ts,10):"number"==typeof e.ts?t.ts=e.ts:"object"===_typeof(e.ts)&&(t.ts=new $util.LongBits(e.ts.low>>>0,e.ts.high>>>0).toNumber())),null!=e.status&&(t.status=0|e.status),null!=e.size&&(t.size=0|e.size),null!=e.data&&("string"==typeof e.data?$util.base64.decode(e.data,t.data=$util.newBuffer($util.base64.length(e.data)),0):e.data.length&&(t.data=e.data)),e.payload){if("object"!==_typeof(e.payload))throw TypeError(".com.auryc.ubi.core.model.Message.MessagePacket.payload: object expected");t.payload={};for(var i=Object.keys(e.payload),n=0;n<i.length;++n)"string"==typeof e.payload[i[n]]?$util.base64.decode(e.payload[i[n]],t.payload[i[n]]=$util.newBuffer($util.base64.length(e.payload[i[n]])),0):e.payload[i[n]].length&&(t.payload[i[n]]=e.payload[i[n]])}return t},t.toObject=function(e,t){t||(t={});var i={};if((t.objects||t.defaults)&&(i.payload={}),t.defaults){if(i.vid="",$util.Long){var n=new $util.Long(0,0,!1);i.ts=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else i.ts=t.longs===String?"0":0;i.status=0,i.size=0,i.data=t.bytes===String?"":[]}null!=e.vid&&e.hasOwnProperty("vid")&&(i.vid=e.vid),null!=e.ts&&e.hasOwnProperty("ts")&&("number"==typeof e.ts?i.ts=t.longs===String?String(e.ts):e.ts:i.ts=t.longs===String?$util.Long.prototype.toString.call(e.ts):t.longs===Number?new $util.LongBits(e.ts.low>>>0,e.ts.high>>>0).toNumber():e.ts),null!=e.status&&e.hasOwnProperty("status")&&(i.status=e.status),null!=e.size&&e.hasOwnProperty("size")&&(i.size=e.size),null!=e.data&&e.hasOwnProperty("data")&&(i.data=t.bytes===String?$util.base64.encode(e.data,0,e.data.length):t.bytes===Array?Array.prototype.slice.call(e.data):e.data);var r=void 0;if(e.payload&&(r=Object.keys(e.payload)).length){i.payload={};for(var s=0;s<r.length;++s)i.payload[r[s]]=t.bytes===String?$util.base64.encode(e.payload[r[s]],0,e.payload[r[s]].length):t.bytes===Array?Array.prototype.slice.call(e.payload[r[s]]):e.payload[r[s]]}return i},t.prototype.toJSON=function(){return this.constructor.toObject(this,minimal_1.toJSONOptions)},t}(),t}(),QV),PV),OV),NV),MV),QV,PV,OV,NV,MV,byteLength_1=byteLength,toByteArray_1=toByteArray,fromByteArray_1=fromByteArray,lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,len=code.length;i<len;++i)lookup[i]=code[i],revLookup[code.charCodeAt(i)]=i;function getLens(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");var i=e.indexOf("=");return-1===i&&(i=t),[i,i===t?0:4-i%4]}function byteLength(e){var t=getLens(e),i=t[0],n=t[1];return 3*(i+n)/4-n}function _byteLength(e,t,i){return 3*(t+i)/4-i}function toByteArray(e){for(var t,i=getLens(e),n=i[0],r=i[1],s=new Arr(_byteLength(e,n,r)),a=0,o=0<r?n-4:n,c=0;c<o;c+=4)t=revLookup[e.charCodeAt(c)]<<18|revLookup[e.charCodeAt(c+1)]<<12|revLookup[e.charCodeAt(c+2)]<<6|revLookup[e.charCodeAt(c+3)],s[a++]=t>>16&255,s[a++]=t>>8&255,s[a++]=255&t;return 2===r&&(t=revLookup[e.charCodeAt(c)]<<2|revLookup[e.charCodeAt(c+1)]>>4,s[a++]=255&t),1===r&&(t=revLookup[e.charCodeAt(c)]<<10|revLookup[e.charCodeAt(c+1)]<<4|revLookup[e.charCodeAt(c+2)]>>2,s[a++]=t>>8&255,s[a++]=255&t),s}function tripletToBase64(e){return lookup[e>>18&63]+lookup[e>>12&63]+lookup[e>>6&63]+lookup[63&e]}function encodeChunk(e,t,i){for(var n,r=[],s=t;s<i;s+=3)n=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),r.push(tripletToBase64(n));return r.join("")}function fromByteArray(e){for(var t,i=e.length,n=i%3,r=[],s=0,a=i-n;s<a;s+=16383)r.push(encodeChunk(e,s,a<s+16383?a:s+16383));return 1===n?(t=e[i-1],r.push(lookup[t>>2]+lookup[t<<4&63]+"==")):2===n&&(t=(e[i-2]<<8)+e[i-1],r.push(lookup[t>>10]+lookup[t>>4&63]+lookup[t<<2&63]+"=")),r.join("")}revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63;var base64Js={byteLength:byteLength_1,toByteArray:toByteArray_1,fromByteArray:fromByteArray_1},read=function(e,t,i,n,r){var s,a,o=8*r-n-1,c=(1<<o)-1,l=c>>1,u=-7,h=i?r-1:0,g=i?-1:1,d=e[t+h];for(h+=g,s=d&(1<<-u)-1,d>>=-u,u+=o;0<u;s=256*s+e[t+h],h+=g,u-=8);for(a=s&(1<<-u)-1,s>>=-u,u+=n;0<u;a=256*a+e[t+h],h+=g,u-=8);if(0===s)s=1-l;else{if(s===c)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,n),s-=l}return(d?-1:1)*a*Math.pow(2,s-n)},write=function(e,t,i,n,r,s){var a,o,c,l=8*s-r-1,u=(1<<l)-1,h=u>>1,g=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:s-1,p=n?1:-1,f=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),2<=(t+=1<=a+h?g/c:g*Math.pow(2,1-h))*c&&(a++,c/=2),u<=a+h?(o=0,a=u):1<=a+h?(o=(t*c-1)*Math.pow(2,r),a+=h):(o=t*Math.pow(2,h-1)*Math.pow(2,r),a=0));8<=r;e[i+d]=255&o,d+=p,o/=256,r-=8);for(a=a<<r|o,l+=r;0<l;e[i+d]=255&a,d+=p,a/=256,l-=8);e[i+d-p]|=128*f},ieee754={read:read,write:write},buffer=createCommonjsModule(function(e,i){i.Buffer=h,i.SlowBuffer=function(e){+e!=e&&(e=0);return h.alloc(+e)},i.INSPECT_MAX_BYTES=50;var n=2147483647;function a(e){if(n<e)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return t.__proto__=h.prototype,t}function h(e,t,i){if("number"!=typeof e)return r(e,t,i);if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return s(e)}function r(e,t,i){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!h.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var i=0|u(e,t),n=a(i),r=n.write(e,t);r!==i&&(n=n.slice(0,r));return n}(e,t);if(ArrayBuffer.isView(e))return c(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(N(e,ArrayBuffer)||e&&N(e.buffer,ArrayBuffer))return function(e,t,i){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(i||0))throw new RangeError('"length" is outside of buffer bounds');var n;n=void 0===t&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,t):new Uint8Array(e,t,i);return n.__proto__=h.prototype,n}(e,t,i);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return h.from(n,t,i);var r=function(e){if(h.isBuffer(e)){var t=0|l(e.length),i=a(t);return 0===i.length||e.copy(i,0,0,t),i}if(void 0!==e.length)return"number"!=typeof e.length||B(e.length)?a(0):c(e);if("Buffer"===e.type&&Array.isArray(e.data))return c(e.data)}(e);if(r)return r;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return h.from(e[Symbol.toPrimitive]("string"),t,i);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function o(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function s(e){return o(e),a(e<0?0:0|l(e))}function c(e){for(var t=e.length<0?0:0|l(e.length),i=a(t),n=0;n<t;n+=1)i[n]=255&e[n];return i}function l(e){if(n<=e)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return 0|e}function u(e,t){if(h.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||N(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var i=e.length,n=2<arguments.length&&!0===arguments[2];if(!n&&0===i)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return k(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return P(e).length;default:if(r)return n?-1:k(e).length;t=(""+t).toLowerCase(),r=!0}}function g(e,t,i){var n=e[t];e[t]=e[i],e[i]=n}function d(e,t,i,n,r){if(0===e.length)return-1;if("string"==typeof i?(n=i,i=0):2147483647<i?i=2147483647:i<-2147483648&&(i=-2147483648),B(i=+i)&&(i=r?0:e.length-1),i<0&&(i=e.length+i),i>=e.length){if(r)return-1;i=e.length-1}else if(i<0){if(!r)return-1;i=0}if("string"==typeof t&&(t=h.from(t,n)),h.isBuffer(t))return 0===t.length?-1:p(e,t,i,n,r);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,i):Uint8Array.prototype.lastIndexOf.call(e,t,i):p(e,[t],i,n,r);throw new TypeError("val must be string, number or Buffer")}function p(e,t,i,n,r){var s,a=1,o=e.length,c=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o/=a=2,c/=2,i/=2}function l(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(r){var u=-1;for(s=i;s<o;s++)if(l(e,s)===l(t,-1===u?0:s-u)){if(-1===u&&(u=s),s-u+1===c)return u*a}else-1!==u&&(s-=s-u),u=-1}else for(o<i+c&&(i=o-c),s=i;0<=s;s--){for(var h=!0,g=0;g<c;g++)if(l(e,s+g)!==l(t,g)){h=!1;break}if(h)return s}return-1}function f(e,t,i,n){i=Number(i)||0;var r=e.length-i;n?r<(n=Number(n))&&(n=r):n=r;var s=t.length;s/2<n&&(n=s/2);for(var a=0;a<n;++a){var o=parseInt(t.substr(2*a,2),16);if(B(o))return a;e[i+a]=o}return a}function y(e,t,i,n){return _(function(e){for(var t=[],i=0;i<e.length;++i)t.push(255&e.charCodeAt(i));return t}(t),e,i,n)}function m(e,t,i){return 0===t&&i===e.length?base64Js.fromByteArray(e):base64Js.fromByteArray(e.slice(t,i))}function b(e,t,i){i=Math.min(e.length,i);for(var n=[],r=t;r<i;){var s,a,o,c,l=e[r],u=null,h=239<l?4:223<l?3:191<l?2:1;if(r+h<=i)switch(h){case 1:l<128&&(u=l);break;case 2:128==(192&(s=e[r+1]))&&127<(c=(31&l)<<6|63&s)&&(u=c);break;case 3:s=e[r+1],a=e[r+2],128==(192&s)&&128==(192&a)&&2047<(c=(15&l)<<12|(63&s)<<6|63&a)&&(c<55296||57343<c)&&(u=c);break;case 4:s=e[r+1],a=e[r+2],o=e[r+3],128==(192&s)&&128==(192&a)&&128==(192&o)&&65535<(c=(15&l)<<18|(63&s)<<12|(63&a)<<6|63&o)&&c<1114112&&(u=c)}null===u?(u=65533,h=1):65535<u&&(u-=65536,n.push(u>>>10&1023|55296),u=56320|1023&u),n.push(u),r+=h}return function(e){var t=e.length;if(t<=I)return String.fromCharCode.apply(String,e);var i="",n=0;for(;n<t;)i+=String.fromCharCode.apply(String,e.slice(n,n+=I));return i}(n)}i.kMaxLength=n,(h.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(h.prototype,"parent",{enumerable:!0,get:function(){if(h.isBuffer(this))return this.buffer}}),Object.defineProperty(h.prototype,"offset",{enumerable:!0,get:function(){if(h.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&h[Symbol.species]===h&&Object.defineProperty(h,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),h.poolSize=8192,h.from=function(e,t,i){return r(e,t,i)},h.prototype.__proto__=Uint8Array.prototype,h.__proto__=Uint8Array,h.alloc=function(e,t,i){return r=t,s=i,o(n=e),n<=0?a(n):void 0!==r?"string"==typeof s?a(n).fill(r,s):a(n).fill(r):a(n);var n,r,s},h.allocUnsafe=function(e){return s(e)},h.allocUnsafeSlow=function(e){return s(e)},h.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==h.prototype},h.compare=function(e,t){if(N(e,Uint8Array)&&(e=h.from(e,e.offset,e.byteLength)),N(t,Uint8Array)&&(t=h.from(t,t.offset,t.byteLength)),!h.isBuffer(e)||!h.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var i=e.length,n=t.length,r=0,s=Math.min(i,n);r<s;++r)if(e[r]!==t[r]){i=e[r],n=t[r];break}return i<n?-1:n<i?1:0},h.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return h.alloc(0);var i;if(void 0===t)for(i=t=0;i<e.length;++i)t+=e[i].length;var n=h.allocUnsafe(t),r=0;for(i=0;i<e.length;++i){var s=e[i];if(N(s,Uint8Array)&&(s=h.from(s)),!h.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,r),r+=s.length}return n},h.byteLength=u,h.prototype._isBuffer=!0,h.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},h.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},h.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},h.prototype.toLocaleString=h.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?b(this,0,e):function(e,t,i){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return C(this,t,i);case"utf8":case"utf-8":return b(this,t,i);case"ascii":return v(this,t,i);case"latin1":case"binary":return A(this,t,i);case"base64":return m(this,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,t,i);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}.apply(this,arguments)},h.prototype.equals=function(e){if(!h.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===h.compare(this,e)},h.prototype.inspect=function(){var e="",t=i.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},h.prototype.compare=function(e,t,i,n,r){if(N(e,Uint8Array)&&(e=h.from(e,e.offset,e.byteLength)),!h.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===i&&(i=e?e.length:0),void 0===n&&(n=0),void 0===r&&(r=this.length),t<0||i>e.length||n<0||r>this.length)throw new RangeError("out of range index");if(r<=n&&i<=t)return 0;if(r<=n)return-1;if(i<=t)return 1;if(this===e)return 0;for(var s=(r>>>=0)-(n>>>=0),a=(i>>>=0)-(t>>>=0),o=Math.min(s,a),c=this.slice(n,r),l=e.slice(t,i),u=0;u<o;++u)if(c[u]!==l[u]){s=c[u],a=l[u];break}return s<a?-1:a<s?1:0},h.prototype.includes=function(e,t,i){return-1!==this.indexOf(e,t,i)},h.prototype.indexOf=function(e,t,i){return d(this,e,t,i,!0)},h.prototype.lastIndexOf=function(e,t,i){return d(this,e,t,i,!1)},h.prototype.write=function(e,t,i,n){if(void 0===t)n="utf8",i=this.length,t=0;else if(void 0===i&&"string"==typeof t)n=t,i=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(i)?(i>>>=0,void 0===n&&(n="utf8")):(n=i,i=void 0)}var r=this.length-t;if((void 0===i||r<i)&&(i=r),0<e.length&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var s,a,o,c,l,u,h,g,d,p=!1;;)switch(n){case"hex":return f(this,e,t,i);case"utf8":case"utf-8":return g=t,d=i,_(k(e,(h=this).length-g),h,g,d);case"ascii":return y(this,e,t,i);case"latin1":case"binary":return y(this,e,t,i);case"base64":return c=this,l=t,u=i,_(P(e),c,l,u);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return a=t,o=i,_(function(e,t){for(var i,n,r,s=[],a=0;a<e.length&&!((t-=2)<0);++a)i=e.charCodeAt(a),n=i>>8,r=i%256,s.push(r),s.push(n);return s}(e,(s=this).length-a),s,a,o);default:if(p)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),p=!0}},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var I=4096;function v(e,t,i){var n="";i=Math.min(e.length,i);for(var r=t;r<i;++r)n+=String.fromCharCode(127&e[r]);return n}function A(e,t,i){var n="";i=Math.min(e.length,i);for(var r=t;r<i;++r)n+=String.fromCharCode(e[r]);return n}function C(e,t,i){var n=e.length;(!t||t<0)&&(t=0),(!i||i<0||n<i)&&(i=n);for(var r="",s=t;s<i;++s)r+=F(e[s]);return r}function S(e,t,i){for(var n=e.slice(t,i),r="",s=0;s<n.length;s+=2)r+=String.fromCharCode(n[s]+256*n[s+1]);return r}function w(e,t,i){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(i<e+t)throw new RangeError("Trying to access beyond buffer length")}function E(e,t,i,n,r,s){if(!h.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(r<t||t<s)throw new RangeError('"value" argument is out of bounds');if(i+n>e.length)throw new RangeError("Index out of range")}function x(e,t,i,n,r,s){if(i+n>e.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function T(e,t,i,n,r){return t=+t,i>>>=0,r||x(e,0,i,4),ieee754.write(e,t,i,n,23,4),i+4}function R(e,t,i,n,r){return t=+t,i>>>=0,r||x(e,0,i,8),ieee754.write(e,t,i,n,52,8),i+8}h.prototype.slice=function(e,t){var i=this.length;(e=~~e)<0?(e+=i)<0&&(e=0):i<e&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):i<t&&(t=i),t<e&&(t=e);var n=this.subarray(e,t);return n.__proto__=h.prototype,n},h.prototype.readUIntLE=function(e,t,i){e>>>=0,t>>>=0,i||w(e,t,this.length);for(var n=this[e],r=1,s=0;++s<t&&(r*=256);)n+=this[e+s]*r;return n},h.prototype.readUIntBE=function(e,t,i){e>>>=0,t>>>=0,i||w(e,t,this.length);for(var n=this[e+--t],r=1;0<t&&(r*=256);)n+=this[e+--t]*r;return n},h.prototype.readUInt8=function(e,t){return e>>>=0,t||w(e,1,this.length),this[e]},h.prototype.readUInt16LE=function(e,t){return e>>>=0,t||w(e,2,this.length),this[e]|this[e+1]<<8},h.prototype.readUInt16BE=function(e,t){return e>>>=0,t||w(e,2,this.length),this[e]<<8|this[e+1]},h.prototype.readUInt32LE=function(e,t){return e>>>=0,t||w(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},h.prototype.readUInt32BE=function(e,t){return e>>>=0,t||w(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},h.prototype.readIntLE=function(e,t,i){e>>>=0,t>>>=0,i||w(e,t,this.length);for(var n=this[e],r=1,s=0;++s<t&&(r*=256);)n+=this[e+s]*r;return(r*=128)<=n&&(n-=Math.pow(2,8*t)),n},h.prototype.readIntBE=function(e,t,i){e>>>=0,t>>>=0,i||w(e,t,this.length);for(var n=t,r=1,s=this[e+--n];0<n&&(r*=256);)s+=this[e+--n]*r;return(r*=128)<=s&&(s-=Math.pow(2,8*t)),s},h.prototype.readInt8=function(e,t){return e>>>=0,t||w(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},h.prototype.readInt16LE=function(e,t){e>>>=0,t||w(e,2,this.length);var i=this[e]|this[e+1]<<8;return 32768&i?4294901760|i:i},h.prototype.readInt16BE=function(e,t){e>>>=0,t||w(e,2,this.length);var i=this[e+1]|this[e]<<8;return 32768&i?4294901760|i:i},h.prototype.readInt32LE=function(e,t){return e>>>=0,t||w(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},h.prototype.readInt32BE=function(e,t){return e>>>=0,t||w(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},h.prototype.readFloatLE=function(e,t){return e>>>=0,t||w(e,4,this.length),ieee754.read(this,e,!0,23,4)},h.prototype.readFloatBE=function(e,t){return e>>>=0,t||w(e,4,this.length),ieee754.read(this,e,!1,23,4)},h.prototype.readDoubleLE=function(e,t){return e>>>=0,t||w(e,8,this.length),ieee754.read(this,e,!0,52,8)},h.prototype.readDoubleBE=function(e,t){return e>>>=0,t||w(e,8,this.length),ieee754.read(this,e,!1,52,8)},h.prototype.writeUIntLE=function(e,t,i,n){(e=+e,t>>>=0,i>>>=0,n)||E(this,e,t,i,Math.pow(2,8*i)-1,0);var r=1,s=0;for(this[t]=255&e;++s<i&&(r*=256);)this[t+s]=e/r&255;return t+i},h.prototype.writeUIntBE=function(e,t,i,n){(e=+e,t>>>=0,i>>>=0,n)||E(this,e,t,i,Math.pow(2,8*i)-1,0);var r=i-1,s=1;for(this[t+r]=255&e;0<=--r&&(s*=256);)this[t+r]=e/s&255;return t+i},h.prototype.writeUInt8=function(e,t,i){return e=+e,t>>>=0,i||E(this,e,t,1,255,0),this[t]=255&e,t+1},h.prototype.writeUInt16LE=function(e,t,i){return e=+e,t>>>=0,i||E(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},h.prototype.writeUInt16BE=function(e,t,i){return e=+e,t>>>=0,i||E(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},h.prototype.writeUInt32LE=function(e,t,i){return e=+e,t>>>=0,i||E(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},h.prototype.writeUInt32BE=function(e,t,i){return e=+e,t>>>=0,i||E(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},h.prototype.writeIntLE=function(e,t,i,n){if(e=+e,t>>>=0,!n){var r=Math.pow(2,8*i-1);E(this,e,t,i,r-1,-r)}var s=0,a=1,o=0;for(this[t]=255&e;++s<i&&(a*=256);)e<0&&0===o&&0!==this[t+s-1]&&(o=1),this[t+s]=(e/a>>0)-o&255;return t+i},h.prototype.writeIntBE=function(e,t,i,n){if(e=+e,t>>>=0,!n){var r=Math.pow(2,8*i-1);E(this,e,t,i,r-1,-r)}var s=i-1,a=1,o=0;for(this[t+s]=255&e;0<=--s&&(a*=256);)e<0&&0===o&&0!==this[t+s+1]&&(o=1),this[t+s]=(e/a>>0)-o&255;return t+i},h.prototype.writeInt8=function(e,t,i){return e=+e,t>>>=0,i||E(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},h.prototype.writeInt16LE=function(e,t,i){return e=+e,t>>>=0,i||E(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},h.prototype.writeInt16BE=function(e,t,i){return e=+e,t>>>=0,i||E(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},h.prototype.writeInt32LE=function(e,t,i){return e=+e,t>>>=0,i||E(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},h.prototype.writeInt32BE=function(e,t,i){return e=+e,t>>>=0,i||E(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},h.prototype.writeFloatLE=function(e,t,i){return T(this,e,t,!0,i)},h.prototype.writeFloatBE=function(e,t,i){return T(this,e,t,!1,i)},h.prototype.writeDoubleLE=function(e,t,i){return R(this,e,t,!0,i)},h.prototype.writeDoubleBE=function(e,t,i){return R(this,e,t,!1,i)},h.prototype.copy=function(e,t,i,n){if(!h.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i||(i=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),0<n&&n<i&&(n=i),n===i)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-i&&(n=e.length-t+i);var r=n-i;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,i,n);else if(this===e&&i<t&&t<n)for(var s=r-1;0<=s;--s)e[s+t]=this[s+i];else Uint8Array.prototype.set.call(e,this.subarray(i,n),t);return r},h.prototype.fill=function(e,t,i,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,i=this.length):"string"==typeof i&&(n=i,i=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!h.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){var r=e.charCodeAt(0);("utf8"===n&&r<128||"latin1"===n)&&(e=r)}}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;var s;if(t>>>=0,i=void 0===i?this.length:i>>>0,e||(e=0),"number"==typeof e)for(s=t;s<i;++s)this[s]=e;else{var a=h.isBuffer(e)?e:h.from(e,n),o=a.length;if(0===o)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<i-t;++s)this[s+t]=a[s%o]}return this};var t=/[^+/0-9A-Za-z-_]/g;function F(e){return e<16?"0"+e.toString(16):e.toString(16)}function k(e,t){var i;t=t||1/0;for(var n=e.length,r=null,s=[],a=0;a<n;++a){if(55295<(i=e.charCodeAt(a))&&i<57344){if(!r){if(56319<i){-1<(t-=3)&&s.push(239,191,189);continue}if(a+1===n){-1<(t-=3)&&s.push(239,191,189);continue}r=i;continue}if(i<56320){-1<(t-=3)&&s.push(239,191,189),r=i;continue}i=65536+(r-55296<<10|i-56320)}else r&&-1<(t-=3)&&s.push(239,191,189);if(r=null,i<128){if((t-=1)<0)break;s.push(i)}else if(i<2048){if((t-=2)<0)break;s.push(i>>6|192,63&i|128)}else if(i<65536){if((t-=3)<0)break;s.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return s}function P(e){return base64Js.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(t,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function _(e,t,i,n){for(var r=0;r<n&&!(r+i>=t.length||r>=e.length);++r)t[r+i]=e[r];return r}function N(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function B(e){return e!=e}}),buffer_1=buffer.Buffer,buffer_2=buffer.SlowBuffer,buffer_3=buffer.INSPECT_MAX_BYTES,buffer_4=buffer.kMaxLength,navigator$1={userAgent:!1},window$1={};if(void 0===YAHOO)var YAHOO={};YAHOO.lang={extend:function(e,t,i){if(!t||!e)throw new Error("YAHOO.lang.extend failed, please check that all dependencies are included.");var n=function(){};if(n.prototype=t.prototype,e.prototype=new n,(e.prototype.constructor=e).superclass=t.prototype,t.prototype.constructor==Object.prototype.constructor&&(t.prototype.constructor=t),i){var r;for(r in i)e.prototype[r]=i[r];var s=function(){},a=["toString","valueOf"];try{/MSIE/.test(navigator$1.userAgent)&&(s=function(e,t){for(r=0;r<a.length;r+=1){var i=a[r],n=t[i];"function"==typeof n&&n!=Object.prototype[i]&&(e[i]=n)}})}catch(e){}s(e.prototype,i)}}};var CryptoJS=CryptoJS||(u6=Math,w6={},x6=w6.lib={},y6=x6.Base=function(){function i(){}return{extend:function(e){i.prototype=this;var t=new i;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),(t.init.prototype=t).$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),z6=x6.WordArray=y6.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||B6).stringify(this)},concat:function(e){var t=this.words,i=e.words,n=this.sigBytes,r=e.sigBytes;if(this.clamp(),n%4)for(var s=0;s<r;s++){var a=i[s>>>2]>>>24-s%4*8&255;t[n+s>>>2]|=a<<24-(n+s)%4*8}else for(s=0;s<r;s+=4)t[n+s>>>2]=i[s>>>2];return this.sigBytes+=r,this},clamp:function(){var e=this.words,t=this.sigBytes;e[t>>>2]&=4294967295<<32-t%4*8,e.length=u6.ceil(t/4)},clone:function(){var e=y6.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],i=0;i<e;i+=4)t.push(4294967296*u6.random()|0);return new z6.init(t,e)}}),A6=w6.enc={},B6=A6.Hex={stringify:function(e){for(var t=e.words,i=e.sigBytes,n=[],r=0;r<i;r++){var s=t[r>>>2]>>>24-r%4*8&255;n.push((s>>>4).toString(16)),n.push((15&s).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,i=[],n=0;n<t;n+=2)i[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new z6.init(i,t/2)}},C6=A6.Latin1={stringify:function(e){for(var t=e.words,i=e.sigBytes,n=[],r=0;r<i;r++){var s=t[r>>>2]>>>24-r%4*8&255;n.push(String.fromCharCode(s))}return n.join("")},parse:function(e){for(var t=e.length,i=[],n=0;n<t;n++)i[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new z6.init(i,t)}},D6=A6.Utf8={stringify:function(e){try{return decodeURIComponent(escape(C6.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return C6.parse(unescape(encodeURIComponent(e)))}},E6=x6.BufferedBlockAlgorithm=y6.extend({reset:function(){this._data=new z6.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=D6.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(e){var t=this._data,i=t.words,n=t.sigBytes,r=this.blockSize,s=n/(4*r),a=(s=e?u6.ceil(s):u6.max((0|s)-this._minBufferSize,0))*r,o=u6.min(4*a,n);if(a){for(var c=0;c<a;c+=r)this._doProcessBlock(i,c);var l=i.splice(0,a);t.sigBytes-=o}return new z6.init(l,o)},clone:function(){var e=y6.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),x6.Hasher=E6.extend({cfg:y6.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){E6.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(i){return function(e,t){return new i.init(t).finalize(e)}},_createHmacHelper:function(i){return function(e,t){return new G6.HMAC.init(i,t).finalize(e)}}}),G6=w6.algo={},w6),u6,w6,x6,y6,z6,A6,B6,C6,D6,E6,G6,W7,X7,Y7,Z7,Mba,Nba,pda,rda,sda,tda,qda,pea,qea,sea,rea,Jfa,Lfa,Mfa,Nfa,Kfa,xga,yga,Nga,Mga,Oga,Pga,Qga,Rga;X7=(W7=CryptoJS).lib,Y7=X7.Base,Z7=X7.WordArray,(W7=W7.x64={}).Word=Y7.extend({init:function(e,t){this.high=e,this.low=t}}),W7.WordArray=Y7.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,i=[],n=0;n<t;n++){var r=e[n];i.push(r.high),i.push(r.low)}return Z7.create(i,this.sigBytes)},clone:function(){for(var e=Y7.clone.call(this),t=e.words=this.words.slice(0),i=t.length,n=0;n<i;n++)t[n]=t[n].clone();return e}}),CryptoJS.lib.Cipher||function(e){var t=(d=CryptoJS).lib,i=t.Base,a=t.WordArray,n=t.BufferedBlockAlgorithm,r=d.enc.Base64,s=d.algo.EvpKDF,o=t.Cipher=n.extend({cfg:i.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,i){this.cfg=this.cfg.extend(i),this._xformMode=e,this._key=t,this.reset()},reset:function(){n.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(n){return{encrypt:function(e,t,i){return("string"==typeof t?p:g).encrypt(n,e,t,i)},decrypt:function(e,t,i){return("string"==typeof t?p:g).decrypt(n,e,t,i)}}}});t.StreamCipher=o.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var c=d.mode={},l=function(e,t,i){var n=this._iv;n?this._iv=void 0:n=this._prevBlock;for(var r=0;r<i;r++)e[t+r]^=n[r]},u=(t.BlockCipherMode=i.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();u.Encryptor=u.extend({processBlock:function(e,t){var i=this._cipher,n=i.blockSize;l.call(this,e,t,n),i.encryptBlock(e,t),this._prevBlock=e.slice(t,t+n)}}),u.Decryptor=u.extend({processBlock:function(e,t){var i=this._cipher,n=i.blockSize,r=e.slice(t,t+n);i.decryptBlock(e,t),l.call(this,e,t,n),this._prevBlock=r}}),c=c.CBC=u,u=(d.pad={}).Pkcs7={pad:function(e,t){for(var i,n=(i=(i=4*t)-e.sigBytes%i)<<24|i<<16|i<<8|i,r=[],s=0;s<i;s+=4)r.push(n);i=a.create(r,i),e.concat(i)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},t.BlockCipher=o.extend({cfg:o.cfg.extend({mode:c,padding:u}),reset:function(){o.reset.call(this);var e=(t=this.cfg).iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var i=t.createEncryptor;else i=t.createDecryptor,this._minBufferSize=1;this._mode=i.call(t,this,e&&e.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var h=t.CipherParams=i.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),g=(c=(d.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return((e=e.salt)?a.create([1398893684,1701076831]).concat(e).concat(t):t).toString(r)},parse:function(e){var t=(e=r.parse(e)).words;if(1398893684==t[0]&&1701076831==t[1]){var i=a.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return h.create({ciphertext:e,salt:i})}},t.SerializableCipher=i.extend({cfg:i.extend({format:c}),encrypt:function(e,t,i,n){n=this.cfg.extend(n);var r=e.createEncryptor(i,n);return t=r.finalize(t),r=r.cfg,h.create({ciphertext:t,key:i,iv:r.iv,algorithm:e,mode:r.mode,padding:r.padding,blockSize:e.blockSize,formatter:n.format})},decrypt:function(e,t,i,n){return n=this.cfg.extend(n),t=this._parse(t,n.format),e.createDecryptor(i,n).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}})),d=(d.kdf={}).OpenSSL={execute:function(e,t,i,n){return n||(n=a.random(8)),e=s.create({keySize:t+i}).compute(e,n),i=a.create(e.words.slice(t),4*i),e.sigBytes=4*t,h.create({key:e,iv:i,salt:n})}},p=t.PasswordBasedCipher=g.extend({cfg:g.cfg.extend({kdf:d}),encrypt:function(e,t,i,n){return i=(n=this.cfg.extend(n)).kdf.execute(i,e.keySize,e.ivSize),n.iv=i.iv,(e=g.encrypt.call(this,e,t,i.key,n)).mixIn(i),e},decrypt:function(e,t,i,n){return n=this.cfg.extend(n),t=this._parse(t,n.format),i=n.kdf.execute(i,e.keySize,e.ivSize,t.salt),n.iv=i.iv,g.decrypt.call(this,e,t,i.key,n)}})}(),function(){for(var e=CryptoJS,t=e.lib.BlockCipher,i=e.algo,a=[],n=[],r=[],s=[],o=[],c=[],l=[],u=[],h=[],g=[],d=[],p=0;p<256;p++)d[p]=p<128?p<<1:p<<1^283;var f=0,y=0;for(p=0;p<256;p++){var m=(m=y^y<<1^y<<2^y<<3^y<<4)>>>8^255&m^99;a[f]=m;var b=d[n[m]=f],I=d[b],v=d[I],A=257*d[m]^16843008*m;r[f]=A<<24|A>>>8,s[f]=A<<16|A>>>16,o[f]=A<<8|A>>>24,c[f]=A,A=16843009*v^65537*I^257*b^16843008*f,l[m]=A<<24|A>>>8,u[m]=A<<16|A>>>16,h[m]=A<<8|A>>>24,g[m]=A,f?(f=b^d[d[d[v^b]]],y^=d[d[y]]):f=y=1}var C=[0,1,2,4,8,16,32,64,128,27,54];i=i.AES=t.extend({_doReset:function(){for(var e=(i=this._key).words,t=i.sigBytes/4,i=4*((this._nRounds=t+6)+1),n=this._keySchedule=[],r=0;r<i;r++)if(r<t)n[r]=e[r];else{var s=n[r-1];r%t?6<t&&4==r%t&&(s=a[s>>>24]<<24|a[s>>>16&255]<<16|a[s>>>8&255]<<8|a[255&s]):(s=a[(s=s<<8|s>>>24)>>>24]<<24|a[s>>>16&255]<<16|a[s>>>8&255]<<8|a[255&s],s^=C[r/t|0]<<24),n[r]=n[r-t]^s}for(e=this._invKeySchedule=[],t=0;t<i;t++)r=i-t,s=t%4?n[r]:n[r-4],e[t]=t<4||r<=4?s:l[a[s>>>24]]^u[a[s>>>16&255]]^h[a[s>>>8&255]]^g[a[255&s]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,r,s,o,c,a)},decryptBlock:function(e,t){var i=e[t+1];e[t+1]=e[t+3],e[t+3]=i,this._doCryptBlock(e,t,this._invKeySchedule,l,u,h,g,n),i=e[t+1],e[t+1]=e[t+3],e[t+3]=i},_doCryptBlock:function(e,t,i,n,r,s,a,o){for(var c=this._nRounds,l=e[t]^i[0],u=e[t+1]^i[1],h=e[t+2]^i[2],g=e[t+3]^i[3],d=4,p=1;p<c;p++){var f=n[l>>>24]^r[u>>>16&255]^s[h>>>8&255]^a[255&g]^i[d++],y=n[u>>>24]^r[h>>>16&255]^s[g>>>8&255]^a[255&l]^i[d++],m=n[h>>>24]^r[g>>>16&255]^s[l>>>8&255]^a[255&u]^i[d++];g=n[g>>>24]^r[l>>>16&255]^s[u>>>8&255]^a[255&h]^i[d++],l=f,u=y,h=m}f=(o[l>>>24]<<24|o[u>>>16&255]<<16|o[h>>>8&255]<<8|o[255&g])^i[d++],y=(o[u>>>24]<<24|o[h>>>16&255]<<16|o[g>>>8&255]<<8|o[255&l])^i[d++],m=(o[h>>>24]<<24|o[g>>>16&255]<<16|o[l>>>8&255]<<8|o[255&u])^i[d++],g=(o[g>>>24]<<24|o[l>>>16&255]<<16|o[u>>>8&255]<<8|o[255&h])^i[d++],e[t]=f,e[t+1]=y,e[t+2]=m,e[t+3]=g},keySize:8});e.AES=t._createHelper(i)}(),function(){function l(e,t){var i=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=i,this._lBlock^=i<<e}function u(e,t){var i=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=i,this._rBlock^=i<<e}var e=CryptoJS,t=(i=e.lib).WordArray,i=i.BlockCipher,n=e.algo,a=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],o=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],c=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],h=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],g=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],r=n.DES=i.extend({_doReset:function(){for(var e=this._key.words,t=[],i=0;i<56;i++){var n=a[i]-1;t[i]=e[n>>>5]>>>31-n%32&1}for(e=this._subKeys=[],n=0;n<16;n++){var r=e[n]=[],s=c[n];for(i=0;i<24;i++)r[i/6|0]|=t[(o[i]-1+s)%28]<<31-i%6,r[4+(i/6|0)]|=t[28+(o[i+24]-1+s)%28]<<31-i%6;for(r[0]=r[0]<<1|r[0]>>>31,i=1;i<7;i++)r[i]>>>=4*(i-1)+3;r[7]=r[7]<<5|r[7]>>>27}for(t=this._invSubKeys=[],i=0;i<16;i++)t[i]=e[15-i]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,i){this._lBlock=e[t],this._rBlock=e[t+1],l.call(this,4,252645135),l.call(this,16,65535),u.call(this,2,858993459),u.call(this,8,16711935),l.call(this,1,1431655765);for(var n=0;n<16;n++){for(var r=i[n],s=this._lBlock,a=this._rBlock,o=0,c=0;c<8;c++)o|=h[c][((a^r[c])&g[c])>>>0];this._lBlock=a,this._rBlock=s^o}i=this._lBlock,this._lBlock=this._rBlock,this._rBlock=i,l.call(this,1,1431655765),u.call(this,8,16711935),u.call(this,2,858993459),l.call(this,16,65535),l.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});e.DES=i._createHelper(r),n=n.TripleDES=i.extend({_doReset:function(){var e=this._key.words;this._des1=r.createEncryptor(t.create(e.slice(0,2))),this._des2=r.createEncryptor(t.create(e.slice(2,4))),this._des3=r.createEncryptor(t.create(e.slice(4,6)))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2}),e.TripleDES=i._createHelper(n)}(),Mba=CryptoJS,Nba=Mba.lib.WordArray,Mba.enc.Base64={stringify:function(e){var t=e.words,i=e.sigBytes,n=this._map;e.clamp(),e=[];for(var r=0;r<i;r+=3)for(var s=(t[r>>>2]>>>24-r%4*8&255)<<16|(t[r+1>>>2]>>>24-(r+1)%4*8&255)<<8|t[r+2>>>2]>>>24-(r+2)%4*8&255,a=0;a<4&&r+.75*a<i;a++)e.push(n.charAt(s>>>6*(3-a)&63));if(t=n.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var t=e.length,i=this._map;(n=i.charAt(64))&&-1!=(n=e.indexOf(n))&&(t=n);for(var n=[],r=0,s=0;s<t;s++)if(s%4){var a=i.indexOf(e.charAt(s-1))<<s%4*2,o=i.indexOf(e.charAt(s))>>>6-s%4*2;n[r>>>2]|=(a|o)<<24-r%4*8,r++}return Nba.create(n,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},function(s){function S(e,t,i,n,r,s,a){return((e=e+(t&i|~t&n)+r+a)<<s|e>>>32-s)+t}function w(e,t,i,n,r,s,a){return((e=e+(t&n|i&~n)+r+a)<<s|e>>>32-s)+t}function E(e,t,i,n,r,s,a){return((e=e+(t^i^n)+r+a)<<s|e>>>32-s)+t}function x(e,t,i,n,r,s,a){return((e=e+(i^(t|~n))+r+a)<<s|e>>>32-s)+t}for(var e=CryptoJS,t=(n=e.lib).WordArray,i=n.Hasher,n=e.algo,T=[],r=0;r<64;r++)T[r]=4294967296*s.abs(s.sin(r+1))|0;n=n.MD5=i.extend({_doReset:function(){this._hash=new t.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var i=0;i<16;i++){var n=e[a=t+i];e[a]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8)}i=this._hash.words;var r,s,a=e[t+0],o=(n=e[t+1],e[t+2]),c=e[t+3],l=e[t+4],u=e[t+5],h=e[t+6],g=e[t+7],d=e[t+8],p=e[t+9],f=e[t+10],y=e[t+11],m=e[t+12],b=e[t+13],I=e[t+14],v=e[t+15],A=i[0],C=x(C=x(C=x(C=x(C=E(C=E(C=E(C=E(C=w(C=w(C=w(C=w(C=S(C=S(C=S(C=S(C=i[1],s=S(s=i[2],r=S(r=i[3],A=S(A,C,s,r,a,7,T[0]),C,s,n,12,T[1]),A,C,o,17,T[2]),r,A,c,22,T[3]),s=S(s,r=S(r,A=S(A,C,s,r,l,7,T[4]),C,s,u,12,T[5]),A,C,h,17,T[6]),r,A,g,22,T[7]),s=S(s,r=S(r,A=S(A,C,s,r,d,7,T[8]),C,s,p,12,T[9]),A,C,f,17,T[10]),r,A,y,22,T[11]),s=S(s,r=S(r,A=S(A,C,s,r,m,7,T[12]),C,s,b,12,T[13]),A,C,I,17,T[14]),r,A,v,22,T[15]),s=w(s,r=w(r,A=w(A,C,s,r,n,5,T[16]),C,s,h,9,T[17]),A,C,y,14,T[18]),r,A,a,20,T[19]),s=w(s,r=w(r,A=w(A,C,s,r,u,5,T[20]),C,s,f,9,T[21]),A,C,v,14,T[22]),r,A,l,20,T[23]),s=w(s,r=w(r,A=w(A,C,s,r,p,5,T[24]),C,s,I,9,T[25]),A,C,c,14,T[26]),r,A,d,20,T[27]),s=w(s,r=w(r,A=w(A,C,s,r,b,5,T[28]),C,s,o,9,T[29]),A,C,g,14,T[30]),r,A,m,20,T[31]),s=E(s,r=E(r,A=E(A,C,s,r,u,4,T[32]),C,s,d,11,T[33]),A,C,y,16,T[34]),r,A,I,23,T[35]),s=E(s,r=E(r,A=E(A,C,s,r,n,4,T[36]),C,s,l,11,T[37]),A,C,g,16,T[38]),r,A,f,23,T[39]),s=E(s,r=E(r,A=E(A,C,s,r,b,4,T[40]),C,s,a,11,T[41]),A,C,c,16,T[42]),r,A,h,23,T[43]),s=E(s,r=E(r,A=E(A,C,s,r,p,4,T[44]),C,s,m,11,T[45]),A,C,v,16,T[46]),r,A,o,23,T[47]),s=x(s,r=x(r,A=x(A,C,s,r,a,6,T[48]),C,s,g,10,T[49]),A,C,I,15,T[50]),r,A,u,21,T[51]),s=x(s,r=x(r,A=x(A,C,s,r,m,6,T[52]),C,s,c,10,T[53]),A,C,f,15,T[54]),r,A,n,21,T[55]),s=x(s,r=x(r,A=x(A,C,s,r,d,6,T[56]),C,s,v,10,T[57]),A,C,h,15,T[58]),r,A,b,21,T[59]),s=x(s,r=x(r,A=x(A,C,s,r,l,6,T[60]),C,s,y,10,T[61]),A,C,o,15,T[62]),r,A,p,21,T[63]);i[0]=i[0]+A|0,i[1]=i[1]+C|0,i[2]=i[2]+s|0,i[3]=i[3]+r|0},_doFinalize:function(){var e=this._data,t=e.words,i=8*this._nDataBytes,n=8*e.sigBytes;t[n>>>5]|=128<<24-n%32;var r=s.floor(i/4294967296);for(t[15+(n+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t[14+(n+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),e.sigBytes=4*(t.length+1),this._process(),t=(e=this._hash).words,i=0;i<4;i++)n=t[i],t[i]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8);return e},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}}),e.MD5=i._createHelper(n),e.HmacMD5=i._createHmacHelper(n)}(Math),pda=CryptoJS,rda=(qda=pda.lib).WordArray,sda=qda.Hasher,tda=[],qda=pda.algo.SHA1=sda.extend({_doReset:function(){this._hash=new rda.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var i=this._hash.words,n=i[0],r=i[1],s=i[2],a=i[3],o=i[4],c=0;c<80;c++){if(c<16)tda[c]=0|e[t+c];else{var l=tda[c-3]^tda[c-8]^tda[c-14]^tda[c-16];tda[c]=l<<1|l>>>31}l=(n<<5|n>>>27)+o+tda[c],l=c<20?l+(1518500249+(r&s|~r&a)):c<40?l+(1859775393+(r^s^a)):c<60?l+((r&s|r&a|s&a)-1894007588):l+((r^s^a)-899497514),o=a,a=s,s=r<<30|r>>>2,r=n,n=l}i[0]=i[0]+n|0,i[1]=i[1]+r|0,i[2]=i[2]+s|0,i[3]=i[3]+a|0,i[4]=i[4]+o|0},_doFinalize:function(){var e=this._data,t=e.words,i=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[14+(n+64>>>9<<4)]=Math.floor(i/4294967296),t[15+(n+64>>>9<<4)]=i,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=sda.clone.call(this);return e._hash=this._hash.clone(),e}}),pda.SHA1=sda._createHelper(qda),pda.HmacSHA1=sda._createHmacHelper(qda),function(r){for(var e=CryptoJS,t=(n=e.lib).WordArray,i=n.Hasher,n=e.algo,s=[],p=[],a=function(e){return 4294967296*(e-(0|e))|0},o=2,c=0;c<64;){var l;e:{l=o;for(var u=r.sqrt(l),h=2;h<=u;h++)if(!(l%h)){l=!1;break e}l=!0}l&&(c<8&&(s[c]=a(r.pow(o,.5))),p[c]=a(r.pow(o,1/3)),c++),o++}var f=[];n=n.SHA256=i.extend({_doReset:function(){this._hash=new t.init(s.slice(0))},_doProcessBlock:function(e,t){for(var i=this._hash.words,n=i[0],r=i[1],s=i[2],a=i[3],o=i[4],c=i[5],l=i[6],u=i[7],h=0;h<64;h++){if(h<16)f[h]=0|e[t+h];else{var g=f[h-15],d=f[h-2];f[h]=((g<<25|g>>>7)^(g<<14|g>>>18)^g>>>3)+f[h-7]+((d<<15|d>>>17)^(d<<13|d>>>19)^d>>>10)+f[h-16]}g=u+((o<<26|o>>>6)^(o<<21|o>>>11)^(o<<7|o>>>25))+(o&c^~o&l)+p[h]+f[h],d=((n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22))+(n&r^n&s^r&s),u=l,l=c,c=o,o=a+g|0,a=s,s=r,r=n,n=g+d|0}i[0]=i[0]+n|0,i[1]=i[1]+r|0,i[2]=i[2]+s|0,i[3]=i[3]+a|0,i[4]=i[4]+o|0,i[5]=i[5]+c|0,i[6]=i[6]+l|0,i[7]=i[7]+u|0},_doFinalize:function(){var e=this._data,t=e.words,i=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[14+(n+64>>>9<<4)]=r.floor(i/4294967296),t[15+(n+64>>>9<<4)]=i,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});e.SHA256=i._createHelper(n),e.HmacSHA256=i._createHmacHelper(n)}(Math),pea=CryptoJS,qea=pea.lib.WordArray,sea=(rea=pea.algo).SHA256,rea=rea.SHA224=sea.extend({_doReset:function(){this._hash=new qea.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=sea._doFinalize.call(this);return e.sigBytes-=4,e}}),pea.SHA224=sea._createHelper(rea),pea.HmacSHA224=sea._createHmacHelper(rea),function(){function e(){return n.create.apply(n,arguments)}for(var t=CryptoJS,i=t.lib.Hasher,n=(s=t.x64).Word,r=s.WordArray,s=t.algo,te=[e(1116352408,3609767458),e(1899447441,602891725),e(3049323471,3964484399),e(3921009573,2173295548),e(961987163,4081628472),e(1508970993,3053834265),e(2453635748,2937671579),e(2870763221,3664609560),e(3624381080,2734883394),e(310598401,1164996542),e(607225278,1323610764),e(1426881987,3590304994),e(1925078388,4068182383),e(2162078206,991336113),e(2614888103,633803317),e(3248222580,3479774868),e(3835390401,2666613458),e(4022224774,944711139),e(264347078,2341262773),e(604807628,2007800933),e(770255983,1495990901),e(1249150122,1856431235),e(1555081692,3175218132),e(1996064986,2198950837),e(2554220882,3999719339),e(2821834349,766784016),e(2952996808,2566594879),e(3210313671,3203337956),e(3336571891,1034457026),e(3584528711,2466948901),e(113926993,3758326383),e(338241895,168717936),e(666307205,1188179964),e(773529912,1546045734),e(1294757372,1522805485),e(1396182291,2643833823),e(1695183700,2343527390),e(1986661051,1014477480),e(2177026350,1206759142),e(2456956037,344077627),e(2730485921,1290863460),e(2820302411,3158454273),e(3259730800,3505952657),e(3345764771,106217008),e(3516065817,3606008344),e(3600352804,1432725776),e(4094571909,1467031594),e(275423344,851169720),e(430227734,3100823752),e(506948616,1363258195),e(659060556,3750685593),e(883997877,3785050280),e(958139571,3318307427),e(1322822218,3812723403),e(1537002063,2003034995),e(1747873779,3602036899),e(1955562222,1575990012),e(2024104815,1125592928),e(2227730452,2716904306),e(2361852424,442776044),e(2428436474,593698344),e(2756734187,3733110249),e(3204031479,2999351573),e(3329325298,3815920427),e(3391569614,3928383900),e(3515267271,566280711),e(3940187606,3454069534),e(4118630271,4000239992),e(116418474,1914138554),e(174292421,2731055270),e(289380356,3203993006),e(460393269,320620315),e(685471733,587496836),e(852142971,1086792851),e(1017036298,365543100),e(1126000580,2618297676),e(1288033470,3409855158),e(1501505948,4234509866),e(1607167915,987167468),e(1816402316,1246189591)],ie=[],a=0;a<80;a++)ie[a]=e();s=s.SHA512=i.extend({_doReset:function(){this._hash=new r.init([new n.init(1779033703,4089235720),new n.init(3144134277,2227873595),new n.init(1013904242,4271175723),new n.init(2773480762,1595750129),new n.init(1359893119,2917565137),new n.init(2600822924,725511199),new n.init(528734635,4215389547),new n.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var i=(l=this._hash.words)[0],n=l[1],r=l[2],s=l[3],a=l[4],o=l[5],c=l[6],l=l[7],u=i.high,h=i.low,g=n.high,d=n.low,p=r.high,f=r.low,y=s.high,m=s.low,b=a.high,I=a.low,v=o.high,A=o.low,C=c.high,S=c.low,w=l.high,E=l.low,x=u,T=h,R=g,F=d,k=p,P=f,_=y,N=m,B=b,D=I,U=v,O=A,V=C,J=S,H=w,W=E,j=0;j<80;j++){var L=ie[j];if(j<16)var M=L.high=0|e[t+2*j],K=L.low=0|e[t+2*j+1];else{M=((K=(M=ie[j-15]).high)>>>1|(Z=M.low)<<31)^(K>>>8|Z<<24)^K>>>7;var Z=(Z>>>1|K<<31)^(Z>>>8|K<<24)^(Z>>>7|K<<25),G=((K=(G=ie[j-2]).high)>>>19|(Y=G.low)<<13)^(K<<3|Y>>>29)^K>>>6,Y=(Y>>>19|K<<13)^(Y<<3|K>>>29)^(Y>>>6|K<<26),X=(K=ie[j-7]).high,z=(q=ie[j-16]).high,q=q.low;M=(M=(M=M+X+((K=Z+K.low)>>>0<Z>>>0?1:0))+G+((K=K+Y)>>>0<Y>>>0?1:0))+z+((K=K+q)>>>0<q>>>0?1:0);L.high=M,L.low=K}X=B&U^~B&V,q=D&O^~D&J,L=x&R^x&k^R&k;var $=T&F^T&P^F&P,Q=(Z=(x>>>28|T<<4)^(x<<30|T>>>2)^(x<<25|T>>>7),G=(T>>>28|x<<4)^(T<<30|x>>>2)^(T<<25|x>>>7),(Y=te[j]).high),ee=Y.low;z=H+((B>>>14|D<<18)^(B>>>18|D<<14)^(B<<23|D>>>9))+((Y=W+((D>>>14|B<<18)^(D>>>18|B<<14)^(D<<23|B>>>9)))>>>0<W>>>0?1:0),H=V,W=J,V=U,J=O,U=B,O=D,B=_+(z=(z=(z=z+X+((Y=Y+q)>>>0<q>>>0?1:0))+Q+((Y=Y+ee)>>>0<ee>>>0?1:0))+M+((Y=Y+K)>>>0<K>>>0?1:0))+((D=N+Y|0)>>>0<N>>>0?1:0)|0,_=k,N=P,k=R,P=F,R=x,F=T,x=z+(L=Z+L+((K=G+$)>>>0<G>>>0?1:0))+((T=Y+K|0)>>>0<Y>>>0?1:0)|0}h=i.low=h+T,i.high=u+x+(h>>>0<T>>>0?1:0),d=n.low=d+F,n.high=g+R+(d>>>0<F>>>0?1:0),f=r.low=f+P,r.high=p+k+(f>>>0<P>>>0?1:0),m=s.low=m+N,s.high=y+_+(m>>>0<N>>>0?1:0),I=a.low=I+D,a.high=b+B+(I>>>0<D>>>0?1:0),A=o.low=A+O,o.high=v+U+(A>>>0<O>>>0?1:0),S=c.low=S+J,c.high=C+V+(S>>>0<J>>>0?1:0),E=l.low=E+W,l.high=w+H+(E>>>0<W>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,i=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[30+(n+128>>>10<<5)]=Math.floor(i/4294967296),t[31+(n+128>>>10<<5)]=i,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32}),t.SHA512=i._createHelper(s),t.HmacSHA512=i._createHmacHelper(s)}(),Jfa=CryptoJS,Lfa=(Kfa=Jfa.x64).Word,Mfa=Kfa.WordArray,Nfa=(Kfa=Jfa.algo).SHA512,Kfa=Kfa.SHA384=Nfa.extend({_doReset:function(){this._hash=new Mfa.init([new Lfa.init(3418070365,3238371032),new Lfa.init(1654270250,914150663),new Lfa.init(2438529370,812702999),new Lfa.init(355462360,4144912697),new Lfa.init(1731405415,4290775857),new Lfa.init(2394180231,1750603025),new Lfa.init(3675008525,1694076839),new Lfa.init(1203062813,3204075428)])},_doFinalize:function(){var e=Nfa._doFinalize.call(this);return e.sigBytes-=16,e}}),Jfa.SHA384=Nfa._createHelper(Kfa),Jfa.HmacSHA384=Nfa._createHmacHelper(Kfa),function(){var e=CryptoJS,t=(n=e.lib).WordArray,i=n.Hasher,n=e.algo,A=t.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),C=t.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),S=t.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),w=t.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),E=t.create([0,1518500249,1859775393,2400959708,2840853838]),x=t.create([1352829926,1548603684,1836072691,2053994217,0]);n=n.RIPEMD160=i.extend({_doReset:function(){this._hash=t.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var i=0;i<16;i++){var n=e[p=t+i];e[p]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8)}var r,s,a,o,c,l,u,h,g,d,p=this._hash.words,f=(n=E.words,x.words),y=A.words,m=C.words,b=S.words,I=w.words;l=r=p[0],u=s=p[1],h=a=p[2],g=o=p[3],d=c=p[4];var v;for(i=0;i<80;i+=1)v=r+e[t+y[i]]|0,v=i<16?v+((s^a^o)+n[0]):i<32?v+((s&a|~s&o)+n[1]):i<48?v+(((s|~a)^o)+n[2]):i<64?v+((s&o|a&~o)+n[3]):v+((s^(a|~o))+n[4]),v=(v=(v|=0)<<b[i]|v>>>32-b[i])+c|0,r=c,c=o,o=a<<10|a>>>22,a=s,s=v,v=l+e[t+m[i]]|0,v=i<16?v+((u^(h|~g))+f[0]):i<32?v+((u&g|h&~g)+f[1]):i<48?v+(((u|~h)^g)+f[2]):i<64?v+((u&h|~u&g)+f[3]):v+((u^h^g)+f[4]),v=(v=(v|=0)<<I[i]|v>>>32-I[i])+d|0,l=d,d=g,g=h<<10|h>>>22,h=u,u=v;v=p[1]+a+g|0,p[1]=p[2]+o+d|0,p[2]=p[3]+c+l|0,p[3]=p[4]+r+u|0,p[4]=p[0]+s+h|0,p[0]=v},_doFinalize:function(){var e=this._data,t=e.words,i=8*this._nDataBytes,n=8*e.sigBytes;for(t[n>>>5]|=128<<24-n%32,t[14+(n+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),e.sigBytes=4*(t.length+1),this._process(),t=(e=this._hash).words,i=0;i<5;i++)n=t[i],t[i]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8);return e},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});e.RIPEMD160=i._createHelper(n),e.HmacRIPEMD160=i._createHmacHelper(n)}(Math),xga=CryptoJS,yga=xga.enc.Utf8,xga.algo.HMAC=xga.lib.Base.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=yga.parse(t));var i=e.blockSize,n=4*i;t.sigBytes>n&&(t=e.finalize(t)),t.clamp();for(var r=this._oKey=t.clone(),s=this._iKey=t.clone(),a=r.words,o=s.words,c=0;c<i;c++)a[c]^=1549556828,o[c]^=909522486;r.sigBytes=s.sigBytes=n,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}}),Mga=CryptoJS,Oga=(Nga=Mga.lib).Base,Pga=Nga.WordArray,Qga=(Nga=Mga.algo).HMAC,Rga=Nga.PBKDF2=Oga.extend({cfg:Oga.extend({keySize:4,hasher:Nga.SHA1,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){var i=this.cfg,n=Qga.create(i.hasher,e),r=Pga.create(),s=Pga.create([1]),a=r.words,o=s.words,c=i.keySize;for(i=i.iterations;a.length<c;){var l=n.update(t).finalize(s);n.reset();for(var u=l.words,h=u.length,g=l,d=1;d<i;d++){g=n.finalize(g),n.reset();for(var p=g.words,f=0;f<h;f++)u[f]^=p[f]}r.concat(l),o[0]++}return r.sigBytes=4*c,r}}),Mga.PBKDF2=function(e,t,i){return Rga.create(i).compute(e,t)};var b64map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b64pad$1="=",dbits;function hex2b64(e){var t,i,n="";for(t=0;t+3<=e.length;t+=3)i=parseInt(e.substring(t,t+3),16),n+=b64map.charAt(i>>6)+b64map.charAt(63&i);if(t+1==e.length?(i=parseInt(e.substring(t,t+1),16),n+=b64map.charAt(i<<2)):t+2==e.length&&(i=parseInt(e.substring(t,t+2),16),n+=b64map.charAt(i>>2)+b64map.charAt((3&i)<<4)),b64pad$1)for(;0<(3&n.length);)n+=b64pad$1;return n}function b64tohex(e){var t,i,n,r="",s=0;for(t=0;t<e.length&&e.charAt(t)!=b64pad$1;++t)(n=b64map.indexOf(e.charAt(t)))<0||(s=0==s?(r+=int2char(n>>2),i=3&n,1):1==s?(r+=int2char(i<<2|n>>4),i=15&n,2):2==s?(r+=int2char(i),r+=int2char(n>>2),i=3&n,3):(r+=int2char(i<<2|n>>4),r+=int2char(15&n),0));return 1==s&&(r+=int2char(i<<2)),r}function b64toBA(e){var t,i=b64tohex(e),n=new Array;for(t=0;2*t<i.length;++t)n[t]=parseInt(i.substring(2*t,2*t+2),16);return n}var canary=0xdeadbeefcafe,j_lm=15715070==(16777215&canary);function BigInteger(e,t,i){null!=e&&("number"==typeof e?this.fromNumber(e,t,i):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function nbi(){return new BigInteger(null)}function am1(e,t,i,n,r,s){for(;0<=--s;){var a=t*this[e++]+i[n]+r;r=Math.floor(a/67108864),i[n++]=67108863&a}return r}function am2(e,t,i,n,r,s){for(var a=32767&t,o=t>>15;0<=--s;){var c=32767&this[e],l=this[e++]>>15,u=o*c+l*a;r=((c=a*c+((32767&u)<<15)+i[n]+(1073741823&r))>>>30)+(u>>>15)+o*l+(r>>>30),i[n++]=1073741823&c}return r}function am3(e,t,i,n,r,s){for(var a=16383&t,o=t>>14;0<=--s;){var c=16383&this[e],l=this[e++]>>14,u=o*c+l*a;r=((c=a*c+((16383&u)<<14)+i[n]+r)>>28)+(u>>14)+o*l,i[n++]=268435455&c}return r}dbits=j_lm&&"Microsoft Internet Explorer"==navigator$1.appName?(BigInteger.prototype.am=am2,30):j_lm&&"Netscape"!=navigator$1.appName?(BigInteger.prototype.am=am1,26):(BigInteger.prototype.am=am3,28),BigInteger.prototype.DB=dbits,BigInteger.prototype.DM=(1<<dbits)-1,BigInteger.prototype.DV=1<<dbits;var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP),BigInteger.prototype.F1=BI_FP-dbits,BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=new Array,rr,vv;for(rr="0".charCodeAt(0),vv=0;vv<=9;++vv)BI_RC[rr++]=vv;for(rr="a".charCodeAt(0),vv=10;vv<36;++vv)BI_RC[rr++]=vv;for(rr="A".charCodeAt(0),vv=10;vv<36;++vv)BI_RC[rr++]=vv;function int2char(e){return BI_RM.charAt(e)}function intAt(e,t){var i=BI_RC[e.charCodeAt(t)];return null==i?-1:i}function bnpCopyTo(e){for(var t=this.t-1;0<=t;--t)e[t]=this[t];e.t=this.t,e.s=this.s}function bnpFromInt(e){this.t=1,this.s=e<0?-1:0,0<e?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0}function nbv(e){var t=nbi();return t.fromInt(e),t}function bnpFromString(e,t){var i;if(16==t)i=4;else if(8==t)i=3;else if(256==t)i=8;else if(2==t)i=1;else if(32==t)i=5;else{if(4!=t)return void this.fromRadix(e,t);i=2}this.t=0,this.s=0;for(var n=e.length,r=!1,s=0;0<=--n;){var a=8==i?255&e[n]:intAt(e,n);a<0?"-"==e.charAt(n)&&(r=!0):(r=!1,0==s?this[this.t++]=a:s+i>this.DB?(this[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this[this.t++]=a>>this.DB-s):this[this.t-1]|=a<<s,(s+=i)>=this.DB&&(s-=this.DB))}8==i&&0!=(128&e[0])&&(this.s=-1,0<s&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),r&&BigInteger.ZERO.subTo(this,this)}function bnpClamp(){for(var e=this.s&this.DM;0<this.t&&this[this.t-1]==e;)--this.t}function bnToString(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var i,n=(1<<t)-1,r=!1,s="",a=this.t,o=this.DB-a*this.DB%t;if(0<a--)for(o<this.DB&&0<(i=this[a]>>o)&&(r=!0,s=int2char(i));0<=a;)o<t?(i=(this[a]&(1<<o)-1)<<t-o,i|=this[--a]>>(o+=this.DB-t)):(i=this[a]>>(o-=t)&n,o<=0&&(o+=this.DB,--a)),0<i&&(r=!0),r&&(s+=int2char(i));return r?s:"0"}function bnNegate(){var e=nbi();return BigInteger.ZERO.subTo(this,e),e}function bnAbs(){return this.s<0?this.negate():this}function bnCompareTo(e){var t=this.s-e.s;if(0!=t)return t;var i=this.t;if(0!=(t=i-e.t))return this.s<0?-t:t;for(;0<=--i;)if(0!=(t=this[i]-e[i]))return t;return 0}function nbits(e){var t,i=1;return 0!=(t=e>>>16)&&(e=t,i+=16),0!=(t=e>>8)&&(e=t,i+=8),0!=(t=e>>4)&&(e=t,i+=4),0!=(t=e>>2)&&(e=t,i+=2),0!=(t=e>>1)&&(e=t,i+=1),i}function bnBitLength(){return this.t<=0?0:this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(e,t){var i;for(i=this.t-1;0<=i;--i)t[i+e]=this[i];for(i=e-1;0<=i;--i)t[i]=0;t.t=this.t+e,t.s=this.s}function bnpDRShiftTo(e,t){for(var i=e;i<this.t;++i)t[i-e]=this[i];t.t=Math.max(this.t-e,0),t.s=this.s}function bnpLShiftTo(e,t){var i,n=e%this.DB,r=this.DB-n,s=(1<<r)-1,a=Math.floor(e/this.DB),o=this.s<<n&this.DM;for(i=this.t-1;0<=i;--i)t[i+a+1]=this[i]>>r|o,o=(this[i]&s)<<n;for(i=a-1;0<=i;--i)t[i]=0;t[a]=o,t.t=this.t+a+1,t.s=this.s,t.clamp()}function bnpRShiftTo(e,t){t.s=this.s;var i=Math.floor(e/this.DB);if(i>=this.t)t.t=0;else{var n=e%this.DB,r=this.DB-n,s=(1<<n)-1;t[0]=this[i]>>n;for(var a=i+1;a<this.t;++a)t[a-i-1]|=(this[a]&s)<<r,t[a-i]=this[a]>>n;0<n&&(t[this.t-i-1]|=(this.s&s)<<r),t.t=this.t-i,t.clamp()}}function bnpSubTo(e,t){for(var i=0,n=0,r=Math.min(e.t,this.t);i<r;)n+=this[i]-e[i],t[i++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;i<this.t;)n+=this[i],t[i++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;i<e.t;)n-=e[i],t[i++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t[i++]=this.DV+n:0<n&&(t[i++]=n),t.t=i,t.clamp()}function bnpMultiplyTo(e,t){var i=this.abs(),n=e.abs(),r=i.t;for(t.t=r+n.t;0<=--r;)t[r]=0;for(r=0;r<n.t;++r)t[r+i.t]=i.am(0,n[r],t,r,0,i.t);t.s=0,t.clamp(),this.s!=e.s&&BigInteger.ZERO.subTo(t,t)}function bnpSquareTo(e){for(var t=this.abs(),i=e.t=2*t.t;0<=--i;)e[i]=0;for(i=0;i<t.t-1;++i){var n=t.am(i,t[i],e,2*i,0,1);(e[i+t.t]+=t.am(i+1,2*t[i],e,2*i+1,n,t.t-i-1))>=t.DV&&(e[i+t.t]-=t.DV,e[i+t.t+1]=1)}0<e.t&&(e[e.t-1]+=t.am(i,t[i],e,2*i,0,1)),e.s=0,e.clamp()}function bnpDivRemTo(e,t,i){var n=e.abs();if(!(n.t<=0)){var r=this.abs();if(r.t<n.t)return null!=t&&t.fromInt(0),void(null!=i&&this.copyTo(i));null==i&&(i=nbi());var s=nbi(),a=this.s,o=e.s,c=this.DB-nbits(n[n.t-1]);0<c?(n.lShiftTo(c,s),r.lShiftTo(c,i)):(n.copyTo(s),r.copyTo(i));var l=s.t,u=s[l-1];if(0!=u){var h=u*(1<<this.F1)+(1<l?s[l-2]>>this.F2:0),g=this.FV/h,d=(1<<this.F1)/h,p=1<<this.F2,f=i.t,y=f-l,m=null==t?nbi():t;for(s.dlShiftTo(y,m),0<=i.compareTo(m)&&(i[i.t++]=1,i.subTo(m,i)),BigInteger.ONE.dlShiftTo(l,m),m.subTo(s,s);s.t<l;)s[s.t++]=0;for(;0<=--y;){var b=i[--f]==u?this.DM:Math.floor(i[f]*g+(i[f-1]+p)*d);if((i[f]+=s.am(0,b,i,y,0,l))<b)for(s.dlShiftTo(y,m),i.subTo(m,i);i[f]<--b;)i.subTo(m,i)}null!=t&&(i.drShiftTo(l,t),a!=o&&BigInteger.ZERO.subTo(t,t)),i.t=l,i.clamp(),0<c&&i.rShiftTo(c,i),a<0&&BigInteger.ZERO.subTo(i,i)}}}function bnMod(e){var t=nbi();return this.abs().divRemTo(e,null,t),this.s<0&&0<t.compareTo(BigInteger.ZERO)&&e.subTo(t,t),t}function Classic(e){this.m=e}function cConvert(e){return e.s<0||0<=e.compareTo(this.m)?e.mod(this.m):e}function cRevert(e){return e}function cReduce(e){e.divRemTo(this.m,null,e)}function cMulTo(e,t,i){e.multiplyTo(t,i),this.reduce(i)}function cSqrTo(e,t){e.squareTo(t),this.reduce(t)}function bnpInvDigit(){if(this.t<1)return 0;var e=this[0];if(0==(1&e))return 0;var t=3&e;return 0<(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)?this.DV-t:-t}function Montgomery(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function montConvert(e){var t=nbi();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&0<t.compareTo(BigInteger.ZERO)&&this.m.subTo(t,t),t}function montRevert(e){var t=nbi();return e.copyTo(t),this.reduce(t),t}function montReduce(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var i=32767&e[t],n=i*this.mpl+((i*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(e[i=t+this.m.t]+=this.m.am(0,n,e,t,0,this.m.t);e[i]>=e.DV;)e[i]-=e.DV,e[++i]++}e.clamp(),e.drShiftTo(this.m.t,e),0<=e.compareTo(this.m)&&e.subTo(this.m,e)}function montSqrTo(e,t){e.squareTo(t),this.reduce(t)}function montMulTo(e,t,i){e.multiplyTo(t,i),this.reduce(i)}function bnpIsEven(){return 0==(0<this.t?1&this[0]:this.s)}function bnpExp(e,t){if(4294967295<e||e<1)return BigInteger.ONE;var i=nbi(),n=nbi(),r=t.convert(this),s=nbits(e)-1;for(r.copyTo(i);0<=--s;)if(t.sqrTo(i,n),0<(e&1<<s))t.mulTo(n,r,i);else{var a=i;i=n,n=a}return t.revert(i)}function bnModPowInt(e,t){var i;return i=e<256||t.isEven()?new Classic(t):new Montgomery(t),this.exp(e,i)}function bnClone(){var e=nbi();return this.copyTo(e),e}function bnIntValue(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function bnByteValue(){return 0==this.t?this.s:this[0]<<24>>24}function bnShortValue(){return 0==this.t?this.s:this[0]<<16>>16}function bnpChunkSize(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function bnSigNum(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function bnpToRadix(e){if(null==e&&(e=10),0==this.signum()||e<2||36<e)return"0";var t=this.chunkSize(e),i=Math.pow(e,t),n=nbv(i),r=nbi(),s=nbi(),a="";for(this.divRemTo(n,r,s);0<r.signum();)a=(i+s.intValue()).toString(e).substr(1)+a,r.divRemTo(n,r,s);return s.intValue().toString(e)+a}function bnpFromRadix(e,t){this.fromInt(0),null==t&&(t=10);for(var i=this.chunkSize(t),n=Math.pow(t,i),r=!1,s=0,a=0,o=0;o<e.length;++o){var c=intAt(e,o);c<0?"-"==e.charAt(o)&&0==this.signum()&&(r=!0):(a=t*a+c,++s>=i&&(this.dMultiply(n),this.dAddOffset(a,0),a=s=0))}0<s&&(this.dMultiply(Math.pow(t,s)),this.dAddOffset(a,0)),r&&BigInteger.ZERO.subTo(this,this)}function bnpFromNumber(e,t,i){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e,i),this.testBit(e-1)||this.bitwiseTo(BigInteger.ONE.shiftLeft(e-1),op_or,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(BigInteger.ONE.shiftLeft(e-1),this);else{var n=new Array,r=7&e;n.length=1+(e>>3),t.nextBytes(n),0<r?n[0]&=(1<<r)-1:n[0]=0,this.fromString(n,256)}}function bnToByteArray(){var e=this.t,t=new Array;t[0]=this.s;var i,n=this.DB-e*this.DB%8,r=0;if(0<e--)for(n<this.DB&&(i=this[e]>>n)!=(this.s&this.DM)>>n&&(t[r++]=i|this.s<<this.DB-n);0<=e;)n<8?(i=(this[e]&(1<<n)-1)<<8-n,i|=this[--e]>>(n+=this.DB-8)):(i=this[e]>>(n-=8)&255,n<=0&&(n+=this.DB,--e)),0!=(128&i)&&(i|=-256),0==r&&(128&this.s)!=(128&i)&&++r,(0<r||i!=this.s)&&(t[r++]=i);return t}function bnEquals(e){return 0==this.compareTo(e)}function bnMin(e){return this.compareTo(e)<0?this:e}function bnMax(e){return 0<this.compareTo(e)?this:e}function bnpBitwiseTo(e,t,i){var n,r,s=Math.min(e.t,this.t);for(n=0;n<s;++n)i[n]=t(this[n],e[n]);if(e.t<this.t){for(r=e.s&this.DM,n=s;n<this.t;++n)i[n]=t(this[n],r);i.t=this.t}else{for(r=this.s&this.DM,n=s;n<e.t;++n)i[n]=t(r,e[n]);i.t=e.t}i.s=t(this.s,e.s),i.clamp()}function op_and(e,t){return e&t}function bnAnd(e){var t=nbi();return this.bitwiseTo(e,op_and,t),t}function op_or(e,t){return e|t}function bnOr(e){var t=nbi();return this.bitwiseTo(e,op_or,t),t}function op_xor(e,t){return e^t}function bnXor(e){var t=nbi();return this.bitwiseTo(e,op_xor,t),t}function op_andnot(e,t){return e&~t}function bnAndNot(e){var t=nbi();return this.bitwiseTo(e,op_andnot,t),t}function bnNot(){for(var e=nbi(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e}function bnShiftLeft(e){var t=nbi();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function bnShiftRight(e){var t=nbi();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function lbit(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function bnGetLowestSetBit(){for(var e=0;e<this.t;++e)if(0!=this[e])return e*this.DB+lbit(this[e]);return this.s<0?this.t*this.DB:-1}function cbit(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function bnBitCount(){for(var e=0,t=this.s&this.DM,i=0;i<this.t;++i)e+=cbit(this[i]^t);return e}function bnTestBit(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this[t]&1<<e%this.DB)}function bnpChangeBit(e,t){var i=BigInteger.ONE.shiftLeft(e);return this.bitwiseTo(i,t,i),i}function bnSetBit(e){return this.changeBit(e,op_or)}function bnClearBit(e){return this.changeBit(e,op_andnot)}function bnFlipBit(e){return this.changeBit(e,op_xor)}function bnpAddTo(e,t){for(var i=0,n=0,r=Math.min(e.t,this.t);i<r;)n+=this[i]+e[i],t[i++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;i<this.t;)n+=this[i],t[i++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;i<e.t;)n+=e[i],t[i++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,0<n?t[i++]=n:n<-1&&(t[i++]=this.DV+n),t.t=i,t.clamp()}function bnAdd(e){var t=nbi();return this.addTo(e,t),t}function bnSubtract(e){var t=nbi();return this.subTo(e,t),t}function bnMultiply(e){var t=nbi();return this.multiplyTo(e,t),t}function bnSquare(){var e=nbi();return this.squareTo(e),e}function bnDivide(e){var t=nbi();return this.divRemTo(e,t,null),t}function bnRemainder(e){var t=nbi();return this.divRemTo(e,null,t),t}function bnDivideAndRemainder(e){var t=nbi(),i=nbi();return this.divRemTo(e,t,i),new Array(t,i)}function bnpDMultiply(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function bnpDAddOffset(e,t){if(0!=e){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}}function NullExp(){}function nNop(e){return e}function nMulTo(e,t,i){e.multiplyTo(t,i)}function nSqrTo(e,t){e.squareTo(t)}function bnPow(e){return this.exp(e,new NullExp)}function bnpMultiplyLowerTo(e,t,i){var n,r=Math.min(this.t+e.t,t);for(i.s=0,i.t=r;0<r;)i[--r]=0;for(n=i.t-this.t;r<n;++r)i[r+this.t]=this.am(0,e[r],i,r,0,this.t);for(n=Math.min(e.t,t);r<n;++r)this.am(0,e[r],i,r,0,t-r);i.clamp()}function bnpMultiplyUpperTo(e,t,i){--t;var n=i.t=this.t+e.t-t;for(i.s=0;0<=--n;)i[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)i[this.t+n-t]=this.am(t-n,e[n],i,0,0,this.t+n-t);i.clamp(),i.drShiftTo(1,i)}function Barrett(e){this.r2=nbi(),this.q3=nbi(),BigInteger.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function barrettConvert(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=nbi();return e.copyTo(t),this.reduce(t),t}function barrettRevert(e){return e}function barrettReduce(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);0<=e.compareTo(this.m);)e.subTo(this.m,e)}function barrettSqrTo(e,t){e.squareTo(t),this.reduce(t)}function barrettMulTo(e,t,i){e.multiplyTo(t,i),this.reduce(i)}function bnModPow(e,t){var i,n,r=e.bitLength(),s=nbv(1);if(r<=0)return s;i=r<18?1:r<48?3:r<144?4:r<768?5:6,n=r<8?new Classic(t):t.isEven()?new Barrett(t):new Montgomery(t);var a=new Array,o=3,c=i-1,l=(1<<i)-1;if(a[1]=n.convert(this),1<i){var u=nbi();for(n.sqrTo(a[1],u);o<=l;)a[o]=nbi(),n.mulTo(u,a[o-2],a[o]),o+=2}var h,g,d=e.t-1,p=!0,f=nbi();for(r=nbits(e[d])-1;0<=d;){for(c<=r?h=e[d]>>r-c&l:(h=(e[d]&(1<<r+1)-1)<<c-r,0<d&&(h|=e[d-1]>>this.DB+r-c)),o=i;0==(1&h);)h>>=1,--o;if((r-=o)<0&&(r+=this.DB,--d),p)a[h].copyTo(s),p=!1;else{for(;1<o;)n.sqrTo(s,f),n.sqrTo(f,s),o-=2;0<o?n.sqrTo(s,f):(g=s,s=f,f=g),n.mulTo(f,a[h],s)}for(;0<=d&&0==(e[d]&1<<r);)n.sqrTo(s,f),g=s,s=f,f=g,--r<0&&(r=this.DB-1,--d)}return n.revert(s)}function bnGCD(e){var t=this.s<0?this.negate():this.clone(),i=e.s<0?e.negate():e.clone();if(t.compareTo(i)<0){var n=t;t=i,i=n}var r=t.getLowestSetBit(),s=i.getLowestSetBit();if(s<0)return t;for(r<s&&(s=r),0<s&&(t.rShiftTo(s,t),i.rShiftTo(s,i));0<t.signum();)0<(r=t.getLowestSetBit())&&t.rShiftTo(r,t),0<(r=i.getLowestSetBit())&&i.rShiftTo(r,i),0<=t.compareTo(i)?(t.subTo(i,t),t.rShiftTo(1,t)):(i.subTo(t,i),i.rShiftTo(1,i));return 0<s&&i.lShiftTo(s,i),i}function bnpModInt(e){if(e<=0)return 0;var t=this.DV%e,i=this.s<0?e-1:0;if(0<this.t)if(0==t)i=this[0]%e;else for(var n=this.t-1;0<=n;--n)i=(t*i+this[n])%e;return i}function bnModInverse(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return BigInteger.ZERO;for(var i=e.clone(),n=this.clone(),r=nbv(1),s=nbv(0),a=nbv(0),o=nbv(1);0!=i.signum();){for(;i.isEven();)i.rShiftTo(1,i),t?(r.isEven()&&s.isEven()||(r.addTo(this,r),s.subTo(e,s)),r.rShiftTo(1,r)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),t?(a.isEven()&&o.isEven()||(a.addTo(this,a),o.subTo(e,o)),a.rShiftTo(1,a)):o.isEven()||o.subTo(e,o),o.rShiftTo(1,o);0<=i.compareTo(n)?(i.subTo(n,i),t&&r.subTo(a,r),s.subTo(o,s)):(n.subTo(i,n),t&&a.subTo(r,a),o.subTo(s,o))}return 0!=n.compareTo(BigInteger.ONE)?BigInteger.ZERO:0<=o.compareTo(e)?o.subtract(e):o.signum()<0?(o.addTo(e,o),o.signum()<0?o.add(e):o):o}Classic.prototype.convert=cConvert,Classic.prototype.revert=cRevert,Classic.prototype.reduce=cReduce,Classic.prototype.mulTo=cMulTo,Classic.prototype.sqrTo=cSqrTo,Montgomery.prototype.convert=montConvert,Montgomery.prototype.revert=montRevert,Montgomery.prototype.reduce=montReduce,Montgomery.prototype.mulTo=montMulTo,Montgomery.prototype.sqrTo=montSqrTo,BigInteger.prototype.copyTo=bnpCopyTo,BigInteger.prototype.fromInt=bnpFromInt,BigInteger.prototype.fromString=bnpFromString,BigInteger.prototype.clamp=bnpClamp,BigInteger.prototype.dlShiftTo=bnpDLShiftTo,BigInteger.prototype.drShiftTo=bnpDRShiftTo,BigInteger.prototype.lShiftTo=bnpLShiftTo,BigInteger.prototype.rShiftTo=bnpRShiftTo,BigInteger.prototype.subTo=bnpSubTo,BigInteger.prototype.multiplyTo=bnpMultiplyTo,BigInteger.prototype.squareTo=bnpSquareTo,BigInteger.prototype.divRemTo=bnpDivRemTo,BigInteger.prototype.invDigit=bnpInvDigit,BigInteger.prototype.isEven=bnpIsEven,BigInteger.prototype.exp=bnpExp,BigInteger.prototype.toString=bnToString,BigInteger.prototype.negate=bnNegate,BigInteger.prototype.abs=bnAbs,BigInteger.prototype.compareTo=bnCompareTo,BigInteger.prototype.bitLength=bnBitLength,BigInteger.prototype.mod=bnMod,BigInteger.prototype.modPowInt=bnModPowInt,BigInteger.ZERO=nbv(0),BigInteger.ONE=nbv(1),NullExp.prototype.convert=nNop,NullExp.prototype.revert=nNop,NullExp.prototype.mulTo=nMulTo,NullExp.prototype.sqrTo=nSqrTo,Barrett.prototype.convert=barrettConvert,Barrett.prototype.revert=barrettRevert,Barrett.prototype.reduce=barrettReduce,Barrett.prototype.mulTo=barrettMulTo,Barrett.prototype.sqrTo=barrettSqrTo;var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],lplim=(1<<26)/lowprimes[lowprimes.length-1];function bnIsProbablePrime(e){var t,i=this.abs();if(1==i.t&&i[0]<=lowprimes[lowprimes.length-1]){for(t=0;t<lowprimes.length;++t)if(i[0]==lowprimes[t])return!0;return!1}if(i.isEven())return!1;for(t=1;t<lowprimes.length;){for(var n=lowprimes[t],r=t+1;r<lowprimes.length&&n<lplim;)n*=lowprimes[r++];for(n=i.modInt(n);t<r;)if(n%lowprimes[t++]==0)return!1}return i.millerRabin(e)}function bnpMillerRabin(e){var t=this.subtract(BigInteger.ONE),i=t.getLowestSetBit();if(i<=0)return!1;var n=t.shiftRight(i);(e=e+1>>1)>lowprimes.length&&(e=lowprimes.length);for(var r=nbi(),s=0;s<e;++s){r.fromInt(lowprimes[Math.floor(Math.random()*lowprimes.length)]);var a=r.modPow(n,this);if(0!=a.compareTo(BigInteger.ONE)&&0!=a.compareTo(t)){for(var o=1;o++<i&&0!=a.compareTo(t);)if(0==(a=a.modPowInt(2,this)).compareTo(BigInteger.ONE))return!1;if(0!=a.compareTo(t))return!1}}return!0}function Arcfour(){this.i=0,this.j=0,this.S=new Array}function ARC4init(e){var t,i,n;for(t=0;t<256;++t)this.S[t]=t;for(t=i=0;t<256;++t)i=i+this.S[t]+e[t%e.length]&255,n=this.S[t],this.S[t]=this.S[i],this.S[i]=n;this.i=0,this.j=0}function ARC4next(){var e;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,e=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=e,this.S[e+this.S[this.i]&255]}function prng_newstate(){return new Arcfour}BigInteger.prototype.chunkSize=bnpChunkSize,BigInteger.prototype.toRadix=bnpToRadix,BigInteger.prototype.fromRadix=bnpFromRadix,BigInteger.prototype.fromNumber=bnpFromNumber,BigInteger.prototype.bitwiseTo=bnpBitwiseTo,BigInteger.prototype.changeBit=bnpChangeBit,BigInteger.prototype.addTo=bnpAddTo,BigInteger.prototype.dMultiply=bnpDMultiply,BigInteger.prototype.dAddOffset=bnpDAddOffset,BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo,BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo,BigInteger.prototype.modInt=bnpModInt,BigInteger.prototype.millerRabin=bnpMillerRabin,BigInteger.prototype.clone=bnClone,BigInteger.prototype.intValue=bnIntValue,BigInteger.prototype.byteValue=bnByteValue,BigInteger.prototype.shortValue=bnShortValue,BigInteger.prototype.signum=bnSigNum,BigInteger.prototype.toByteArray=bnToByteArray,BigInteger.prototype.equals=bnEquals,BigInteger.prototype.min=bnMin,BigInteger.prototype.max=bnMax,BigInteger.prototype.and=bnAnd,BigInteger.prototype.or=bnOr,BigInteger.prototype.xor=bnXor,BigInteger.prototype.andNot=bnAndNot,BigInteger.prototype.not=bnNot,BigInteger.prototype.shiftLeft=bnShiftLeft,BigInteger.prototype.shiftRight=bnShiftRight,BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit,BigInteger.prototype.bitCount=bnBitCount,BigInteger.prototype.testBit=bnTestBit,BigInteger.prototype.setBit=bnSetBit,BigInteger.prototype.clearBit=bnClearBit,BigInteger.prototype.flipBit=bnFlipBit,BigInteger.prototype.add=bnAdd,BigInteger.prototype.subtract=bnSubtract,BigInteger.prototype.multiply=bnMultiply,BigInteger.prototype.divide=bnDivide,BigInteger.prototype.remainder=bnRemainder,BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder,BigInteger.prototype.modPow=bnModPow,BigInteger.prototype.modInverse=bnModInverse,BigInteger.prototype.pow=bnPow,BigInteger.prototype.gcd=bnGCD,BigInteger.prototype.isProbablePrime=bnIsProbablePrime,BigInteger.prototype.square=bnSquare,Arcfour.prototype.init=ARC4init,Arcfour.prototype.next=ARC4next;var rng_psize=256,rng_state,rng_pool,rng_pptr;function rng_seed_int(e){rng_pool[rng_pptr++]^=255&e,rng_pool[rng_pptr++]^=e>>8&255,rng_pool[rng_pptr++]^=e>>16&255,rng_pool[rng_pptr++]^=e>>24&255,rng_psize<=rng_pptr&&(rng_pptr-=rng_psize)}function rng_seed_time(){rng_seed_int((new Date).getTime())}if(null==rng_pool){var t;if(rng_pool=new Array,rng_pptr=0,void 0!==window$1&&(void 0!==window$1.crypto||void 0!==window$1.msCrypto)){var crypto=window$1.crypto||window$1.msCrypto;if(crypto.getRandomValues){var ua=new Uint8Array(32);for(crypto.getRandomValues(ua),t=0;t<32;++t)rng_pool[rng_pptr++]=ua[t]}else if("Netscape"==navigator$1.appName&&navigator$1.appVersion<"5"){var z=window$1.crypto.random(32);for(t=0;t<z.length;++t)rng_pool[rng_pptr++]=255&z.charCodeAt(t)}}for(;rng_pptr<rng_psize;)t=Math.floor(65536*Math.random()),rng_pool[rng_pptr++]=t>>>8,rng_pool[rng_pptr++]=255&t;rng_pptr=0,rng_seed_time()}function rng_get_byte(){if(null==rng_state){for(rng_seed_time(),(rng_state=prng_newstate()).init(rng_pool),rng_pptr=0;rng_pptr<rng_pool.length;++rng_pptr)rng_pool[rng_pptr]=0;rng_pptr=0}return rng_state.next()}function rng_get_bytes(e){var t;for(t=0;t<e.length;++t)e[t]=rng_get_byte()}function SecureRandom(){}function parseBigInt(e,t){return new BigInteger(e,t)}function pkcs1pad2(e,t){if(t<e.length+11)throw"Message too long for RSA";for(var i=new Array,n=e.length-1;0<=n&&0<t;){var r=e.charCodeAt(n--);i[--t]=r<128?r:127<r&&r<2048?(i[--t]=63&r|128,r>>6|192):(i[--t]=63&r|128,i[--t]=r>>6&63|128,r>>12|224)}i[--t]=0;for(var s=new SecureRandom,a=new Array;2<t;){for(a[0]=0;0==a[0];)s.nextBytes(a);i[--t]=a[0]}return i[--t]=2,i[--t]=0,new BigInteger(i)}function oaep_mgf1_arr(e,t,i){for(var n="",r=0;n.length<t;)n+=i(String.fromCharCode.apply(String,e.concat([(4278190080&r)>>24,(16711680&r)>>16,(65280&r)>>8,255&r]))),r+=1;return n}function oaep_pad(e,t,i,n){var r=KJUR.crypto.MessageDigest,s=KJUR.crypto.Util,a=null;if(i||(i="sha1"),"string"==typeof i&&(a=r.getCanonicalAlgName(i),n=r.getHashLength(a),i=function(e){return hextorstr(s.hashHex(rstrtohex(e),a))}),e.length+2*n+2>t)throw"Message too long for RSA";var o,c="";for(o=0;o<t-e.length-2*n-2;o+=1)c+="\0";var l=i("")+c+""+e,u=new Array(n);(new SecureRandom).nextBytes(u);var h=oaep_mgf1_arr(u,l.length,i),g=[];for(o=0;o<l.length;o+=1)g[o]=l.charCodeAt(o)^h.charCodeAt(o);var d=oaep_mgf1_arr(g,u.length,i),p=[0];for(o=0;o<u.length;o+=1)p[o+1]=u[o]^d.charCodeAt(o);return new BigInteger(p.concat(g))}function RSAKey(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function RSASetPublic(e,t){if(this.isPublic=!0,this.isPrivate=!1,"string"!=typeof e)this.n=e,this.e=t;else{if(!(null!=e&&null!=t&&0<e.length&&0<t.length))throw"Invalid RSA public key";this.n=parseBigInt(e,16),this.e=parseInt(t,16)}}function RSADoPublic(e){return e.modPowInt(this.e,this.n)}function RSAEncrypt(e){var t=pkcs1pad2(e,this.n.bitLength()+7>>3);if(null==t)return null;var i=this.doPublic(t);if(null==i)return null;var n=i.toString(16);return 0==(1&n.length)?n:"0"+n}function RSAEncryptOAEP(e,t,i){var n=oaep_pad(e,this.n.bitLength()+7>>3,t,i);if(null==n)return null;var r=this.doPublic(n);if(null==r)return null;var s=r.toString(16);return 0==(1&s.length)?s:"0"+s}function pkcs1unpad2(e,t){for(var i=e.toByteArray(),n=0;n<i.length&&0==i[n];)++n;if(i.length-n!=t-1||2!=i[n])return null;for(++n;0!=i[n];)if(++n>=i.length)return null;for(var r="";++n<i.length;){var s=255&i[n];s<128?r+=String.fromCharCode(s):191<s&&s<224?(r+=String.fromCharCode((31&s)<<6|63&i[n+1]),++n):(r+=String.fromCharCode((15&s)<<12|(63&i[n+1])<<6|63&i[n+2]),n+=2)}return r}function oaep_mgf1_str(e,t,i){for(var n="",r=0;n.length<t;)n+=i(e+String.fromCharCode.apply(String,[(4278190080&r)>>24,(16711680&r)>>16,(65280&r)>>8,255&r])),r+=1;return n}function oaep_unpad(e,t,i,n){var r=KJUR.crypto.MessageDigest,s=KJUR.crypto.Util,a=null;for(i||(i="sha1"),"string"==typeof i&&(a=r.getCanonicalAlgName(i),n=r.getHashLength(a),i=function(e){return hextorstr(s.hashHex(rstrtohex(e),a))}),e=e.toByteArray(),o=0;o<e.length;o+=1)e[o]&=255;for(;e.length<t;)e.unshift(0);if((e=String.fromCharCode.apply(String,e)).length<2*n+2)throw"Cipher too short";var o,c=e.substr(1,n),l=e.substr(n+1),u=oaep_mgf1_str(l,n,i),h=[];for(o=0;o<c.length;o+=1)h[o]=c.charCodeAt(o)^u.charCodeAt(o);var g=oaep_mgf1_str(String.fromCharCode.apply(String,h),e.length-n,i),d=[];for(o=0;o<l.length;o+=1)d[o]=l.charCodeAt(o)^g.charCodeAt(o);if((d=String.fromCharCode.apply(String,d)).substr(0,n)!==i(""))throw"Hash mismatch";var p=(d=d.substr(n)).indexOf("");if((-1!=p?d.substr(0,p).lastIndexOf("\0"):-1)+1!=p)throw"Malformed data";return d.substr(p+1)}function RSASetPrivate(e,t,i){if(this.isPrivate=!0,"string"!=typeof e)this.n=e,this.e=t,this.d=i;else{if(!(null!=e&&null!=t&&0<e.length&&0<t.length))throw"Invalid RSA private key";this.n=parseBigInt(e,16),this.e=parseInt(t,16),this.d=parseBigInt(i,16)}}function RSASetPrivateEx(e,t,i,n,r,s,a,o){if(this.isPrivate=!0,this.isPublic=!1,null==e)throw"RSASetPrivateEx N == null";if(null==t)throw"RSASetPrivateEx E == null";if(0==e.length)throw"RSASetPrivateEx N.length == 0";if(0==t.length)throw"RSASetPrivateEx E.length == 0";if(!(null!=e&&null!=t&&0<e.length&&0<t.length))throw"Invalid RSA private key in RSASetPrivateEx";this.n=parseBigInt(e,16),this.e=parseInt(t,16),this.d=parseBigInt(i,16),this.p=parseBigInt(n,16),this.q=parseBigInt(r,16),this.dmp1=parseBigInt(s,16),this.dmq1=parseBigInt(a,16),this.coeff=parseBigInt(o,16)}function RSAGenerate(e,t){var i=new SecureRandom,n=e>>1;this.e=parseInt(t,16);for(var r=new BigInteger(t,16);;){for(;this.p=new BigInteger(e-n,1,i),0!=this.p.subtract(BigInteger.ONE).gcd(r).compareTo(BigInteger.ONE)||!this.p.isProbablePrime(10););for(;this.q=new BigInteger(n,1,i),0!=this.q.subtract(BigInteger.ONE).gcd(r).compareTo(BigInteger.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var s=this.p;this.p=this.q,this.q=s}var a=this.p.subtract(BigInteger.ONE),o=this.q.subtract(BigInteger.ONE),c=a.multiply(o);if(0==c.gcd(r).compareTo(BigInteger.ONE)){this.n=this.p.multiply(this.q),this.d=r.modInverse(c),this.dmp1=this.d.mod(a),this.dmq1=this.d.mod(o),this.coeff=this.q.modInverse(this.p);break}}this.isPrivate=!0}function RSADoPrivate(e){if(null==this.p||null==this.q)return e.modPow(this.d,this.n);for(var t=e.mod(this.p).modPow(this.dmp1,this.p),i=e.mod(this.q).modPow(this.dmq1,this.q);t.compareTo(i)<0;)t=t.add(this.p);return t.subtract(i).multiply(this.coeff).mod(this.p).multiply(this.q).add(i)}function RSADecrypt(e){var t=parseBigInt(e,16),i=this.doPrivate(t);return null==i?null:pkcs1unpad2(i,this.n.bitLength()+7>>3)}function RSADecryptOAEP(e,t,i){var n=parseBigInt(e,16),r=this.doPrivate(n);return null==r?null:oaep_unpad(r,this.n.bitLength()+7>>3,t,i)}function ECFieldElementFp(e,t){this.x=t,this.q=e}function feFpEquals(e){return e==this||this.q.equals(e.q)&&this.x.equals(e.x)}function feFpToBigInteger(){return this.x}function feFpNegate(){return new ECFieldElementFp(this.q,this.x.negate().mod(this.q))}function feFpAdd(e){return new ECFieldElementFp(this.q,this.x.add(e.toBigInteger()).mod(this.q))}function feFpSubtract(e){return new ECFieldElementFp(this.q,this.x.subtract(e.toBigInteger()).mod(this.q))}function feFpMultiply(e){return new ECFieldElementFp(this.q,this.x.multiply(e.toBigInteger()).mod(this.q))}function feFpSquare(){return new ECFieldElementFp(this.q,this.x.square().mod(this.q))}function feFpDivide(e){return new ECFieldElementFp(this.q,this.x.multiply(e.toBigInteger().modInverse(this.q)).mod(this.q))}function ECPointFp(e,t,i,n){this.curve=e,this.x=t,this.y=i,this.z=null==n?BigInteger.ONE:n,this.zinv=null}function pointFpGetX(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function pointFpGetY(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function pointFpEquals(e){return e==this||(this.isInfinity()?e.isInfinity():e.isInfinity()?this.isInfinity():!!e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q).equals(BigInteger.ZERO)&&e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q).equals(BigInteger.ZERO))}function pointFpIsInfinity(){return null==this.x&&null==this.y||this.z.equals(BigInteger.ZERO)&&!this.y.toBigInteger().equals(BigInteger.ZERO)}function pointFpNegate(){return new ECPointFp(this.curve,this.x,this.y.negate(),this.z)}function pointFpAdd(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q),i=e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q);if(BigInteger.ZERO.equals(i))return BigInteger.ZERO.equals(t)?this.twice():this.curve.getInfinity();var n=new BigInteger("3"),r=this.x.toBigInteger(),s=this.y.toBigInteger(),a=(e.x.toBigInteger(),e.y.toBigInteger(),i.square()),o=a.multiply(i),c=r.multiply(a),l=t.square().multiply(this.z),u=l.subtract(c.shiftLeft(1)).multiply(e.z).subtract(o).multiply(i).mod(this.curve.q),h=c.multiply(n).multiply(t).subtract(s.multiply(o)).subtract(l.multiply(t)).multiply(e.z).add(t.multiply(o)).mod(this.curve.q),g=o.multiply(this.z).multiply(e.z).mod(this.curve.q);return new ECPointFp(this.curve,this.curve.fromBigInteger(u),this.curve.fromBigInteger(h),g)}function pointFpTwice(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var e=new BigInteger("3"),t=this.x.toBigInteger(),i=this.y.toBigInteger(),n=i.multiply(this.z),r=n.multiply(i).mod(this.curve.q),s=this.curve.a.toBigInteger(),a=t.square().multiply(e);BigInteger.ZERO.equals(s)||(a=a.add(this.z.square().multiply(s)));var o=(a=a.mod(this.curve.q)).square().subtract(t.shiftLeft(3).multiply(r)).shiftLeft(1).multiply(n).mod(this.curve.q),c=a.multiply(e).multiply(t).subtract(r.shiftLeft(1)).shiftLeft(2).multiply(r).subtract(a.square().multiply(a)).mod(this.curve.q),l=n.square().multiply(n).shiftLeft(3).mod(this.curve.q);return new ECPointFp(this.curve,this.curve.fromBigInteger(o),this.curve.fromBigInteger(c),l)}function pointFpMultiply(e){if(this.isInfinity())return this;if(0==e.signum())return this.curve.getInfinity();var t,i=e,n=i.multiply(new BigInteger("3")),r=this.negate(),s=this;for(t=n.bitLength()-2;0<t;--t){s=s.twice();var a=n.testBit(t);a!=i.testBit(t)&&(s=s.add(a?this:r))}return s}function pointFpMultiplyTwo(e,t,i){var n;n=e.bitLength()>i.bitLength()?e.bitLength()-1:i.bitLength()-1;for(var r=this.curve.getInfinity(),s=this.add(t);0<=n;)r=r.twice(),e.testBit(n)?r=i.testBit(n)?r.add(s):r.add(this):i.testBit(n)&&(r=r.add(t)),--n;return r}function ECCurveFp(e,t,i){this.q=e,this.a=this.fromBigInteger(t),this.b=this.fromBigInteger(i),this.infinity=new ECPointFp(this,null,null)}function curveFpGetQ(){return this.q}function curveFpGetA(){return this.a}function curveFpGetB(){return this.b}function curveFpEquals(e){return e==this||this.q.equals(e.q)&&this.a.equals(e.a)&&this.b.equals(e.b)}function curveFpGetInfinity(){return this.infinity}function curveFpFromBigInteger(e){return new ECFieldElementFp(this.q,e)}function curveFpDecodePointHex(e){switch(parseInt(e.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var t=(e.length-2)/2,i=e.substr(2,t),n=e.substr(t+2,t);return new ECPointFp(this,this.fromBigInteger(new BigInteger(i,16)),this.fromBigInteger(new BigInteger(n,16)));default:return null}}SecureRandom.prototype.nextBytes=rng_get_bytes,RSAKey.prototype.doPublic=RSADoPublic,RSAKey.prototype.setPublic=RSASetPublic,RSAKey.prototype.encrypt=RSAEncrypt,RSAKey.prototype.encryptOAEP=RSAEncryptOAEP,RSAKey.prototype.type="RSA",RSAKey.prototype.doPrivate=RSADoPrivate,RSAKey.prototype.setPrivate=RSASetPrivate,RSAKey.prototype.setPrivateEx=RSASetPrivateEx,RSAKey.prototype.generate=RSAGenerate,RSAKey.prototype.decrypt=RSADecrypt,RSAKey.prototype.decryptOAEP=RSADecryptOAEP,ECFieldElementFp.prototype.equals=feFpEquals,ECFieldElementFp.prototype.toBigInteger=feFpToBigInteger,ECFieldElementFp.prototype.negate=feFpNegate,ECFieldElementFp.prototype.add=feFpAdd,ECFieldElementFp.prototype.subtract=feFpSubtract,ECFieldElementFp.prototype.multiply=feFpMultiply,ECFieldElementFp.prototype.square=feFpSquare,ECFieldElementFp.prototype.divide=feFpDivide,ECPointFp.prototype.getX=pointFpGetX,ECPointFp.prototype.getY=pointFpGetY,ECPointFp.prototype.equals=pointFpEquals,ECPointFp.prototype.isInfinity=pointFpIsInfinity,ECPointFp.prototype.negate=pointFpNegate,ECPointFp.prototype.add=pointFpAdd,ECPointFp.prototype.twice=pointFpTwice,ECPointFp.prototype.multiply=pointFpMultiply,ECPointFp.prototype.multiplyTwo=pointFpMultiplyTwo,ECCurveFp.prototype.getQ=curveFpGetQ,ECCurveFp.prototype.getA=curveFpGetA,ECCurveFp.prototype.getB=curveFpGetB,ECCurveFp.prototype.equals=curveFpEquals,ECCurveFp.prototype.getInfinity=curveFpGetInfinity,ECCurveFp.prototype.fromBigInteger=curveFpFromBigInteger,ECCurveFp.prototype.decodePointHex=curveFpDecodePointHex,ECFieldElementFp.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},ECPointFp.prototype.getEncoded=function(e){var t=function(e,t){var i=e.toByteArrayUnsigned();if(t<i.length)i=i.slice(i.length-t);else for(;t>i.length;)i.unshift(0);return i},i=this.getX().toBigInteger(),n=this.getY().toBigInteger(),r=t(i,32);return e?n.isEven()?r.unshift(2):r.unshift(3):(r.unshift(4),r=r.concat(t(n,32))),r},ECPointFp.decodeFrom=function(e,t){t[0];var i=t.length-1,n=t.slice(1,1+i/2),r=t.slice(1+i/2,1+i);n.unshift(0),r.unshift(0);var s=new BigInteger(n),a=new BigInteger(r);return new ECPointFp(e,e.fromBigInteger(s),e.fromBigInteger(a))},ECPointFp.decodeFromHex=function(e,t){t.substr(0,2);var i=t.length-2,n=t.substr(2,i/2),r=t.substr(2+i/2,i/2),s=new BigInteger(n,16),a=new BigInteger(r,16);return new ECPointFp(e,e.fromBigInteger(s),e.fromBigInteger(a))},ECPointFp.prototype.add2D=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;if(this.x.equals(e.x))return this.y.equals(e.y)?this.twice():this.curve.getInfinity();var t=e.x.subtract(this.x),i=e.y.subtract(this.y).divide(t),n=i.square().subtract(this.x).subtract(e.x),r=i.multiply(this.x.subtract(n)).subtract(this.y);return new ECPointFp(this.curve,n,r)},ECPointFp.prototype.twice2D=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var e=this.curve.fromBigInteger(BigInteger.valueOf(2)),t=this.curve.fromBigInteger(BigInteger.valueOf(3)),i=this.x.square().multiply(t).add(this.curve.a).divide(this.y.multiply(e)),n=i.square().subtract(this.x.multiply(e)),r=i.multiply(this.x.subtract(n)).subtract(this.y);return new ECPointFp(this.curve,n,r)},ECPointFp.prototype.multiply2D=function(e){if(this.isInfinity())return this;if(0==e.signum())return this.curve.getInfinity();var t,i=e,n=i.multiply(new BigInteger("3")),r=this.negate(),s=this;for(t=n.bitLength()-2;0<t;--t){s=s.twice();var a=n.testBit(t);a!=i.testBit(t)&&(s=s.add2D(a?this:r))}return s},ECPointFp.prototype.isOnCurve=function(){var e=this.getX().toBigInteger(),t=this.getY().toBigInteger(),i=this.curve.getA().toBigInteger(),n=this.curve.getB().toBigInteger(),r=this.curve.getQ(),s=t.multiply(t).mod(r),a=e.multiply(e).multiply(e).add(i.multiply(e)).add(n).mod(r);return s.equals(a)},ECPointFp.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},ECPointFp.prototype.validate=function(){var e=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var t=this.getX().toBigInteger(),i=this.getY().toBigInteger();if(t.compareTo(BigInteger.ONE)<0||0<t.compareTo(e.subtract(BigInteger.ONE)))throw new Error("x coordinate out of bounds");if(i.compareTo(BigInteger.ONE)<0||0<i.compareTo(e.subtract(BigInteger.ONE)))throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(e).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};var jsonParse=function(){var g=new RegExp('(?:false|true|null|[\\{\\}\\[\\]]|(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)|(?:"(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))*"))',"g"),d=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),n={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function p(e,t,i){return t?n[t]:String.fromCharCode(parseInt(i,16))}var f=new String(""),y=Object.hasOwnProperty;return function(e,o){var t,i,n=e.match(g),r=n[0],s=!1;"{"===r?t={}:"["===r?t=[]:(t=[],s=!0);for(var a=[t],c=1-s,l=n.length;c<l;++c){var u;switch((r=n[c]).charCodeAt(0)){default:(u=a[0])[i||u.length]=+r,i=void 0;break;case 34:if(-1!==(r=r.substring(1,r.length-1)).indexOf("\\")&&(r=r.replace(d,p)),u=a[0],!i){if(!(u instanceof Array)){i=r||f;break}i=u.length}u[i]=r,i=void 0;break;case 91:u=a[0],a.unshift(u[i||u.length]=[]),i=void 0;break;case 93:a.shift();break;case 102:(u=a[0])[i||u.length]=!1,i=void 0;break;case 110:(u=a[0])[i||u.length]=null,i=void 0;break;case 116:(u=a[0])[i||u.length]=!0,i=void 0;break;case 123:u=a[0],a.unshift(u[i||u.length]={}),i=void 0;break;case 125:a.shift()}}if(s){if(1!==a.length)throw new Error;t=t[0]}else if(a.length)throw new Error;if(o){var h=function(e,t){var i=e[t];if(i&&"object"==typeof i){var n=null;for(var r in i)if(y.call(i,r)&&i!==e){var s=h(i,r);void 0!==s?i[r]=s:(n||(n=[]),n.push(r))}if(n)for(var a=n.length;0<=--a;)delete i[n[a]]}return o.call(e,t,i)};t=h({"":t},"")}return t}}();void 0!==KJUR&&KJUR||(KJUR={}),void 0!==KJUR.asn1&&KJUR.asn1||(KJUR.asn1={}),KJUR.asn1.ASN1Util=new function(){this.integerToByteHex=function(e){var t=e.toString(16);return t.length%2==1&&(t="0"+t),t},this.bigIntToMinTwosComplementsHex=function(e){var t=e.toString(16);if("-"!=t.substr(0,1))t.length%2==1?t="0"+t:t.match(/^[0-7]/)||(t="00"+t);else{var i=t.substr(1).length;i%2==1?i+=1:t.match(/^[0-7]/)||(i+=2);for(var n="",r=0;r<i;r++)n+="f";t=new BigInteger(n,16).xor(e).add(BigInteger.ONE).toString(16).replace(/^-/,"")}return t},this.getPEMStringFromHex=function(e,t){return hextopem(e,t)},this.newObject=function(e){var t=KJUR.asn1,i=t.DERBoolean,n=t.DERInteger,r=t.DERBitString,s=t.DEROctetString,a=t.DERNull,o=t.DERObjectIdentifier,c=t.DEREnumerated,l=t.DERUTF8String,u=t.DERNumericString,h=t.DERPrintableString,g=t.DERTeletexString,d=t.DERIA5String,p=t.DERUTCTime,f=t.DERGeneralizedTime,y=t.DERSequence,m=t.DERSet,b=t.DERTaggedObject,I=t.ASN1Util.newObject,v=Object.keys(e);if(1!=v.length)throw"key of param shall be only one.";var A=v[0];if(-1==":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+A+":"))throw"undefined key: "+A;if("bool"==A)return new i(e[A]);if("int"==A)return new n(e[A]);if("bitstr"==A)return new r(e[A]);if("octstr"==A)return new s(e[A]);if("null"==A)return new a(e[A]);if("oid"==A)return new o(e[A]);if("enum"==A)return new c(e[A]);if("utf8str"==A)return new l(e[A]);if("numstr"==A)return new u(e[A]);if("prnstr"==A)return new h(e[A]);if("telstr"==A)return new g(e[A]);if("ia5str"==A)return new d(e[A]);if("utctime"==A)return new p(e[A]);if("gentime"==A)return new f(e[A]);if("seq"==A){for(var C=e[A],S=[],w=0;w<C.length;w++){var E=I(C[w]);S.push(E)}return new y({array:S})}if("set"==A){for(C=e[A],S=[],w=0;w<C.length;w++){E=I(C[w]);S.push(E)}return new m({array:S})}if("tag"==A){var x=e[A];if("[object Array]"===Object.prototype.toString.call(x)&&3==x.length){var T=I(x[2]);return new b({tag:x[0],explicit:x[1],obj:T})}var R={};if(void 0!==x.explicit&&(R.explicit=x.explicit),void 0!==x.tag&&(R.tag=x.tag),void 0===x.obj)throw"obj shall be specified for 'tag'.";return R.obj=I(x.obj),new b(R)}},this.jsonToASN1HEX=function(e){return this.newObject(e).getEncodedHex()}},KJUR.asn1.ASN1Util.oidHexToInt=function(e){for(var t="",i=parseInt(e.substr(0,2),16),n=(t=Math.floor(i/40)+"."+i%40,""),r=2;r<e.length;r+=2){var s=("00000000"+parseInt(e.substr(r,2),16).toString(2)).slice(-8);if(n+=s.substr(1,7),"0"==s.substr(0,1))t=t+"."+new BigInteger(n,2).toString(10),n=""}return t},KJUR.asn1.ASN1Util.oidIntToHex=function(e){var o=function(e){var t=e.toString(16);return 1==t.length&&(t="0"+t),t},t=function(e){var t="",i=new BigInteger(e,10).toString(2),n=7-i.length%7;7==n&&(n=0);for(var r="",s=0;s<n;s++)r+="0";i=r+i;for(s=0;s<i.length-1;s+=7){var a=i.substr(s,7);s!=i.length-7&&(a="1"+a),t+=o(parseInt(a,2))}return t};if(!e.match(/^[0-9.]+$/))throw"malformed oid string: "+e;var i="",n=e.split("."),r=40*parseInt(n[0])+parseInt(n[1]);i+=o(r),n.splice(0,2);for(var s=0;s<n.length;s++)i+=t(n[s]);return i},KJUR.asn1.ASN1Object=function(){this.getLengthHexFromValue=function(){if(void 0===this.hV||null==this.hV)throw"this.hV is null or undefined.";if(this.hV.length%2==1)throw"value hex must be even length: n="+"".length+",v="+this.hV;var e=this.hV.length/2,t=e.toString(16);if(t.length%2==1&&(t="0"+t),e<128)return t;var i=t.length/2;if(15<i)throw"ASN.1 length too long to represent by 8x: n = "+e.toString(16);return(128+i).toString(16)+t},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}},KJUR.asn1.DERAbstractString=function(e){KJUR.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(e){this.hTLV=null,this.isModified=!0,this.s=e,this.hV=utf8tohex(this.s).toLowerCase()},this.setStringHex=function(e){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&("string"==typeof e?this.setString(e):void 0!==e.str?this.setString(e.str):void 0!==e.hex&&this.setStringHex(e.hex))},YAHOO.lang.extend(KJUR.asn1.DERAbstractString,KJUR.asn1.ASN1Object),KJUR.asn1.DERAbstractTime=function(e){KJUR.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(e){return utc=e.getTime()+6e4*e.getTimezoneOffset(),new Date(utc)},this.formatDate=function(e,t,i){var n=this.zeroPadding,r=this.localDateToUTC(e),s=String(r.getFullYear());"utc"==t&&(s=s.substr(2,2));var a=s+n(String(r.getMonth()+1),2)+n(String(r.getDate()),2)+n(String(r.getHours()),2)+n(String(r.getMinutes()),2)+n(String(r.getSeconds()),2);if(!0===i){var o=r.getMilliseconds();if(0!=o){var c=n(String(o),3);a=a+"."+(c=c.replace(/[0]+$/,""))}}return a+"Z"},this.zeroPadding=function(e,t){return e.length>=t?e:new Array(t-e.length+1).join("0")+e},this.getString=function(){return this.s},this.setString=function(e){this.hTLV=null,this.isModified=!0,this.s=e,this.hV=stohex(e)},this.setByDateValue=function(e,t,i,n,r,s){var a=new Date(Date.UTC(e,t-1,i,n,r,s,0));this.setByDate(a)},this.getFreshValueHex=function(){return this.hV}},YAHOO.lang.extend(KJUR.asn1.DERAbstractTime,KJUR.asn1.ASN1Object),KJUR.asn1.DERAbstractStructured=function(e){KJUR.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(e){this.hTLV=null,this.isModified=!0,this.asn1Array=e},this.appendASN1Object=function(e){this.hTLV=null,this.isModified=!0,this.asn1Array.push(e)},this.asn1Array=new Array,void 0!==e&&void 0!==e.array&&(this.asn1Array=e.array)},YAHOO.lang.extend(KJUR.asn1.DERAbstractStructured,KJUR.asn1.ASN1Object),KJUR.asn1.DERBoolean=function(){KJUR.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"},YAHOO.lang.extend(KJUR.asn1.DERBoolean,KJUR.asn1.ASN1Object),KJUR.asn1.DERInteger=function(e){KJUR.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(e){this.hTLV=null,this.isModified=!0,this.hV=KJUR.asn1.ASN1Util.bigIntToMinTwosComplementsHex(e)},this.setByInteger=function(e){var t=new BigInteger(String(e),10);this.setByBigInteger(t)},this.setValueHex=function(e){this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&(void 0!==e.bigint?this.setByBigInteger(e.bigint):void 0!==e.int?this.setByInteger(e.int):"number"==typeof e?this.setByInteger(e):void 0!==e.hex&&this.setValueHex(e.hex))},YAHOO.lang.extend(KJUR.asn1.DERInteger,KJUR.asn1.ASN1Object),KJUR.asn1.DERBitString=function(e){if(void 0!==e&&void 0!==e.obj){var t=KJUR.asn1.ASN1Util.newObject(e.obj);e.hex="00"+t.getEncodedHex()}KJUR.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(e){this.hTLV=null,this.isModified=!0,this.hV=e},this.setUnusedBitsAndHexValue=function(e,t){if(e<0||7<e)throw"unused bits shall be from 0 to 7: u = "+e;var i="0"+e;this.hTLV=null,this.isModified=!0,this.hV=i+t},this.setByBinaryString=function(e){var t=8-(e=e.replace(/0+$/,"")).length%8;8==t&&(t=0);for(var i=0;i<=t;i++)e+="0";var n="";for(i=0;i<e.length-1;i+=8){var r=e.substr(i,8),s=parseInt(r,2).toString(16);1==s.length&&(s="0"+s),n+=s}this.hTLV=null,this.isModified=!0,this.hV="0"+t+n},this.setByBooleanArray=function(e){for(var t="",i=0;i<e.length;i++)1==e[i]?t+="1":t+="0";this.setByBinaryString(t)},this.newFalseArray=function(e){for(var t=new Array(e),i=0;i<e;i++)t[i]=!1;return t},this.getFreshValueHex=function(){return this.hV},void 0!==e&&("string"==typeof e&&e.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(e):void 0!==e.hex?this.setHexValueIncludingUnusedBits(e.hex):void 0!==e.bin?this.setByBinaryString(e.bin):void 0!==e.array&&this.setByBooleanArray(e.array))},YAHOO.lang.extend(KJUR.asn1.DERBitString,KJUR.asn1.ASN1Object),KJUR.asn1.DEROctetString=function(e){if(void 0!==e&&void 0!==e.obj){var t=KJUR.asn1.ASN1Util.newObject(e.obj);e.hex=t.getEncodedHex()}KJUR.asn1.DEROctetString.superclass.constructor.call(this,e),this.hT="04"},YAHOO.lang.extend(KJUR.asn1.DEROctetString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERNull=function(){KJUR.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},YAHOO.lang.extend(KJUR.asn1.DERNull,KJUR.asn1.ASN1Object),KJUR.asn1.DERObjectIdentifier=function(e){var o=function(e){var t=e.toString(16);return 1==t.length&&(t="0"+t),t},s=function(e){var t="",i=new BigInteger(e,10).toString(2),n=7-i.length%7;7==n&&(n=0);for(var r="",s=0;s<n;s++)r+="0";i=r+i;for(s=0;s<i.length-1;s+=7){var a=i.substr(s,7);s!=i.length-7&&(a="1"+a),t+=o(parseInt(a,2))}return t};KJUR.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(e){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.setValueOidString=function(e){if(!e.match(/^[0-9.]+$/))throw"malformed oid string: "+e;var t="",i=e.split("."),n=40*parseInt(i[0])+parseInt(i[1]);t+=o(n),i.splice(0,2);for(var r=0;r<i.length;r++)t+=s(i[r]);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.setValueName=function(e){var t=KJUR.asn1.x509.OID.name2oid(e);if(""===t)throw"DERObjectIdentifier oidName undefined: "+e;this.setValueOidString(t)},this.getFreshValueHex=function(){return this.hV},void 0!==e&&("string"==typeof e?e.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(e):this.setValueName(e):void 0!==e.oid?this.setValueOidString(e.oid):void 0!==e.hex?this.setValueHex(e.hex):void 0!==e.name&&this.setValueName(e.name))},YAHOO.lang.extend(KJUR.asn1.DERObjectIdentifier,KJUR.asn1.ASN1Object),KJUR.asn1.DEREnumerated=function(e){KJUR.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(e){this.hTLV=null,this.isModified=!0,this.hV=KJUR.asn1.ASN1Util.bigIntToMinTwosComplementsHex(e)},this.setByInteger=function(e){var t=new BigInteger(String(e),10);this.setByBigInteger(t)},this.setValueHex=function(e){this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&(void 0!==e.int?this.setByInteger(e.int):"number"==typeof e?this.setByInteger(e):void 0!==e.hex&&this.setValueHex(e.hex))},YAHOO.lang.extend(KJUR.asn1.DEREnumerated,KJUR.asn1.ASN1Object),KJUR.asn1.DERUTF8String=function(e){KJUR.asn1.DERUTF8String.superclass.constructor.call(this,e),this.hT="0c"},YAHOO.lang.extend(KJUR.asn1.DERUTF8String,KJUR.asn1.DERAbstractString),KJUR.asn1.DERNumericString=function(e){KJUR.asn1.DERNumericString.superclass.constructor.call(this,e),this.hT="12"},YAHOO.lang.extend(KJUR.asn1.DERNumericString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERPrintableString=function(e){KJUR.asn1.DERPrintableString.superclass.constructor.call(this,e),this.hT="13"},YAHOO.lang.extend(KJUR.asn1.DERPrintableString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERTeletexString=function(e){KJUR.asn1.DERTeletexString.superclass.constructor.call(this,e),this.hT="14"},YAHOO.lang.extend(KJUR.asn1.DERTeletexString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERIA5String=function(e){KJUR.asn1.DERIA5String.superclass.constructor.call(this,e),this.hT="16"},YAHOO.lang.extend(KJUR.asn1.DERIA5String,KJUR.asn1.DERAbstractString),KJUR.asn1.DERUTCTime=function(e){KJUR.asn1.DERUTCTime.superclass.constructor.call(this,e),this.hT="17",this.setByDate=function(e){this.hTLV=null,this.isModified=!0,this.date=e,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)),this.hV},void 0!==e&&(void 0!==e.str?this.setString(e.str):"string"==typeof e&&e.match(/^[0-9]{12}Z$/)?this.setString(e):void 0!==e.hex?this.setStringHex(e.hex):void 0!==e.date&&this.setByDate(e.date))},YAHOO.lang.extend(KJUR.asn1.DERUTCTime,KJUR.asn1.DERAbstractTime),KJUR.asn1.DERGeneralizedTime=function(e){KJUR.asn1.DERGeneralizedTime.superclass.constructor.call(this,e),this.hT="18",this.withMillis=!1,this.setByDate=function(e){this.hTLV=null,this.isModified=!0,this.date=e,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=stohex(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=stohex(this.s)),this.hV},void 0!==e&&(void 0!==e.str?this.setString(e.str):"string"==typeof e&&e.match(/^[0-9]{14}Z$/)?this.setString(e):void 0!==e.hex?this.setStringHex(e.hex):void 0!==e.date&&this.setByDate(e.date),!0===e.millis&&(this.withMillis=!0))},YAHOO.lang.extend(KJUR.asn1.DERGeneralizedTime,KJUR.asn1.DERAbstractTime),KJUR.asn1.DERSequence=function(e){KJUR.asn1.DERSequence.superclass.constructor.call(this,e),this.hT="30",this.getFreshValueHex=function(){for(var e="",t=0;t<this.asn1Array.length;t++){e+=this.asn1Array[t].getEncodedHex()}return this.hV=e,this.hV}},YAHOO.lang.extend(KJUR.asn1.DERSequence,KJUR.asn1.DERAbstractStructured),KJUR.asn1.DERSet=function(e){KJUR.asn1.DERSet.superclass.constructor.call(this,e),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var e=new Array,t=0;t<this.asn1Array.length;t++){var i=this.asn1Array[t];e.push(i.getEncodedHex())}return 1==this.sortFlag&&e.sort(),this.hV=e.join(""),this.hV},void 0!==e&&void 0!==e.sortflag&&0==e.sortflag&&(this.sortFlag=!1)},YAHOO.lang.extend(KJUR.asn1.DERSet,KJUR.asn1.DERAbstractStructured),KJUR.asn1.DERTaggedObject=function(e){KJUR.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(e,t,i){this.hT=t,this.isExplicit=e,this.asn1Object=i,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=i.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,t),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},void 0!==e&&(void 0!==e.tag&&(this.hT=e.tag),void 0!==e.explicit&&(this.isExplicit=e.explicit),void 0!==e.obj&&(this.asn1Object=e.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},YAHOO.lang.extend(KJUR.asn1.DERTaggedObject,KJUR.asn1.ASN1Object);var ASN1HEX=new function(){},KJUR,utf8tob64u,b64utoutf8;function stoBA(e){for(var t=new Array,i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t}function BAtos(e){for(var t="",i=0;i<e.length;i++)t+=String.fromCharCode(e[i]);return t}function BAtohex(e){for(var t="",i=0;i<e.length;i++){var n=e[i].toString(16);1==n.length&&(n="0"+n),t+=n}return t}function stohex(e){return BAtohex(stoBA(e))}function stob64(e){return hex2b64(stohex(e))}function stob64u(e){return b64tob64u(hex2b64(stohex(e)))}function b64utos(e){return BAtos(b64toBA(b64utob64(e)))}function b64tob64u(e){return e=(e=(e=e.replace(/\=/g,"")).replace(/\+/g,"-")).replace(/\//g,"_")}function b64utob64(e){return e.length%4==2?e+="==":e.length%4==3&&(e+="="),e=(e=e.replace(/-/g,"+")).replace(/_/g,"/")}function hextob64u(e){return e.length%2==1&&(e="0"+e),b64tob64u(hex2b64(e))}function b64utohex(e){return b64tohex(b64utob64(e))}function utf8tob64(e){return hex2b64(uricmptohex(encodeURIComponentAll(e)))}function b64toutf8(e){return decodeURIComponent(hextouricmp(b64tohex(e)))}function utf8tohex(e){return uricmptohex(encodeURIComponentAll(e))}function hextoutf8(e){return decodeURIComponent(hextouricmp(e))}function hextorstr(e){for(var t="",i=0;i<e.length-1;i+=2)t+=String.fromCharCode(parseInt(e.substr(i,2),16));return t}function rstrtohex(e){for(var t="",i=0;i<e.length;i++)t+=("0"+e.charCodeAt(i).toString(16)).slice(-2);return t}function hextob64(e){return hex2b64(e)}function hextob64nl(e){var t=hextob64(e).replace(/(.{64})/g,"$1\r\n");return t=t.replace(/\r\n$/,"")}function b64nltohex(e){return b64tohex(e.replace(/[^0-9A-Za-z\/+=]*/g,""))}function hextopem(e,t){return"-----BEGIN "+t+"-----\r\n"+hextob64nl(e)+"\r\n-----END "+t+"-----\r\n"}function pemtohex(e,t){if(-1==e.indexOf("-----BEGIN "))throw"can't find PEM header: "+t;return b64nltohex(e=void 0!==t?(e=e.replace("-----BEGIN "+t+"-----","")).replace("-----END "+t+"-----",""):(e=e.replace(/-----BEGIN [^-]+-----/,"")).replace(/-----END [^-]+-----/,""))}function hextoArrayBuffer(e){if(e.length%2!=0)throw"input is not even length";if(null==e.match(/^[0-9A-Fa-f]+$/))throw"input is not hexadecimal";for(var t=new ArrayBuffer(e.length/2),i=new DataView(t),n=0;n<e.length/2;n++)i.setUint8(n,parseInt(e.substr(2*n,2),16));return t}function ArrayBuffertohex(e){for(var t="",i=new DataView(e),n=0;n<e.byteLength;n++)t+=("00"+i.getUint8(n).toString(16)).slice(-2);return t}function zulutomsec(e){var t,i,n,r,s,a,o,c,l,u,h;if(h=e.match(/^(\d{2}|\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/))return c=h[1],t=parseInt(c),2===c.length&&(50<=t&&t<100?t=1900+t:0<=t&&t<50&&(t=2e3+t)),i=parseInt(h[2])-1,n=parseInt(h[3]),r=parseInt(h[4]),s=parseInt(h[5]),a=parseInt(h[6]),o=0,""!==(l=h[7])&&(u=(l.substr(1)+"00").substr(0,3),o=parseInt(u)),Date.UTC(t,i,n,r,s,a,o);throw"unsupported zulu format: "+e}function zulutosec(e){return~~(zulutomsec(e)/1e3)}function zulutodate(e){return new Date(zulutomsec(e))}function datetozulu(e,t,i){var n,r=e.getUTCFullYear();if(t){if(r<1950||2049<r)throw"not proper year for UTCTime: "+r;n=(""+r).slice(-2)}else n=("000"+r).slice(-4);if(n+=("0"+(e.getUTCMonth()+1)).slice(-2),n+=("0"+e.getUTCDate()).slice(-2),n+=("0"+e.getUTCHours()).slice(-2),n+=("0"+e.getUTCMinutes()).slice(-2),n+=("0"+e.getUTCSeconds()).slice(-2),i){var s=e.getUTCMilliseconds();0!==s&&(n+="."+(s=(s=("00"+s).slice(-3)).replace(/0+$/g,"")))}return n+="Z"}function uricmptohex(e){return e.replace(/%/g,"")}function hextouricmp(e){return e.replace(/(..)/g,"%$1")}function ipv6tohex(e){var t="malformed IPv6 address";if(!e.match(/^[0-9A-Fa-f:]+$/))throw t;var i=(e=e.toLowerCase()).split(":").length-1;if(i<2)throw t;var n=":".repeat(7-i+2),r=(e=e.replace("::",n)).split(":");if(8!=r.length)throw t;for(var s=0;s<8;s++)r[s]=("0000"+r[s]).slice(-4);return r.join("")}function hextoipv6(e){if(!e.match(/^[0-9A-Fa-f]{32}$/))throw"malformed IPv6 address octet";for(var t=(e=e.toLowerCase()).match(/.{1,4}/g),i=0;i<8;i++)t[i]=t[i].replace(/^0+/,""),""==t[i]&&(t[i]="0");var n=(e=":"+t.join(":")+":").match(/:(0:){2,}/g);if(null===n)return e.slice(1,-1);var r="";for(i=0;i<n.length;i++)n[i].length>r.length&&(r=n[i]);return(e=e.replace(r,"::")).slice(1,-1)}function hextoip(e){var t="malformed hex value";if(!e.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw t;if(8!=e.length)return 32==e.length?hextoipv6(e):e;try{return parseInt(e.substr(0,2),16)+"."+parseInt(e.substr(2,2),16)+"."+parseInt(e.substr(4,2),16)+"."+parseInt(e.substr(6,2),16)}catch(e){throw t}}function iptohex(e){var t="malformed IP address";if(!(e=e.toLowerCase(e)).match(/^[0-9.]+$/)){if(e.match(/^[0-9a-f:]+$/)&&-1!==e.indexOf(":"))return ipv6tohex(e);throw t}var i=e.split(".");if(4!==i.length)throw t;var n="";try{for(var r=0;r<4;r++){n+=("0"+parseInt(i[r]).toString(16)).slice(-2)}return n}catch(e){throw t}}function encodeURIComponentAll(e){for(var t=encodeURIComponent(e),i="",n=0;n<t.length;n++)"%"==t[n]?(i+=t.substr(n,3),n+=2):i=i+"%"+stohex(t[n]);return i}function newline_toUnix(e){return e=e.replace(/\r\n/gm,"\n")}function newline_toDos(e){return e=(e=e.replace(/\r\n/gm,"\n")).replace(/\n/gm,"\r\n")}function hextoposhex(e){return e.length%2==1?"0"+e:"7"<e.substr(0,1)?"00"+e:e}function intarystrtohex(e){e=(e=(e=e.replace(/^\s*\[\s*/,"")).replace(/\s*\]\s*$/,"")).replace(/\s*/g,"");try{return e.split(/,/).map(function(e,t,i){var n=parseInt(e);if(n<0||255<n)throw"integer not in range 0-255";return("00"+n.toString(16)).slice(-2)}).join("")}catch(e){throw"malformed integer array string: "+e}}ASN1HEX.getLblen=function(e,t){if("8"!=e.substr(t+2,1))return 1;var i=parseInt(e.substr(t+3,1));return 0==i?-1:0<i&&i<10?i+1:-2},ASN1HEX.getL=function(e,t){var i=ASN1HEX.getLblen(e,t);return i<1?"":e.substr(t+2,2*i)},ASN1HEX.getVblen=function(e,t){var i;return""==(i=ASN1HEX.getL(e,t))?-1:("8"===i.substr(0,1)?new BigInteger(i.substr(2),16):new BigInteger(i,16)).intValue()},ASN1HEX.getVidx=function(e,t){var i=ASN1HEX.getLblen(e,t);return i<0?i:t+2*(i+1)},ASN1HEX.getV=function(e,t){var i=ASN1HEX.getVidx(e,t),n=ASN1HEX.getVblen(e,t);return e.substr(i,2*n)},ASN1HEX.getTLV=function(e,t){return e.substr(t,2)+ASN1HEX.getL(e,t)+ASN1HEX.getV(e,t)},ASN1HEX.getNextSiblingIdx=function(e,t){return ASN1HEX.getVidx(e,t)+2*ASN1HEX.getVblen(e,t)},ASN1HEX.getChildIdx=function(e,t){var i=ASN1HEX,n=new Array,r=i.getVidx(e,t);"03"==e.substr(t,2)?n.push(r+2):n.push(r);for(var s=i.getVblen(e,t),a=r,o=0;;){var c=i.getNextSiblingIdx(e,a);if(null==c||2*s<=c-r)break;if(200<=o)break;n.push(c),a=c,o++}return n},ASN1HEX.getNthChildIdx=function(e,t,i){return ASN1HEX.getChildIdx(e,t)[i]},ASN1HEX.getIdxbyList=function(e,t,i,n){var r,s,a=ASN1HEX;if(0!=i.length)return r=i.shift(),s=a.getChildIdx(e,t),a.getIdxbyList(e,s[r],i,n);if(void 0!==n&&e.substr(t,2)!==n)throw"checking tag doesn't match: "+e.substr(t,2)+"!="+n;return t},ASN1HEX.getTLVbyList=function(e,t,i,n){var r=ASN1HEX,s=r.getIdxbyList(e,t,i);if(void 0===s)throw"can't find nthList object";if(void 0!==n&&e.substr(s,2)!=n)throw"checking tag doesn't match: "+e.substr(s,2)+"!="+n;return r.getTLV(e,s)},ASN1HEX.getVbyList=function(e,t,i,n,r){var s,a,o=ASN1HEX;if(void 0===(s=o.getIdxbyList(e,t,i,n)))throw"can't find nthList object";return a=o.getV(e,s),!0===r&&(a=a.substr(2)),a},ASN1HEX.hextooidstr=function(e){var t=function(e,t){return e.length>=t?e:new Array(t-e.length+1).join("0")+e},i=[],n=e.substr(0,2),r=parseInt(n,16);i[0]=new String(Math.floor(r/40)),i[1]=new String(r%40);for(var s=e.substr(2),a=[],o=0;o<s.length/2;o++)a.push(parseInt(s.substr(2*o,2),16));var c=[],l="";for(o=0;o<a.length;o++)128&a[o]?l+=t((127&a[o]).toString(2),7):(l+=t((127&a[o]).toString(2),7),c.push(new String(parseInt(l,2))),l="");var u=i.join(".");return 0<c.length&&(u=u+"."+c.join(".")),u},ASN1HEX.dump=function(e,t,i,n){var r=ASN1HEX,s=r.getV,a=r.dump,o=r.getChildIdx,c=e;e instanceof KJUR.asn1.ASN1Object&&(c=e.getEncodedHex());var l=function(e,t){return e.length<=2*t?e:e.substr(0,t)+"..(total "+e.length/2+"bytes).."+e.substr(e.length-t,t)};void 0===t&&(t={ommit_long_octet:32}),void 0===i&&(i=0),void 0===n&&(n="");var u=t.ommit_long_octet;if("01"==c.substr(i,2))return"00"==(h=s(c,i))?n+"BOOLEAN FALSE\n":n+"BOOLEAN TRUE\n";if("02"==c.substr(i,2))return n+"INTEGER "+l(h=s(c,i),u)+"\n";if("03"==c.substr(i,2))return n+"BITSTRING "+l(h=s(c,i),u)+"\n";if("04"==c.substr(i,2)){var h=s(c,i);if(r.isASN1HEX(h)){var g=n+"OCTETSTRING, encapsulates\n";return g+=a(h,t,0,n+"  ")}return n+"OCTETSTRING "+l(h,u)+"\n"}if("05"==c.substr(i,2))return n+"NULL\n";if("06"==c.substr(i,2)){var d=s(c,i),p=KJUR.asn1.ASN1Util.oidHexToInt(d),f=KJUR.asn1.x509.OID.oid2name(p),y=p.replace(/\./g," ");return""!=f?n+"ObjectIdentifier "+f+" ("+y+")\n":n+"ObjectIdentifier ("+y+")\n"}if("0c"==c.substr(i,2))return n+"UTF8String '"+hextoutf8(s(c,i))+"'\n";if("13"==c.substr(i,2))return n+"PrintableString '"+hextoutf8(s(c,i))+"'\n";if("14"==c.substr(i,2))return n+"TeletexString '"+hextoutf8(s(c,i))+"'\n";if("16"==c.substr(i,2))return n+"IA5String '"+hextoutf8(s(c,i))+"'\n";if("17"==c.substr(i,2))return n+"UTCTime "+hextoutf8(s(c,i))+"\n";if("18"==c.substr(i,2))return n+"GeneralizedTime "+hextoutf8(s(c,i))+"\n";if("30"==c.substr(i,2)){if("3000"==c.substr(i,4))return n+"SEQUENCE {}\n";g=n+"SEQUENCE\n";var m=t;if((2==(v=o(c,i)).length||3==v.length)&&"06"==c.substr(v[0],2)&&"04"==c.substr(v[v.length-1],2)){f=r.oidname(s(c,v[0]));var b=JSON.parse(JSON.stringify(t));b.x509ExtName=f,m=b}for(var I=0;I<v.length;I++)g+=a(c,m,v[I],n+"  ");return g}if("31"==c.substr(i,2)){g=n+"SET\n";var v=o(c,i);for(I=0;I<v.length;I++)g+=a(c,t,v[I],n+"  ");return g}var A=parseInt(c.substr(i,2),16);if(0==(128&A))return n+"UNKNOWN("+c.substr(i,2)+") "+s(c,i)+"\n";var C=31&A;if(0==(32&A))return"68747470"==(h=s(c,i)).substr(0,8)&&(h=hextoutf8(h)),"subjectAltName"===t.x509ExtName&&2==C&&(h=hextoutf8(h)),g=n+"["+C+"] "+h+"\n";var g=n+"["+C+"]\n";for(v=o(c,i),I=0;I<v.length;I++)g+=a(c,t,v[I],n+"  ");return g},ASN1HEX.isASN1HEX=function(e){var t=ASN1HEX;if(e.length%2==1)return!1;var i=t.getVblen(e,0),n=e.substr(0,2),r=t.getL(e,0);return e.length-n.length-r.length==2*i},ASN1HEX.oidname=function(e){var t=KJUR.asn1;KJUR.lang.String.isHex(e)&&(e=t.ASN1Util.oidHexToInt(e));var i=t.x509.OID.oid2name(e);return""===i&&(i=e),i},void 0!==KJUR&&KJUR||(KJUR={}),void 0!==KJUR.asn1&&KJUR.asn1||(KJUR.asn1={}),void 0!==KJUR.asn1.x509&&KJUR.asn1.x509||(KJUR.asn1.x509={}),KJUR.asn1.x509.Certificate=function(e){KJUR.asn1.x509.Certificate.superclass.constructor.call(this);var t=KJUR,i=(t.crypto,t.asn1),n=i.DERSequence,r=i.DERBitString;this.sign=function(){this.asn1SignatureAlg=this.asn1TBSCert.asn1SignatureAlg;var e=new KJUR.crypto.Signature({alg:this.asn1SignatureAlg.nameAlg});e.init(this.prvKey),e.updateHex(this.asn1TBSCert.getEncodedHex()),this.hexSig=e.sign(),this.asn1Sig=new r({hex:"00"+this.hexSig});var t=new n({array:[this.asn1TBSCert,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=t.getEncodedHex(),this.isModified=!1},this.setSignatureHex=function(e){this.asn1SignatureAlg=this.asn1TBSCert.asn1SignatureAlg,this.hexSig=e,this.asn1Sig=new r({hex:"00"+this.hexSig});var t=new n({array:[this.asn1TBSCert,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=t.getEncodedHex(),this.isModified=!1},this.getEncodedHex=function(){if(0==this.isModified&&null!=this.hTLV)return this.hTLV;throw"not signed yet"},this.getPEMString=function(){return"-----BEGIN CERTIFICATE-----\r\n"+hextob64nl(this.getEncodedHex())+"\r\n-----END CERTIFICATE-----\r\n"},void 0!==e&&(void 0!==e.tbscertobj&&(this.asn1TBSCert=e.tbscertobj),void 0!==e.prvkeyobj&&(this.prvKey=e.prvkeyobj))},YAHOO.lang.extend(KJUR.asn1.x509.Certificate,KJUR.asn1.ASN1Object),KJUR.asn1.x509.TBSCertificate=function(e){KJUR.asn1.x509.TBSCertificate.superclass.constructor.call(this);var t=KJUR.asn1,r=t.DERSequence,i=t.DERInteger,s=t.DERTaggedObject,n=t.x509,a=n.Time,o=n.X500Name,c=n.SubjectPublicKeyInfo;this._initialize=function(){this.asn1Array=new Array,this.asn1Version=new s({obj:new i({int:2})}),this.asn1SerialNumber=null,this.asn1SignatureAlg=null,this.asn1Issuer=null,this.asn1NotBefore=null,this.asn1NotAfter=null,this.asn1Subject=null,this.asn1SubjPKey=null,this.extensionsArray=new Array},this.setSerialNumberByParam=function(e){this.asn1SerialNumber=new i(e)},this.setSignatureAlgByParam=function(e){this.asn1SignatureAlg=new n.AlgorithmIdentifier(e)},this.setIssuerByParam=function(e){this.asn1Issuer=new o(e)},this.setNotBeforeByParam=function(e){this.asn1NotBefore=new a(e)},this.setNotAfterByParam=function(e){this.asn1NotAfter=new a(e)},this.setSubjectByParam=function(e){this.asn1Subject=new o(e)},this.setSubjectPublicKey=function(e){this.asn1SubjPKey=new c(e)},this.setSubjectPublicKeyByGetKey=function(e){var t=KEYUTIL.getKey(e);this.asn1SubjPKey=new c(t)},this.appendExtension=function(e){this.extensionsArray.push(e)},this.appendExtensionByName=function(e,t){KJUR.asn1.x509.Extension.appendByNameToArray(e,t,this.extensionsArray)},this.getEncodedHex=function(){if(null==this.asn1NotBefore||null==this.asn1NotAfter)throw"notBefore and/or notAfter not set";var e=new r({array:[this.asn1NotBefore,this.asn1NotAfter]});if(this.asn1Array=new Array,this.asn1Array.push(this.asn1Version),this.asn1Array.push(this.asn1SerialNumber),this.asn1Array.push(this.asn1SignatureAlg),this.asn1Array.push(this.asn1Issuer),this.asn1Array.push(e),this.asn1Array.push(this.asn1Subject),this.asn1Array.push(this.asn1SubjPKey),0<this.extensionsArray.length){var t=new r({array:this.extensionsArray}),i=new s({explicit:!0,tag:"a3",obj:t});this.asn1Array.push(i)}var n=new r({array:this.asn1Array});return this.hTLV=n.getEncodedHex(),this.isModified=!1,this.hTLV},this._initialize()},YAHOO.lang.extend(KJUR.asn1.x509.TBSCertificate,KJUR.asn1.ASN1Object),KJUR.asn1.x509.Extension=function(e){KJUR.asn1.x509.Extension.superclass.constructor.call(this);var t=KJUR.asn1,n=t.DERObjectIdentifier,r=t.DEROctetString,s=(t.DERBitString,t.DERBoolean),a=t.DERSequence;this.getEncodedHex=function(){var e=new n({oid:this.oid}),t=new r({hex:this.getExtnValueHex()}),i=new Array;return i.push(e),this.critical&&i.push(new s),i.push(t),new a({array:i}).getEncodedHex()},this.critical=!1,void 0!==e&&void 0!==e.critical&&(this.critical=e.critical)},YAHOO.lang.extend(KJUR.asn1.x509.Extension,KJUR.asn1.ASN1Object),KJUR.asn1.x509.Extension.appendByNameToArray=function(e,t,i){var n=e.toLowerCase(),r=KJUR.asn1.x509;if("basicconstraints"==n){var s=new r.BasicConstraints(t);i.push(s)}else if("keyusage"==n){s=new r.KeyUsage(t);i.push(s)}else if("crldistributionpoints"==n){s=new r.CRLDistributionPoints(t);i.push(s)}else if("extkeyusage"==n){s=new r.ExtKeyUsage(t);i.push(s)}else if("authoritykeyidentifier"==n){s=new r.AuthorityKeyIdentifier(t);i.push(s)}else if("authorityinfoaccess"==n){s=new r.AuthorityInfoAccess(t);i.push(s)}else if("subjectaltname"==n){s=new r.SubjectAltName(t);i.push(s)}else{if("issueraltname"!=n)throw"unsupported extension name: "+e;s=new r.IssuerAltName(t);i.push(s)}},KJUR.asn1.x509.KeyUsage=function(e){KJUR.asn1.x509.KeyUsage.superclass.constructor.call(this,e);var t=X509.KEYUSAGE_NAME;if(this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.15",void 0!==e&&(void 0!==e.bin&&(this.asn1ExtnValue=new KJUR.asn1.DERBitString(e)),void 0!==e.names&&void 0!==e.names.length)){for(var i=e.names,n="000000000",r=0;r<i.length;r++)for(var s=0;s<t.length;s++)i[r]===t[s]&&(n=n.substring(0,s)+"1"+n.substring(s+1,n.length));this.asn1ExtnValue=new KJUR.asn1.DERBitString({bin:n})}},YAHOO.lang.extend(KJUR.asn1.x509.KeyUsage,KJUR.asn1.x509.Extension),KJUR.asn1.x509.BasicConstraints=function(e){KJUR.asn1.x509.BasicConstraints.superclass.constructor.call(this,e),this.getExtnValueHex=function(){var e=new Array;this.cA&&e.push(new KJUR.asn1.DERBoolean),-1<this.pathLen&&e.push(new KJUR.asn1.DERInteger({int:this.pathLen}));var t=new KJUR.asn1.DERSequence({array:e});return this.asn1ExtnValue=t,this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.19",this.cA=!1,this.pathLen=-1,void 0!==e&&(void 0!==e.cA&&(this.cA=e.cA),void 0!==e.pathLen&&(this.pathLen=e.pathLen))},YAHOO.lang.extend(KJUR.asn1.x509.BasicConstraints,KJUR.asn1.x509.Extension),KJUR.asn1.x509.CRLDistributionPoints=function(e){KJUR.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,e);var t=KJUR.asn1,r=t.x509;this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.setByDPArray=function(e){this.asn1ExtnValue=new t.DERSequence({array:e})},this.setByOneURI=function(e){var t=new r.GeneralNames([{uri:e}]),i=new r.DistributionPointName(t),n=new r.DistributionPoint({dpobj:i});this.setByDPArray([n])},this.oid="2.5.29.31",void 0!==e&&(void 0!==e.array?this.setByDPArray(e.array):void 0!==e.uri&&this.setByOneURI(e.uri))},YAHOO.lang.extend(KJUR.asn1.x509.CRLDistributionPoints,KJUR.asn1.x509.Extension),KJUR.asn1.x509.ExtKeyUsage=function(e){KJUR.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,e);var n=KJUR.asn1;this.setPurposeArray=function(e){this.asn1ExtnValue=new n.DERSequence;for(var t=0;t<e.length;t++){var i=new n.DERObjectIdentifier(e[t]);this.asn1ExtnValue.appendASN1Object(i)}},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.37",void 0!==e&&void 0!==e.array&&this.setPurposeArray(e.array)},YAHOO.lang.extend(KJUR.asn1.x509.ExtKeyUsage,KJUR.asn1.x509.Extension),KJUR.asn1.x509.AuthorityKeyIdentifier=function(e){KJUR.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,e);var i=KJUR.asn1,n=i.DERTaggedObject;this.asn1KID=null,this.asn1CertIssuer=null,this.asn1CertSN=null,this.getExtnValueHex=function(){var e=new Array;this.asn1KID&&e.push(new n({explicit:!1,tag:"80",obj:this.asn1KID})),this.asn1CertIssuer&&e.push(new n({explicit:!1,tag:"a1",obj:this.asn1CertIssuer})),this.asn1CertSN&&e.push(new n({explicit:!1,tag:"82",obj:this.asn1CertSN}));var t=new i.DERSequence({array:e});return this.asn1ExtnValue=t,this.asn1ExtnValue.getEncodedHex()},this.setKIDByParam=function(e){this.asn1KID=new KJUR.asn1.DEROctetString(e)},this.setCertIssuerByParam=function(e){this.asn1CertIssuer=new KJUR.asn1.x509.X500Name(e)},this.setCertSNByParam=function(e){this.asn1CertSN=new KJUR.asn1.DERInteger(e)},this.oid="2.5.29.35",void 0!==e&&(void 0!==e.kid&&this.setKIDByParam(e.kid),void 0!==e.issuer&&this.setCertIssuerByParam(e.issuer),void 0!==e.sn&&this.setCertSNByParam(e.sn))},YAHOO.lang.extend(KJUR.asn1.x509.AuthorityKeyIdentifier,KJUR.asn1.x509.Extension),KJUR.asn1.x509.AuthorityInfoAccess=function(e){KJUR.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this,e),this.setAccessDescriptionArray=function(e){for(var t=new Array,i=KJUR.asn1,n=i.DERSequence,r=0;r<e.length;r++){var s=new n({array:[new i.DERObjectIdentifier(e[r].accessMethod),new i.x509.GeneralName(e[r].accessLocation)]});t.push(s)}this.asn1ExtnValue=new n({array:t})},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="1.3.6.1.5.5.7.1.1",void 0!==e&&void 0!==e.array&&this.setAccessDescriptionArray(e.array)},YAHOO.lang.extend(KJUR.asn1.x509.AuthorityInfoAccess,KJUR.asn1.x509.Extension),KJUR.asn1.x509.SubjectAltName=function(e){KJUR.asn1.x509.SubjectAltName.superclass.constructor.call(this,e),this.setNameArray=function(e){this.asn1ExtnValue=new KJUR.asn1.x509.GeneralNames(e)},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.17",void 0!==e&&void 0!==e.array&&this.setNameArray(e.array)},YAHOO.lang.extend(KJUR.asn1.x509.SubjectAltName,KJUR.asn1.x509.Extension),KJUR.asn1.x509.IssuerAltName=function(e){KJUR.asn1.x509.IssuerAltName.superclass.constructor.call(this,e),this.setNameArray=function(e){this.asn1ExtnValue=new KJUR.asn1.x509.GeneralNames(e)},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.18",void 0!==e&&void 0!==e.array&&this.setNameArray(e.array)},YAHOO.lang.extend(KJUR.asn1.x509.IssuerAltName,KJUR.asn1.x509.Extension),KJUR.asn1.x509.CRL=function(e){KJUR.asn1.x509.CRL.superclass.constructor.call(this),this.sign=function(){this.asn1SignatureAlg=this.asn1TBSCertList.asn1SignatureAlg,sig=new KJUR.crypto.Signature({alg:"SHA1withRSA",prov:"cryptojs/jsrsa"}),sig.init(this.prvKey),sig.updateHex(this.asn1TBSCertList.getEncodedHex()),this.hexSig=sig.sign(),this.asn1Sig=new KJUR.asn1.DERBitString({hex:"00"+this.hexSig});var e=new KJUR.asn1.DERSequence({array:[this.asn1TBSCertList,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=e.getEncodedHex(),this.isModified=!1},this.getEncodedHex=function(){if(0==this.isModified&&null!=this.hTLV)return this.hTLV;throw"not signed yet"},this.getPEMString=function(){return"-----BEGIN X509 CRL-----\r\n"+hextob64nl(this.getEncodedHex())+"\r\n-----END X509 CRL-----\r\n"},void 0!==e&&(void 0!==e.tbsobj&&(this.asn1TBSCertList=e.tbsobj),void 0!==e.prvkeyobj&&(this.prvKey=e.prvkeyobj))},YAHOO.lang.extend(KJUR.asn1.x509.CRL,KJUR.asn1.ASN1Object),KJUR.asn1.x509.TBSCertList=function(e){KJUR.asn1.x509.TBSCertList.superclass.constructor.call(this);var t=KJUR.asn1,i=t.DERSequence,r=t.x509,n=r.Time;this.setSignatureAlgByParam=function(e){this.asn1SignatureAlg=new r.AlgorithmIdentifier(e)},this.setIssuerByParam=function(e){this.asn1Issuer=new r.X500Name(e)},this.setThisUpdateByParam=function(e){this.asn1ThisUpdate=new n(e)},this.setNextUpdateByParam=function(e){this.asn1NextUpdate=new n(e)},this.addRevokedCert=function(e,t){var i={};null!=e&&null!=e&&(i.sn=e),null!=t&&null!=t&&(i.time=t);var n=new r.CRLEntry(i);this.aRevokedCert.push(n)},this.getEncodedHex=function(){if(this.asn1Array=new Array,null!=this.asn1Version&&this.asn1Array.push(this.asn1Version),this.asn1Array.push(this.asn1SignatureAlg),this.asn1Array.push(this.asn1Issuer),this.asn1Array.push(this.asn1ThisUpdate),null!=this.asn1NextUpdate&&this.asn1Array.push(this.asn1NextUpdate),0<this.aRevokedCert.length){var e=new i({array:this.aRevokedCert});this.asn1Array.push(e)}var t=new i({array:this.asn1Array});return this.hTLV=t.getEncodedHex(),this.isModified=!1,this.hTLV},this._initialize=function(){this.asn1Version=null,this.asn1SignatureAlg=null,this.asn1Issuer=null,this.asn1ThisUpdate=null,this.asn1NextUpdate=null,this.aRevokedCert=new Array},this._initialize()},YAHOO.lang.extend(KJUR.asn1.x509.TBSCertList,KJUR.asn1.ASN1Object),KJUR.asn1.x509.CRLEntry=function(e){KJUR.asn1.x509.CRLEntry.superclass.constructor.call(this);var t=KJUR.asn1;this.setCertSerial=function(e){this.sn=new t.DERInteger(e)},this.setRevocationDate=function(e){this.time=new t.x509.Time(e)},this.getEncodedHex=function(){var e=new t.DERSequence({array:[this.sn,this.time]});return this.TLV=e.getEncodedHex(),this.TLV},void 0!==e&&(void 0!==e.time&&this.setRevocationDate(e.time),void 0!==e.sn&&this.setCertSerial(e.sn))},YAHOO.lang.extend(KJUR.asn1.x509.CRLEntry,KJUR.asn1.ASN1Object),KJUR.asn1.x509.X500Name=function(e){KJUR.asn1.x509.X500Name.superclass.constructor.call(this),this.asn1Array=new Array;var t=KJUR.asn1,s=t.x509,i=pemtohex;if(this.setByString=function(e){var t=e.split("/");t.shift();for(var i=[],n=0;n<t.length;n++)if(t[n].match(/^[^=]+=.+$/))i.push(t[n]);else{var r=i.length-1;i[r]=i[r]+"/"+t[n]}for(n=0;n<i.length;n++)this.asn1Array.push(new s.RDN({str:i[n]}))},this.setByLdapString=function(e){var t=s.X500Name.ldapToOneline(e);this.setByString(t)},this.setByObject=function(e){for(var t in e)if(e.hasOwnProperty(t)){var i=new KJUR.asn1.x509.RDN({str:t+"="+e[t]});this.asn1Array?this.asn1Array.push(i):this.asn1Array=[i]}},this.getEncodedHex=function(){if("string"==typeof this.hTLV)return this.hTLV;var e=new t.DERSequence({array:this.asn1Array});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==e){var n;if(void 0!==e.str?this.setByString(e.str):void 0!==e.ldapstr?this.setByLdapString(e.ldapstr):"object"==typeof e&&this.setByObject(e),void 0!==e.certissuer)(n=new X509).hex=i(e.certissuer),this.hTLV=n.getIssuerHex();if(void 0!==e.certsubject)(n=new X509).hex=i(e.certsubject),this.hTLV=n.getSubjectHex()}},YAHOO.lang.extend(KJUR.asn1.x509.X500Name,KJUR.asn1.ASN1Object),KJUR.asn1.x509.X500Name.onelineToLDAP=function(e){if("/"!==e.substr(0,1))throw"malformed input";var t=(e=e.substr(1)).split("/");return t.reverse(),(t=t.map(function(e){return e.replace(/,/,"\\,")})).join(",")},KJUR.asn1.x509.X500Name.ldapToOneline=function(e){for(var t=e.split(","),i=!1,n=[],r=0;0<t.length;r++){var s=t.shift();if(!0===i){var a=(n.pop()+","+s).replace(/\\,/g,",");n.push(a),i=!1}else n.push(s);"\\"===s.substr(-1,1)&&(i=!0)}return(n=n.map(function(e){return e.replace("/","\\/")})).reverse(),"/"+n.join("/")},KJUR.asn1.x509.RDN=function(e){KJUR.asn1.x509.RDN.superclass.constructor.call(this),this.asn1Array=new Array,this.addByString=function(e){this.asn1Array.push(new KJUR.asn1.x509.AttributeTypeAndValue({str:e}))},this.addByMultiValuedString=function(e){for(var t=KJUR.asn1.x509.RDN.parseString(e),i=0;i<t.length;i++)this.addByString(t[i])},this.getEncodedHex=function(){var e=new KJUR.asn1.DERSet({array:this.asn1Array});return this.TLV=e.getEncodedHex(),this.TLV},void 0!==e&&void 0!==e.str&&this.addByMultiValuedString(e.str)},YAHOO.lang.extend(KJUR.asn1.x509.RDN,KJUR.asn1.ASN1Object),KJUR.asn1.x509.RDN.parseString=function(e){for(var t=e.split(/\+/),i=!1,n=[],r=0;0<t.length;r++){var s=t.shift();if(!0===i){var a=(n.pop()+"+"+s).replace(/\\\+/g,"+");n.push(a),i=!1}else n.push(s);"\\"===s.substr(-1,1)&&(i=!0)}var o=!1,c=[];for(r=0;0<n.length;r++){s=n.shift();if(!0===o){var l=c.pop();if(s.match(/"$/)){a=(l+"+"+s).replace(/^([^=]+)="(.*)"$/,"$1=$2");c.push(a),o=!1}else c.push(l+"+"+s)}else c.push(s);s.match(/^[^=]+="/)&&(o=!0)}return c},KJUR.asn1.x509.AttributeTypeAndValue=function(e){KJUR.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this);var i=KJUR.asn1;this.setByString=function(e){var t=e.match(/^([^=]+)=(.+)$/);if(!t)throw"malformed attrTypeAndValueStr: "+e;this.setByAttrTypeAndValueStr(t[1],t[2])},this.setByAttrTypeAndValueStr=function(e,t){this.typeObj=KJUR.asn1.x509.OID.atype2obj(e);var i="utf8";"C"==e&&(i="prn"),this.valueObj=this.getValueObj(i,t)},this.getValueObj=function(e,t){if("utf8"==e)return new i.DERUTF8String({str:t});if("prn"==e)return new i.DERPrintableString({str:t});if("tel"==e)return new i.DERTeletexString({str:t});if("ia5"==e)return new i.DERIA5String({str:t});throw"unsupported directory string type: type="+e+" value="+t},this.getEncodedHex=function(){var e=new i.DERSequence({array:[this.typeObj,this.valueObj]});return this.TLV=e.getEncodedHex(),this.TLV},void 0!==e&&void 0!==e.str&&this.setByString(e.str)},YAHOO.lang.extend(KJUR.asn1.x509.AttributeTypeAndValue,KJUR.asn1.ASN1Object),KJUR.asn1.x509.SubjectPublicKeyInfo=function(e){KJUR.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);var t=KJUR,i=t.asn1,r=i.DERInteger,s=i.DERBitString,a=i.DERObjectIdentifier,n=i.DERSequence,o=i.ASN1Util.newObject,c=i.x509.AlgorithmIdentifier,l=t.crypto;l.ECDSA,l.DSA;this.getASN1Object=function(){if(null==this.asn1AlgId||null==this.asn1SubjPKey)throw"algId and/or subjPubKey not set";return new n({array:[this.asn1AlgId,this.asn1SubjPKey]})},this.getEncodedHex=function(){var e=this.getASN1Object();return this.hTLV=e.getEncodedHex(),this.hTLV},this.setPubKey=function(e){try{if(e instanceof RSAKey){var t=o({seq:[{int:{bigint:e.n}},{int:{int:e.e}}]}).getEncodedHex();this.asn1AlgId=new c({name:"rsaEncryption"}),this.asn1SubjPKey=new s({hex:"00"+t})}}catch(e){}try{if(e instanceof KJUR.crypto.ECDSA){var i=new a({name:e.curveName});this.asn1AlgId=new c({name:"ecPublicKey",asn1params:i}),this.asn1SubjPKey=new s({hex:"00"+e.pubKeyHex})}}catch(e){}try{if(e instanceof KJUR.crypto.DSA){i=new o({seq:[{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.g}}]});this.asn1AlgId=new c({name:"dsa",asn1params:i});var n=new r({bigint:e.y});this.asn1SubjPKey=new s({hex:"00"+n.getEncodedHex()})}}catch(e){}},void 0!==e&&this.setPubKey(e)},YAHOO.lang.extend(KJUR.asn1.x509.SubjectPublicKeyInfo,KJUR.asn1.ASN1Object),KJUR.asn1.x509.Time=function(e){KJUR.asn1.x509.Time.superclass.constructor.call(this);var t=KJUR.asn1,i=t.DERUTCTime,n=t.DERGeneralizedTime;this.setTimeParams=function(e){this.timeParams=e},this.getEncodedHex=function(){var e=null;return e=null!=this.timeParams?"utc"==this.type?new i(this.timeParams):new n(this.timeParams):"utc"==this.type?new i:new n,this.TLV=e.getEncodedHex(),this.TLV},this.type="utc",void 0!==e&&(void 0!==e.type?this.type=e.type:void 0!==e.str&&(e.str.match(/^[0-9]{12}Z$/)&&(this.type="utc"),e.str.match(/^[0-9]{14}Z$/)&&(this.type="gen")),this.timeParams=e)},YAHOO.lang.extend(KJUR.asn1.x509.Time,KJUR.asn1.ASN1Object),KJUR.asn1.x509.AlgorithmIdentifier=function(e){KJUR.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this),this.nameAlg=null,this.asn1Alg=null,this.asn1Params=null,this.paramEmpty=!1;var i=KJUR.asn1;if(this.getEncodedHex=function(){if(null===this.nameAlg&&null===this.asn1Alg)throw"algorithm not specified";null!==this.nameAlg&&null===this.asn1Alg&&(this.asn1Alg=i.x509.OID.name2obj(this.nameAlg));var e=[this.asn1Alg];null!==this.asn1Params&&e.push(this.asn1Params);var t=new i.DERSequence({array:e});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==e&&(void 0!==e.name&&(this.nameAlg=e.name),void 0!==e.asn1params&&(this.asn1Params=e.asn1params),void 0!==e.paramempty&&(this.paramEmpty=e.paramempty)),null===this.asn1Params&&!1===this.paramEmpty&&null!==this.nameAlg){var t=this.nameAlg.toLowerCase();"withdsa"!==t.substr(-7,7)&&"withecdsa"!==t.substr(-9,9)&&(this.asn1Params=new i.DERNull)}},YAHOO.lang.extend(KJUR.asn1.x509.AlgorithmIdentifier,KJUR.asn1.ASN1Object),KJUR.asn1.x509.GeneralName=function(e){KJUR.asn1.x509.GeneralName.superclass.constructor.call(this);var l={rfc822:"81",dns:"82",dn:"a4",uri:"86",ip:"87"},t=KJUR.asn1,u=(t.DERSequence,t.DEROctetString),h=t.DERIA5String,g=t.DERTaggedObject,d=t.ASN1Object,p=t.x509.X500Name,f=pemtohex;this.explicit=!1,this.setByParam=function(e){var t=null;if(void 0!==e){if(void 0!==e.rfc822&&(this.type="rfc822",t=new h({str:e[this.type]})),void 0!==e.dns&&(this.type="dns",t=new h({str:e[this.type]})),void 0!==e.uri&&(this.type="uri",t=new h({str:e[this.type]})),void 0!==e.dn&&(this.type="dn",this.explicit=!0,t=new p({str:e.dn})),void 0!==e.ldapdn&&(this.type="dn",this.explicit=!0,t=new p({ldapstr:e.ldapdn})),void 0!==e.certissuer){this.type="dn",this.explicit=!0;var i=null;if((r=e.certissuer).match(/^[0-9A-Fa-f]+$/),-1!=r.indexOf("-----BEGIN ")&&(i=f(r)),null==i)throw"certissuer param not cert";(s=new X509).hex=i;var n=s.getIssuerHex();(t=new d).hTLV=n}if(void 0!==e.certsubj){this.type="dn",this.explicit=!0;var r,s;i=null;if((r=e.certsubj).match(/^[0-9A-Fa-f]+$/),-1!=r.indexOf("-----BEGIN ")&&(i=f(r)),null==i)throw"certsubj param not cert";(s=new X509).hex=i;n=s.getSubjectHex();(t=new d).hTLV=n}if(void 0!==e.ip){this.type="ip",this.explicit=!1;var a,o=e.ip,c="malformed IP address";if(o.match(/^[0-9.]+[.][0-9.]+$/)){if(8!==(a=intarystrtohex("["+o.split(".").join(",")+"]")).length)throw c}else if(o.match(/^[0-9A-Fa-f:]+:[0-9A-Fa-f:]+$/))a=ipv6tohex(o);else{if(!o.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw c;a=o}t=new u({hex:a})}if(null==this.type)throw"unsupported type in params="+e;this.asn1Obj=new g({explicit:this.explicit,tag:l[this.type],obj:t})}},this.getEncodedHex=function(){return this.asn1Obj.getEncodedHex()},void 0!==e&&this.setByParam(e)},YAHOO.lang.extend(KJUR.asn1.x509.GeneralName,KJUR.asn1.ASN1Object),KJUR.asn1.x509.GeneralNames=function(e){KJUR.asn1.x509.GeneralNames.superclass.constructor.call(this);var n=KJUR.asn1;this.setByParamArray=function(e){for(var t=0;t<e.length;t++){var i=new n.x509.GeneralName(e[t]);this.asn1Array.push(i)}},this.getEncodedHex=function(){return new n.DERSequence({array:this.asn1Array}).getEncodedHex()},this.asn1Array=new Array,void 0!==e&&this.setByParamArray(e)},YAHOO.lang.extend(KJUR.asn1.x509.GeneralNames,KJUR.asn1.ASN1Object),KJUR.asn1.x509.DistributionPointName=function(e){KJUR.asn1.x509.DistributionPointName.superclass.constructor.call(this);var t=KJUR.asn1,i=t.DERTaggedObject;if(this.getEncodedHex=function(){if("full"!=this.type)throw"currently type shall be 'full': "+this.type;return this.asn1Obj=new i({explicit:!1,tag:this.tag,obj:this.asn1V}),this.hTLV=this.asn1Obj.getEncodedHex(),this.hTLV},void 0!==e){if(!t.x509.GeneralNames.prototype.isPrototypeOf(e))throw"This class supports GeneralNames only as argument";this.type="full",this.tag="a0",this.asn1V=e}},YAHOO.lang.extend(KJUR.asn1.x509.DistributionPointName,KJUR.asn1.ASN1Object),KJUR.asn1.x509.DistributionPoint=function(e){KJUR.asn1.x509.DistributionPoint.superclass.constructor.call(this);var i=KJUR.asn1;this.getEncodedHex=function(){var e=new i.DERSequence;if(null!=this.asn1DP){var t=new i.DERTaggedObject({explicit:!0,tag:"a0",obj:this.asn1DP});e.appendASN1Object(t)}return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==e&&void 0!==e.dpobj&&(this.asn1DP=e.dpobj)},YAHOO.lang.extend(KJUR.asn1.x509.DistributionPoint,KJUR.asn1.ASN1Object),KJUR.asn1.x509.OID=new function(e){this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",T:"2.5.4.12",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",serialNumber:"2.5.4.5",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"},this.name2oidList={sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",countryName:"2.5.4.6",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",streetAddress:"2.5.4.9",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",title:"2.5.4.12",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",ecPublicKey:"1.2.840.10045.2.1",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",extensionRequest:"1.2.840.113549.1.9.14"},this.objCache={},this.name2obj=function(e){if(void 0!==this.objCache[e])return this.objCache[e];if(void 0===this.name2oidList[e])throw"Name of ObjectIdentifier not defined: "+e;var t=this.name2oidList[e],i=new KJUR.asn1.DERObjectIdentifier({oid:t});return this.objCache[e]=i},this.atype2obj=function(e){if(void 0!==this.objCache[e])return this.objCache[e];if(void 0===this.atype2oidList[e])throw"AttributeType name undefined: "+e;var t=this.atype2oidList[e],i=new KJUR.asn1.DERObjectIdentifier({oid:t});return this.objCache[e]=i}},KJUR.asn1.x509.OID.oid2name=function(e){var t=KJUR.asn1.x509.OID.name2oidList;for(var i in t)if(t[i]==e)return i;return""},KJUR.asn1.x509.OID.oid2atype=function(e){var t=KJUR.asn1.x509.OID.atype2oidList;for(var i in t)if(t[i]==e)return i;return e},KJUR.asn1.x509.OID.name2oid=function(e){var t=KJUR.asn1.x509.OID.name2oidList;return void 0===t[e]?"":t[e]},KJUR.asn1.x509.X509Util={},KJUR.asn1.x509.X509Util.newCertPEM=function(e){var t=KJUR.asn1.x509,i=t.TBSCertificate,n=t.Certificate,r=new i;if(void 0===e.serial)throw"serial number undefined.";if(r.setSerialNumberByParam(e.serial),"string"!=typeof e.sigalg.name)throw"unproper signature algorithm name";if(r.setSignatureAlgByParam(e.sigalg),void 0===e.issuer)throw"issuer name undefined.";if(r.setIssuerByParam(e.issuer),void 0===e.notbefore)throw"notbefore undefined.";if(r.setNotBeforeByParam(e.notbefore),void 0===e.notafter)throw"notafter undefined.";if(r.setNotAfterByParam(e.notafter),void 0===e.subject)throw"subject name undefined.";if(r.setSubjectByParam(e.subject),void 0===e.sbjpubkey)throw"subject public key undefined.";if(r.setSubjectPublicKeyByGetKey(e.sbjpubkey),void 0!==e.ext&&void 0!==e.ext.length)for(var s=0;s<e.ext.length;s++)for(key in e.ext[s])r.appendExtensionByName(key,e.ext[s][key]);if(void 0===e.cakey&&void 0===e.sighex)throw"param cakey and sighex undefined.";var a=null;return e.cakey&&(a=new n({tbscertobj:r,prvkeyobj:!0===e.cakey.isPrivate?e.cakey:KEYUTIL.getKey.apply(null,e.cakey)})).sign(),e.sighex&&(a=new n({tbscertobj:r})).setSignatureHex(e.sighex),a.getPEMString()},void 0!==KJUR&&KJUR||(KJUR={}),void 0!==KJUR.asn1&&KJUR.asn1||(KJUR.asn1={}),void 0!==KJUR.asn1.cms&&KJUR.asn1.cms||(KJUR.asn1.cms={}),KJUR.asn1.cms.Attribute=function(e){var n=KJUR.asn1;n.cms.Attribute.superclass.constructor.call(this),this.getEncodedHex=function(){var e,t,i;e=new n.DERObjectIdentifier({oid:this.attrTypeOid}),t=new n.DERSet({array:this.valueList});try{t.getEncodedHex()}catch(e){throw"fail valueSet.getEncodedHex in Attribute(1)/"+e}i=new n.DERSequence({array:[e,t]});try{this.hTLV=i.getEncodedHex()}catch(e){throw"failed seq.getEncodedHex in Attribute(2)/"+e}return this.hTLV}},YAHOO.lang.extend(KJUR.asn1.cms.Attribute,KJUR.asn1.ASN1Object),KJUR.asn1.cms.ContentType=function(e){var t=KJUR.asn1;t.cms.ContentType.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.3";var i=null;if(void 0!==e){i=new t.DERObjectIdentifier(e);this.valueList=[i]}},YAHOO.lang.extend(KJUR.asn1.cms.ContentType,KJUR.asn1.cms.Attribute),KJUR.asn1.cms.MessageDigest=function(e){var t=KJUR,i=t.asn1,n=i.DEROctetString,r=i.cms;if(r.MessageDigest.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.4",void 0!==e)if(e.eciObj instanceof r.EncapsulatedContentInfo&&"string"==typeof e.hashAlg){var s=e.eciObj.eContentValueHex,a=e.hashAlg;(o=new n({hex:t.crypto.Util.hashHex(s,a)})).getEncodedHex(),this.valueList=[o]}else{var o;(o=new n(e)).getEncodedHex(),this.valueList=[o]}},YAHOO.lang.extend(KJUR.asn1.cms.MessageDigest,KJUR.asn1.cms.Attribute),KJUR.asn1.cms.SigningTime=function(e){var t=KJUR.asn1;if(t.cms.SigningTime.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.5",void 0!==e){var i=new t.x509.Time(e);try{i.getEncodedHex()}catch(e){throw"SigningTime.getEncodedHex() failed/"+e}this.valueList=[i]}},YAHOO.lang.extend(KJUR.asn1.cms.SigningTime,KJUR.asn1.cms.Attribute),KJUR.asn1.cms.SigningCertificate=function(e){var l=KJUR,u=l.asn1,h=u.DERSequence,g=u.cms;l.crypto;g.SigningCertificate.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.12",this.setCerts=function(e){for(var t=[],i=0;i<e.length;i++){var n=pemtohex(e[i]),r=l.crypto.Util.hashHex(n,"sha1"),s=new u.DEROctetString({hex:r});s.getEncodedHex();var a=new g.IssuerAndSerialNumber({cert:e[i]});a.getEncodedHex();var o=new h({array:[s,a]});o.getEncodedHex(),t.push(o)}var c=new h({array:t});c.getEncodedHex(),this.valueList=[c]},void 0!==e&&"object"==typeof e.array&&this.setCerts(e.array)},YAHOO.lang.extend(KJUR.asn1.cms.SigningCertificate,KJUR.asn1.cms.Attribute),KJUR.asn1.cms.SigningCertificateV2=function(e){var t=KJUR,h=t.asn1,g=h.DERSequence,d=h.x509,p=h.cms,f=t.crypto;if(p.SigningCertificateV2.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.47",this.setCerts=function(e,t){for(var i=[],n=0;n<e.length;n++){var r=pemtohex(e[n]),s=[];"sha256"!==t&&s.push(new d.AlgorithmIdentifier({name:t}));var a=f.Util.hashHex(r,t),o=new h.DEROctetString({hex:a});o.getEncodedHex(),s.push(o);var c=new p.IssuerAndSerialNumber({cert:e[n]});c.getEncodedHex(),s.push(c);var l=new g({array:s});l.getEncodedHex(),i.push(l)}var u=new g({array:i});u.getEncodedHex(),this.valueList=[u]},void 0!==e&&"object"==typeof e.array){var i="sha256";"string"==typeof e.hashAlg&&(i=e.hashAlg),this.setCerts(e.array,i)}},YAHOO.lang.extend(KJUR.asn1.cms.SigningCertificateV2,KJUR.asn1.cms.Attribute),KJUR.asn1.cms.IssuerAndSerialNumber=function(e){var t=KJUR.asn1,s=t.DERInteger,i=t.cms,a=t.x509.X500Name,o=X509;i.IssuerAndSerialNumber.superclass.constructor.call(this),this.setByCertPEM=function(e){var t=pemtohex(e),i=new o;i.hex=t;var n=i.getIssuerHex();this.dIssuer=new a,this.dIssuer.hTLV=n;var r=i.getSerialNumberHex();this.dSerial=new s({hex:r})},this.getEncodedHex=function(){var e=new t.DERSequence({array:[this.dIssuer,this.dSerial]});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==e&&("string"==typeof e&&-1!=e.indexOf("-----BEGIN ")&&this.setByCertPEM(e),e.issuer&&e.serial&&(e.issuer instanceof a?this.dIssuer=e.issuer:this.dIssuer=new a(e.issuer),e.serial instanceof s?this.dSerial=e.serial:this.dSerial=new s(e.serial)),"string"==typeof e.cert&&this.setByCertPEM(e.cert))},YAHOO.lang.extend(KJUR.asn1.cms.IssuerAndSerialNumber,KJUR.asn1.ASN1Object),KJUR.asn1.cms.AttributeList=function(e){var t=KJUR.asn1,i=t.cms;i.AttributeList.superclass.constructor.call(this),this.list=new Array,this.sortFlag=!0,this.add=function(e){e instanceof i.Attribute&&this.list.push(e)},this.length=function(){return this.list.length},this.clear=function(){this.list=new Array,this.hTLV=null,this.hV=null},this.getEncodedHex=function(){if("string"==typeof this.hTLV)return this.hTLV;var e=new t.DERSet({array:this.list,sortflag:this.sortFlag});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==e&&void 0!==e.sortflag&&0==e.sortflag&&(this.sortFlag=!1)},YAHOO.lang.extend(KJUR.asn1.cms.AttributeList,KJUR.asn1.ASN1Object),KJUR.asn1.cms.SignerInfo=function(e){var t=KJUR,a=t.asn1,r=a.DERTaggedObject,i=a.cms,s=i.AttributeList,n=i.ContentType,o=i.EncapsulatedContentInfo,c=i.MessageDigest,l=i.SignedData,u=a.x509.AlgorithmIdentifier,h=t.crypto,g=KEYUTIL;i.SignerInfo.superclass.constructor.call(this),this.dCMSVersion=new a.DERInteger({int:1}),this.dSignerIdentifier=null,this.dDigestAlgorithm=null,this.dSignedAttrs=new s,this.dSigAlg=null,this.dSig=null,this.dUnsignedAttrs=new s,this.setSignerIdentifier=function(e){"string"==typeof e&&-1!=e.indexOf("CERTIFICATE")&&-1!=e.indexOf("BEGIN")&&-1!=e.indexOf("END")&&(this.dSignerIdentifier=new i.IssuerAndSerialNumber({cert:e}))},this.setForContentAndHash=function(e){void 0!==e&&(e.eciObj instanceof o&&(this.dSignedAttrs.add(new n({oid:"1.2.840.113549.1.7.1"})),this.dSignedAttrs.add(new c({eciObj:e.eciObj,hashAlg:e.hashAlg}))),void 0!==e.sdObj&&e.sdObj instanceof l&&-1==e.sdObj.digestAlgNameList.join(":").indexOf(e.hashAlg)&&e.sdObj.digestAlgNameList.push(e.hashAlg),"string"==typeof e.hashAlg&&(this.dDigestAlgorithm=new u({name:e.hashAlg})))},this.sign=function(e,t){this.dSigAlg=new u({name:t});var i=this.dSignedAttrs.getEncodedHex(),n=g.getKey(e),r=new h.Signature({alg:t});r.init(n),r.updateHex(i);var s=r.sign();this.dSig=new a.DEROctetString({hex:s})},this.addUnsigned=function(e){this.hTLV=null,this.dUnsignedAttrs.hTLV=null,this.dUnsignedAttrs.add(e)},this.getEncodedHex=function(){if(this.dSignedAttrs instanceof s&&0==this.dSignedAttrs.length())throw"SignedAttrs length = 0 (empty)";var e=new r({obj:this.dSignedAttrs,tag:"a0",explicit:!1}),t=null;0<this.dUnsignedAttrs.length()&&(t=new r({obj:this.dUnsignedAttrs,tag:"a1",explicit:!1}));var i=[this.dCMSVersion,this.dSignerIdentifier,this.dDigestAlgorithm,e,this.dSigAlg,this.dSig];null!=t&&i.push(t);var n=new a.DERSequence({array:i});return this.hTLV=n.getEncodedHex(),this.hTLV}},YAHOO.lang.extend(KJUR.asn1.cms.SignerInfo,KJUR.asn1.ASN1Object),KJUR.asn1.cms.EncapsulatedContentInfo=function(e){var t=KJUR.asn1,n=t.DERTaggedObject,r=t.DERSequence,i=t.DERObjectIdentifier,s=t.DEROctetString;t.cms.EncapsulatedContentInfo.superclass.constructor.call(this),this.dEContentType=new i({name:"data"}),this.dEContent=null,this.isDetached=!1,this.eContentValueHex=null,this.setContentType=function(e){e.match(/^[0-2][.][0-9.]+$/)?this.dEContentType=new i({oid:e}):this.dEContentType=new i({name:e})},this.setContentValue=function(e){void 0!==e&&("string"==typeof e.hex?this.eContentValueHex=e.hex:"string"==typeof e.str&&(this.eContentValueHex=utf8tohex(e.str)))},this.setContentValueHex=function(e){this.eContentValueHex=e},this.setContentValueStr=function(e){this.eContentValueHex=utf8tohex(e)},this.getEncodedHex=function(){if("string"!=typeof this.eContentValueHex)throw"eContentValue not yet set";var e=new s({hex:this.eContentValueHex});this.dEContent=new n({obj:e,tag:"a0",explicit:!0});var t=[this.dEContentType];this.isDetached||t.push(this.dEContent);var i=new r({array:t});return this.hTLV=i.getEncodedHex(),this.hTLV}},YAHOO.lang.extend(KJUR.asn1.cms.EncapsulatedContentInfo,KJUR.asn1.ASN1Object),KJUR.asn1.cms.ContentInfo=function(e){var t=KJUR.asn1,i=t.DERTaggedObject,n=t.DERSequence,r=t.x509;KJUR.asn1.cms.ContentInfo.superclass.constructor.call(this),this.dContentType=null,this.dContent=null,this.setContentType=function(e){"string"==typeof e&&(this.dContentType=r.OID.name2obj(e))},this.getEncodedHex=function(){var e=new i({obj:this.dContent,tag:"a0",explicit:!0}),t=new n({array:[this.dContentType,e]});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==e&&(e.type&&this.setContentType(e.type),e.obj&&e.obj instanceof t.ASN1Object&&(this.dContent=e.obj))},YAHOO.lang.extend(KJUR.asn1.cms.ContentInfo,KJUR.asn1.ASN1Object),KJUR.asn1.cms.SignedData=function(e){var t=KJUR.asn1,n=t.ASN1Object,i=t.DERInteger,c=t.DERSet,l=t.DERSequence,u=t.DERTaggedObject,r=t.cms,s=r.EncapsulatedContentInfo,a=r.SignerInfo,o=r.ContentInfo,h=t.x509.AlgorithmIdentifier;KJUR.asn1.cms.SignedData.superclass.constructor.call(this),this.dCMSVersion=new i({int:1}),this.dDigestAlgs=null,this.digestAlgNameList=[],this.dEncapContentInfo=new s,this.dCerts=null,this.certificateList=[],this.crlList=[],this.signerInfoList=[new a],this.addCertificatesByPEM=function(e){var t=pemtohex(e),i=new n;i.hTLV=t,this.certificateList.push(i)},this.getEncodedHex=function(){if("string"==typeof this.hTLV)return this.hTLV;if(null==this.dDigestAlgs){for(var e=[],t=0;t<this.digestAlgNameList.length;t++){var i=this.digestAlgNameList[t],n=new h({name:i});e.push(n)}this.dDigestAlgs=new c({array:e})}var r=[this.dCMSVersion,this.dDigestAlgs,this.dEncapContentInfo];if(null==this.dCerts&&0<this.certificateList.length){var s=new c({array:this.certificateList});this.dCerts=new u({obj:s,tag:"a0",explicit:!1})}null!=this.dCerts&&r.push(this.dCerts);var a=new c({array:this.signerInfoList});r.push(a);var o=new l({array:r});return this.hTLV=o.getEncodedHex(),this.hTLV},this.getContentInfo=function(){return this.getEncodedHex(),new o({type:"signed-data",obj:this})},this.getContentInfoEncodedHex=function(){return this.getContentInfo().getEncodedHex()},this.getPEM=function(){return hextopem(this.getContentInfoEncodedHex(),"CMS")}},YAHOO.lang.extend(KJUR.asn1.cms.SignedData,KJUR.asn1.ASN1Object),KJUR.asn1.cms.CMSUtil=new function(){},KJUR.asn1.cms.CMSUtil.newSignedData=function(e){var t=KJUR.asn1,i=t.cms,n=i.SignerInfo,r=i.SignedData,s=i.SigningTime,a=i.SigningCertificate,o=i.SigningCertificateV2,c=t.cades.SignaturePolicyIdentifier,l=new r;if(l.dEncapContentInfo.setContentValue(e.content),"object"==typeof e.certs)for(var u=0;u<e.certs.length;u++)l.addCertificatesByPEM(e.certs[u]);l.signerInfoList=[];for(u=0;u<e.signerInfos.length;u++){var h=e.signerInfos[u],g=new n;for(attrName in g.setSignerIdentifier(h.signerCert),g.setForContentAndHash({sdObj:l,eciObj:l.dEncapContentInfo,hashAlg:h.hashAlg}),h.sAttr){var d=h.sAttr[attrName];if("SigningTime"==attrName){var p=new s(d);g.dSignedAttrs.add(p)}if("SigningCertificate"==attrName){p=new a(d);g.dSignedAttrs.add(p)}if("SigningCertificateV2"==attrName){p=new o(d);g.dSignedAttrs.add(p)}if("SignaturePolicyIdentifier"==attrName){p=new c(d);g.dSignedAttrs.add(p)}}g.sign(h.signerPrvKey,h.sigAlg),l.signerInfoList.push(g)}return l},KJUR.asn1.cms.CMSUtil.verifySignedData=function(e){var t=KJUR,i=t.asn1,n=i.cms,r=(n.SignerInfo,n.SignedData,n.SigningTime,n.SigningCertificate,n.SigningCertificateV2,i.cades.SignaturePolicyIdentifier,t.lang.String.isHex),s=ASN1HEX,c=s.getVbyList,a=s.getTLVbyList,o=s.getIdxbyList,d=s.getChildIdx,p=s.getTLV,l=s.oidname,f=t.crypto.Util.hashHex;void 0===e.cms&&r(e.cms);var u=e.cms,h=function(e,t){var i=t.idx;t.signerid_issuer1=a(e,i,[1,0],"30"),t.signerid_serial1=c(e,i,[1,1],"02"),t.hashalg=l(c(e,i,[2,0],"06"));var n=o(e,i,[3],"a0");t.idxSignedAttrs=n,g(e,t,n);var r=d(e,i).length;if(r<6)throw"malformed SignerInfo";t.sigalg=l(c(e,i,[r-2,0],"06")),t.sigval=c(e,i,[r-1],"04")},g=function(e,t,i){var n=d(e,i);t.signedAttrIdxList=n;for(var r=0;r<n.length;r++){var s,a=n[r],o=c(e,a,[0],"06");"2a864886f70d010905"===o?(s=hextoutf8(c(e,a,[1,0])),t.saSigningTime=s):"2a864886f70d010904"===o&&(s=c(e,a,[1,0],"04"),t.saMessageDigest=s)}},y=function(e,t,i,n){i.verifyDetail={};var r=i.verifyDetail,s=t.parse.econtent,a=i.hashalg,o=i.saMessageDigest;r.validMessageDigest=!1,f(s,a)===o&&(r.validMessageDigest=!0),function(e,t,i,n){var r,s=t.parse.certsIdx;if(void 0===t.certs){r=[],t.certkeys=[];for(var a=d(e,s),o=0;o<a.length;o++){var c=p(e,a[o]),l=new X509;l.readCertHex(c),r[o]=l,t.certkeys[o]=l.getPublicKey()}t.certs=r}else r=t.certs;t.cccc=r.length,t.cccci=a.length;for(o=0;o<r.length;o++){var u=l.getIssuerHex(),h=l.getSerialNumberHex();i.signerid_issuer1===u&&i.signerid_serial1===h&&(i.certkey_idx=o)}}(e,t,i),r.validSignatureValue=!1;var c=i.sigalg,l="31"+p(e,i.idxSignedAttrs).substr(2);i.signedattrshex=l;var u=t.certs[i.certkey_idx].getPublicKey(),h=new KJUR.crypto.Signature({alg:c});h.init(u),h.updateHex(l);var g=h.verify(i.sigval);!0===(r.validSignatureValue_isValid=g)&&(r.validSignatureValue=!0),i.isValid=!1,r.validMessageDigest&&r.validSignatureValue&&(i.isValid=!0)},m={isValid:!1,parse:{}};return function(e,t){if("2a864886f70d010702"!==c(e,0,[0],"06"))return;t.cmsType="signedData",t.econtent=c(e,0,[1,0,2,1,0]),function(e,t){for(var i,n=3;n<6;n++)if(void 0!==(i=o(e,0,[1,0,n]))){var r=e.substr(i,2);"a0"===r&&(t.certsIdx=i),"a1"===r&&(t.revinfosIdx=i),"31"===r&&(t.signerinfosIdx=i)}}(e,t),t.signerInfos=[],function(e,t){var i=t.signerinfosIdx;if(void 0!==i){var n=d(e,i);t.signerInfoIdxList=n;for(var r=0;r<n.length;r++){var s={idx:n[r]};h(e,s),t.signerInfos.push(s)}}}(e,t)}(u,m.parse),function(e,t){for(var i=t.parse.signerInfos,n=i.length,r=!0,s=0;s<n;s++){var a=i[s];y(e,t,a,s),a.isValid||(r=!1)}t.isValid=r}(u,m),m},void 0!==KJUR&&KJUR||(KJUR={}),void 0!==KJUR.asn1&&KJUR.asn1||(KJUR.asn1={}),void 0!==KJUR.asn1.tsp&&KJUR.asn1.tsp||(KJUR.asn1.tsp={}),KJUR.asn1.tsp.Accuracy=function(e){var t=KJUR.asn1,o=t.DERInteger,c=t.DERSequence,l=t.DERTaggedObject;t.tsp.Accuracy.superclass.constructor.call(this),this.seconds=null,this.millis=null,this.micros=null,this.getEncodedHex=function(){var e=null,t=null,i=null,n=[];if(null!=this.seconds&&(e=new o({int:this.seconds}),n.push(e)),null!=this.millis){var r=new o({int:this.millis});t=new l({obj:r,tag:"80",explicit:!1}),n.push(t)}if(null!=this.micros){var s=new o({int:this.micros});i=new l({obj:s,tag:"81",explicit:!1}),n.push(i)}var a=new c({array:n});return this.hTLV=a.getEncodedHex(),this.hTLV},void 0!==e&&("number"==typeof e.seconds&&(this.seconds=e.seconds),"number"==typeof e.millis&&(this.millis=e.millis),"number"==typeof e.micros&&(this.micros=e.micros))},YAHOO.lang.extend(KJUR.asn1.tsp.Accuracy,KJUR.asn1.ASN1Object),KJUR.asn1.tsp.MessageImprint=function(e){var t=KJUR.asn1,i=t.DERSequence,n=t.DEROctetString,r=t.x509.AlgorithmIdentifier;t.tsp.MessageImprint.superclass.constructor.call(this),this.dHashAlg=null,this.dHashValue=null,this.getEncodedHex=function(){return"string"==typeof this.hTLV?this.hTLV:new i({array:[this.dHashAlg,this.dHashValue]}).getEncodedHex()},void 0!==e&&("string"==typeof e.hashAlg&&(this.dHashAlg=new r({name:e.hashAlg})),"string"==typeof e.hashValue&&(this.dHashValue=new n({hex:e.hashValue})))},YAHOO.lang.extend(KJUR.asn1.tsp.MessageImprint,KJUR.asn1.ASN1Object),KJUR.asn1.tsp.TimeStampReq=function(e){var t=KJUR.asn1,i=t.DERSequence,n=t.DERInteger,r=t.DERBoolean,s=t.DERObjectIdentifier,a=t.tsp,o=a.MessageImprint;a.TimeStampReq.superclass.constructor.call(this),this.dVersion=new n({int:1}),this.dMessageImprint=null,this.dPolicy=null,this.dNonce=null,this.certReq=!0,this.setMessageImprint=function(e){e instanceof o?this.dMessageImprint=e:"object"==typeof e&&(this.dMessageImprint=new o(e))},this.getEncodedHex=function(){if(null==this.dMessageImprint)throw"messageImprint shall be specified";var e=[this.dVersion,this.dMessageImprint];null!=this.dPolicy&&e.push(this.dPolicy),null!=this.dNonce&&e.push(this.dNonce),this.certReq&&e.push(new r);var t=new i({array:e});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==e&&("object"==typeof e.mi&&this.setMessageImprint(e.mi),"object"==typeof e.policy&&(this.dPolicy=new s(e.policy)),"object"==typeof e.nonce&&(this.dNonce=new n(e.nonce)),"boolean"==typeof e.certreq&&(this.certReq=e.certreq))},YAHOO.lang.extend(KJUR.asn1.tsp.TimeStampReq,KJUR.asn1.ASN1Object),KJUR.asn1.tsp.TSTInfo=function(e){var t=KJUR.asn1,i=t.DERSequence,n=t.DERInteger,r=t.DERBoolean,s=t.DERGeneralizedTime,a=t.DERObjectIdentifier,o=t.tsp,c=o.MessageImprint,l=o.Accuracy,u=t.x509.X500Name;if(o.TSTInfo.superclass.constructor.call(this),this.dVersion=new n({int:1}),this.dPolicy=null,this.dMessageImprint=null,this.dSerialNumber=null,this.dGenTime=null,this.dAccuracy=null,this.dOrdering=null,this.dNonce=null,this.dTsa=null,this.getEncodedHex=function(){var e=[this.dVersion];if(null==this.dPolicy)throw"policy shall be specified.";if(e.push(this.dPolicy),null==this.dMessageImprint)throw"messageImprint shall be specified.";if(e.push(this.dMessageImprint),null==this.dSerialNumber)throw"serialNumber shall be specified.";if(e.push(this.dSerialNumber),null==this.dGenTime)throw"genTime shall be specified.";e.push(this.dGenTime),null!=this.dAccuracy&&e.push(this.dAccuracy),null!=this.dOrdering&&e.push(this.dOrdering),null!=this.dNonce&&e.push(this.dNonce),null!=this.dTsa&&e.push(this.dTsa);var t=new i({array:e});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==e){if("string"==typeof e.policy){if(!e.policy.match(/^[0-9.]+$/))throw"policy shall be oid like 0.1.4.134";this.dPolicy=new a({oid:e.policy})}void 0!==e.messageImprint&&(this.dMessageImprint=new c(e.messageImprint)),void 0!==e.serialNumber&&(this.dSerialNumber=new n(e.serialNumber)),void 0!==e.genTime&&(this.dGenTime=new s(e.genTime)),void 0!==e.accuracy&&(this.dAccuracy=new l(e.accuracy)),void 0!==e.ordering&&1==e.ordering&&(this.dOrdering=new r),void 0!==e.nonce&&(this.dNonce=new n(e.nonce)),void 0!==e.tsa&&(this.dTsa=new u(e.tsa))}},YAHOO.lang.extend(KJUR.asn1.tsp.TSTInfo,KJUR.asn1.ASN1Object),KJUR.asn1.tsp.TimeStampResp=function(e){var t=KJUR.asn1,i=t.DERSequence,n=t.ASN1Object,r=t.tsp,s=r.PKIStatusInfo;r.TimeStampResp.superclass.constructor.call(this),this.dStatus=null,this.dTST=null,this.getEncodedHex=function(){if(null==this.dStatus)throw"status shall be specified";var e=[this.dStatus];null!=this.dTST&&e.push(this.dTST);var t=new i({array:e});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==e&&("object"==typeof e.status&&(this.dStatus=new s(e.status)),void 0!==e.tst&&e.tst instanceof n&&(this.dTST=e.tst.getContentInfo()))},YAHOO.lang.extend(KJUR.asn1.tsp.TimeStampResp,KJUR.asn1.ASN1Object),KJUR.asn1.tsp.PKIStatusInfo=function(e){var t=KJUR.asn1,i=t.DERSequence,n=t.tsp,r=n.PKIStatus,s=n.PKIFreeText,a=n.PKIFailureInfo;n.PKIStatusInfo.superclass.constructor.call(this),this.dStatus=null,this.dStatusString=null,this.dFailureInfo=null,this.getEncodedHex=function(){if(null==this.dStatus)throw"status shall be specified";var e=[this.dStatus];null!=this.dStatusString&&e.push(this.dStatusString),null!=this.dFailureInfo&&e.push(this.dFailureInfo);var t=new i({array:e});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==e&&("object"==typeof e.status&&(this.dStatus=new r(e.status)),"object"==typeof e.statstr&&(this.dStatusString=new s({array:e.statstr})),"object"==typeof e.failinfo&&(this.dFailureInfo=new a(e.failinfo)))},YAHOO.lang.extend(KJUR.asn1.tsp.PKIStatusInfo,KJUR.asn1.ASN1Object),KJUR.asn1.tsp.PKIStatus=function(e){var t=KJUR.asn1,i=t.DERInteger,n=t.tsp,r=n.PKIStatus;if(n.PKIStatus.superclass.constructor.call(this),this.getEncodedHex=function(){return this.hTLV=this.dStatus.getEncodedHex(),this.hTLV},void 0!==e)if(void 0!==e.name){var s=r.valueList;if(void 0===s[e.name])throw"name undefined: "+e.name;this.dStatus=new i({int:s[e.name]})}else this.dStatus=new i(e)},YAHOO.lang.extend(KJUR.asn1.tsp.PKIStatus,KJUR.asn1.ASN1Object),KJUR.asn1.tsp.PKIStatus.valueList={granted:0,grantedWithMods:1,rejection:2,waiting:3,revocationWarning:4,revocationNotification:5},KJUR.asn1.tsp.PKIFreeText=function(e){var t=KJUR.asn1,n=t.DERSequence,r=t.DERUTF8String;t.tsp.PKIFreeText.superclass.constructor.call(this),this.textList=[],this.getEncodedHex=function(){for(var e=[],t=0;t<this.textList.length;t++)e.push(new r({str:this.textList[t]}));var i=new n({array:e});return this.hTLV=i.getEncodedHex(),this.hTLV},void 0!==e&&"object"==typeof e.array&&(this.textList=e.array)},YAHOO.lang.extend(KJUR.asn1.tsp.PKIFreeText,KJUR.asn1.ASN1Object),KJUR.asn1.tsp.PKIFailureInfo=function(e){var t=KJUR.asn1,i=t.DERBitString,n=t.tsp.PKIFailureInfo;if(n.superclass.constructor.call(this),this.value=null,this.getEncodedHex=function(){if(null==this.value)throw"value shall be specified";var e=new Number(this.value).toString(2),t=new i;return t.setByBinaryString(e),this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==e)if("string"==typeof e.name){var r=n.valueList;if(void 0===r[e.name])throw"name undefined: "+e.name;this.value=r[e.name]}else"number"==typeof e.int&&(this.value=e.int)},YAHOO.lang.extend(KJUR.asn1.tsp.PKIFailureInfo,KJUR.asn1.ASN1Object),KJUR.asn1.tsp.PKIFailureInfo.valueList={badAlg:0,badRequest:2,badDataFormat:5,timeNotAvailable:14,unacceptedPolicy:15,unacceptedExtension:16,addInfoNotAvailable:17,systemFailure:25},KJUR.asn1.tsp.AbstractTSAAdapter=function(e){this.getTSTHex=function(e,t){throw"not implemented yet"}},KJUR.asn1.tsp.SimpleTSAAdapter=function(e){var t=KJUR,r=t.asn1.tsp,s=t.crypto.Util.hashHex;r.SimpleTSAAdapter.superclass.constructor.call(this),this.params=null,this.serial=0,this.getTSTHex=function(e,t){var i=s(e,t);this.params.tstInfo.messageImprint={hashAlg:t,hashValue:i},this.params.tstInfo.serialNumber={int:this.serial++};var n=Math.floor(1e9*Math.random());return this.params.tstInfo.nonce={int:n},r.TSPUtil.newTimeStampToken(this.params).getContentInfoEncodedHex()},void 0!==e&&(this.params=e)},YAHOO.lang.extend(KJUR.asn1.tsp.SimpleTSAAdapter,KJUR.asn1.tsp.AbstractTSAAdapter),KJUR.asn1.tsp.FixedTSAAdapter=function(e){var t=KJUR,n=t.asn1.tsp,r=t.crypto.Util.hashHex;n.FixedTSAAdapter.superclass.constructor.call(this),this.params=null,this.getTSTHex=function(e,t){var i=r(e,t);return this.params.tstInfo.messageImprint={hashAlg:t,hashValue:i},n.TSPUtil.newTimeStampToken(this.params).getContentInfoEncodedHex()},void 0!==e&&(this.params=e)},YAHOO.lang.extend(KJUR.asn1.tsp.FixedTSAAdapter,KJUR.asn1.tsp.AbstractTSAAdapter),KJUR.asn1.tsp.TSPUtil=new function(){},KJUR.asn1.tsp.TSPUtil.newTimeStampToken=function(e){var t=KJUR.asn1,i=t.cms,n=(t.tsp,t.tsp.TSTInfo),r=new i.SignedData,s=new n(e.tstInfo).getEncodedHex();if(r.dEncapContentInfo.setContentValue({hex:s}),r.dEncapContentInfo.setContentType("tstinfo"),"object"==typeof e.certs)for(var a=0;a<e.certs.length;a++)r.addCertificatesByPEM(e.certs[a]);var o=r.signerInfoList[0];o.setSignerIdentifier(e.signerCert),o.setForContentAndHash({sdObj:r,eciObj:r.dEncapContentInfo,hashAlg:e.hashAlg});var c=new i.SigningCertificate({array:[e.signerCert]});return o.dSignedAttrs.add(c),o.sign(e.signerPrvKey,e.sigAlg),r},KJUR.asn1.tsp.TSPUtil.parseTimeStampReq=function(e){var t=ASN1HEX,i=t.getChildIdx,n=t.getV,r=t.getTLV,s={certreq:!1},a=i(e,0);if(a.length<2)throw"TimeStampReq must have at least 2 items";var o=r(e,a[1]);s.mi=KJUR.asn1.tsp.TSPUtil.parseMessageImprint(o);for(var c=2;c<a.length;c++){var l=a[c],u=e.substr(l,2);if("06"==u){var h=n(e,l);s.policy=t.hextooidstr(h)}"02"==u&&(s.nonce=n(e,l)),"01"==u&&(s.certreq=!0)}return s},KJUR.asn1.tsp.TSPUtil.parseMessageImprint=function(e){var t=ASN1HEX,i=t.getChildIdx,n=t.getV,r=t.getIdxbyList,s={};if("30"!=e.substr(0,2))throw"head of messageImprint hex shall be '30'";i(e,0);var a=n(e,r(e,0,[0,0])),o=t.hextooidstr(a),c=KJUR.asn1.x509.OID.oid2name(o);if(""==c)throw"hashAlg name undefined: "+o;var l=c,u=r(e,0,[1]);return s.hashAlg=l,s.hashValue=n(e,u),s},void 0!==KJUR&&KJUR||(KJUR={}),void 0!==KJUR.asn1&&KJUR.asn1||(KJUR.asn1={}),void 0!==KJUR.asn1.cades&&KJUR.asn1.cades||(KJUR.asn1.cades={}),KJUR.asn1.cades.SignaturePolicyIdentifier=function(e){var t=KJUR.asn1,i=t.DERObjectIdentifier,n=t.DERSequence,r=t.cades,s=r.OtherHashAlgAndValue;if(r.SignaturePolicyIdentifier.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.15",void 0!==e&&"string"==typeof e.oid&&"object"==typeof e.hash){var a=new n({array:[new i({oid:e.oid}),new s(e.hash)]});this.valueList=[a]}},YAHOO.lang.extend(KJUR.asn1.cades.SignaturePolicyIdentifier,KJUR.asn1.cms.Attribute),KJUR.asn1.cades.OtherHashAlgAndValue=function(e){var t=KJUR.asn1,i=t.DERSequence,n=t.DEROctetString,r=t.x509.AlgorithmIdentifier;t.cades.OtherHashAlgAndValue.superclass.constructor.call(this),this.dAlg=null,this.dHash=null,this.getEncodedHex=function(){var e=new i({array:[this.dAlg,this.dHash]});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==e&&"string"==typeof e.alg&&"string"==typeof e.hash&&(this.dAlg=new r({name:e.alg}),this.dHash=new n({hex:e.hash}))},YAHOO.lang.extend(KJUR.asn1.cades.OtherHashAlgAndValue,KJUR.asn1.ASN1Object),KJUR.asn1.cades.SignatureTimeStamp=function(e){var t=KJUR.asn1,i=t.ASN1Object;t.x509;if(t.cades.SignatureTimeStamp.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.14",this.tstHex=null,void 0!==e){if(void 0!==e.res)if("string"==typeof e.res&&e.res.match(/^[0-9A-Fa-f]+$/));else if(!(e.res instanceof i))throw"res param shall be ASN1Object or hex string";if(void 0!==e.tst)if("string"==typeof e.tst&&e.tst.match(/^[0-9A-Fa-f]+$/)){var n=new i;this.tstHex=e.tst,n.hTLV=this.tstHex,n.getEncodedHex(),this.valueList=[n]}else if(!(e.tst instanceof i))throw"tst param shall be ASN1Object or hex string"}},YAHOO.lang.extend(KJUR.asn1.cades.SignatureTimeStamp,KJUR.asn1.cms.Attribute),KJUR.asn1.cades.CompleteCertificateRefs=function(e){var n=KJUR.asn1.cades;n.CompleteCertificateRefs.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.21",this.setByArray=function(e){this.valueList=[];for(var t=0;t<e.length;t++){var i=new n.OtherCertID(e[t]);this.valueList.push(i)}},void 0!==e&&"object"==typeof e&&"number"==typeof e.length&&this.setByArray(e)},YAHOO.lang.extend(KJUR.asn1.cades.CompleteCertificateRefs,KJUR.asn1.cms.Attribute),KJUR.asn1.cades.OtherCertID=function(e){var i=KJUR.asn1,t=i.cms,n=i.cades;n.OtherCertID.superclass.constructor.call(this),this.hasIssuerSerial=!0,this.dOtherCertHash=null,this.dIssuerSerial=null,this.setByCertPEM=function(e){this.dOtherCertHash=new n.OtherHash(e),this.hasIssuerSerial&&(this.dIssuerSerial=new t.IssuerAndSerialNumber(e))},this.getEncodedHex=function(){if(null!=this.hTLV)return this.hTLV;if(null==this.dOtherCertHash)throw"otherCertHash not set";var e=[this.dOtherCertHash];null!=this.dIssuerSerial&&e.push(this.dIssuerSerial);var t=new i.DERSequence({array:e});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==e&&("string"==typeof e&&-1!=e.indexOf("-----BEGIN ")&&this.setByCertPEM(e),"object"==typeof e&&(!1===e.hasis&&(this.hasIssuerSerial=!1),"string"==typeof e.cert&&this.setByCertPEM(e.cert)))},YAHOO.lang.extend(KJUR.asn1.cades.OtherCertID,KJUR.asn1.ASN1Object),KJUR.asn1.cades.OtherHash=function(e){var t=KJUR,i=t.asn1,n=(i.cms,i.cades),r=n.OtherHashAlgAndValue,s=t.crypto.Util.hashHex;if(n.OtherHash.superclass.constructor.call(this),this.alg="sha256",this.dOtherHash=null,this.setByCertPEM=function(e){if(-1==e.indexOf("-----BEGIN "))throw"certPEM not to seem PEM format";var t=pemtohex(e),i=s(t,this.alg);this.dOtherHash=new r({alg:this.alg,hash:i})},this.getEncodedHex=function(){if(null==this.dOtherHash)throw"OtherHash not set";return this.dOtherHash.getEncodedHex()},void 0!==e)if("string"==typeof e)if(-1!=e.indexOf("-----BEGIN "))this.setByCertPEM(e);else{if(!e.match(/^[0-9A-Fa-f]+$/))throw"unsupported string value for params";this.dOtherHash=new i.DEROctetString({hex:e})}else"object"==typeof e&&("string"==typeof e.cert?("string"==typeof e.alg&&(this.alg=e.alg),this.setByCertPEM(e.cert)):this.dOtherHash=new r(e))},YAHOO.lang.extend(KJUR.asn1.cades.OtherHash,KJUR.asn1.ASN1Object),KJUR.asn1.cades.CAdESUtil=new function(){},KJUR.asn1.cades.CAdESUtil.addSigTS=function(e,t,i){},KJUR.asn1.cades.CAdESUtil.parseSignedDataForAddingUnsigned=function(e){var t=ASN1HEX,i=t.getChildIdx,n=t.getTLV,r=t.getTLVbyList,s=t.getIdxbyList,a=KJUR.asn1,o=a.ASN1Object,c=a.cms.SignedData,l=a.cades.CAdESUtil,u={};if("06092a864886f70d010702"!=r(e,0,[0]))throw"hex is not CMS SignedData";var h=i(e,s(e,0,[1,0]));if(h.length<4)throw"num of SignedData elem shall be 4 at least";var g=h.shift();u.version=n(e,g);var d=h.shift();u.algs=n(e,d);var p=h.shift();u.encapcontent=n(e,p),u.certs=null,u.revs=null,u.si=[];var f=h.shift();"a0"==e.substr(f,2)&&(u.certs=n(e,f),f=h.shift()),"a1"==e.substr(f,2)&&(u.revs=n(e,f),f=h.shift());var y=f;if("31"!=e.substr(y,2))throw"Can't find signerInfos";for(var m=i(e,y),b=0;b<m.length;b++){var I=m[b],v=l.parseSignerInfoForAddingUnsigned(e,I,b);u.si[b]=v}var A=null;u.obj=new c,(A=new o).hTLV=u.version,u.obj.dCMSVersion=A,(A=new o).hTLV=u.algs,u.obj.dDigestAlgs=A,(A=new o).hTLV=u.encapcontent,u.obj.dEncapContentInfo=A,(A=new o).hTLV=u.certs,u.obj.dCerts=A,u.obj.signerInfoList=[];for(b=0;b<u.si.length;b++)u.obj.signerInfoList.push(u.si[b].obj);return u},KJUR.asn1.cades.CAdESUtil.parseSignerInfoForAddingUnsigned=function(e,t,i){var n=ASN1HEX,r=n.getChildIdx,s=n.getTLV,a=n.getV,o=KJUR.asn1,c=o.ASN1Object,l=o.cms,u=l.AttributeList,h=l.SignerInfo,g={},d=r(e,t);if(6!=d.length)throw"not supported items for SignerInfo (!=6)";var p=d.shift();g.version=s(e,p);var f=d.shift();g.si=s(e,f);var y=d.shift();g.digalg=s(e,y);var m=d.shift();g.sattrs=s(e,m);var b=d.shift();g.sigalg=s(e,b);var I=d.shift();g.sig=s(e,I),g.sigval=a(e,I);var v=null;return g.obj=new h,(v=new c).hTLV=g.version,g.obj.dCMSVersion=v,(v=new c).hTLV=g.si,g.obj.dSignerIdentifier=v,(v=new c).hTLV=g.digalg,g.obj.dDigestAlgorithm=v,(v=new c).hTLV=g.sattrs,g.obj.dSignedAttrs=v,(v=new c).hTLV=g.sigalg,g.obj.dSigAlg=v,(v=new c).hTLV=g.sig,g.obj.dSig=v,g.obj.dUnsignedAttrs=new u,g},void 0!==KJUR.asn1.csr&&KJUR.asn1.csr||(KJUR.asn1.csr={}),KJUR.asn1.csr.CertificationRequest=function(e){var n=KJUR,t=n.asn1,r=t.DERBitString,s=t.DERSequence,i=t.csr,a=t.x509;i.CertificationRequest.superclass.constructor.call(this),this.sign=function(e,t){null==this.prvKey&&(this.prvKey=t),this.asn1SignatureAlg=new a.AlgorithmIdentifier({name:e}),sig=new n.crypto.Signature({alg:e}),sig.init(this.prvKey),sig.updateHex(this.asn1CSRInfo.getEncodedHex()),this.hexSig=sig.sign(),this.asn1Sig=new r({hex:"00"+this.hexSig});var i=new s({array:[this.asn1CSRInfo,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=i.getEncodedHex(),this.isModified=!1},this.getPEMString=function(){return hextopem(this.getEncodedHex(),"CERTIFICATE REQUEST")},this.getEncodedHex=function(){if(0==this.isModified&&null!=this.hTLV)return this.hTLV;throw"not signed yet"},void 0!==e&&void 0!==e.csrinfo&&(this.asn1CSRInfo=e.csrinfo)},YAHOO.lang.extend(KJUR.asn1.csr.CertificationRequest,KJUR.asn1.ASN1Object),KJUR.asn1.csr.CertificationRequestInfo=function(e){var t=KJUR.asn1,i=t.DERInteger,s=t.DERSequence,a=t.DERSet,o=t.DERNull,c=t.DERTaggedObject,l=t.DERObjectIdentifier,n=t.csr,r=t.x509,u=r.X500Name,h=r.Extension,g=KEYUTIL;n.CertificationRequestInfo.superclass.constructor.call(this),this._initialize=function(){this.asn1Array=new Array,this.asn1Version=new i({int:0}),this.asn1Subject=null,this.asn1SubjPKey=null,this.extensionsArray=new Array},this.setSubjectByParam=function(e){this.asn1Subject=new u(e)},this.setSubjectPublicKeyByGetKey=function(e){var t=g.getKey(e);this.asn1SubjPKey=new r.SubjectPublicKeyInfo(t)},this.appendExtensionByName=function(e,t){h.appendByNameToArray(e,t,this.extensionsArray)},this.getEncodedHex=function(){if(this.asn1Array=new Array,this.asn1Array.push(this.asn1Version),this.asn1Array.push(this.asn1Subject),this.asn1Array.push(this.asn1SubjPKey),0<this.extensionsArray.length){var e=new s({array:this.extensionsArray}),t=new a({array:[e]}),i=new s({array:[new l({oid:"1.2.840.113549.1.9.14"}),t]}),n=new c({explicit:!0,tag:"a0",obj:i});this.asn1Array.push(n)}else{n=new c({explicit:!1,tag:"a0",obj:new o});this.asn1Array.push(n)}var r=new s({array:this.asn1Array});return this.hTLV=r.getEncodedHex(),this.isModified=!1,this.hTLV},this._initialize()},YAHOO.lang.extend(KJUR.asn1.csr.CertificationRequestInfo,KJUR.asn1.ASN1Object),KJUR.asn1.csr.CSRUtil=new function(){},KJUR.asn1.csr.CSRUtil.newCSRPEM=function(e){var t=KEYUTIL,i=KJUR.asn1.csr;if(void 0===e.subject)throw"parameter subject undefined";if(void 0===e.sbjpubkey)throw"parameter sbjpubkey undefined";if(void 0===e.sigalg)throw"parameter sigalg undefined";if(void 0===e.sbjprvkey)throw"parameter sbjpubkey undefined";var n=new i.CertificationRequestInfo;if(n.setSubjectByParam(e.subject),n.setSubjectPublicKeyByGetKey(e.sbjpubkey),void 0!==e.ext&&void 0!==e.ext.length)for(var r=0;r<e.ext.length;r++)for(key in e.ext[r])n.appendExtensionByName(key,e.ext[r][key]);var s=new i.CertificationRequest({csrinfo:n}),a=t.getKey(e.sbjprvkey);return s.sign(e.sigalg,a),s.getPEMString()},KJUR.asn1.csr.CSRUtil.getInfo=function(e){var t=ASN1HEX.getTLVbyList,i={subject:{},pubkey:{}};if(-1==e.indexOf("-----BEGIN CERTIFICATE REQUEST"))throw"argument is not PEM file";var n=pemtohex(e,"CERTIFICATE REQUEST");return i.subject.hex=t(n,0,[0,1]),i.subject.name=X509.hex2dn(i.subject.hex),i.pubkey.hex=t(n,0,[0,2]),i.pubkey.obj=KEYUTIL.getKey(i.pubkey.hex,null,"pkcs8pub"),i},void 0!==KJUR&&KJUR||(KJUR={}),void 0!==KJUR.asn1&&KJUR.asn1||(KJUR.asn1={}),void 0!==KJUR.asn1.ocsp&&KJUR.asn1.ocsp||(KJUR.asn1.ocsp={}),KJUR.asn1.ocsp.DEFAULT_HASH="sha1",KJUR.asn1.ocsp.CertID=function(e){var t=KJUR,i=t.asn1,r=i.DEROctetString,s=i.DERInteger,n=i.DERSequence,a=i.x509.AlgorithmIdentifier,o=i.ocsp,u=o.DEFAULT_HASH,h=t.crypto.Util.hashHex,g=X509,d=ASN1HEX;if(o.CertID.superclass.constructor.call(this),this.dHashAlg=null,this.dIssuerNameHash=null,this.dIssuerKeyHash=null,this.dSerialNumber=null,this.setByValue=function(e,t,i,n){void 0===n&&(n=u),this.dHashAlg=new a({name:n}),this.dIssuerNameHash=new r({hex:e}),this.dIssuerKeyHash=new r({hex:t}),this.dSerialNumber=new s({hex:i})},this.setByCert=function(e,t,i){void 0===i&&(i=u);var n=new g;n.readCertPEM(t);var r=new g;r.readCertPEM(e);var s=r.getPublicKeyHex(),a=d.getTLVbyList(s,0,[1,0],"30"),o=n.getSerialNumberHex(),c=h(r.getSubjectHex(),i),l=h(a,i);this.setByValue(c,l,o,i),this.hoge=n.getSerialNumberHex()},this.getEncodedHex=function(){if(null===this.dHashAlg&&null===this.dIssuerNameHash&&null===this.dIssuerKeyHash&&null===this.dSerialNumber)throw"not yet set values";var e=[this.dHashAlg,this.dIssuerNameHash,this.dIssuerKeyHash,this.dSerialNumber],t=new n({array:e});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==e){var c=e;if(void 0!==c.issuerCert&&void 0!==c.subjectCert){var l=u;void 0===c.alg&&(l=void 0),this.setByCert(c.issuerCert,c.subjectCert,l)}else{if(void 0===c.namehash||void 0===c.keyhash||void 0===c.serial)throw"invalid constructor arguments";l=u;void 0===c.alg&&(l=void 0),this.setByValue(c.namehash,c.keyhash,c.serial,l)}}},YAHOO.lang.extend(KJUR.asn1.ocsp.CertID,KJUR.asn1.ASN1Object),KJUR.asn1.ocsp.Request=function(e){var t=KJUR.asn1,i=t.DERSequence,n=t.ocsp;if(n.Request.superclass.constructor.call(this),this.dReqCert=null,this.dExt=null,this.getEncodedHex=function(){var e=[];if(null===this.dReqCert)throw"reqCert not set";e.push(this.dReqCert);var t=new i({array:e});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==e){var r=new n.CertID(e);this.dReqCert=r}},YAHOO.lang.extend(KJUR.asn1.ocsp.Request,KJUR.asn1.ASN1Object),KJUR.asn1.ocsp.TBSRequest=function(e){var t=KJUR.asn1,n=t.DERSequence,r=t.ocsp;r.TBSRequest.superclass.constructor.call(this),this.version=0,this.dRequestorName=null,this.dRequestList=[],this.dRequestExt=null,this.setRequestListByParam=function(e){for(var t=[],i=0;i<e.length;i++){var n=new r.Request(e[0]);t.push(n)}this.dRequestList=t},this.getEncodedHex=function(){var e=[];if(0!==this.version)throw"not supported version: "+this.version;if(null!==this.dRequestorName)throw"requestorName not supported";var t=new n({array:this.dRequestList});if(e.push(t),null!==this.dRequestExt)throw"requestExtensions not supported";var i=new n({array:e});return this.hTLV=i.getEncodedHex(),this.hTLV},void 0!==e&&void 0!==e.reqList&&this.setRequestListByParam(e.reqList)},YAHOO.lang.extend(KJUR.asn1.ocsp.TBSRequest,KJUR.asn1.ASN1Object),KJUR.asn1.ocsp.OCSPRequest=function(e){var t=KJUR.asn1,i=t.DERSequence,n=t.ocsp;if(n.OCSPRequest.superclass.constructor.call(this),this.dTbsRequest=null,this.dOptionalSignature=null,this.getEncodedHex=function(){var e=[];if(null===this.dTbsRequest)throw"tbsRequest not set";if(e.push(this.dTbsRequest),null!==this.dOptionalSignature)throw"optionalSignature not supported";var t=new i({array:e});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==e&&void 0!==e.reqList){var r=new n.TBSRequest(e);this.dTbsRequest=r}},YAHOO.lang.extend(KJUR.asn1.ocsp.OCSPRequest,KJUR.asn1.ASN1Object),KJUR.asn1.ocsp.OCSPUtil={},KJUR.asn1.ocsp.OCSPUtil.getRequestHex=function(e,t,i){var n=KJUR.asn1.ocsp;void 0===i&&(i=n.DEFAULT_HASH);var r={alg:i,issuerCert:e,subjectCert:t};return new n.OCSPRequest({reqList:[r]}).getEncodedHex()},KJUR.asn1.ocsp.OCSPUtil.getOCSPResponseInfo=function(e){var t=ASN1HEX,i=t.getVbyList,n=t.getIdxbyList,r=(i=t.getVbyList,t.getV),s={};try{var a=i(e,0,[0],"0a");s.responseStatus=parseInt(a,16)}catch(e){}if(0!==s.responseStatus)return s;try{var o=n(e,0,[1,0,1,0,0,2,0,1]);"80"===e.substr(o,2)?s.certStatus="good":"a1"===e.substr(o,2)?(s.certStatus="revoked",s.revocationTime=hextoutf8(i(e,o,[0]))):"82"===e.substr(o,2)&&(s.certStatus="unknown")}catch(e){}try{var c=n(e,0,[1,0,1,0,0,2,0,2]);s.thisUpdate=hextoutf8(r(e,c))}catch(e){}try{var l=n(e,0,[1,0,1,0,0,2,0,3]);"a0"===e.substr(l,2)&&(s.nextUpdate=hextoutf8(i(e,l,[0])))}catch(e){}return s},void 0!==KJUR&&KJUR||(KJUR={}),void 0!==KJUR.lang&&KJUR.lang||(KJUR.lang={}),KJUR.lang.String=function(){},b64utoutf8="function"==typeof Buffer?(utf8tob64u=function(e){return b64tob64u(new Buffer(e,"utf8").toString("base64"))},function(e){return new Buffer(b64utob64(e),"base64").toString("utf8")}):(utf8tob64u=function(e){return hextob64u(uricmptohex(encodeURIComponentAll(e)))},function(e){return decodeURIComponent(hextouricmp(b64utohex(e)))}),KJUR.lang.String.isInteger=function(e){return!!e.match(/^[0-9]+$/)||!!e.match(/^-[0-9]+$/)},KJUR.lang.String.isHex=function(e){return!(e.length%2!=0||!e.match(/^[0-9a-f]+$/)&&!e.match(/^[0-9A-F]+$/))},KJUR.lang.String.isBase64=function(e){return!(!(e=e.replace(/\s+/g,"")).match(/^[0-9A-Za-z+\/]+={0,3}$/)||e.length%4!=0)},KJUR.lang.String.isBase64URL=function(e){return!e.match(/[+/=]/)&&(e=b64utob64(e),KJUR.lang.String.isBase64(e))},KJUR.lang.String.isIntegerArray=function(e){return!!(e=e.replace(/\s+/g,"")).match(/^\[[0-9,]+\]$/)};var strdiffidx=function(e,t){var i=e.length;e.length>t.length&&(i=t.length);for(var n=0;n<i;n++)if(e.charCodeAt(n)!=t.charCodeAt(n))return n;return e.length!=t.length?i:-1};void 0!==KJUR&&KJUR||(KJUR={}),void 0!==KJUR.crypto&&KJUR.crypto||(KJUR.crypto={}),KJUR.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:CryptoJS.algo.MD5,sha1:CryptoJS.algo.SHA1,sha224:CryptoJS.algo.SHA224,sha256:CryptoJS.algo.SHA256,sha384:CryptoJS.algo.SHA384,sha512:CryptoJS.algo.SHA512,ripemd160:CryptoJS.algo.RIPEMD160},this.getDigestInfoHex=function(e,t){if(void 0===this.DIGESTINFOHEAD[t])throw"alg not supported in Util.DIGESTINFOHEAD: "+t;return this.DIGESTINFOHEAD[t]+e},this.getPaddedDigestInfoHex=function(e,t,i){var n=this.getDigestInfoHex(e,t),r=i/4;if(n.length+22>r)throw"key is too short for SigAlg: keylen="+i+","+t;for(var s="00"+n,a="",o=r-"0001".length-s.length,c=0;c<o;c+=2)a+="ff";return"0001"+a+s},this.hashString=function(e,t){return new KJUR.crypto.MessageDigest({alg:t}).digestString(e)},this.hashHex=function(e,t){return new KJUR.crypto.MessageDigest({alg:t}).digestHex(e)},this.sha1=function(e){return new KJUR.crypto.MessageDigest({alg:"sha1",prov:"cryptojs"}).digestString(e)},this.sha256=function(e){return new KJUR.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"}).digestString(e)},this.sha256Hex=function(e){return new KJUR.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"}).digestHex(e)},this.sha512=function(e){return new KJUR.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"}).digestString(e)},this.sha512Hex=function(e){return new KJUR.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"}).digestHex(e)}},KJUR.crypto.Util.md5=function(e){return new KJUR.crypto.MessageDigest({alg:"md5",prov:"cryptojs"}).digestString(e)},KJUR.crypto.Util.ripemd160=function(e){return new KJUR.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"}).digestString(e)},KJUR.crypto.Util.SECURERANDOMGEN=new SecureRandom,KJUR.crypto.Util.getRandomHexOfNbytes=function(e){var t=new Array(e);return KJUR.crypto.Util.SECURERANDOMGEN.nextBytes(t),BAtohex(t)},KJUR.crypto.Util.getRandomBigIntegerOfNbytes=function(e){return new BigInteger(KJUR.crypto.Util.getRandomHexOfNbytes(e),16)},KJUR.crypto.Util.getRandomHexOfNbits=function(e){var t=e%8,i=new Array((e-t)/8+1);return KJUR.crypto.Util.SECURERANDOMGEN.nextBytes(i),i[0]=(255<<t&255^255)&i[0],BAtohex(i)},KJUR.crypto.Util.getRandomBigIntegerOfNbits=function(e){return new BigInteger(KJUR.crypto.Util.getRandomHexOfNbits(e),16)},KJUR.crypto.Util.getRandomBigIntegerZeroToMax=function(e){for(var t=e.bitLength();;){var i=KJUR.crypto.Util.getRandomBigIntegerOfNbits(t);if(-1!=e.compareTo(i))return i}},KJUR.crypto.Util.getRandomBigIntegerMinToMax=function(e,t){var i=e.compareTo(t);if(1==i)throw"biMin is greater than biMax";if(0==i)return e;var n=t.subtract(e);return KJUR.crypto.Util.getRandomBigIntegerZeroToMax(n).add(e)},KJUR.crypto.MessageDigest=function(e){this.setAlgAndProvider=function(t,e){if(null!==(t=KJUR.crypto.MessageDigest.getCanonicalAlgName(t))&&void 0===e&&(e=KJUR.crypto.Util.DEFAULTPROVIDER[t]),-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(t)&&"cryptojs"==e){try{this.md=KJUR.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[t].create()}catch(e){throw"setAlgAndProvider hash alg set fail alg="+t+"/"+e}this.updateString=function(e){this.md.update(e)},this.updateHex=function(e){var t=CryptoJS.enc.Hex.parse(e);this.md.update(t)},this.digest=function(){return this.md.finalize().toString(CryptoJS.enc.Hex)},this.digestString=function(e){return this.updateString(e),this.digest()},this.digestHex=function(e){return this.updateHex(e),this.digest()}}if(-1!=":sha256:".indexOf(t)&&"sjcl"==e){try{this.md=new sjcl.hash.sha256}catch(e){throw"setAlgAndProvider hash alg set fail alg="+t+"/"+e}this.updateString=function(e){this.md.update(e)},this.updateHex=function(e){var t=sjcl.codec.hex.toBits(e);this.md.update(t)},this.digest=function(){var e=this.md.finalize();return sjcl.codec.hex.fromBits(e)},this.digestString=function(e){return this.updateString(e),this.digest()},this.digestHex=function(e){return this.updateHex(e),this.digest()}}},this.updateString=function(e){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(e){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(e){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(e){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},void 0!==e&&void 0!==e.alg&&(this.algName=e.alg,void 0===e.prov&&(this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},KJUR.crypto.MessageDigest.getCanonicalAlgName=function(e){return"string"==typeof e&&(e=(e=e.toLowerCase()).replace(/-/,"")),e},KJUR.crypto.MessageDigest.getHashLength=function(e){var t=KJUR.crypto.MessageDigest,i=t.getCanonicalAlgName(e);if(void 0===t.HASHLENGTH[i])throw"not supported algorithm: "+e;return t.HASHLENGTH[i]},KJUR.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},KJUR.crypto.Mac=function(e){this.setAlgAndProvider=function(e,t){if(null==(e=e.toLowerCase())&&(e="hmacsha1"),"hmac"!=(e=e.toLowerCase()).substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+e;void 0===t&&(t=KJUR.crypto.Util.DEFAULTPROVIDER[e]),this.algProv=e+"/"+t;var i=e.substr(4);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(i)&&"cryptojs"==t){try{var n=KJUR.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[i];this.mac=CryptoJS.algo.HMAC.create(n,this.pass)}catch(e){throw"setAlgAndProvider hash alg set fail hashAlg="+i+"/"+e}this.updateString=function(e){this.mac.update(e)},this.updateHex=function(e){var t=CryptoJS.enc.Hex.parse(e);this.mac.update(t)},this.doFinal=function(){return this.mac.finalize().toString(CryptoJS.enc.Hex)},this.doFinalString=function(e){return this.updateString(e),this.doFinal()},this.doFinalHex=function(e){return this.updateHex(e),this.doFinal()}}},this.updateString=function(e){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(e){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(e){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(e){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(e){if("string"==typeof e){var t=e;return e.length%2!=1&&e.match(/^[0-9A-Fa-f]+$/)||(t=rstrtohex(e)),void(this.pass=CryptoJS.enc.Hex.parse(t))}if("object"!=typeof e)throw"KJUR.crypto.Mac unsupported password type: "+e;t=null;if(void 0!==e.hex){if(e.hex.length%2!=0||!e.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+e.hex;t=e.hex}if(void 0!==e.utf8&&(t=utf8tohex(e.utf8)),void 0!==e.rstr&&(t=rstrtohex(e.rstr)),void 0!==e.b64&&(t=b64tohex(e.b64)),void 0!==e.b64u&&(t=b64utohex(e.b64u)),null==t)throw"KJUR.crypto.Mac unsupported password type: "+e;this.pass=CryptoJS.enc.Hex.parse(t)},void 0!==e&&(void 0!==e.pass&&this.setPassword(e.pass),void 0!==e.alg&&(this.algName=e.alg,void 0===e.prov&&(this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},KJUR.crypto.Signature=function(e){var t=null;if(this._setAlgNames=function(){var e=this.algName.match(/^(.+)with(.+)$/);e&&(this.mdAlgName=e[1].toLowerCase(),this.pubkeyAlgName=e[2].toLowerCase())},this._zeroPaddingOfSignature=function(e,t){for(var i="",n=t/4-e.length,r=0;r<n;r++)i+="0";return i+e},this.setAlgAndProvider=function(e,t){if(this._setAlgNames(),"cryptojs/jsrsa"!=t)throw"provider not supported: "+t;if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)){try{this.md=new KJUR.crypto.MessageDigest({alg:this.mdAlgName})}catch(e){throw"setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+e}this.init=function(e,t){var i=null;try{i=void 0===t?KEYUTIL.getKey(e):KEYUTIL.getKey(e,t)}catch(e){throw"init failed:"+e}if(!0===i.isPrivate)this.prvKey=i,this.state="SIGN";else{if(!0!==i.isPublic)throw"init failed.:"+i;this.pubKey=i,this.state="VERIFY"}},this.updateString=function(e){this.md.updateString(e)},this.updateHex=function(e){this.md.updateHex(e)},this.sign=function(){if(this.sHashHex=this.md.digest(),void 0!==this.ecprvhex&&void 0!==this.eccurvename){var e=new KJUR.crypto.ECDSA({curve:this.eccurvename});this.hSign=e.signHex(this.sHashHex,this.ecprvhex)}else if(this.prvKey instanceof RSAKey&&"rsaandmgf1"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof RSAKey&&"rsa"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof KJUR.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else{if(!(this.prvKey instanceof KJUR.crypto.DSA))throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}return this.hSign},this.signString=function(e){return this.updateString(e),this.sign()},this.signHex=function(e){return this.updateHex(e),this.sign()},this.verify=function(e){if(this.sHashHex=this.md.digest(),void 0!==this.ecpubhex&&void 0!==this.eccurvename)return new KJUR.crypto.ECDSA({curve:this.eccurvename}).verifyHex(this.sHashHex,e,this.ecpubhex);if(this.pubKey instanceof RSAKey&&"rsaandmgf1"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,e,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof RSAKey&&"rsa"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHash(this.sHashHex,e);if(void 0!==KJUR.crypto.ECDSA&&this.pubKey instanceof KJUR.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,e);if(void 0!==KJUR.crypto.DSA&&this.pubKey instanceof KJUR.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,e);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(e,t){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(e){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(e){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(e){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(e){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(e){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},void 0!==(this.initParams=e)&&(void 0!==e.alg&&(this.algName=e.alg,void 0===e.prov?this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=e.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),void 0!==e.psssaltlen&&(this.pssSaltLen=e.psssaltlen),void 0!==e.prvkeypem)){if(void 0!==e.prvkeypas)throw"both prvkeypem and prvkeypas parameters not supported";try{t=KEYUTIL.getKey(e.prvkeypem);this.init(t)}catch(e){throw"fatal error to load pem private key: "+e}}},KJUR.crypto.Cipher=function(e){},KJUR.crypto.Cipher.encrypt=function(e,t,i){if(t instanceof RSAKey&&t.isPublic){var n=KJUR.crypto.Cipher.getAlgByKeyAndName(t,i);if("RSA"===n)return t.encrypt(e);if("RSAOAEP"===n)return t.encryptOAEP(e,"sha1");var r=n.match(/^RSAOAEP(\d+)$/);if(null!==r)return t.encryptOAEP(e,"sha"+r[1]);throw"Cipher.encrypt: unsupported algorithm for RSAKey: "+i}throw"Cipher.encrypt: unsupported key or algorithm"},KJUR.crypto.Cipher.decrypt=function(e,t,i){if(t instanceof RSAKey&&t.isPrivate){var n=KJUR.crypto.Cipher.getAlgByKeyAndName(t,i);if("RSA"===n)return t.decrypt(e);if("RSAOAEP"===n)return t.decryptOAEP(e,"sha1");var r=n.match(/^RSAOAEP(\d+)$/);if(null!==r)return t.decryptOAEP(e,"sha"+r[1]);throw"Cipher.decrypt: unsupported algorithm for RSAKey: "+i}throw"Cipher.decrypt: unsupported key or algorithm"},KJUR.crypto.Cipher.getAlgByKeyAndName=function(e,t){if(e instanceof RSAKey){if(-1!=":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(t))return t;if(null==t)return"RSA";throw"getAlgByKeyAndName: not supported algorithm name for RSAKey: "+t}throw"getAlgByKeyAndName: not supported algorithm name: "+t},KJUR.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},void 0!==KJUR&&KJUR||(KJUR={}),void 0!==KJUR.crypto&&KJUR.crypto||(KJUR.crypto={}),KJUR.crypto.ECDSA=function(e){var t=new SecureRandom;this.type="EC",this.isPrivate=!1,this.isPublic=!1,this.getBigRandom=function(e){return new BigInteger(e.bitLength(),t).mod(e.subtract(BigInteger.ONE)).add(BigInteger.ONE)},this.setNamedCurve=function(e){this.ecparams=KJUR.crypto.ECParameterDB.getByName(e),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=e},this.setPrivateKeyHex=function(e){this.isPrivate=!0,this.prvKeyHex=e},this.setPublicKeyHex=function(e){this.isPublic=!0,this.pubKeyHex=e},this.getPublicKeyXYHex=function(){var e=this.pubKeyHex;if("04"!==e.substr(0,2))throw"this method supports uncompressed format(04) only";var t=this.ecparams.keylen/4;if(e.length!==2+2*t)throw"malformed public key hex length";var i={};return i.x=e.substr(2,t),i.y=e.substr(2+t),i},this.getShortNISTPCurveName=function(){var e=this.curveName;return"secp256r1"===e||"NIST P-256"===e||"P-256"===e||"prime256v1"===e?"P-256":"secp384r1"===e||"NIST P-384"===e||"P-384"===e?"P-384":null},this.generateKeyPairHex=function(){var e=this.ecparams.n,t=this.getBigRandom(e),i=this.ecparams.G.multiply(t),n=i.getX().toBigInteger(),r=i.getY().toBigInteger(),s=this.ecparams.keylen/4,a=("0000000000"+t.toString(16)).slice(-s),o="04"+("0000000000"+n.toString(16)).slice(-s)+("0000000000"+r.toString(16)).slice(-s);return this.setPrivateKeyHex(a),this.setPublicKeyHex(o),{ecprvhex:a,ecpubhex:o}},this.signWithMessageHash=function(e){return this.signHex(e,this.prvKeyHex)},this.signHex=function(e,t){var i=new BigInteger(t,16),n=this.ecparams.n,r=new BigInteger(e,16);do{var s=this.getBigRandom(n),a=this.ecparams.G.multiply(s).getX().toBigInteger().mod(n)}while(a.compareTo(BigInteger.ZERO)<=0);var o=s.modInverse(n).multiply(r.add(i.multiply(a))).mod(n);return KJUR.crypto.ECDSA.biRSSigToASN1Sig(a,o)},this.sign=function(e,t){var i=t,n=this.ecparams.n,r=BigInteger.fromByteArrayUnsigned(e);do{var s=this.getBigRandom(n),a=this.ecparams.G.multiply(s).getX().toBigInteger().mod(n)}while(a.compareTo(BigInteger.ZERO)<=0);var o=s.modInverse(n).multiply(r.add(i.multiply(a))).mod(n);return this.serializeSig(a,o)},this.verifyWithMessageHash=function(e,t){return this.verifyHex(e,t,this.pubKeyHex)},this.verifyHex=function(e,t,i){var n,r,s,a=KJUR.crypto.ECDSA.parseSigHex(t);n=a.r,r=a.s,s=ECPointFp.decodeFromHex(this.ecparams.curve,i);var o=new BigInteger(e,16);return this.verifyRaw(o,n,r,s)},this.verify=function(e,t,i){var n,r,s;if(Bitcoin.Util.isArray(t)){var a=this.parseSig(t);n=a.r,r=a.s}else{if("object"!=typeof t||!t.r||!t.s)throw"Invalid value for signature";n=t.r,r=t.s}if(i instanceof ECPointFp)s=i;else{if(!Bitcoin.Util.isArray(i))throw"Invalid format for pubkey value, must be byte array or ECPointFp";s=ECPointFp.decodeFrom(this.ecparams.curve,i)}var o=BigInteger.fromByteArrayUnsigned(e);return this.verifyRaw(o,n,r,s)},this.verifyRaw=function(e,t,i,n){var r=this.ecparams.n,s=this.ecparams.G;if(t.compareTo(BigInteger.ONE)<0||0<=t.compareTo(r))return!1;if(i.compareTo(BigInteger.ONE)<0||0<=i.compareTo(r))return!1;var a=i.modInverse(r),o=e.multiply(a).mod(r),c=t.multiply(a).mod(r);return s.multiply(o).add(n.multiply(c)).getX().toBigInteger().mod(r).equals(t)},this.serializeSig=function(e,t){var i=e.toByteArraySigned(),n=t.toByteArraySigned(),r=[];return r.push(2),r.push(i.length),(r=r.concat(i)).push(2),r.push(n.length),(r=r.concat(n)).unshift(r.length),r.unshift(48),r},this.parseSig=function(e){var t;if(48!=e[0])throw new Error("Signature not a valid DERSequence");if((t=2)!=e[t])throw new Error("First element in signature must be a DERInteger");var i=e.slice(t+2,t+2+e[t+1]);if(2!=e[t+=2+e[t+1]])throw new Error("Second element in signature must be a DERInteger");var n=e.slice(t+2,t+2+e[t+1]);return t+=2+e[t+1],{r:BigInteger.fromByteArrayUnsigned(i),s:BigInteger.fromByteArrayUnsigned(n)}},this.parseSigCompact=function(e){if(65!==e.length)throw"Signature has the wrong length";var t=e[0]-27;if(t<0||7<t)throw"Invalid signature type";var i=this.ecparams.n;return{r:BigInteger.fromByteArrayUnsigned(e.slice(1,33)).mod(i),s:BigInteger.fromByteArrayUnsigned(e.slice(33,65)).mod(i),i:t}},this.readPKCS5PrvKeyHex=function(e){var t,i,n,r=ASN1HEX,s=KJUR.crypto.ECDSA.getName,a=r.getVbyList;if(!1===r.isASN1HEX(e))throw"not ASN.1 hex string";try{t=a(e,0,[2,0],"06"),i=a(e,0,[1],"04");try{n=a(e,0,[3,0],"03").substr(2)}catch(e){}}catch(e){throw"malformed PKCS#1/5 plain ECC private key"}if(this.curveName=s(t),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(n),this.setPrivateKeyHex(i),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(e){var t,i,n,r=ASN1HEX,s=KJUR.crypto.ECDSA.getName,a=r.getVbyList;if(!1===r.isASN1HEX(e))throw"not ASN.1 hex string";try{a(e,0,[1,0],"06"),t=a(e,0,[1,1],"06"),i=a(e,0,[2,0,1],"04");try{n=a(e,0,[2,0,2,0],"03").substr(2)}catch(e){}}catch(e){throw"malformed PKCS#8 plain ECC private key"}if(this.curveName=s(t),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(n),this.setPrivateKeyHex(i),this.isPublic=!1},this.readPKCS8PubKeyHex=function(e){var t,i,n=ASN1HEX,r=KJUR.crypto.ECDSA.getName,s=n.getVbyList;if(!1===n.isASN1HEX(e))throw"not ASN.1 hex string";try{s(e,0,[0,0],"06"),t=s(e,0,[0,1],"06"),i=s(e,0,[1],"03").substr(2)}catch(e){throw"malformed PKCS#8 ECC public key"}if(this.curveName=r(t),null===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(i)},this.readCertPubKeyHex=function(e,t){5!==t&&(t=6);var i,n,r=ASN1HEX,s=KJUR.crypto.ECDSA.getName,a=r.getVbyList;if(!1===r.isASN1HEX(e))throw"not ASN.1 hex string";try{i=a(e,0,[0,t,0,1],"06"),n=a(e,0,[0,t,1],"03").substr(2)}catch(e){throw"malformed X.509 certificate ECC public key"}if(this.curveName=s(i),null===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(n)},void 0!==e&&void 0!==e.curve&&(this.curveName=e.curve),void 0===this.curveName&&(this.curveName="secp256r1"),this.setNamedCurve(this.curveName),void 0!==e&&(void 0!==e.prv&&this.setPrivateKeyHex(e.prv),void 0!==e.pub&&this.setPublicKeyHex(e.pub))},KJUR.crypto.ECDSA.parseSigHex=function(e){var t=KJUR.crypto.ECDSA.parseSigHexInHexRS(e);return{r:new BigInteger(t.r,16),s:new BigInteger(t.s,16)}},KJUR.crypto.ECDSA.parseSigHexInHexRS=function(e){var t=ASN1HEX,i=t.getChildIdx,n=t.getV;if("30"!=e.substr(0,2))throw"signature is not a ASN.1 sequence";var r=i(e,0);if(2!=r.length)throw"number of signature ASN.1 sequence elements seem wrong";var s=r[0],a=r[1];if("02"!=e.substr(s,2))throw"1st item of sequene of signature is not ASN.1 integer";if("02"!=e.substr(a,2))throw"2nd item of sequene of signature is not ASN.1 integer";return{r:n(e,s),s:n(e,a)}},KJUR.crypto.ECDSA.asn1SigToConcatSig=function(e){var t=KJUR.crypto.ECDSA.parseSigHexInHexRS(e),i=t.r,n=t.s;if("00"==i.substr(0,2)&&i.length%32==2&&(i=i.substr(2)),"00"==n.substr(0,2)&&n.length%32==2&&(n=n.substr(2)),i.length%32==30&&(i="00"+i),n.length%32==30&&(n="00"+n),i.length%32!=0)throw"unknown ECDSA sig r length error";if(n.length%32!=0)throw"unknown ECDSA sig s length error";return i+n},KJUR.crypto.ECDSA.concatSigToASN1Sig=function(e){if(e.length/2*8%128!=0)throw"unknown ECDSA concatinated r-s sig  length error";var t=e.substr(0,e.length/2),i=e.substr(e.length/2);return KJUR.crypto.ECDSA.hexRSSigToASN1Sig(t,i)},KJUR.crypto.ECDSA.hexRSSigToASN1Sig=function(e,t){var i=new BigInteger(e,16),n=new BigInteger(t,16);return KJUR.crypto.ECDSA.biRSSigToASN1Sig(i,n)},KJUR.crypto.ECDSA.biRSSigToASN1Sig=function(e,t){var i=KJUR.asn1,n=new i.DERInteger({bigint:e}),r=new i.DERInteger({bigint:t});return new i.DERSequence({array:[n,r]}).getEncodedHex()},KJUR.crypto.ECDSA.getName=function(e){return"2a8648ce3d030107"===e?"secp256r1":"2b8104000a"===e?"secp256k1":"2b81040022"===e?"secp384r1":-1!=="|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(e)?"secp256r1":-1!=="|secp256k1|".indexOf(e)?"secp256k1":-1!=="|secp384r1|NIST P-384|P-384|".indexOf(e)?"secp384r1":null},void 0!==KJUR&&KJUR||(KJUR={}),void 0!==KJUR.crypto&&KJUR.crypto||(KJUR.crypto={}),KJUR.crypto.ECParameterDB=new function(){var v={},A={};function C(e){return new BigInteger(e,16)}this.getByName=function(e){var t=e;if(void 0!==A[t]&&(t=A[e]),void 0!==v[t])return v[t];throw"unregistered EC curve name: "+t},this.regist=function(e,t,i,n,r,s,a,o,c,l,u,h){v[e]={};var g=C(i),d=C(n),p=C(r),f=C(s),y=C(a),m=new ECCurveFp(g,d,p),b=m.decodePointHex("04"+o+c);v[e].name=e,v[e].keylen=t,v[e].curve=m,v[e].G=b,v[e].n=f,v[e].h=y,v[e].oid=u,v[e].info=h;for(var I=0;I<l.length;I++)A[l[I]]=e}},KJUR.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),KJUR.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),KJUR.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),KJUR.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),KJUR.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),KJUR.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),KJUR.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),KJUR.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),KJUR.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),KJUR.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]),void 0!==KJUR&&KJUR||(KJUR={}),void 0!==KJUR.crypto&&KJUR.crypto||(KJUR.crypto={}),KJUR.crypto.DSA=function(){this.p=null,this.q=null,this.g=null,this.y=null,this.x=null,this.type="DSA",this.isPrivate=!1,this.isPublic=!1,this.setPrivate=function(e,t,i,n,r){this.isPrivate=!0,this.p=e,this.q=t,this.g=i,this.y=n,this.x=r},this.setPrivateHex=function(e,t,i,n,r){var s,a,o,c,l;s=new BigInteger(e,16),a=new BigInteger(t,16),o=new BigInteger(i,16),c="string"==typeof n&&1<n.length?new BigInteger(n,16):null,l=new BigInteger(r,16),this.setPrivate(s,a,o,c,l)},this.setPublic=function(e,t,i,n){this.isPublic=!0,this.p=e,this.q=t,this.g=i,this.y=n,this.x=null},this.setPublicHex=function(e,t,i,n){var r,s,a,o;r=new BigInteger(e,16),s=new BigInteger(t,16),a=new BigInteger(i,16),o=new BigInteger(n,16),this.setPublic(r,s,a,o)},this.signWithMessageHash=function(e){var t=this.p,i=this.q,n=this.g,r=(this.y,this.x),s=KJUR.crypto.Util.getRandomBigIntegerMinToMax(BigInteger.ONE.add(BigInteger.ONE),i.subtract(BigInteger.ONE)),a=new BigInteger(e.substr(0,i.bitLength()/4),16),o=n.modPow(s,t).mod(i),c=s.modInverse(i).multiply(a.add(r.multiply(o))).mod(i);return KJUR.asn1.ASN1Util.jsonToASN1HEX({seq:[{int:{bigint:o}},{int:{bigint:c}}]})},this.verifyWithMessageHash=function(e,t){var i=this.p,n=this.q,r=this.g,s=this.y,a=this.parseASN1Signature(t),o=a[0],c=a[1],l=new BigInteger(e.substr(0,n.bitLength()/4),16);if(0<BigInteger.ZERO.compareTo(o)||0<o.compareTo(n))throw"invalid DSA signature";if(0<=BigInteger.ZERO.compareTo(c)||0<c.compareTo(n))throw"invalid DSA signature";var u=c.modInverse(n),h=l.multiply(u).mod(n),g=o.multiply(u).mod(n);return 0==r.modPow(h,i).multiply(s.modPow(g,i)).mod(i).mod(n).compareTo(o)},this.parseASN1Signature=function(e){try{return[new BigInteger(ASN1HEX.getVbyList(e,0,[0],"02"),16),new BigInteger(ASN1HEX.getVbyList(e,0,[1],"02"),16)]}catch(e){throw"malformed ASN.1 DSA signature"}},this.readPKCS5PrvKeyHex=function(e){var t,i,n,r,s,a=ASN1HEX,o=a.getVbyList;if(!1===a.isASN1HEX(e))throw"not ASN.1 hex string";try{t=o(e,0,[1],"02"),i=o(e,0,[2],"02"),n=o(e,0,[3],"02"),r=o(e,0,[4],"02"),s=o(e,0,[5],"02")}catch(e){throw console.log("EXCEPTION:"+e),"malformed PKCS#1/5 plain DSA private key"}this.setPrivateHex(t,i,n,r,s)},this.readPKCS8PrvKeyHex=function(e){var t,i,n,r,s=ASN1HEX,a=s.getVbyList;if(!1===s.isASN1HEX(e))throw"not ASN.1 hex string";try{t=a(e,0,[1,1,0],"02"),i=a(e,0,[1,1,1],"02"),n=a(e,0,[1,1,2],"02"),r=a(e,0,[2,0],"02")}catch(e){throw console.log("EXCEPTION:"+e),"malformed PKCS#8 plain DSA private key"}this.setPrivateHex(t,i,n,null,r)},this.readPKCS8PubKeyHex=function(e){var t,i,n,r,s=ASN1HEX,a=s.getVbyList;if(!1===s.isASN1HEX(e))throw"not ASN.1 hex string";try{t=a(e,0,[0,1,0],"02"),i=a(e,0,[0,1,1],"02"),n=a(e,0,[0,1,2],"02"),r=a(e,0,[1,0],"02")}catch(e){throw console.log("EXCEPTION:"+e),"malformed PKCS#8 DSA public key"}this.setPublicHex(t,i,n,r)},this.readCertPubKeyHex=function(e,t){var i,n,r,s;5!==t&&(t=6);var a=ASN1HEX,o=a.getVbyList;if(!1===a.isASN1HEX(e))throw"not ASN.1 hex string";try{i=o(e,0,[0,t,0,1,0],"02"),n=o(e,0,[0,t,0,1,1],"02"),r=o(e,0,[0,t,0,1,2],"02"),s=o(e,0,[0,t,1,0],"02")}catch(e){throw console.log("EXCEPTION:"+e),"malformed X.509 certificate DSA public key"}this.setPublicHex(i,n,r,s)}};var KEYUTIL=(XYa=function(e,t,i){return $Ya(CryptoJS.AES,e,t,i)},$Ya=function(e,t,i,n){var r=CryptoJS.enc.Hex.parse(t),s=CryptoJS.enc.Hex.parse(i),a=CryptoJS.enc.Hex.parse(n),o={};o.key=s,o.iv=a,o.ciphertext=r;var c=e.decrypt(o,s,{iv:a});return CryptoJS.enc.Hex.stringify(c)},_Ya=function(e,t,i){return cZa(CryptoJS.AES,e,t,i)},cZa=function(e,t,i,n){var r=CryptoJS.enc.Hex.parse(t),s=CryptoJS.enc.Hex.parse(i),a=CryptoJS.enc.Hex.parse(n),o=e.encrypt(r,s,{iv:a}),c=CryptoJS.enc.Hex.parse(o.toString());return CryptoJS.enc.Base64.stringify(c)},dZa={"AES-256-CBC":{proc:XYa,eproc:_Ya,keylen:32,ivlen:16},"AES-192-CBC":{proc:XYa,eproc:_Ya,keylen:24,ivlen:16},"AES-128-CBC":{proc:XYa,eproc:_Ya,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:function(e,t,i){return $Ya(CryptoJS.TripleDES,e,t,i)},eproc:function(e,t,i){return cZa(CryptoJS.TripleDES,e,t,i)},keylen:24,ivlen:8},"DES-CBC":{proc:function(e,t,i){return $Ya(CryptoJS.DES,e,t,i)},eproc:function(e,t,i){return cZa(CryptoJS.DES,e,t,i)},keylen:8,ivlen:8}},fZa=function(e){var t={},i=e.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));i&&(t.cipher=i[1],t.ivsalt=i[2]);var n=e.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));n&&(t.type=n[1]);var r=-1,s=0;-1!=e.indexOf("\r\n\r\n")&&(r=e.indexOf("\r\n\r\n"),s=2),-1!=e.indexOf("\n\n")&&(r=e.indexOf("\n\n"),s=1);var a=e.indexOf("-----END");if(-1!=r&&-1!=a){var o=e.substring(r+2*s,a-s);o=o.replace(/\s+/g,""),t.data=o}return t},gZa=function(e,t,i){for(var n=i.substring(0,16),r=CryptoJS.enc.Hex.parse(n),s=CryptoJS.enc.Utf8.parse(t),a=dZa[e].keylen+dZa[e].ivlen,o="",c=null;;){var l=CryptoJS.algo.MD5.create();if(null!=c&&l.update(c),l.update(s),l.update(r),c=l.finalize(),(o+=CryptoJS.enc.Hex.stringify(c)).length>=2*a)break}var u={};return u.keyhex=o.substr(0,2*dZa[e].keylen),u.ivhex=o.substr(2*dZa[e].keylen,2*dZa[e].ivlen),u},hZa=function(e,t,i,n){var r=CryptoJS.enc.Base64.parse(e),s=CryptoJS.enc.Hex.stringify(r);return(0,dZa[t].proc)(s,i,n)},{version:"1.0.0",parsePKCS5PEM:function(e){return fZa(e)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(e,t,i){return gZa(e,t,i)},decryptKeyB64:function(e,t,i,n){return hZa(e,t,i,n)},getDecryptedKeyHex:function(e,t){var i=fZa(e),n=i.cipher,r=i.ivsalt,s=i.data,a=gZa(n,t,r).keyhex;return hZa(s,n,a,r)},getEncryptedPKCS5PEMFromPrvKeyHex:function(e,t,i,n,r){var s,a,o="";if(void 0!==n&&null!=n||(n="AES-256-CBC"),void 0===dZa[n])throw"KEYUTIL unsupported algorithm: "+n;if(void 0===r||null==r){var c=dZa[n].ivlen;r=(s=c,a=CryptoJS.lib.WordArray.random(s),CryptoJS.enc.Hex.stringify(a)).toUpperCase()}var l,u,h,g=gZa(n,i,r).keyhex;return o="-----BEGIN "+e+" PRIVATE KEY-----\r\n",o+="Proc-Type: 4,ENCRYPTED\r\n",o+="DEK-Info: "+n+","+r+"\r\n",o+="\r\n",o+=(l=t,u=g,h=r,(0,dZa[n].eproc)(l,u,h)).replace(/(.{64})/g,"$1\r\n"),o+="\r\n-----END "+e+" PRIVATE KEY-----\r\n"},parseHexOfEncryptedPKCS8:function(e){var t=ASN1HEX,i=t.getChildIdx,n=t.getV,r={},s=i(e,0);if(2!=s.length)throw"malformed format: SEQUENCE(0).items != 2: "+s.length;r.ciphertext=n(e,s[1]);var a=i(e,s[0]);if(2!=a.length)throw"malformed format: SEQUENCE(0.0).items != 2: "+a.length;if("2a864886f70d01050d"!=n(e,a[0]))throw"this only supports pkcs5PBES2";var o=i(e,a[1]);if(2!=a.length)throw"malformed format: SEQUENCE(0.0.1).items != 2: "+o.length;var c=i(e,o[1]);if(2!=c.length)throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+c.length;if("2a864886f70d0307"!=n(e,c[0]))throw"this only supports TripleDES";r.encryptionSchemeAlg="TripleDES",r.encryptionSchemeIV=n(e,c[1]);var l=i(e,o[0]);if(2!=l.length)throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+l.length;if("2a864886f70d01050c"!=n(e,l[0]))throw"this only supports pkcs5PBKDF2";var u=i(e,l[1]);if(u.length<2)throw"malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+u.length;r.pbkdf2Salt=n(e,u[0]);var h=n(e,u[1]);try{r.pbkdf2Iter=parseInt(h,16)}catch(e){throw"malformed format pbkdf2Iter: "+h}return r},getPBKDF2KeyHexFromParam:function(e,t){var i=CryptoJS.enc.Hex.parse(e.pbkdf2Salt),n=e.pbkdf2Iter,r=CryptoJS.PBKDF2(t,i,{keySize:6,iterations:n});return CryptoJS.enc.Hex.stringify(r)},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(e,t){var i=pemtohex(e,"ENCRYPTED PRIVATE KEY"),n=this.parseHexOfEncryptedPKCS8(i),r=KEYUTIL.getPBKDF2KeyHexFromParam(n,t),s={};s.ciphertext=CryptoJS.enc.Hex.parse(n.ciphertext);var a=CryptoJS.enc.Hex.parse(r),o=CryptoJS.enc.Hex.parse(n.encryptionSchemeIV),c=CryptoJS.TripleDES.decrypt(s,a,{iv:o});return CryptoJS.enc.Hex.stringify(c)},getKeyFromEncryptedPKCS8PEM:function(e,t){var i=this._getPlainPKCS8HexFromEncryptedPKCS8PEM(e,t);return this.getKeyFromPlainPrivatePKCS8Hex(i)},parsePlainPrivatePKCS8Hex:function(e){var t=ASN1HEX,i=t.getChildIdx,n=t.getV,r={algparam:null};if("30"!=e.substr(0,2))throw"malformed plain PKCS8 private key(code:001)";var s=i(e,0);if(3!=s.length)throw"malformed plain PKCS8 private key(code:002)";if("30"!=e.substr(s[1],2))throw"malformed PKCS8 private key(code:003)";var a=i(e,s[1]);if(2!=a.length)throw"malformed PKCS8 private key(code:004)";if("06"!=e.substr(a[0],2))throw"malformed PKCS8 private key(code:005)";if(r.algoid=n(e,a[0]),"06"==e.substr(a[1],2)&&(r.algparam=n(e,a[1])),"04"!=e.substr(s[2],2))throw"malformed PKCS8 private key(code:006)";return r.keyidx=t.getVidx(e,s[2]),r},getKeyFromPlainPrivatePKCS8PEM:function(e){var t=pemtohex(e,"PRIVATE KEY");return this.getKeyFromPlainPrivatePKCS8Hex(t)},getKeyFromPlainPrivatePKCS8Hex:function(e){var t,i=this.parsePlainPrivatePKCS8Hex(e);if("2a864886f70d010101"==i.algoid)t=new RSAKey;else if("2a8648ce380401"==i.algoid)t=new KJUR.crypto.DSA;else{if("2a8648ce3d0201"!=i.algoid)throw"unsupported private key algorithm";t=new KJUR.crypto.ECDSA}return t.readPKCS8PrvKeyHex(e),t},_getKeyFromPublicPKCS8Hex:function(e){var t,i=ASN1HEX.getVbyList(e,0,[0,0],"06");if("2a864886f70d010101"===i)t=new RSAKey;else if("2a8648ce380401"===i)t=new KJUR.crypto.DSA;else{if("2a8648ce3d0201"!==i)throw"unsupported PKCS#8 public key hex";t=new KJUR.crypto.ECDSA}return t.readPKCS8PubKeyHex(e),t},parsePublicRawRSAKeyHex:function(e){var t=ASN1HEX,i=t.getChildIdx,n=t.getV,r={};if("30"!=e.substr(0,2))throw"malformed RSA key(code:001)";var s=i(e,0);if(2!=s.length)throw"malformed RSA key(code:002)";if("02"!=e.substr(s[0],2))throw"malformed RSA key(code:003)";if(r.n=n(e,s[0]),"02"!=e.substr(s[1],2))throw"malformed RSA key(code:004)";return r.e=n(e,s[1]),r},parsePublicPKCS8Hex:function(e){var t=ASN1HEX,i=t.getChildIdx,n=t.getV,r={algparam:null},s=i(e,0);if(2!=s.length)throw"outer DERSequence shall have 2 elements: "+s.length;var a=s[0];if("30"!=e.substr(a,2))throw"malformed PKCS8 public key(code:001)";var o=i(e,a);if(2!=o.length)throw"malformed PKCS8 public key(code:002)";if("06"!=e.substr(o[0],2))throw"malformed PKCS8 public key(code:003)";if(r.algoid=n(e,o[0]),"06"==e.substr(o[1],2)?r.algparam=n(e,o[1]):"30"==e.substr(o[1],2)&&(r.algparam={},r.algparam.p=t.getVbyList(e,o[1],[0],"02"),r.algparam.q=t.getVbyList(e,o[1],[1],"02"),r.algparam.g=t.getVbyList(e,o[1],[2],"02")),"03"!=e.substr(s[1],2))throw"malformed PKCS8 public key(code:004)";return r.key=n(e,s[1]).substr(2),r}}),XYa,$Ya,_Ya,cZa,dZa,fZa,gZa,hZa;KEYUTIL.getKey=function(e,t,i){var n=(y=ASN1HEX).getChildIdx,r=(y.getV,y.getVbyList),s=KJUR.crypto,a=s.ECDSA,o=s.DSA,c=RSAKey,l=pemtohex,u=KEYUTIL;if(void 0!==c&&e instanceof c)return e;if(void 0!==a&&e instanceof a)return e;if(void 0!==o&&e instanceof o)return e;if(void 0!==e.curve&&void 0!==e.xy&&void 0===e.d)return new a({pub:e.xy,curve:e.curve});if(void 0!==e.curve&&void 0!==e.d)return new a({prv:e.d,curve:e.curve});if(void 0===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0===e.d)return(T=new c).setPublic(e.n,e.e),T;if(void 0===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d&&void 0!==e.p&&void 0!==e.q&&void 0!==e.dp&&void 0!==e.dq&&void 0!==e.co&&void 0===e.qi)return(T=new c).setPrivateEx(e.n,e.e,e.d,e.p,e.q,e.dp,e.dq,e.co),T;if(void 0===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d&&void 0===e.p)return(T=new c).setPrivate(e.n,e.e,e.d),T;if(void 0!==e.p&&void 0!==e.q&&void 0!==e.g&&void 0!==e.y&&void 0===e.x)return(T=new o).setPublic(e.p,e.q,e.g,e.y),T;if(void 0!==e.p&&void 0!==e.q&&void 0!==e.g&&void 0!==e.y&&void 0!==e.x)return(T=new o).setPrivate(e.p,e.q,e.g,e.y,e.x),T;if("RSA"===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0===e.d)return(T=new c).setPublic(b64utohex(e.n),b64utohex(e.e)),T;if("RSA"===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d&&void 0!==e.p&&void 0!==e.q&&void 0!==e.dp&&void 0!==e.dq&&void 0!==e.qi)return(T=new c).setPrivateEx(b64utohex(e.n),b64utohex(e.e),b64utohex(e.d),b64utohex(e.p),b64utohex(e.q),b64utohex(e.dp),b64utohex(e.dq),b64utohex(e.qi)),T;if("RSA"===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d)return(T=new c).setPrivate(b64utohex(e.n),b64utohex(e.e),b64utohex(e.d)),T;if("EC"===e.kty&&void 0!==e.crv&&void 0!==e.x&&void 0!==e.y&&void 0===e.d){var h=(x=new a({curve:e.crv})).ecparams.keylen/4,g="04"+("0000000000"+b64utohex(e.x)).slice(-h)+("0000000000"+b64utohex(e.y)).slice(-h);return x.setPublicKeyHex(g),x}if("EC"===e.kty&&void 0!==e.crv&&void 0!==e.x&&void 0!==e.y&&void 0!==e.d){h=(x=new a({curve:e.crv})).ecparams.keylen/4,g="04"+("0000000000"+b64utohex(e.x)).slice(-h)+("0000000000"+b64utohex(e.y)).slice(-h);var d=("0000000000"+b64utohex(e.d)).slice(-h);return x.setPublicKeyHex(g),x.setPrivateKeyHex(d),x}if("pkcs5prv"===i){var p,f=e,y=ASN1HEX;if(9===(p=n(f,0)).length)(T=new c).readPKCS5PrvKeyHex(f);else if(6===p.length)(T=new o).readPKCS5PrvKeyHex(f);else{if(!(2<p.length&&"04"===f.substr(p[1],2)))throw"unsupported PKCS#1/5 hexadecimal key";(T=new a).readPKCS5PrvKeyHex(f)}return T}if("pkcs8prv"===i)return T=u.getKeyFromPlainPrivatePKCS8Hex(e);if("pkcs8pub"===i)return u._getKeyFromPublicPKCS8Hex(e);if("x509pub"===i)return X509.getPublicKeyFromCertHex(e);if(-1!=e.indexOf("-END CERTIFICATE-",0)||-1!=e.indexOf("-END X509 CERTIFICATE-",0)||-1!=e.indexOf("-END TRUSTED CERTIFICATE-",0))return X509.getPublicKeyFromCertPEM(e);if(-1!=e.indexOf("-END PUBLIC KEY-")){var m=pemtohex(e,"PUBLIC KEY");return u._getKeyFromPublicPKCS8Hex(m)}if(-1!=e.indexOf("-END RSA PRIVATE KEY-")&&-1==e.indexOf("4,ENCRYPTED")){var b=l(e,"RSA PRIVATE KEY");return u.getKey(b,null,"pkcs5prv")}if(-1!=e.indexOf("-END DSA PRIVATE KEY-")&&-1==e.indexOf("4,ENCRYPTED")){var I=r(k=l(e,"DSA PRIVATE KEY"),0,[1],"02"),v=r(k,0,[2],"02"),A=r(k,0,[3],"02"),C=r(k,0,[4],"02"),S=r(k,0,[5],"02");return(T=new o).setPrivate(new BigInteger(I,16),new BigInteger(v,16),new BigInteger(A,16),new BigInteger(C,16),new BigInteger(S,16)),T}if(-1!=e.indexOf("-END PRIVATE KEY-"))return u.getKeyFromPlainPrivatePKCS8PEM(e);if(-1!=e.indexOf("-END RSA PRIVATE KEY-")&&-1!=e.indexOf("4,ENCRYPTED")){var w=u.getDecryptedKeyHex(e,t),E=new RSAKey;return E.readPKCS5PrvKeyHex(w),E}if(-1!=e.indexOf("-END EC PRIVATE KEY-")&&-1!=e.indexOf("4,ENCRYPTED")){var x,T=r(k=u.getDecryptedKeyHex(e,t),0,[1],"04"),R=r(k,0,[2,0],"06"),F=r(k,0,[3,0],"03").substr(2);if(void 0===KJUR.crypto.OID.oidhex2name[R])throw"undefined OID(hex) in KJUR.crypto.OID: "+R;return(x=new a({curve:KJUR.crypto.OID.oidhex2name[R]})).setPublicKeyHex(F),x.setPrivateKeyHex(T),x.isPublic=!1,x}if(-1!=e.indexOf("-END DSA PRIVATE KEY-")&&-1!=e.indexOf("4,ENCRYPTED")){var k;I=r(k=u.getDecryptedKeyHex(e,t),0,[1],"02"),v=r(k,0,[2],"02"),A=r(k,0,[3],"02"),C=r(k,0,[4],"02"),S=r(k,0,[5],"02");return(T=new o).setPrivate(new BigInteger(I,16),new BigInteger(v,16),new BigInteger(A,16),new BigInteger(C,16),new BigInteger(S,16)),T}if(-1!=e.indexOf("-END ENCRYPTED PRIVATE KEY-"))return u.getKeyFromEncryptedPKCS8PEM(e,t);throw"not supported argument"},KEYUTIL.generateKeypair=function(e,t){if("RSA"==e){var i=t;(a=new RSAKey).generate(i,"10001"),a.isPrivate=!0,a.isPublic=!0;var n=new RSAKey,r=a.n.toString(16),s=a.e.toString(16);return n.setPublic(r,s),n.isPrivate=!1,n.isPublic=!0,(o={}).prvKeyObj=a,o.pubKeyObj=n,o}if("EC"!=e)throw"unknown algorithm: "+e;var a,o,c=t,l=new KJUR.crypto.ECDSA({curve:c}).generateKeyPairHex();return(a=new KJUR.crypto.ECDSA({curve:c})).setPublicKeyHex(l.ecpubhex),a.setPrivateKeyHex(l.ecprvhex),a.isPrivate=!0,a.isPublic=!1,(n=new KJUR.crypto.ECDSA({curve:c})).setPublicKeyHex(l.ecpubhex),n.isPrivate=!1,n.isPublic=!0,(o={}).prvKeyObj=a,o.pubKeyObj=n,o},KEYUTIL.getPEM=function(e,t,i,n,r,s){var a=KJUR,o=a.asn1,c=o.DERObjectIdentifier,l=o.DERInteger,u=o.ASN1Util.newObject,h=o.x509.SubjectPublicKeyInfo,g=a.crypto,d=g.DSA,p=g.ECDSA,f=RSAKey;function y(e){return u({seq:[{int:0},{int:{bigint:e.n}},{int:e.e},{int:{bigint:e.d}},{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.dmp1}},{int:{bigint:e.dmq1}},{int:{bigint:e.coeff}}]})}function m(e){return u({seq:[{int:1},{octstr:{hex:e.prvKeyHex}},{tag:["a0",!0,{oid:{name:e.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+e.pubKeyHex}}]}]})}function b(e){return u({seq:[{int:0},{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.g}},{int:{bigint:e.y}},{int:{bigint:e.x}}]})}if((void 0!==f&&e instanceof f||void 0!==d&&e instanceof d||void 0!==p&&e instanceof p)&&1==e.isPublic&&(void 0===t||"PKCS8PUB"==t))return hextopem(C=new h(e).getEncodedHex(),"PUBLIC KEY");if("PKCS1PRV"==t&&void 0!==f&&e instanceof f&&(void 0===i||null==i)&&1==e.isPrivate)return hextopem(C=y(e).getEncodedHex(),"RSA PRIVATE KEY");if("PKCS1PRV"==t&&void 0!==p&&e instanceof p&&(void 0===i||null==i)&&1==e.isPrivate){var I=new c({name:e.curveName}).getEncodedHex(),v=m(e).getEncodedHex(),A="";return A+=hextopem(I,"EC PARAMETERS"),A+=hextopem(v,"EC PRIVATE KEY")}if("PKCS1PRV"==t&&void 0!==d&&e instanceof d&&(void 0===i||null==i)&&1==e.isPrivate)return hextopem(C=b(e).getEncodedHex(),"DSA PRIVATE KEY");if("PKCS5PRV"==t&&void 0!==f&&e instanceof f&&void 0!==i&&null!=i&&1==e.isPrivate){var C=y(e).getEncodedHex();return void 0===n&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",C,i,n,s)}if("PKCS5PRV"==t&&void 0!==p&&e instanceof p&&void 0!==i&&null!=i&&1==e.isPrivate){C=m(e).getEncodedHex();return void 0===n&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",C,i,n,s)}if("PKCS5PRV"==t&&void 0!==d&&e instanceof d&&void 0!==i&&null!=i&&1==e.isPrivate){C=b(e).getEncodedHex();return void 0===n&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",C,i,n,s)}var S=function(e,t){var i=w(e,t);return new u({seq:[{seq:[{oid:{name:"pkcs5PBES2"}},{seq:[{seq:[{oid:{name:"pkcs5PBKDF2"}},{seq:[{octstr:{hex:i.pbkdf2Salt}},{int:i.pbkdf2Iter}]}]},{seq:[{oid:{name:"des-EDE3-CBC"}},{octstr:{hex:i.encryptionSchemeIV}}]}]}]},{octstr:{hex:i.ciphertext}}]}).getEncodedHex()},w=function(e,t){var i=CryptoJS.lib.WordArray.random(8),n=CryptoJS.lib.WordArray.random(8),r=CryptoJS.PBKDF2(t,i,{keySize:6,iterations:100}),s=CryptoJS.enc.Hex.parse(e),a=CryptoJS.TripleDES.encrypt(s,r,{iv:n})+"",o={};return o.ciphertext=a,o.pbkdf2Salt=CryptoJS.enc.Hex.stringify(i),o.pbkdf2Iter=100,o.encryptionSchemeAlg="DES-EDE3-CBC",o.encryptionSchemeIV=CryptoJS.enc.Hex.stringify(n),o};if("PKCS8PRV"==t&&null!=f&&e instanceof f&&1==e.isPrivate){var E=y(e).getEncodedHex();C=u({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:E}}]}).getEncodedHex();return void 0===i||null==i?hextopem(C,"PRIVATE KEY"):hextopem(v=S(C,i),"ENCRYPTED PRIVATE KEY")}if("PKCS8PRV"==t&&void 0!==p&&e instanceof p&&1==e.isPrivate){E=new u({seq:[{int:1},{octstr:{hex:e.prvKeyHex}},{tag:["a1",!0,{bitstr:{hex:"00"+e.pubKeyHex}}]}]}).getEncodedHex(),C=u({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:e.curveName}}]},{octstr:{hex:E}}]}).getEncodedHex();return void 0===i||null==i?hextopem(C,"PRIVATE KEY"):hextopem(v=S(C,i),"ENCRYPTED PRIVATE KEY")}if("PKCS8PRV"==t&&void 0!==d&&e instanceof d&&1==e.isPrivate){E=new l({bigint:e.x}).getEncodedHex(),C=u({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.g}}]}]},{octstr:{hex:E}}]}).getEncodedHex();return void 0===i||null==i?hextopem(C,"PRIVATE KEY"):hextopem(v=S(C,i),"ENCRYPTED PRIVATE KEY")}throw"unsupported object nor format"},KEYUTIL.getKeyFromCSRPEM=function(e){var t=pemtohex(e,"CERTIFICATE REQUEST");return KEYUTIL.getKeyFromCSRHex(t)},KEYUTIL.getKeyFromCSRHex=function(e){var t=KEYUTIL.parseCSRHex(e);return KEYUTIL.getKey(t.p8pubkeyhex,null,"pkcs8pub")},KEYUTIL.parseCSRHex=function(e){var t=ASN1HEX,i=t.getChildIdx,n=t.getTLV,r={},s=e;if("30"!=s.substr(0,2))throw"malformed CSR(code:001)";var a=i(s,0);if(a.length<1)throw"malformed CSR(code:002)";if("30"!=s.substr(a[0],2))throw"malformed CSR(code:003)";var o=i(s,a[0]);if(o.length<3)throw"malformed CSR(code:004)";return r.p8pubkeyhex=n(s,o[2]),r},KEYUTIL.getJWKFromKey=function(e){var t={};if(e instanceof RSAKey&&e.isPrivate)return t.kty="RSA",t.n=hextob64u(e.n.toString(16)),t.e=hextob64u(e.e.toString(16)),t.d=hextob64u(e.d.toString(16)),t.p=hextob64u(e.p.toString(16)),t.q=hextob64u(e.q.toString(16)),t.dp=hextob64u(e.dmp1.toString(16)),t.dq=hextob64u(e.dmq1.toString(16)),t.qi=hextob64u(e.coeff.toString(16)),t;if(e instanceof RSAKey&&e.isPublic)return t.kty="RSA",t.n=hextob64u(e.n.toString(16)),t.e=hextob64u(e.e.toString(16)),t;if(e instanceof KJUR.crypto.ECDSA&&e.isPrivate){if("P-256"!==(n=e.getShortNISTPCurveName())&&"P-384"!==n)throw"unsupported curve name for JWT: "+n;var i=e.getPublicKeyXYHex();return t.kty="EC",t.crv=n,t.x=hextob64u(i.x),t.y=hextob64u(i.y),t.d=hextob64u(e.prvKeyHex),t}if(e instanceof KJUR.crypto.ECDSA&&e.isPublic){var n;if("P-256"!==(n=e.getShortNISTPCurveName())&&"P-384"!==n)throw"unsupported curve name for JWT: "+n;i=e.getPublicKeyXYHex();return t.kty="EC",t.crv=n,t.x=hextob64u(i.x),t.y=hextob64u(i.y),t}throw"not supported key object"},RSAKey.getPosArrayOfChildrenFromHex=function(e){return ASN1HEX.getChildIdx(e,0)},RSAKey.getHexValueArrayOfChildrenFromHex=function(e){var t,i=ASN1HEX.getV,n=i(e,(t=RSAKey.getPosArrayOfChildrenFromHex(e))[0]),r=i(e,t[1]),s=i(e,t[2]),a=i(e,t[3]),o=i(e,t[4]),c=i(e,t[5]),l=i(e,t[6]),u=i(e,t[7]),h=i(e,t[8]);return(t=new Array).push(n,r,s,a,o,c,l,u,h),t},RSAKey.prototype.readPrivateKeyFromPEMString=function(e){var t=pemtohex(e),i=RSAKey.getHexValueArrayOfChildrenFromHex(t);this.setPrivateEx(i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8])},RSAKey.prototype.readPKCS5PrvKeyHex=function(e){var t=RSAKey.getHexValueArrayOfChildrenFromHex(e);this.setPrivateEx(t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])},RSAKey.prototype.readPKCS8PrvKeyHex=function(e){var t,i,n,r,s,a,o,c,l=ASN1HEX,u=l.getVbyList;if(!1===l.isASN1HEX(e))throw"not ASN.1 hex string";try{t=u(e,0,[2,0,1],"02"),i=u(e,0,[2,0,2],"02"),n=u(e,0,[2,0,3],"02"),r=u(e,0,[2,0,4],"02"),s=u(e,0,[2,0,5],"02"),a=u(e,0,[2,0,6],"02"),o=u(e,0,[2,0,7],"02"),c=u(e,0,[2,0,8],"02")}catch(e){throw"malformed PKCS#8 plain RSA private key"}this.setPrivateEx(t,i,n,r,s,a,o,c)},RSAKey.prototype.readPKCS5PubKeyHex=function(e){var t=ASN1HEX,i=t.getV;if(!1===t.isASN1HEX(e))throw"keyHex is not ASN.1 hex string";var n=t.getChildIdx(e,0);if(2!==n.length||"02"!==e.substr(n[0],2)||"02"!==e.substr(n[1],2))throw"wrong hex for PKCS#5 public key";var r=i(e,n[0]),s=i(e,n[1]);this.setPublic(r,s)},RSAKey.prototype.readPKCS8PubKeyHex=function(e){var t=ASN1HEX;if(!1===t.isASN1HEX(e))throw"not ASN.1 hex string";if("06092a864886f70d010101"!==t.getTLVbyList(e,0,[0,0]))throw"not PKCS8 RSA public key";var i=t.getTLVbyList(e,0,[1,0]);this.readPKCS5PubKeyHex(i)},RSAKey.prototype.readCertPubKeyHex=function(e,t){var i,n;(i=new X509).readCertHex(e),n=i.getPublicKeyHex(),this.readPKCS8PubKeyHex(n)};var _RE_HEXDECONLY=new RegExp("");function _zeroPaddingOfSignature(e,t){for(var i="",n=t/4-e.length,r=0;r<n;r++)i+="0";return i+e}function pss_mgf1_str(e,t,i){for(var n="",r=0;n.length<t;)n+=hextorstr(i(rstrtohex(e+String.fromCharCode.apply(String,[(4278190080&r)>>24,(16711680&r)>>16,(65280&r)>>8,255&r])))),r+=1;return n}function _rsasign_getAlgNameAndHashFromHexDisgestInfo(e){for(var t in KJUR.crypto.Util.DIGESTINFOHEAD){var i=KJUR.crypto.Util.DIGESTINFOHEAD[t],n=i.length;if(e.substring(0,n)==i)return[t,e.substring(n)]}return[]}function X509(){var a=ASN1HEX,u=a.getChildIdx,h=a.getV,g=a.getTLV,d=a.getVbyList,s=a.getTLVbyList,o=a.getIdxbyList,c=a.getVidx,p=a.oidname,e=X509,t=pemtohex;this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){return null===this.hex||0!==this.version?this.version:"a003020102"!==s(this.hex,0,[0,0])?(this.version=1,this.foffset=-1,1):this.version=3},this.getSerialNumberHex=function(){return d(this.hex,0,[0,1+this.foffset],"02")},this.getSignatureAlgorithmField=function(){return p(d(this.hex,0,[0,2+this.foffset,0],"06"))},this.getIssuerHex=function(){return s(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){return e.hex2dn(this.getIssuerHex())},this.getSubjectHex=function(){return s(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){return e.hex2dn(this.getSubjectHex())},this.getNotBefore=function(){var e=d(this.hex,0,[0,4+this.foffset,0]);return e=e.replace(/(..)/g,"%$1"),e=decodeURIComponent(e)},this.getNotAfter=function(){var e=d(this.hex,0,[0,4+this.foffset,1]);return e=e.replace(/(..)/g,"%$1"),e=decodeURIComponent(e)},this.getPublicKeyHex=function(){return a.getTLVbyList(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyIdx=function(){return o(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var e=this.getPublicKeyIdx();return o(this.hex,e,[1,0],"30")},this.getPublicKey=function(){return KEYUTIL.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){return p(d(this.hex,0,[1,0],"06"))},this.getSignatureValueHex=function(){return d(this.hex,0,[2],"03",!0)},this.verifySignature=function(e){var t=this.getSignatureAlgorithmName(),i=this.getSignatureValueHex(),n=s(this.hex,0,[0],"30"),r=new KJUR.crypto.Signature({alg:t});return r.init(e),r.updateHex(n),r.verify(i)},this.parseExt=function(){if(3!==this.version)return-1;var e=o(this.hex,0,[0,7,0],"30"),t=u(this.hex,e);this.aExtInfo=new Array;for(var i=0;i<t.length;i++){var n={critical:!1},r=0;3===u(this.hex,t[i]).length&&(n.critical=!0,r=1),n.oid=a.hextooidstr(d(this.hex,t[i],[0],"06"));var s=o(this.hex,t[i],[1+r]);n.vidx=c(this.hex,s),this.aExtInfo.push(n)}},this.getExtInfo=function(e){var t=this.aExtInfo,i=e;if(e.match(/^[0-9.]+$/)||(i=KJUR.asn1.x509.OID.name2oid(e)),""!==i)for(var n=0;n<t.length;n++)if(t[n].oid===i)return t[n]},this.getExtBasicConstraints=function(){var e=this.getExtInfo("basicConstraints");if(void 0===e)return e;var t=h(this.hex,e.vidx);if(""===t)return{};if("0101ff"===t)return{cA:!0};if("0101ff02"!==t.substr(0,8))throw"basicConstraints parse error";var i=h(t,6);return{cA:!0,pathLen:parseInt(i,16)}},this.getExtKeyUsageBin=function(){var e=this.getExtInfo("keyUsage");if(void 0===e)return"";var t=h(this.hex,e.vidx);if(t.length%2!=0||t.length<=2)throw"malformed key usage value";var i=parseInt(t.substr(0,2)),n=parseInt(t.substr(2),16).toString(2);return n.substr(0,n.length-i)},this.getExtKeyUsageString=function(){for(var e=this.getExtKeyUsageBin(),t=new Array,i=0;i<e.length;i++)"1"==e.substr(i,1)&&t.push(X509.KEYUSAGE_NAME[i]);return t.join(",")},this.getExtSubjectKeyIdentifier=function(){var e=this.getExtInfo("subjectKeyIdentifier");return void 0===e?e:h(this.hex,e.vidx)},this.getExtAuthorityKeyIdentifier=function(){var e=this.getExtInfo("authorityKeyIdentifier");if(void 0===e)return e;for(var t={},i=g(this.hex,e.vidx),n=u(i,0),r=0;r<n.length;r++)"80"===i.substr(n[r],2)&&(t.kid=h(i,n[r]));return t},this.getExtExtKeyUsageName=function(){var e=this.getExtInfo("extKeyUsage");if(void 0===e)return e;var t=new Array,i=g(this.hex,e.vidx);if(""===i)return t;for(var n=u(i,0),r=0;r<n.length;r++)t.push(p(h(i,n[r])));return t},this.getExtSubjectAltName=function(){for(var e=this.getExtSubjectAltName2(),t=new Array,i=0;i<e.length;i++)"DNS"===e[i][0]&&t.push(e[i][1]);return t},this.getExtSubjectAltName2=function(){var e,t,i,n=this.getExtInfo("subjectAltName");if(void 0===n)return n;for(var r=new Array,s=g(this.hex,n.vidx),a=u(s,0),o=0;o<a.length;o++)i=s.substr(a[o],2),e=h(s,a[o]),"81"===i&&(t=hextoutf8(e),r.push(["MAIL",t])),"82"===i&&(t=hextoutf8(e),r.push(["DNS",t])),"84"===i&&(t=X509.hex2dn(e,0),r.push(["DN",t])),"86"===i&&(t=hextoutf8(e),r.push(["URI",t])),"87"===i&&(t=hextoip(e),r.push(["IP",t]));return r},this.getExtCRLDistributionPointsURI=function(){var e=this.getExtInfo("cRLDistributionPoints");if(void 0===e)return e;for(var t=new Array,i=u(this.hex,e.vidx),n=0;n<i.length;n++)try{var r=hextoutf8(d(this.hex,i[n],[0,0,0],"86"));t.push(r)}catch(e){}return t},this.getExtAIAInfo=function(){var e=this.getExtInfo("authorityInfoAccess");if(void 0===e)return e;for(var t={ocsp:[],caissuer:[]},i=u(this.hex,e.vidx),n=0;n<i.length;n++){var r=d(this.hex,i[n],[0],"06"),s=d(this.hex,i[n],[1],"86");"2b06010505073001"===r&&t.ocsp.push(hextoutf8(s)),"2b06010505073002"===r&&t.caissuer.push(hextoutf8(s))}return t},this.getExtCertificatePolicies=function(){var e=this.getExtInfo("certificatePolicies");if(void 0===e)return e;for(var t=g(this.hex,e.vidx),i=[],n=u(t,0),r=0;r<n.length;r++){var s={},a=u(t,n[r]);if(s.id=p(h(t,a[0])),2===a.length)for(var o=u(t,a[1]),c=0;c<o.length;c++){var l=d(t,o[c],[0],"06");"2b06010505070201"===l?s.cps=hextoutf8(d(t,o[c],[1])):"2b06010505070202"===l&&(s.unotice=hextoutf8(d(t,o[c],[1,0])))}i.push(s)}return i},this.readCertPEM=function(e){this.readCertHex(t(e))},this.readCertHex=function(e){this.hex=e,this.getVersion();try{o(this.hex,0,[0,7],"a3"),this.parseExt()}catch(e){}},this.getInfo=function(){var e,t,i;if(e="Basic Fields\n",e+="  serial number: "+this.getSerialNumberHex()+"\n",e+="  signature algorithm: "+this.getSignatureAlgorithmField()+"\n",e+="  issuer: "+this.getIssuerString()+"\n",e+="  notBefore: "+this.getNotBefore()+"\n",e+="  notAfter: "+this.getNotAfter()+"\n",e+="  subject: "+this.getSubjectString()+"\n",e+="  subject public key info: \n",e+="    key algorithm: "+(t=this.getPublicKey()).type+"\n","RSA"===t.type&&(e+="    n="+hextoposhex(t.n.toString(16)).substr(0,16)+"...\n",e+="    e="+hextoposhex(t.e.toString(16))+"\n"),null!=(i=this.aExtInfo)){e+="X509v3 Extensions:\n";for(var n=0;n<i.length;n++){var r=i[n],s=KJUR.asn1.x509.OID.oid2name(r.oid);""===s&&(s=r.oid);var a="";if(!0===r.critical&&(a="CRITICAL"),e+="  "+s+" "+a+":\n","basicConstraints"===s){var o=this.getExtBasicConstraints();void 0===o.cA?e+="    {}\n":(e+="    cA=true",void 0!==o.pathLen&&(e+=", pathLen="+o.pathLen),e+="\n")}else if("keyUsage"===s)e+="    "+this.getExtKeyUsageString()+"\n";else if("subjectKeyIdentifier"===s)e+="    "+this.getExtSubjectKeyIdentifier()+"\n";else if("authorityKeyIdentifier"===s){var c=this.getExtAuthorityKeyIdentifier();void 0!==c.kid&&(e+="    kid="+c.kid+"\n")}else{if("extKeyUsage"===s)e+="    "+this.getExtExtKeyUsageName().join(", ")+"\n";else if("subjectAltName"===s)e+="    "+this.getExtSubjectAltName2()+"\n";else if("cRLDistributionPoints"===s)e+="    "+this.getExtCRLDistributionPointsURI()+"\n";else if("authorityInfoAccess"===s){var l=this.getExtAIAInfo();void 0!==l.ocsp&&(e+="    ocsp: "+l.ocsp.join(",")+"\n"),void 0!==l.caissuer&&(e+="    caissuer: "+l.caissuer.join(",")+"\n")}else if("certificatePolicies"===s)for(var u=this.getExtCertificatePolicies(),h=0;h<u.length;h++)void 0!==u[h].id&&(e+="    policy oid: "+u[h].id+"\n"),void 0!==u[h].cps&&(e+="    cps: "+u[h].cps+"\n")}}}return e+="signature algorithm: "+this.getSignatureAlgorithmName()+"\n",e+="signature: "+this.getSignatureValueHex().substr(0,16)+"...\n"}}_RE_HEXDECONLY.compile("[^0-9a-f]","gi"),RSAKey.prototype.sign=function(e,t){var i,n=(i=e,KJUR.crypto.Util.hashString(i,t));return this.signWithMessageHash(n,t)},RSAKey.prototype.signWithMessageHash=function(e,t){var i=parseBigInt(KJUR.crypto.Util.getPaddedDigestInfoHex(e,t,this.n.bitLength()),16);return _zeroPaddingOfSignature(this.doPrivate(i).toString(16),this.n.bitLength())},RSAKey.prototype.signPSS=function(e,t,i){var n,r=(n=rstrtohex(e),KJUR.crypto.Util.hashHex(n,t));return void 0===i&&(i=-1),this.signWithMessageHashPSS(r,t,i)},RSAKey.prototype.signWithMessageHashPSS=function(e,t,i){var n,r=hextorstr(e),s=r.length,a=this.n.bitLength()-1,o=Math.ceil(a/8),c=function(e){return KJUR.crypto.Util.hashHex(e,t)};if(-1===i||void 0===i)i=s;else if(-2===i)i=o-s-2;else if(i<-2)throw"invalid salt length";if(o<s+i+2)throw"data too long";var l="";0<i&&(l=new Array(i),(new SecureRandom).nextBytes(l),l=String.fromCharCode.apply(String,l));var u=hextorstr(c(rstrtohex("\0\0\0\0\0\0\0\0"+r+l))),h=[];for(n=0;n<o-i-s-2;n+=1)h[n]=0;var g=String.fromCharCode.apply(String,h)+""+l,d=pss_mgf1_str(u,g.length,c),p=[];for(n=0;n<g.length;n+=1)p[n]=g.charCodeAt(n)^d.charCodeAt(n);var f=65280>>8*o-a&255;for(p[0]&=~f,n=0;n<s;n++)p.push(u.charCodeAt(n));return p.push(188),_zeroPaddingOfSignature(this.doPrivate(new BigInteger(p)).toString(16),this.n.bitLength())},RSAKey.prototype.verify=function(e,t){var i=parseBigInt(t=(t=t.replace(_RE_HEXDECONLY,"")).replace(/[ \n]+/g,""),16);if(i.bitLength()>this.n.bitLength())return 0;var n=_rsasign_getAlgNameAndHashFromHexDisgestInfo(this.doPublic(i).toString(16).replace(/^1f+00/,""));if(0==n.length)return!1;var r,s=n[0];return n[1]==(r=e,KJUR.crypto.Util.hashString(r,s))},RSAKey.prototype.verifyWithMessageHash=function(e,t){var i=parseBigInt(t=(t=t.replace(_RE_HEXDECONLY,"")).replace(/[ \n]+/g,""),16);if(i.bitLength()>this.n.bitLength())return 0;var n=_rsasign_getAlgNameAndHashFromHexDisgestInfo(this.doPublic(i).toString(16).replace(/^1f+00/,""));return 0!=n.length&&n[1]==e},RSAKey.prototype.verifyPSS=function(e,t,i,n){var r,s=(r=rstrtohex(e),KJUR.crypto.Util.hashHex(r,i));return void 0===n&&(n=-1),this.verifyWithMessageHashPSS(s,t,i,n)},RSAKey.prototype.verifyWithMessageHashPSS=function(e,t,i,n){var r=new BigInteger(t,16);if(r.bitLength()>this.n.bitLength())return!1;var s,a=function(e){return KJUR.crypto.Util.hashHex(e,i)},o=hextorstr(e),c=o.length,l=this.n.bitLength()-1,u=Math.ceil(l/8);if(-1===n||void 0===n)n=c;else if(-2===n)n=u-c-2;else if(n<-2)throw"invalid salt length";if(u<c+n+2)throw"data too long";var h=this.doPublic(r).toByteArray();for(s=0;s<h.length;s+=1)h[s]&=255;for(;h.length<u;)h.unshift(0);if(188!==h[u-1])throw"encoded message does not end in 0xbc";var g=(h=String.fromCharCode.apply(String,h)).substr(0,u-c-1),d=h.substr(g.length,c),p=65280>>8*u-l&255;if(0!=(g.charCodeAt(0)&p))throw"bits beyond keysize not zero";var f=pss_mgf1_str(d,g.length,a),y=[];for(s=0;s<g.length;s+=1)y[s]=g.charCodeAt(s)^f.charCodeAt(s);y[0]&=~p;var m=u-c-n-2;for(s=0;s<m;s+=1)if(0!==y[s])throw"leftmost octets not zero";if(1!==y[m])throw"0x01 marker not found";return d===hextorstr(a(rstrtohex("\0\0\0\0\0\0\0\0"+o+String.fromCharCode.apply(String,y.slice(-n)))))},RSAKey.SALT_LEN_HLEN=-1,RSAKey.SALT_LEN_MAX=-2,RSAKey.SALT_LEN_RECOVER=-2,X509.hex2dn=function(e,t){if(void 0===t&&(t=0),"30"!==e.substr(t,2))throw"malformed DN";for(var i=new Array,n=ASN1HEX.getChildIdx(e,t),r=0;r<n.length;r++)i.push(X509.hex2rdn(e,n[r]));return"/"+(i=i.map(function(e){return e.replace("/","\\/")})).join("/")},X509.hex2rdn=function(e,t){if(void 0===t&&(t=0),"31"!==e.substr(t,2))throw"malformed RDN";for(var i=new Array,n=ASN1HEX.getChildIdx(e,t),r=0;r<n.length;r++)i.push(X509.hex2attrTypeValue(e,n[r]));return(i=i.map(function(e){return e.replace("+","\\+")})).join("+")},X509.hex2attrTypeValue=function(e,t){var i=ASN1HEX,n=i.getV;if(void 0===t&&(t=0),"30"!==e.substr(t,2))throw"malformed attribute type and value";var r=i.getChildIdx(e,t);2!==r.length||e.substr(r[0],2);var s=n(e,r[0]),a=KJUR.asn1.ASN1Util.oidHexToInt(s);return KJUR.asn1.x509.OID.oid2atype(a)+"="+hextorstr(n(e,r[1]))},X509.getPublicKeyFromCertHex=function(e){var t=new X509;return t.readCertHex(e),t.getPublicKey()},X509.getPublicKeyFromCertPEM=function(e){var t=new X509;return t.readCertPEM(e),t.getPublicKey()},X509.getPublicKeyInfoPropOfCertPEM=function(e){var t,i,n=ASN1HEX.getVbyList,r={};return r.algparam=null,(t=new X509).readCertPEM(e),i=t.getPublicKeyHex(),r.keyhex=n(i,0,[1],"03").substr(2),r.algoid=n(i,0,[0,0],"06"),"2a8648ce3d0201"===r.algoid&&(r.algparam=n(i,0,[0,1],"06")),r},X509.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"],void 0!==KJUR&&KJUR||(KJUR={}),void 0!==KJUR.jws&&KJUR.jws||(KJUR.jws={}),KJUR.jws.JWS=function(){var h=KJUR.jws.JWS.isSafeJSONString;this.parseJWS=function(e,t){if(void 0===this.parsedJWS||!t&&void 0===this.parsedJWS.sigvalH){var i=e.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(null==i)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var n=i[1],r=i[2],s=i[3],a=n+"."+r;if(this.parsedJWS={},this.parsedJWS.headB64U=n,this.parsedJWS.payloadB64U=r,this.parsedJWS.sigvalB64U=s,this.parsedJWS.si=a,!t){var o=b64utohex(s),c=parseBigInt(o,16);this.parsedJWS.sigvalH=o,this.parsedJWS.sigvalBI=c}var l=b64utoutf8(n),u=b64utoutf8(r);if(this.parsedJWS.headS=l,this.parsedJWS.payloadS=u,!h(l,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+l}}},KJUR.jws.JWS.sign=function(e,t,i,n,r){var s,a,o,c=KJUR,l=c.jws.JWS,u=l.readSafeJSONString,h=l.isSafeJSONString,g=c.crypto,d=(g.ECDSA,g.Mac),p=g.Signature,f=JSON;if("string"!=typeof t&&"object"!=typeof t)throw"spHeader must be JSON string or object: "+t;if("object"==typeof t&&(a=t,s=f.stringify(a)),"string"==typeof t){if(!h(s=t))throw"JWS Head is not safe JSON string: "+s;a=u(s)}if("object"==typeof(o=i)&&(o=f.stringify(i)),""!=e&&null!=e||void 0===a.alg||(e=a.alg),""!=e&&null!=e&&void 0===a.alg&&(a.alg=e,s=f.stringify(a)),e!==a.alg)throw"alg and sHeader.alg doesn't match: "+e+"!="+a.alg;var y=null;if(void 0===l.jwsalg2sigalg[e])throw"unsupported alg name: "+e;y=l.jwsalg2sigalg[e];var m=utf8tob64u(s)+"."+utf8tob64u(o),b="";if("Hmac"==y.substr(0,4)){if(void 0===n)throw"mac key shall be specified for HS* alg";var I=new d({alg:y,prov:"cryptojs",pass:n});I.updateString(m),b=I.doFinal()}else{var v;if(-1!=y.indexOf("withECDSA"))(v=new p({alg:y})).init(n,r),v.updateString(m),hASN1Sig=v.sign(),b=KJUR.crypto.ECDSA.asn1SigToConcatSig(hASN1Sig);else if("none"!=y)(v=new p({alg:y})).init(n,r),v.updateString(m),b=v.sign()}return m+"."+hextob64u(b)},KJUR.jws.JWS.verify=function(e,t,i){var n,r=KJUR,s=r.jws.JWS,a=s.readSafeJSONString,o=r.crypto,c=o.ECDSA,l=o.Mac,u=o.Signature;void 0!==typeof RSAKey&&(n=RSAKey);var h=e.split(".");if(3!==h.length)return!1;var g=h[0]+"."+h[1],d=b64utohex(h[2]),p=a(b64utoutf8(h[0])),f=null,y=null;if(void 0===p.alg)throw"algorithm not specified in header";if((y=(f=p.alg).substr(0,2),null!=i&&"[object Array]"===Object.prototype.toString.call(i)&&0<i.length)&&-1==(":"+i.join(":")+":").indexOf(":"+f+":"))throw"algorithm '"+f+"' not accepted in the list";if("none"!=f&&null===t)throw"key shall be specified to verify.";if("string"==typeof t&&-1!=t.indexOf("-----BEGIN ")&&(t=KEYUTIL.getKey(t)),!("RS"!=y&&"PS"!=y||t instanceof n))throw"key shall be a RSAKey obj for RS* and PS* algs";if("ES"==y&&!(t instanceof c))throw"key shall be a ECDSA obj for ES* algs";var m=null;if(void 0===s.jwsalg2sigalg[p.alg])throw"unsupported alg name: "+f;if("none"==(m=s.jwsalg2sigalg[f]))throw"not supported";if("Hmac"==m.substr(0,4)){if(void 0===t)throw"hexadecimal key shall be specified for HMAC";var b=new l({alg:m,pass:t});return b.updateString(g),d==b.doFinal()}if(-1==m.indexOf("withECDSA"))return(I=new u({alg:m})).init(t),I.updateString(g),I.verify(d);var I,v=null;try{v=c.concatSigToASN1Sig(d)}catch(e){return!1}return(I=new u({alg:m})).init(t),I.updateString(g),I.verify(v)},KJUR.jws.JWS.parse=function(e){var t,i,n,r=e.split("."),s={};if(2!=r.length&&3!=r.length)throw"malformed sJWS: wrong number of '.' splitted elements";return t=r[0],i=r[1],3==r.length&&(n=r[2]),s.headerObj=KJUR.jws.JWS.readSafeJSONString(b64utoutf8(t)),s.payloadObj=KJUR.jws.JWS.readSafeJSONString(b64utoutf8(i)),s.headerPP=JSON.stringify(s.headerObj,null,"  "),null==s.payloadObj?s.payloadPP=b64utoutf8(i):s.payloadPP=JSON.stringify(s.payloadObj,null,"  "),void 0!==n&&(s.sigHex=b64utohex(n)),s},KJUR.jws.JWS.verifyJWT=function(e,t,i){var n=KJUR.jws,r=n.JWS,s=r.readSafeJSONString,a=r.inArray,o=r.includedArray,c=e.split("."),l=c[0],u=c[1],h=(b64utohex(c[2]),s(b64utoutf8(l))),g=s(b64utoutf8(u));if(void 0===h.alg)return!1;if(void 0===i.alg)throw"acceptField.alg shall be specified";if(!a(h.alg,i.alg))return!1;if(void 0!==g.iss&&"object"==typeof i.iss&&!a(g.iss,i.iss))return!1;if(void 0!==g.sub&&"object"==typeof i.sub&&!a(g.sub,i.sub))return!1;if(void 0!==g.aud&&"object"==typeof i.aud)if("string"==typeof g.aud){if(!a(g.aud,i.aud))return!1}else if("object"==typeof g.aud&&!o(g.aud,i.aud))return!1;var d=n.IntDate.getNow();return void 0!==i.verifyAt&&"number"==typeof i.verifyAt&&(d=i.verifyAt),void 0!==i.gracePeriod&&"number"==typeof i.gracePeriod||(i.gracePeriod=0),!(void 0!==g.exp&&"number"==typeof g.exp&&g.exp+i.gracePeriod<d)&&(!(void 0!==g.nbf&&"number"==typeof g.nbf&&d<g.nbf-i.gracePeriod)&&(!(void 0!==g.iat&&"number"==typeof g.iat&&d<g.iat-i.gracePeriod)&&((void 0===g.jti||void 0===i.jti||g.jti===i.jti)&&!!r.verify(e,t,i.alg))))},KJUR.jws.JWS.includedArray=function(e,t){var i=KJUR.jws.JWS.inArray;if(null===e)return!1;if("object"!=typeof e)return!1;if("number"!=typeof e.length)return!1;for(var n=0;n<e.length;n++)if(!i(e[n],t))return!1;return!0},KJUR.jws.JWS.inArray=function(e,t){if(null===t)return!1;if("object"!=typeof t)return!1;if("number"!=typeof t.length)return!1;for(var i=0;i<t.length;i++)if(t[i]==e)return!0;return!1},KJUR.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},KJUR.jws.JWS.isSafeJSONString=function(e,t,i){var n=null;try{return"object"!=typeof(n=jsonParse(e))?0:n.constructor===Array?0:(t&&(t[i]=n),1)}catch(e){return 0}},KJUR.jws.JWS.readSafeJSONString=function(e){var t=null;try{return"object"!=typeof(t=jsonParse(e))?null:t.constructor===Array?null:t}catch(e){return null}},KJUR.jws.JWS.getEncodedSignatureValueFromJWS=function(e){var t=e.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(null==t)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return t[1]},KJUR.jws.JWS.getJWKthumbprint=function(e){if("RSA"!==e.kty&&"EC"!==e.kty&&"oct"!==e.kty)throw"unsupported algorithm for JWK Thumprint";var t="{";if("RSA"===e.kty){if("string"!=typeof e.n||"string"!=typeof e.e)throw"wrong n and e value for RSA key";t+='"e":"'+e.e+'",',t+='"kty":"'+e.kty+'",',t+='"n":"'+e.n+'"}'}else if("EC"===e.kty){if("string"!=typeof e.crv||"string"!=typeof e.x||"string"!=typeof e.y)throw"wrong crv, x and y value for EC key";t+='"crv":"'+e.crv+'",',t+='"kty":"'+e.kty+'",',t+='"x":"'+e.x+'",',t+='"y":"'+e.y+'"}'}else if("oct"===e.kty){if("string"!=typeof e.k)throw"wrong k value for oct(symmetric) key";t+='"kty":"'+e.kty+'",',t+='"k":"'+e.k+'"}'}var i=rstrtohex(t);return hextob64u(KJUR.crypto.Util.hashHex(i,"sha256"))},KJUR.jws.IntDate={},KJUR.jws.IntDate.get=function(e){var t=KJUR.jws.IntDate,i=t.getNow,n=t.getZulu;if("now"==e)return i();if("now + 1hour"==e)return i()+3600;if("now + 1day"==e)return i()+86400;if("now + 1month"==e)return i()+2592e3;if("now + 1year"==e)return i()+31536e3;if(e.match(/Z$/))return n(e);if(e.match(/^[0-9]+$/))return parseInt(e);throw"unsupported format: "+e},KJUR.jws.IntDate.getZulu=function(e){return zulutosec(e)},KJUR.jws.IntDate.getNow=function(){return~~(new Date/1e3)},KJUR.jws.IntDate.intDate2UTCString=function(e){return new Date(1e3*e).toUTCString()},KJUR.jws.IntDate.intDate2Zulu=function(e){var t=new Date(1e3*e);return("0000"+t.getUTCFullYear()).slice(-4)+("00"+(t.getUTCMonth()+1)).slice(-2)+("00"+t.getUTCDate()).slice(-2)+("00"+t.getUTCHours()).slice(-2)+("00"+t.getUTCMinutes()).slice(-2)+("00"+t.getUTCSeconds()).slice(-2)+"Z"},void 0!==KJUR&&KJUR||(KJUR={}),void 0!==KJUR.jws&&KJUR.jws||(KJUR.jws={}),KJUR.jws.JWSJS=function(){var o=KJUR.jws.JWS,i=o.readSafeJSONString;this.aHeader=[],this.sPayload="",this.aSignature=[],this.init=function(){this.aHeader=[],this.sPayload=void 0,this.aSignature=[]},this.initWithJWS=function(e){this.init();var t=e.split(".");if(3!=t.length)throw"malformed input JWS";this.aHeader.push(t[0]),this.sPayload=t[1],this.aSignature.push(t[2])},this.addSignature=function(e,t,i,n){if(void 0===this.sPayload||null===this.sPayload)throw"there's no JSON-JS signature to add.";var r=this.aHeader.length;if(this.aHeader.length!=this.aSignature.length)throw"aHeader.length != aSignature.length";try{var s=KJUR.jws.JWS.sign(e,t,this.sPayload,i,n).split(".");s[0],s[2];this.aHeader.push(s[0]),this.aSignature.push(s[2])}catch(e){throw this.aHeader.length>r&&this.aHeader.pop(),this.aSignature.length>r&&this.aSignature.pop(),"addSignature failed: "+e}},this.verifyAll=function(e){if(this.aHeader.length!==e.length||this.aSignature.length!==e.length)return!1;for(var t=0;t<e.length;t++){var i=e[t];if(2!==i.length)return!1;if(!1===this.verifyNth(t,i[0],i[1]))return!1}return!0},this.verifyNth=function(e,t,i){if(this.aHeader.length<=e||this.aSignature.length<=e)return!1;var n=this.aHeader[e],r=this.aSignature[e],s=n+"."+this.sPayload+"."+r,a=!1;try{a=o.verify(s,t,i)}catch(e){return!1}return a},this.readJWSJS=function(e){if("string"==typeof e){var t=i(e);if(null==t)throw"argument is not safe JSON object string";this.aHeader=t.headers,this.sPayload=t.payload,this.aSignature=t.signatures}else try{if(!(0<e.headers.length))throw"malformed header";if(this.aHeader=e.headers,"string"!=typeof e.payload)throw"malformed signatures";if(this.sPayload=e.payload,!(0<e.signatures.length))throw"malformed signatures";this.aSignatures=e.signatures}catch(e){throw"malformed JWS-JS JSON object: "+e}},this.getJSON=function(){return{headers:this.aHeader,payload:this.sPayload,signatures:this.aSignature}},this.isEmpty=function(){return 0==this.aHeader.length?1:0}};var SecureRandom_1=SecureRandom,rng_seed_time_1=rng_seed_time,BigInteger_1=BigInteger,RSAKey_1=RSAKey,ECDSA=KJUR.crypto.ECDSA,DSA=KJUR.crypto.DSA,Signature=KJUR.crypto.Signature,MessageDigest=KJUR.crypto.MessageDigest,Mac=KJUR.crypto.Mac,Cipher=KJUR.crypto.Cipher,KEYUTIL_1=KEYUTIL,ASN1HEX_1=ASN1HEX,X509_1=X509,CryptoJS_1=CryptoJS,b64tohex_1=b64tohex,b64toBA_1=b64toBA,stoBA_1=stoBA,BAtos_1=BAtos,BAtohex_1=BAtohex,stohex_1=stohex,stob64_1=stob64,stob64u_1=stob64u,b64utos_1=b64utos,b64tob64u_1=b64tob64u,b64utob64_1=b64utob64,hex2b64_1=hex2b64,hextob64u_1=hextob64u,b64utohex_1=b64utohex,utf8tob64u_1=utf8tob64u,b64utoutf8_1=b64utoutf8,utf8tob64_1=utf8tob64,b64toutf8_1=b64toutf8,utf8tohex_1=utf8tohex,hextoutf8_1=hextoutf8,hextorstr_1=hextorstr,rstrtohex_1=rstrtohex,hextob64_1=hextob64,hextob64nl_1=hextob64nl,b64nltohex_1=b64nltohex,hextopem_1=hextopem,pemtohex_1=pemtohex,hextoArrayBuffer_1=hextoArrayBuffer,ArrayBuffertohex_1=ArrayBuffertohex,zulutomsec_1=zulutomsec,zulutosec_1=zulutosec,zulutodate_1=zulutodate,datetozulu_1=datetozulu,uricmptohex_1=uricmptohex,hextouricmp_1=hextouricmp,ipv6tohex_1=ipv6tohex,hextoipv6_1=hextoipv6,hextoip_1=hextoip,iptohex_1=iptohex,encodeURIComponentAll_1=encodeURIComponentAll,newline_toUnix_1=newline_toUnix,newline_toDos_1=newline_toDos,hextoposhex_1=hextoposhex,intarystrtohex_1=intarystrtohex,strdiffidx_1=strdiffidx,KJUR_1=KJUR,crypto_1=KJUR.crypto,asn1=KJUR.asn1,jws=KJUR.jws,lang=KJUR.lang,jsrsasign={SecureRandom:SecureRandom_1,rng_seed_time:rng_seed_time_1,BigInteger:BigInteger_1,RSAKey:RSAKey_1,ECDSA:ECDSA,DSA:DSA,Signature:Signature,MessageDigest:MessageDigest,Mac:Mac,Cipher:Cipher,KEYUTIL:KEYUTIL_1,ASN1HEX:ASN1HEX_1,X509:X509_1,CryptoJS:CryptoJS_1,b64tohex:b64tohex_1,b64toBA:b64toBA_1,stoBA:stoBA_1,BAtos:BAtos_1,BAtohex:BAtohex_1,stohex:stohex_1,stob64:stob64_1,stob64u:stob64u_1,b64utos:b64utos_1,b64tob64u:b64tob64u_1,b64utob64:b64utob64_1,hex2b64:hex2b64_1,hextob64u:hextob64u_1,b64utohex:b64utohex_1,utf8tob64u:utf8tob64u_1,b64utoutf8:b64utoutf8_1,utf8tob64:utf8tob64_1,b64toutf8:b64toutf8_1,utf8tohex:utf8tohex_1,hextoutf8:hextoutf8_1,hextorstr:hextorstr_1,rstrtohex:rstrtohex_1,hextob64:hextob64_1,hextob64nl:hextob64nl_1,b64nltohex:b64nltohex_1,hextopem:hextopem_1,pemtohex:pemtohex_1,hextoArrayBuffer:hextoArrayBuffer_1,ArrayBuffertohex:ArrayBuffertohex_1,zulutomsec:zulutomsec_1,zulutosec:zulutosec_1,zulutodate:zulutodate_1,datetozulu:datetozulu_1,uricmptohex:uricmptohex_1,hextouricmp:hextouricmp_1,ipv6tohex:ipv6tohex_1,hextoipv6:hextoipv6_1,hextoip:hextoip_1,iptohex:iptohex_1,encodeURIComponentAll:encodeURIComponentAll_1,newline_toUnix:newline_toUnix_1,newline_toDos:newline_toDos_1,hextoposhex:hextoposhex_1,intarystrtohex:intarystrtohex_1,strdiffidx:strdiffidx_1,KJUR:KJUR_1,crypto:crypto_1,asn1:asn1,jws:jws,lang:lang},$zlib={};(function(){var re=void 0,se=!0,s=this;function e(e,t){var i,n=e.split("."),r=s;!(n[0]in r)&&r.execScript&&r.execScript("var "+n[0]);for(;n.length&&(i=n.shift());)n.length||t===re?r=r[i]?r[i]:r[i]={}:r[i]=t}var ae="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array&&"undefined"!=typeof DataView;function oe(e,t){if(this.index="number"==typeof t?t:0,this.d=0,this.buffer=e instanceof(ae?Uint8Array:Array)?e:new(ae?Uint8Array:Array)(32768),2*this.buffer.length<=this.index)throw Error("invalid index");this.buffer.length<=this.index&&c(this)}function c(e){var t,i=e.buffer,n=i.length,r=new(ae?Uint8Array:Array)(n<<1);if(ae)r.set(i);else for(t=0;t<n;++t)r[t]=i[t];return e.buffer=r}oe.prototype.a=function(e,t,i){var n,r=this.buffer,s=this.index,a=this.d,o=r[s];if(i&&1<t&&(e=8<t?(l[255&e]<<24|l[e>>>8&255]<<16|l[e>>>16&255]<<8|l[e>>>24&255])>>32-t:l[e]>>8-t),t+a<8)o=o<<t|e,a+=t;else for(n=0;n<t;++n)o=o<<1|e>>t-n-1&1,8==++a&&(a=0,r[s++]=l[o],o=0,s===r.length&&(r=c(this)));r[s]=o,this.buffer=r,this.d=a,this.index=s},oe.prototype.finish=function(){var e=this.buffer,t=this.index;return 0<this.d&&(e[t]<<=8-this.d,e[t]=l[e[t]],t++),ae?e.subarray(0,t):(e.length=t,e)};var t,i=new(ae?Uint8Array:Array)(256);for(t=0;t<256;++t){for(var n=a=t,r=7,a=a>>>1;a;a>>>=1)n<<=1,n|=1&a,--r;i[t]=(n<<r&255)>>>0}var l=i;function u(e){this.buffer=new(ae?Uint16Array:Array)(2*e),this.length=0}function o(e,t){this.e=ce,this.f=0,this.input=ae&&e instanceof Array?new Uint8Array(e):e,this.c=0,t&&(t.lazy&&(this.f=t.lazy),"number"==typeof t.compressionType&&(this.e=t.compressionType),t.outputBuffer&&(this.b=ae&&t.outputBuffer instanceof Array?new Uint8Array(t.outputBuffer):t.outputBuffer),"number"==typeof t.outputIndex&&(this.c=t.outputIndex)),this.b||(this.b=new(ae?Uint8Array:Array)(32768))}u.prototype.getParent=function(e){return 2*((e-2)/4|0)},u.prototype.push=function(e,t){var i,n,r,s=this.buffer;for(i=this.length,s[this.length++]=t,s[this.length++]=e;0<i&&(n=this.getParent(i),s[i]>s[n]);)r=s[i],s[i]=s[n],s[n]=r,r=s[i+1],s[i+1]=s[n+1],s[n+1]=r,i=n;return this.length},u.prototype.pop=function(){var e,t,i,n,r,s=this.buffer;for(t=s[0],e=s[1],this.length-=2,s[0]=s[this.length],s[1]=s[this.length+1],r=0;!((n=2*r+2)>=this.length)&&(n+2<this.length&&s[n+2]>s[n]&&(n+=2),s[n]>s[r]);)i=s[r],s[r]=s[n],s[n]=i,i=s[r+1],s[r+1]=s[n+1],s[n+1]=i,r=n;return{index:e,value:t,length:this.length}};var h,ce=2,le=[];for(h=0;h<288;h++)switch(se){case h<=143:le.push([h+48,8]);break;case h<=255:le.push([h-144+400,9]);break;case h<=279:le.push([h-256+0,7]);break;case h<=287:le.push([h-280+192,8]);break;default:throw"invalid literal: "+h}function g(e,t){this.length=e,this.g=t}o.prototype.h=function(){var e,t,i,n,r=this.input;switch(this.e){case 0:for(i=0,n=r.length;i<n;){var s,a,o,c=t=ae?r.subarray(i,i+65535):r.slice(i,i+65535),l=(i+=t.length)===n,u=re,h=re,g=this.b,d=this.c;if(ae){for(g=new Uint8Array(this.b.buffer);g.length<=d+c.length+5;)g=new Uint8Array(g.length<<1);g.set(this.b)}if(s=l?1:0,g[d++]=0|s,o=65536+~(a=c.length)&65535,g[d++]=255&a,g[d++]=a>>>8&255,g[d++]=255&o,g[d++]=o>>>8&255,ae)g.set(c,d),d+=c.length,g=g.subarray(0,d);else{for(u=0,h=c.length;u<h;++u)g[d++]=c[u];g.length=d}this.c=d,this.b=g}break;case 1:var p=new oe(ae?new Uint8Array(this.b.buffer):this.b,this.c);p.a(1,1,se),p.a(1,2,se);var f,y,m,b=ue(this,r);for(f=0,y=b.length;f<y;f++)if(m=b[f],oe.prototype.a.apply(p,le[m]),256<m)p.a(b[++f],b[++f],se),p.a(b[++f],5),p.a(b[++f],b[++f],se);else if(256===m)break;this.b=p.finish(),this.c=this.b.length;break;case ce:var I,v,A,C,S,w,E,x,T,R,F,k,P,_,N,B=new oe(ae?new Uint8Array(this.b.buffer):this.b,this.c),D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],U=Array(19);for(I=ce,B.a(1,1,se),B.a(I,2,se),v=ue(this,r),E=ge(w=he(this.j,15)),T=ge(x=he(this.i,7)),A=286;257<A&&0===w[A-1];A--);for(C=30;1<C&&0===x[C-1];C--);var O,V,J,H,W,j,L=A,M=C,K=new(ae?Uint32Array:Array)(L+M),Z=new(ae?Uint32Array:Array)(316),G=new(ae?Uint8Array:Array)(19);for(O=V=0;O<L;O++)K[V++]=w[O];for(O=0;O<M;O++)K[V++]=x[O];if(!ae)for(O=0,H=G.length;O<H;++O)G[O]=0;for(O=W=0,H=K.length;O<H;O+=V){for(V=1;O+V<H&&K[O+V]===K[O];++V);if(J=V,0===K[O])if(J<3)for(;0<J--;)G[Z[W++]=0]++;else for(;0<J;)J-3<(j=J<138?J:138)&&j<J&&(j=J-3),j<=10?(Z[W++]=17,Z[W++]=j-3,G[17]++):(Z[W++]=18,Z[W++]=j-11,G[18]++),J-=j;else if(Z[W++]=K[O],G[K[O]]++,--J<3)for(;0<J--;)Z[W++]=K[O],G[K[O]]++;else for(;0<J;)J-3<(j=J<6?J:6)&&j<J&&(j=J-3),Z[W++]=16,Z[W++]=j-3,G[16]++,J-=j}for(e=ae?Z.subarray(0,W):Z.slice(0,W),R=he(G,7),_=0;_<19;_++)U[_]=R[D[_]];for(S=19;4<S&&0===U[S-1];S--);for(F=ge(R),B.a(A-257,5,se),B.a(C-1,5,se),B.a(S-4,4,se),_=0;_<S;_++)B.a(U[_],3,se);for(_=0,N=e.length;_<N;_++)if(k=e[_],B.a(F[k],R[k],se),16<=k){switch(_++,k){case 16:P=2;break;case 17:P=3;break;case 18:P=7;break;default:throw"invalid code: "+k}B.a(e[_],P,se)}var Y,X,z,q,$,Q,ee,te,ie=[E,w],ne=[T,x];for($=ie[0],Q=ie[1],ee=ne[0],te=ne[1],Y=0,X=v.length;Y<X;++Y)if(z=v[Y],B.a($[z],Q[z],se),256<z)B.a(v[++Y],v[++Y],se),q=v[++Y],B.a(ee[q],te[q],se),B.a(v[++Y],v[++Y],se);else if(256===z)break;this.b=B.finish(),this.c=this.b.length;break;default:throw"invalid compression type"}return this.b};var d=function(){function e(e){switch(se){case 3===e:return[257,e-3,0];case 4===e:return[258,e-4,0];case 5===e:return[259,e-5,0];case 6===e:return[260,e-6,0];case 7===e:return[261,e-7,0];case 8===e:return[262,e-8,0];case 9===e:return[263,e-9,0];case 10===e:return[264,e-10,0];case e<=12:return[265,e-11,1];case e<=14:return[266,e-13,1];case e<=16:return[267,e-15,1];case e<=18:return[268,e-17,1];case e<=22:return[269,e-19,2];case e<=26:return[270,e-23,2];case e<=30:return[271,e-27,2];case e<=34:return[272,e-31,2];case e<=42:return[273,e-35,3];case e<=50:return[274,e-43,3];case e<=58:return[275,e-51,3];case e<=66:return[276,e-59,3];case e<=82:return[277,e-67,4];case e<=98:return[278,e-83,4];case e<=114:return[279,e-99,4];case e<=130:return[280,e-115,4];case e<=162:return[281,e-131,5];case e<=194:return[282,e-163,5];case e<=226:return[283,e-195,5];case e<=257:return[284,e-227,5];case 258===e:return[285,e-258,0];default:throw"invalid length: "+e}}var t,i,n=[];for(t=3;t<=258;t++)i=e(t),n[t]=i[2]<<24|i[1]<<16|i[0];return n}(),I=ae?new Uint32Array(d):d;function ue(e,t){function i(e,t){var i,n,r,s,a=e.g,o=[],c=0;switch(i=I[e.length],o[c++]=65535&i,o[c++]=i>>16&255,o[c++]=i>>24,se){case 1===a:n=[0,a-1,0];break;case 2===a:n=[1,a-2,0];break;case 3===a:n=[2,a-3,0];break;case 4===a:n=[3,a-4,0];break;case a<=6:n=[4,a-5,1];break;case a<=8:n=[5,a-7,1];break;case a<=12:n=[6,a-9,2];break;case a<=16:n=[7,a-13,2];break;case a<=24:n=[8,a-17,3];break;case a<=32:n=[9,a-25,3];break;case a<=48:n=[10,a-33,4];break;case a<=64:n=[11,a-49,4];break;case a<=96:n=[12,a-65,5];break;case a<=128:n=[13,a-97,5];break;case a<=192:n=[14,a-129,6];break;case a<=256:n=[15,a-193,6];break;case a<=384:n=[16,a-257,7];break;case a<=512:n=[17,a-385,7];break;case a<=768:n=[18,a-513,8];break;case a<=1024:n=[19,a-769,8];break;case a<=1536:n=[20,a-1025,9];break;case a<=2048:n=[21,a-1537,9];break;case a<=3072:n=[22,a-2049,10];break;case a<=4096:n=[23,a-3073,10];break;case a<=6144:n=[24,a-4097,11];break;case a<=8192:n=[25,a-6145,11];break;case a<=12288:n=[26,a-8193,12];break;case a<=16384:n=[27,a-12289,12];break;case a<=24576:n=[28,a-16385,13];break;case a<=32768:n=[29,a-24577,13];break;default:throw"invalid distance"}for(i=n,o[c++]=i[0],o[c++]=i[1],o[c++]=i[2],r=0,s=o.length;r<s;++r)d[p++]=o[r];y[o[0]]++,m[o[3]]++,f=e.length+t-1,u=null}var n,r,s,a,o,c,l,u,h,g={},d=ae?new Uint16Array(2*t.length):[],p=0,f=0,y=new(ae?Uint32Array:Array)(286),m=new(ae?Uint32Array:Array)(30),b=e.f;if(!ae){for(s=0;s<=285;)y[s++]=0;for(s=0;s<=29;)m[s++]=0}for(y[256]=1,n=0,r=t.length;n<r;++n){for(s=o=0,a=3;s<a&&n+s!==r;++s)o=o<<8|t[n+s];if(g[o]===re&&(g[o]=[]),c=g[o],!(0<f--)){for(;0<c.length&&32768<n-c[0];)c.shift();if(r<=n+3){for(u&&i(u,-1),s=0,a=r-n;s<a;++s)h=t[n+s],d[p++]=h,++y[h];break}0<c.length?(l=v(t,n,c),u?u.length<l.length?(h=t[n-1],d[p++]=h,++y[h],i(l,0)):i(u,-1):l.length<b?u=l:i(l,0)):u?i(u,-1):(h=t[n],d[p++]=h,++y[h])}c.push(n)}return d[p++]=256,y[256]++,e.j=y,e.i=m,ae?d.subarray(0,p):d}function v(e,t,i){var n,r,s,a,o,c,l=0,u=e.length;a=0,c=i.length;e:for(;a<c;a++){if(n=i[c-a-1],(s=3)<l){for(o=l;3<o;o--)if(e[n+o-1]!==e[t+o-1])continue e;s=l}for(;s<258&&t+s<u&&e[n+s]===e[t+s];)++s;if(l<s&&(r=n,l=s),258===s)break}return new g(l,t-r)}function he(e,t){var i,n,r,s,a,o=e.length,c=new u(572),l=new(ae?Uint8Array:Array)(o);if(!ae)for(s=0;s<o;s++)l[s]=0;for(s=0;s<o;++s)0<e[s]&&c.push(s,e[s]);if(i=Array(c.length/2),n=new(ae?Uint32Array:Array)(c.length/2),1===i.length)return l[c.pop().index]=1,l;for(s=0,a=c.length/2;s<a;++s)i[s]=c.pop(),n[s]=i[s].value;for(r=function(e,i,t){function n(e){var t=d[e][p[e]];t===i?(n(e+1),n(e+1)):--h[t],++p[e]}var r,s,a,o,c,l=new(ae?Uint16Array:Array)(t),u=new(ae?Uint8Array:Array)(t),h=new(ae?Uint8Array:Array)(i),g=Array(t),d=Array(t),p=Array(t),f=(1<<t)-i,y=1<<t-1;for(l[t-1]=i,s=0;s<t;++s)f<y?u[s]=0:(u[s]=1,f-=y),f<<=1,l[t-2-s]=(l[t-1-s]/2|0)+i;for(l[0]=u[0],g[0]=Array(l[0]),d[0]=Array(l[0]),s=1;s<t;++s)l[s]>2*l[s-1]+u[s]&&(l[s]=2*l[s-1]+u[s]),g[s]=Array(l[s]),d[s]=Array(l[s]);for(r=0;r<i;++r)h[r]=t;for(a=0;a<l[t-1];++a)g[t-1][a]=e[a],d[t-1][a]=a;for(r=0;r<t;++r)p[r]=0;for(1===u[t-1]&&(--h[0],++p[t-1]),s=t-2;0<=s;--s){for(o=r=0,c=p[s+1],a=0;a<l[s];a++)(o=g[s+1][c]+g[s+1][c+1])>e[r]?(g[s][a]=o,d[s][a]=i,c+=2):(g[s][a]=e[r],d[s][a]=r,++r);p[s]=0,1===u[s]&&n(s)}return h}(n,n.length,t),s=0,a=i.length;s<a;++s)l[i[s].index]=r[s];return l}function ge(e){var t,i,n,r,s=new(ae?Uint16Array:Array)(e.length),a=[],o=[],c=0;for(t=0,i=e.length;t<i;t++)a[e[t]]=1+(0|a[e[t]]);for(t=1,i=16;t<=i;t++)o[t]=c,c+=0|a[t],c<<=1;for(t=0,i=e.length;t<i;t++)for(c=o[e[t]],o[e[t]]+=1,n=s[t]=0,r=e[t];n<r;n++)s[t]=s[t]<<1|1&c,c>>>=1;return s}e("Zlib.RawDeflate",o),e("Zlib.RawDeflate.prototype.compress",o.prototype.h);var p,f,y,m,b={NONE:0,FIXED:1,DYNAMIC:ce};if(Object.keys)p=Object.keys(b);else for(f in p=[],y=0,b)p[y++]=f;for(y=0,m=p.length;y<m;++y)e("Zlib.RawDeflate.CompressionType."+(f=p[y]),b[f])}).call($zlib);var Zlib=function(){function m(){classCallCheck(this,m)}return createClass(m,null,[{key:"stringToByteArray",value:function(e){for(var t=e.split(""),i=0,n=t.length;i<n;i++)t[i]=(255&t[i].charCodeAt(0))>>>0;return t}},{key:"byteArrayToString",value:function(e){for(var t="",i=0;i<e.length;i++)t+=String.fromCharCode(e[i]);return t}},{key:"emojiToHtmlEntity",value:function(e){return e.replace(/\ud83c[\udf00-\udfff]|\ud83d[\udc00-\ude4f]|\ud83d[\ude80-\udeff]/g,function(e){return"&#"+e.codePointAt(0)+";"})}},{key:"utf8Encode",value:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",i=0;i<e.length;i++){var n=e.charCodeAt(i);n<128?t+=String.fromCharCode(n):(127<n&&n<2048?t+=String.fromCharCode(n>>6|192):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128)),t+=String.fromCharCode(63&n|128))}return t}},{key:"timerSplitAndProcess",value:function(e,t,i,n,r,s,a,o,c,l){logger.log("timerSplitAndProcess: processing "+t+" - "+i);for(var u=t;u<i;u++){var h=e.substring(u*r,(u+1)*r);h=m.emojiToHtmlEntity(h);var g=m.utf8Encode(h),d=m.stringToByteArray(g),p=new $zlib.Zlib.RawDeflate(d).compress(),f=btoa(m.byteArrayToString(p));a.push(f)}if(logger.log("timerSplitAndProcess: finished processing "+t+" - "+i),i<n){var y=Math.min(n,i+s);logger.log("set timeout to process: "+i+" - "+y),setTimeout(function(){m.timerSplitAndProcess(e,i,y,n,r,s,a,o,c,l)},o)}else logger.log("finished compressinbg all: "+a.length),l(a,c)}},{key:"splitAndProcess",value:function(e,r,t,i,n,s){var a=5,o=25;i&&i.browser&&"Firefox"===i.browser.name?(a=2,o=i.browser.version<51?75:50):i&&i.isInternetExp()&&(a=2,o=75);var c=parseInt(e.length/t)+1;logger.log("initiating timer. length: "+e.length+", fragment count:"+c);var l=Math.min(a,c);m.timerSplitAndProcess(e,0,l,c,t,a,[],o,n,function(e,t){var i="";logger.log("finalizing array after compression: "+e.length);for(var n=0;n<e.length;n++)i+=constants.record.upload.delim+e[n];s(i,r,t,1)})}}]),m}(),EventWriter=function(){function n(e,t,i){classCallCheck(this,n),logger.log("event writer constructor"),this.storKey=i,this.stg=e,this.browser=getInstance(),this.initParams(),this.initState(e)}return createClass(n,[{key:"initParams",value:function(){this.transmitInterval=1e3*(config.getConfig("transmitInterval","behavior")||constants.record.upload.defaultTransmitInterval),this.mobileTransmitInterval=1e3*(config.getConfig("mobileTransmitInterval","behavior")||constants.record.upload.defaultMobileMaxTransmitInterval),this.maxTransmitInterval=1e3*(config.getConfig("maxTransmitInterval","behavior")||constants.record.upload.defaultMaxTransmitInterval),this.mobileMaxTransmitInterval=1e3*(config.getConfig("mobileMaxTransmitInterval","behavior")||constants.record.upload.defaultMobileMaxTransmitInterval)}},{key:"syncToServerAndPersist",value:function(e){this.transformDataForUpload(),this.upload(e),this.dataLayer.setStrAndCommit(this.serialized)}},{key:"logVisibilityChange",value:function(){var e=globalSessionTracker.getSessionMetadata();e.isOver||e.sessionId&&this.append(EventType.ViewChangeT(),{k:"vc",v:{sid:e.viewId,status:0,url:location.href,title:this.title}})}},{key:"setReady",value:function(){this.ready=!0,this.stg.setByKey(constants.events.READY,!0)}},{key:"setNotReady",value:function(){this.ready=!1,this.stg.setByKey(constants.events.READY,!1)}},{key:"stopUploading",value:function(){this.setNotReady(),this.initAndClearInterval()}},{key:"initAndClearInterval",value:function(){this.initEventQueue(),this.readyFlagTracker&&(clearInterval(this.readyFlagTracker),delete this.readyFlagTracker)}},{key:"pause",value:function(){var e=this;if(!globalSessionTracker.getSessionMetadata().isOver)return!globalSessionTracker.isCanceled()&&(this.sendRecordingStatusEvent("Recording Paused"),this.serializeAndUpload(!0),setTimeout(function(){e.initAndClearInterval(),e.cancelStorageCheck(),globalSessionTracker.setCancel(!0)},500),!0)}},{key:"resume",value:function(){var e=!1,t=globalSessionTracker.getSessionMetadata();return t.isOver&&(globalSessionTracker.renewSession(),e=!0),t=globalSessionTracker.getSessionMetadata(),!!globalSessionTracker.isCanceled()&&(globalSessionTracker.setCancel(!1),this.startCheckingStorage(),this.startCheckingState(),e||globalSessionTracker.initSessionOrPV(),this.sendRecordingStatusEvent("Recording Resumed"),!0)}},{key:"sendRecordingStatusEvent",value:function(e){this.append(EventType.CustomEventT(),{k:e,v:JSON.stringify({et:e,url:location.href,title:this.title})})}},{key:"updateToCoBrowsing",value:function(){this.cobrowsing||(this.upgradedToCoBrowsing=!0)}},{key:"isUpgradedToCoBrowsing",value:function(){return this.upgradedToCoBrowsing}},{key:"initState",value:function(e){this.ready=!_.isDefined(e.getByKey(constants.events.READY))||e.getByKey(constants.events.READY),this.stg.setByKey(constants.events.READY,this.ready),this.numUploadErrors=0,this.uploadWaiting=!1,this.isUploader=!1,this.prevUploadTS=_.now()-constants.record.upload.initTimeOffset,this.lastPingTime=_.now()-constants.record.upload.initTimeOffset,this.cobrowsing=config.getConfig("cb","record")?1:0,this.upgradedToCoBrowsing=!1,this.title=document.title||_.isObject(history.state)&&history.state&&history.state.title,null!==this.title&&0!==this.title.length||(this.title="Untitled Page"),this.eventid=0,this.dataLayer=StorageManager.getInstance(this.storKey),this.serialized="",this.dataLayer&&(this.serialized=this.dataLayer.getStr()),this.instance=null,this.lastEvtTime=null,this.lastTrackingSessionTime=0,this.resetDomPathCache(),this.initEventQueue(),this.startCheckingState(),this.startCheckingStorage()}},{key:"serializeAndUpload",value:function(e){this.ready&&!globalSessionTracker.isCanceled()&&(e||this.isFull())&&(this.transformDataForUpload(),this.upload(e))}},{key:"readyForUpload",value:function(){return config.isVisualEditorMode()?(this.serialized="",!1):!(globalSessionTracker.isSessionOver()||!this.ready||0===this.serialized.length||globalSessionTracker.isCanceled())}},{key:"upload",value:function(e){if(this.readyForUpload()){var t=_.timestamp();if(this.isUploading){var i=e?constants.record.upload.shortWait:constants.record.upload.wait;if(t-this.prevUploadTS<=i)return void(this.uploadWaiting=!0)}this.prevUploadTS=t,config.getConfig("siteToken","base")?this.sendWithProtobuf(this.serialized):logger.warn("Can not found accessToken")}}},{key:"ping",value:function(){if(!globalSessionTracker.isSessionOver()&&this.ready&&!globalSessionTracker.isCanceled()){var e=_.now();e-this.prevUploadTS<constants.record.upload.pingWaitInterval||e-this.lastPingTime<constants.record.upload.pingWaitInterval||this.append(EventType.HeartbeatT(),{},0)}}},{key:"initEventQueue",value:function(){this.queue={},this.newEventsByteLength=0,this.queue.log=[],this.queue.start=_.timestamp(),this.queue.guid=idGen$1.generateGUID()}},{key:"isQueueEmpty",value:function(){return 0===this.queue.log.size}},{key:"addDeviceInfoEvent",value:function(e){var t=brUtils.getScreenResolution(),i={et:EventType.DeviceInfoT(),dt:"",df:"",dm:"",on:"",ov:"",sw:t.w,sh:t.h,longitude:0,latitude:0},n=DataLayer.getInstance(constants.symbols.PERMANENT),r=n&&n.getUserProp(constants.events.IDENTITYVALUE);r&&(i.identity=r);var s={id:this.eventid,x:-1,p:globalSessionTracker.getPV(),d:i,t:_.now()};return this.eventid=this.eventid+1,e.push(s),e}},{key:"transformDataForUpload",value:function(){if(!this.isQueueEmpty()){var e=JSON.stringify(this.queue.log);if(-1===this.serialized.indexOf("{"))this.serialized=e;else{var t=this.serialized.lastIndexOf("}"),i=e.indexOf("{");this.serialized=this.serialized.substring(0,t+1)+","+e.substr(i)}this.initEventQueue()}}},{key:"append",value:function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;if(this.ready&&!globalSessionTracker.isCanceled()){var r=globalSessionTracker.getSessionMetadata();if(!r.isOver){var s="number"==typeof i?i:i?this.updateNodeDict(i.getProcXPath()):0,a=_.timestamp();t.basicProps&&t.basicProps.currentTime&&(a=t.basicProps.currentTime,delete t.basicProps),a-=n,(t=config.compress(t)).et=e;var o=r.sessionId,c=r.viewId,l={id:this.eventid,x:s,p:globalSessionTracker.getPV(),d:t,t:a,_v:c,_s:o};this.eventid=this.eventid+1,this.queue.log.push(l),this.newEventsByteLength+=JSON.stringify(l).length,this.isCriticalEvents(e)&&this.serializeAndUpload(!0)}}}},{key:"isCriticalEvents",value:function(e){return e===EventType.TapT()||e===EventType.PressT()||e===EventType.PVT()||e===EventType.HTMLTextT()||e===EventType.MouseClickT()}},{key:"isUserInitiatedEvents",value:function(e){return e===EventType.PVT()||e===EventType.HTMLTextT()||e===EventType.SclWindowT()||e===EventType.MouseLeaveEntryT()||e===EventType.KeyStrokeDownT()||e===EventType.InputValChangedT()||e===EventType.MouseClickT()||e===EventType.SclInNodeT()||e===EventType.SwipeT()||e===EventType.PinchT()||e===EventType.TapT()||e===EventType.PressT()||e===EventType.MouseClickT()}},{key:"updateNodeDict",value:function(){if(this.ready&&!globalSessionTracker.isCanceled()){var e=arguments[0].join(",");if(!_.isDefined(this.domPathCache[e])){this.domPathList[this.domPathList.length]=e;var t=this.domPathList.length-1;this.domPathCache[e]=t,this.append(EventType.NodeDictionaryT(),{x:t+"",v:e})}return this.domPathCache[e]}}},{key:"resetDomPathCache",value:function(){this.domPathCache={},this.domPathList=[]}},{key:"resetState",value:function(){this.eventid=0}},{key:"isFull",value:function(){return constants.storage.DEFAULT_LIMIT<=this.newEventsByteLength+this.serialized.length}},{key:"loadReadyFlagFromStg",value:function(){this.ready=!_.isDefined(this.stg.getByKey(constants.events.READY))||this.stg.getByKey(constants.events.READY),this.ready?this.setReady():this.stopUploading()}},{key:"startCheckingState",value:function(){var e=this;this.readyFlagTracker||(this.loadReadyFlagFromStg(),this.readyFlagTracker=setInterval(function(){return e.loadReadyFlagFromStg()},5e3))}},{key:"startCheckingStorage",value:function(){var e=this;this.storageChecker||(this.storageChecker=setInterval(function(){return e.serializeAndUpload()},this.browser.isPhoneOrTablet()?this.mobileTransmitInterval:this.transmitInterval)),this.maxWaitMonitor||(this.maxWaitMonitor=setInterval(function(){return e.serializeAndUpload(!0)},this.browser.isPhoneOrTablet()?this.mobileMaxTransmitInterval:this.maxTransmitInterval))}},{key:"cancelStorageCheck",value:function(){this.storageChecker&&(clearInterval(this.storageChecker),delete this.storageChecker),this.maxWaitMonitor&&(clearInterval(this.maxWaitMonitor),delete this.maxWaitMonitor)}},{key:"useProxy",value:function(){return!0===config.getConfig("proxy","base")}},{key:"getUploadUri",value:function(){var e=config.getConfig("tracking_uri","base");return e=this.useProxy()?config.getConfig("tracking_uri_proxy","base")+"/v1/event":window.location.protocol+"//"+e+"/v1/event"}},{key:"uploadToServer",value:function(e,t,i,n,r){var s=this;try{var a=new window.XMLHttpRequest;for(var o in a.open(r,i,!0),a.onreadystatechange=function(){4===this.readyState&&(202===this.status&&"POST"===r?(s.serialized===t?s.serialized="":-1!==s.serialized.indexOf(t.substr(1,t.length-1))&&(s.serialized="["+s.serialized.substr(t.length)),s.isUploading=!1,s.uploadWaiting&&setTimeout(function(){s.serializeAndUpload(!0)},100)):202!==this.status&&"POST"===r&&(s.isUploading=!1,s.numUploadErrors++,s.numUploadErrors>constants.storage.RETRY_LIMIT?(s.stopUploading(),s.initEventQueue()):s.uploadWaiting&&setTimeout(function(){s.serializeAndUpload(!0)},100)))},n)"Content-length"!==n&&"Connection"!==n&&a.setRequestHeader(o,n[o]);"POST"===r?a.send(e):a.send()}catch(e){}}},{key:"convertToProtobuf",value:function(e,t,i,n){var r=n.sessionId,s=n.viewId,a=n.userId,o=config.getSiteid();if(o&&a&&r){var c=$root.com.auryc.ubi.core.model.Message,l=new buffer_1(e),u=new c.MessagePacket({vid:s,ts:i,status:t,size:l.length,data:l}),h=new c({cid:o,uid:a,sid:r,domain:document.domain.toString(),context:new c.MessageContext({ln:"Web",lv:"0.4.32",ref:document.referrer}),packet:[u]}),g=c.verify(h);if(g)throw Error(g);return c.encode(h).finish()}return null}},{key:"getUTCTime",value:function(){var e=new Date,t=Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds());return Math.floor(t/1e3)}},{key:"getStatusInt",value:function(e,t){var i=0;return 1===e&&(i|=1),1===t&&(i|=2),this.isUpgradedToCoBrowsing()&&(i|=4),i}},{key:"getJWTToken",value:function(){var e={};e.iss=config.getSiteid(),e.iat=this.getUTCTime()-12e4;var t=config.getConfig("siteToken","base"),i=JSON.stringify({alg:"HS256",typ:"JWT"}),n=JSON.stringify(e);return jsrsasign.jws.JWS.sign("HS256",i,n,{rstr:t})}},{key:"splitEvents",value:function(e){var t=[];if(1===e.length)return[e];var i=Math.floor(e.length/2),n=e.slice(0,i),r=e.slice(i);if(JSON.stringify(n).length>constants.storage.MAX_PACKET_SIZE&&1<n.length){var s=this.splitEvents(n);t=t.concat(s)}else t.push(n);if(JSON.stringify(r).length>constants.storage.MAX_PACKET_SIZE&&1<r.length){var a=this.splitEvents(r);t=t.concat(a)}else t.push(r);return t}},{key:"getLastUserEventTime",value:function(e){if(e&&0<e.length)for(var t=e.length-1;0<=t;t--)if(this.isUserInitiatedEvents(e[t].d.et))return e[t].t;return null}},{key:"sendWithProtobuf",value:function(t){var l=this,u=globalSessionTracker.getSessionMetadata();if(!u.isOver){var i=[];try{i=JSON.parse(t)}catch(e){logger.log("json exception"),logger.log(e),logger.log(t),i=[]}if(i&&0!==i.length)if((i=i.filter(function(e){return e&&e.t>=u.sessionTime&&e._v===u.viewId&&e._s===u.sessionId}).sort(function(e,t){return e.t-t.t}).map(function(e){return delete e._v,delete e._s,e}))&&0!==i.length){var e=this.getLastUserEventTime(i);if(this.lastEvtTime)i[i.length-1].t>=this.lastEvtTime?(i=i.filter(function(e){return e.t>=l.lastEvtTime}),this.lastEvtTime=e||this.lastEvtTime):i=[];else this.lastEvtTime=e;if(i&&0!==i.length){var n=(i=this.addDeviceInfoEvent(i))[0].t;i.forEach(function(e){e.t=e.t-n});var r=JSON.stringify(i),s=function(e,t,i,n){var r=l.getStatusInt(n,l.cobrowsing),s=l.convertToProtobuf(e,r,i,u);if(s){logger.log("SIZE: pb data length: "+s.length,!0);var a=l.getJWTToken(),o=l.getUploadUri(),c={"Content-Type":"application/x-protobuf;charset=utf-8",Authorization:a};l.useProxy()&&(c["Payload-Type"]=0),l.uploadToServer(s,t,o,c,"POST",i)}};!1!==config.getConfig("compress","behavior")&&!this.isCompressBlackList()?Zlib.splitAndProcess(r,t,constants.record.upload.fragLength,this.browser,n,s):s(r,t,n,0)}else logger.log("Empty event list. Skip")}else logger.log("Empty event list. Skip");else logger.log("Empty event list. Skip")}}},{key:"isCompressBlackList",value:function(){var e=getInstance(),t=config.getConfig("perf_blacklist","record")||{},i=t.urls||[],n=(t.browser_cutoff||{})[e.browser.name];if(n&&e.browser.version<n)for(var r=0;r<i.length;r++)if(-1!==window.location.href.indexOf(i[r]))return!0;return!1}},{key:"samplingEvent",value:function(e){var t=!0;if(!_.isNumber(e))return t;0===e?t=!1:t=100*Math.random()<e;return t}}],[{key:"getInstance",value:function(e,t){return n.instance||(n.instance=new n(e,t)),n.instance}}]),n}();function normalize(e){var i=[];return e.forEach(function(e,t){i.push(normalizeNode(e))}),i}var htmlEscape={"&":"&amp;","=":"&#61;","'":"&#39;","\0":"&#00;","\v":"&#11;","\n":"&#12;","\\[":"&#91;","\\]":"&#93;"};function normalizeAttribute(e){return e.value&&(e.value=replaceAll(e.value.trim(),htmlEscape)),e}function normalizeClassName(e){var t=e.value.replace(/\s\s+/g," ").split(" ").sort();return e.value="."+t.join("."),e}function normalizeNode(e){var i={},n={},r={};e.forEach(function(e){var t=e.name.toLowerCase();0<=["tag","id","class"].indexOf(t)?("tag"===t?e.value=e.value.toLowerCase():"class"===t&&(e=normalizeClassName(e)),i[t]=e):0===t.indexOf(":")?r[t]=e:(e=normalizeAttribute(e),n[t]=e)});var t=[];return i.tag&&t.push(i.tag),i.id&&t.push(i.id),i.class&&t.push(i.class),t=(t=t.concat(mapToArrayByKey(n))).concat(mapToArrayByKey(r))}function mapToArrayByKey(t){var i=[];return Object.keys(t).sort().forEach(function(e){i.push(t[e])}),i}function replaceAll(e,t){var i=new RegExp(Object.keys(t).join("|"),"gi");return e.replace(i,function(e){return t[e.toLowerCase()]||t["\\"+e.toLowerCase()]})}var attrCode={tag:"t",id:"i",class:"c",":nth-child":":nc",":nth-of-type":":nt"};function generateElementContext(e){var t=getElementsOnPath(e);return serializeNodes(t=normalize(t))}function serializeNodes(i){var n="";return i.forEach(function(e,t){e.forEach(function(e){var t=attrCode[e.name]||e.name;n+="["+t+"="+e.value+"]"}),t<i.length-1&&(n+="\v")}),n}function getElementsOnPath(e){for(var t=[];e;){var i=getElementProperties(e);if(t.unshift(i),e===document.body||"BODY"===e.nodeName)break;e=e.parentNode}return t}function getClassName(e){switch(_typeof(e.className)){case"string":return e.className;case"object":return e.className.baseVal||e.getAttribute("class")||"";default:return""}}function specialWhitelist(e){return"src"===e.name&&"/etc/designs/site/cc/img/btn-build-package-small.png"===e.value||"alt"===e.name&&(null===e.value||""===e.value)}function getElementProperties(e){var t=[{name:"tag",value:e.tagName?e.tagName:""}];e.id&&t.push({name:"id",value:e.id});var i=getClassName(e).trim();i&&t.push({name:"class",value:i});var n=[],r=["id","class"].concat(constants.pii.maskingAttributes);if(e.attributes)for(var s=0;s<e.attributes.length;s++)e.attributes[s].name&&(specialWhitelist(e.attributes[s])||r.indexOf(e.attributes[s].name)<0&&!/data-*/.test(e.attributes[s].name))&&n.push({name:e.attributes[s].name,value:e.attributes[s].value});0<n.length&&(n=n.sort(function(e,t){return e.name<t.name?-1:e.name>t.name?1:0}),t=t.concat(n));for(var a=1,o=1,c=previousElementSibling(e);c;)a++,c.tagName===e.tagName&&o++,c=previousElementSibling(c);return t.push({name:":nth-child",value:a}),t.push({name:":nth-of-type",value:o}),t}var ELEMENT_NODE=1;function previousElementSibling(e){if(e.previousElementSibling)return e.previousElementSibling;for(;(e=e.previousSibling)&&e.nodeType!==ELEMENT_NODE;);return e}var eventTargetParser={_initializedTokens:[],_previousElementSibling:function(e){if(e.previousElementSibling)return e.previousElementSibling;for(;(e=e.previousSibling)&&e.nodeType!==Node.ELEMENT_NODE;);return e},_loadScript:function(e,t){var i=document.createElement("script");i.type="text/javascript",i.src=e,i.onload=t;var n=document.getElementsByTagName("script");0<n.length?n[0].parentNode.insertBefore(i,n[0]):document.body.appendChild(i)},_getClassName:function(e){return e.tagName&&"svg"===e.tagName.toLowerCase()?e.className.baseVal||e.getAttribute("class")||"":e.className||""},_isClickEvent:function(e){return"click"===e||"mousedown"===e||-1<e.indexOf("touch")||-1<e.indexOf("pointer")},_shouldTrackDomEvent:function(e,t){if(!e||e===document||e===document.body.parentNode||e.nodeType!==Node.ELEMENT_NODE)return!1;switch(e.tagName?e.tagName.toLowerCase():""){case"html":return!1;case"form":return"submit"===t.type;case"input":return["button","submit"].indexOf(e.getAttribute("type")),this._isClickEvent(t.type);case"select":case"textarea":default:return this._isClickEvent(t.type)}},_getDefaultProperties:function(e){if(document&&document.body)return{$event_type:e,$host:window.location.host,$pathname:window.location.pathname};logger.log("document not ready yet, trying again in 500 milliseconds...");var t=this;setTimeout(function(){t._getDefaultProperties(e)},500)},_getInputValue:function(e){var t=null;switch(e.type.toLowerCase()){case"checkbox":e.checked&&(t=[e.value]);break;case"radio":e.checked&&(t=e.value);break;default:t=e.value}return t},_getSelectValue:function(e){var t;if(e.multiple){var i=[];_.each(e.querySelectorAll("[selected]"),function(e){i.push(e.value)}),t=i}else t=e.value;return t},_includeProperty:function(e,t){for(var i=e;i.parentNode&&i!==document.body;i=i.parentNode){var n=this._getClassName(i).split(" ");if(_.includes(n,"_ar_hide_"))return!1}if(null===t)return!1;switch((e.type||"").toLowerCase()){case"hidden":case"password":return!1}var r=e.name||e.id||"";if(/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|seccode|securitycode|securitynum|socialsec|socsec|ssn/i.test(r.replace(/[^a-zA-Z0-9]/g,"")))return!1;if("string"==typeof t){if(/^(?:(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11}))$/.test((t||"").replace(/[\- ]/g,"")))return!1;if(/(^\d{3}-?\d{2}-?\d{4}$)/.test(t))return!1}return!0},_getFormFieldValue:function(e){var t;switch((e.tagName?e.tagName:"").toLowerCase()){case"input":t=this._getInputValue(e);break;case"select":t=this._getSelectValue(e);break;default:t=e.value||e.textContent}return this._includeProperty(e,t)?t:null},_getFormFieldProperties:function(e){var r={};return _.each(e.elements,function(e){var t=e.getAttribute("name")||e.getAttribute("id");if(null!==t){t="$form_field__"+t;var i=this._getFormFieldValue(e);if(this._includeProperty(e,i)){var n=r[t];r[t]=void 0!==n?[].concat(n,i):i}}},this),r},_extractCustomPropertyValue:function(e){var i=[];return _.each(document.querySelectorAll(e.css_selector),function(e){var t=e.tagName?e.tagName:"";-1<["input","select"].indexOf(t.toLowerCase())?i.push(e.value):e.textContent&&i.push(e.textContent)}),i.join(", ")},_getCustomProperties:function(n){var r={};return _.each(this._customProperties,function(i){_.each(i.event_selectors,function(e){var t=document.querySelectorAll(e);_.each(t,function(e){_.includes(n,e)&&(r[i.name]=this._extractCustomPropertyValue(i))},this)},this)},this),r},_getEventTarget:function(e){return void 0===e.target?e.srcElement:e.target},getTarget:function(e){var r=this;if("string"==typeof e)return this._getDefaultProperties(e);var t=this._getEventTarget(e);if(t.nodeType===Node.TEXT_NODE&&(t=t.parentNode),this._shouldTrackDomEvent(t,e)){for(var i=[t],n=t;n.parentNode&&n!==document.body;)i.push(n.parentNode),n=n.parentNode;var s,a,o,c,l=!1;_.each(i,function(e,t){if(e.tagName&&"a"===e.tagName.toLowerCase()?a=e.getAttribute("href"):e.tagName&&"form"===e.tagName.toLowerCase()&&(c=e),!o&&t<5&&e.textContent){var i=_.trim(e.textContent.substring(0,510));i&&(o=i.replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255))}if("string"==typeof r._getClassName(e)){var n=r._getClassName(e).split(" ");_.includes(n,"_ar_hide_")&&(l=!0)}}),l&&(o="Sensitive Information"),s=generateElementContext(t),logger.log(JSON.stringify(s));var u=_.extend(this._getDefaultProperties(e.type),{$elements:s,$el_attr__href:a});return l||(u=_.extend(u,this._getCustomProperties(i))),!c||"submit"!==e.type&&"click"!==e.type||_.extend(u,this._getFormFieldProperties(c)),u}},_navigate:function(e){window.location.href=e},_customProperties:{},isBrowserSupported:function(){return _.isFunction(document.querySelectorAll)}};function isPIINodeRec(e){if(!e)return!1;e.nodeType===Node.TEXT_NODE&&(e=e.parentNode);try{var t=e.type||e.getAttribute("type");if("reset"===t||"submit"===t||"button"===t)return!1;var i=e.className||e.getAttribute("class");return i&&0<=i.indexOf(constants.pii.maskingClassName)}catch(e){return!1}}function isPIINode(e){if(!e)return!1;if(e.nodeType===Node.TEXT_NODE)return isPIINode(e=e.parentNode);if("body"===e.nodeName.toLowerCase())return isPIINodeRec(e);var t=isPIINodeRec(e);return!t&&e.parentNode?isPIINode(e.parentNode):t}function getTopLevelWin(e){if(!e)return null;if(e.ownerDocument&&e.ownerDocument.defaultView)return e.ownerDocument.defaultView;for(;e.parentNode||e.document;){if(e.document)return e;e=e.parentNode}}function getNodeCoord(e,t){for(var i=0,n=0;e;){var r=parseFloat(getElCssProp(e,t,"border-top-width"));r||(r=0);var s=parseFloat(getElCssProp(e,t,"border-left-width"));s||(s=0),i=r+i+e.offsetTop,n=s+n+e.offsetLeft,e=e.offsetParent}return{x:i,y:n}}function getPosInTopFrame(e,t){var i={x:0,y:0};if(!t)return i;for(;t&&t.parent!==t;){var n=brUtils.getScroll(t),r=getNodeCoord(e,t);t.parent!==t&&(r={x:r.x-n.x,y:r.y-n.y}),i={x:i.x+r.x,y:i.y+r.y},e=(t=t.parent).frameElement}return i}function getElCssProp(e,t,i){return e&&t&&i?t.getComputedStyle(e,null).getPropertyValue(i):""}function getWinSz(e){return{w:(e=e||window).innerWidth||0,h:e.innerHeight||0}}function isFeedbackShown(e){return e&&0<e.querySelectorAll("."+constants.css.FBMODAL_CONTAINER).length}function getDocumentWH(e){e||(e=window.document);var t=e.body,i=e.documentElement,n="hidden"!==window.getComputedStyle(t).overflowX||isFeedbackShown(t)?Math.max(t.scrollWidth,i.scrollWidth):0;0===n&&(n=Math.max(i.clientWidth,t.offsetWidth,i.offsetWidth));var r="hidden"!==window.getComputedStyle(t).overflowY||isFeedbackShown(t)?r=Math.max(t.scrollHeight,i.scrollHeight):0;return 0===r&&(r=Math.max(i.clientHeight,t.offsetHeight,i.offsetHeight)),{width:n,height:r}}function nodeBelongsTo(e,t){if(t.contains)return t.contains(e);if(t.compareDocumentPosition)return!!(16&t.compareDocumentPosition(e));for(;e.parentNode;){if(e===t||e===t.body)return!0;e=e.parentNode}return!1}var dom={isPIINode:isPIINode,getTopLevelWin:getTopLevelWin,getPosInTopFrame:getPosInTopFrame,getSize:getWinSz,getDocSize:getDocumentWH,nodeBelongsTo:nodeBelongsTo,getPosition:getNodeCoord,getStyle:getElCssProp},SnapshotProperties=function(){function e(){classCallCheck(this,e),this.snapshotProperties={}}return createClass(e,[{key:"setEventGroups",value:function(e){var t=this;e&&(this.snapshotProperties.egs={},e.forEach(function(e){e.snapshotProperties&&0<e.snapshotProperties.length&&(t.snapshotProperties.egs[e.id]=e)}))}},{key:"isEnabled",value:function(){var e=config.getConfig("spEnabled","behavior");if(!e)return!1;for(var t=(window.location.href||"about:blank").toLowerCase(),i=0;i<e.length;i++){if(new RegExp(e[i],"i").test(t))return!0}return!1}},{key:"getMatchedEventGroups",value:function(e){var t=[];for(var i in logger.log("getMatchedEventGroups:",e),this.snapshotProperties.egs){var n=this.snapshotProperties.egs[i],r=n.jsCriteria;if(r&&""!==r){/^\s*return/.test(r)||(r="return "+r);var s=!1;try{s=new Function("event",r)(e)}catch(e){logger.warn("error in getMatchedEventGroups:",i),s=!1}logger.log("eg:"+i+": "+s),s&&n&&t.push(n)}}return t}},{key:"collect",value:function(e){var i=this,t=e.snapshotProperties,n={};return t.forEach(function(e){var t=i.collectOne(e);n=_.extend(t,n)}),n}},{key:"collectOne",value:function(e){if(e){var t=e.name,i=e.content,n=e.valueType,r=e.type;if(t&&i&&n&&r){var s={};if("javascript"===r.toLowerCase()){var a=this.getJSProp(i,n);null!=a?s[t]=a:logger.warn("Ignoring null or undefined property value for content: "+i)}else logger.warn("Unsupported snapshot property type: "+r);return s}logger.warn("missing snapshop properties metadata:",e)}}},{key:"getJSProp",value:function(t,e){/^\s*return/.test(t)||(t="return "+t),e=e.toLowerCase();var i=null;try{switch(i=new Function(t)()+"",logger.log("value: ",i),e){case"number":i=+i;break;case"currency":i=+i.replace(/[^0-9\.-]+/g,"");break;case"boolean":i=!!i}}catch(e){logger.warn("exception in getJSProp: "+t,e),i=null}return i}}]),e}(),AurycSP=new SnapshotProperties,EventGenerator=function(){function e(){classCallCheck(this,e),this.previousEventPos=null,this.instance=null}return createClass(e,[{key:"getTrackingTarget",value:function(e){var t=eventTargetParser.getTarget(e);return _.extend({},brUtils.properties(),t)}},{key:"generateLastVisitTime",value:function(e){if(globalSessionTracker.isSessionOver())logger.log("Session is over. No action");else{var t=e.currentTime;e.$timeSinceFirstVisit=t,e.visitTime=t;var i=globalSessionTracker.getSessionMetadata();if(e.userId=i.userId,e.$timeSinceLastVisit=i.sessionTime,e.userId&&""!==e.userId)return e;logger.log("can not get userId. No action")}}},{key:"getSessionId",value:function(){return globalSessionTracker.getSessionMetadata().sessionId}},{key:"getGlobalSessionId",value:function(){return globalSessionTracker.getSessionMetadata().globalSessionId}},{key:"getStartTs",value:function(e,t){return t&&"pageview"===e.$event_type&&(e.$timeSinceFirstVisit=e.startTS,e.visitTime=e.startTS),e}},{key:"assemblePayloads",value:function(e,t,i){if(t){var n,r,s=t.eventName,a=t.path,o=t.form,c=t.userIdentify,l=t.userProperties,u=t.eventProperties;u&&u.formid&&(n=u.formid);var h=t.eventType;h&&(e.$event_type=h),a||(n&&(e.tags=[t.eventName+":"+n]),"Feedback Submitted"===s?(r=u.respid,e.tags=[t.eventName+":"+n+"-"+r]):"FeedbackSubmitted"===s&&(e.tags=[s+":"+n+"-"+r],e.payloads=_.extend(o,e.payloads)),c&&(e.$event_type="IDENTIFY_USER",e.identity=c),l&&(e.$event_type="ADD_USER_PROPERTY",e.payloads=l),i&&(e.payloads=u))}return e}},{key:"assembleBehaviorEvent",value:function(e,t){if(!(e=this.generateLastVisitTime(e)))return null;var i,n,r=t&&t.eventType===constants.events.CUSTOM_EVENT,s=(e=this.assemblePayloads(e,t,r)).$event_type;"mousedown"===s&&(s="click");var a=window.performance||window.mozPerformance||window.msPerformance||window.webkitPerformance;"pageview"===e.$event_type||"feedback"===e.$event_type||r?(i=document.title,n=decodeURIComponent(e.$current_url),s="URL"):"IDENTIFY_USER"===e.$event_type?(i=e.userId,n=e.identity):"ADD_USER_PROPERTY"===e.$event_type?i=e.userId:n=r?(i=t.eventName,t.eventName):(i=s,e.elText);var o={userId:e.userId,name:i,content:n,source:{elements:e.$elements},payload:{}},c=brUtils.locationInfo();if(o.source=_.extend({},o.source,c),"pageview"===e.$event_type){var l=1;a&&a.timing&&a.timing.requestStart&&a.timing.responseEnd&&(l=a.timing.responseEnd-a.timing.requestStart),o.generationTime=Math.max(1,l)}if(e.ps&&(o.ps=e.ps,o.v=e.elText),r&&t.eventProperties&&(o.payload=_.extend(o.payload,e.payloads)),"pageview"===e.$event_type&&(o=_.extend(o,this.getUTMParameter())),_.inArray(e.$event_type,["click","pageview"])&&AurycSP.isEnabled()){var u=e.$event_type.toUpperCase(),h=_.extend({libraryName:"Web",type:u},o),g=AurycSP.getMatchedEventGroups(h);g&&g.forEach(function(e){var t=AurycSP.collect(e);o.payload=_.extend(t,o.payload)})}return o}},{key:"getUTMParameter",value:function(){var e={us:"utm_source",um:"utm_medium",uc:"utm_campaign",ut:"utm_term",un:"utm_content"},t=brUtils.campaignParams(),i={};for(var n in e){var r=e[n];t[r]&&(i[n]=t[r])}return i}},{key:"getEventCommonProperties",value:function(e,t,i){var n={currentTime:_.now()};if(t===constants.events.PAGEVIEWTRACKER){var r=globalSessionTracker.getPVStartTS();n.startTS=parseInt(r),n=_.extend(n,i)}return t===constants.events.CLICKTRACKER&&(n.elText=this.getClickTargetText(e),n.ps=this.calcMouseCoord(e,i)),n}},{key:"getClickTargetText",value:function(e){var t=e.target||e.srcElement||e.originalTarget,i="";if(!t)return i;try{var n=dom.isPIINode(t);"password"===t.type?i='input[type="password"]':"select"===t.nodeName.toLowerCase()?i=t.name:"img"===t.nodeName.toLowerCase()?i=t.alt:"body"===t.nodeName.toLowerCase()&&(i="body"),i||n||(t.getAttribute&&t.getAttribute("data-text")&&!n&&(i=t.getAttribute("data-text")),i=i||t.value||t.textContent||t.innerText);i&&(i=i.substring(0,60)),0===(i=i.replace(/^\s+|\s+$/g,"")).length&&(i=t.nodeName||t.name)&&(i=i.toLowerCase(),t.type&&(i+='[type="'+t.type.toLowerCase()+'"]')),n&&(i+=" - Sensitive Information"),i=i.replace(/^\s+|\s+$/g,""),logger.log("elText: "+i)}catch(e){logger.warn("Exception in getTargetText"),logger.warn(e),i=""}return i}},{key:"calcMouseCoord",value:function(e,t){if(t&&t.position)return t.position;var i={x:e.clientX,y:e.clientY},n=brUtils.getScroll(window);this.previousEventPos=i;var r={};if(r.x=e.clientX+n.x,r.y=e.clientY+n.y,this.inIframe()){var s=dom.getPosInTopFrame(window.frameElement,dom.getTopLevelWin(window.frameElement));return r.x=r.x+s.x-n.x,r.y=r.y+s.y-n.y,r}return r}},{key:"inIframe",value:function(){try{return window!==window.top}catch(e){return!0}}},{key:"getEvent",value:function(e,t,i,n){n=this.getEventCommonProperties(e,t,i);var r=this.getTrackingTarget(e),s=_.extend({},n,r),a=this.assembleBehaviorEvent(s,i);return a?(a.basicProps=n,a):null}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),RcInputMonitor=function(){function s(e,t){classCallCheck(this,s),this.eventWriter=EventWriter.getInstance(),this.iNode=t,this.rcProcessor=e,this.cursorTracker=null;var i=this.isInputSupported(t),n=this.isRadioCbox(t);i&&(this.previousIptVal=t.getAttribute("value")||t.value||"");var r=this.getInputType(t);(i&&t.value||"checkbox"===r&&t.checked||"select-one"===r)&&this.initProcess(r,t),this.trackInputEvents(r,i,n,t,e)}return createClass(s,[{key:"getInputType",value:function(e){var t=((e=e||this.iNode).getAttribute("type")||e.type||"text").toLowerCase();return"select"!==e.nodeName.toLowerCase()&&"textarea"!==e.nodeName.toLowerCase()||(t=e.nodeName.toLowerCase()),t}}],[{key:"getNewInstance",value:function(e,t){return t._arIM||(t._arIM=new s(e,t)),t._arIM}}]),createClass(s,[{key:"trackInputEvents",value:function(t,e,i,n,r){var s=this;e&&(_.addEventListener(n,"focus",function(){return s.iptReceivedFocus(n)}),_.addEventListener(n,"blur",function(){return s.iptLostFocus()}),_.addEventListener(n,"keydown",function(){return s.processKeyStroke(n,t)})),(i||"select"===t)&&[r.getWinObj(),n].forEach(function(e){return _.addEventListener(e,"click",function(){return s.elemCheckValChanged(n,t)})}),i||_.addEventListener(n,"change",function(){return s.elemSelectedValChanged(n,t)})}},{key:"iptReceivedFocus",value:function(e){var t=this;this.updateCursorData(e),this.cursorTracker=setInterval(function(){t.updateCursorData(e)},constants.record.throttler.CURSOR_INFO_INTERVAL)}},{key:"iptLostFocus",value:function(){this.cursorTracker&&clearInterval(this.cursorTracker)}},{key:"elemCheckValChanged",value:function(e,t){if(this.previousSelected!==e.checked){this.previousSelected=e.checked;var i={jNodeName:this.getNodeName(e),aCheckValue:e.checked,wNodePath:this.eventWriter.updateNodeDict(globalCacheObj.getNodeXPath(e)),comp:1,sInputType:t};this.eventWriter.append(EventType.InputValChangedT(),i,this.rcProcessor)}}},{key:"elemSelectedValChanged",value:function(e,t){this.previousElInnerText!==e.innerHTML&&(this.processCurrElem(),this.previousElInnerText=e.innerHTML);var i={jNodeName:this.getNodeName(e),"rSelected:hIndex":e.selectedIndex,wNodePath:this.eventWriter.updateNodeDict(globalCacheObj.getNodeXPath(e)),comp:1,sInputType:t};this.eventWriter.append(EventType.InputValChangedT(),i,this.rcProcessor),this.previousIptVal=e.value}},{key:"processKeyStroke",value:function(t,i){var n=this;setTimeout(function(){if(n.updateCursorData(),n.processCurrElem(),n.previousIptVal=t.value,t.value&&0<t.value.length){var e={"rSelected:jKey":1,"oScroll:rPos":{x:n.iNode.scrollTop,y:n.iNode.scrollLeft},wNodePath:n.eventWriter.updateNodeDict(globalCacheObj.getNodeXPath(t)),uValue:t.value,comp:1,sInputType:i};n.eventWriter.append(EventType.KeyStrokeDownT(),e,n.rcProcessor)}},1)}},{key:"hasChanged",value:function(){return this.isInputSupported()?this.previousIptVal!==this.iNode.value:!!this.isRadioCbox()&&this.previousSelected!==this.iNode.checked}},{key:"isSecret",value:function(e){return e||(e=this.iNode),dom.isPIINode(e)}},{key:"isRadioCbox",value:function(e){var t=(e=e||this.iNode).getAttribute("type")?e.getAttribute("type").toLowerCase():"text";return"radio"===t||"checkbox"===t}},{key:"isInputSupported",value:function(e){return"textarea"===(e=e||this.iNode).nodeName||_.inArray(this.getInputType(e),["","color","email","number","password","search","tel","text","textarea","url"])}},{key:"isSubmitInput",value:function(){return"submit"===(this.iNode.getAttribute("type")?this.iNode.getAttribute("type").toLowerCase():"text")}},{key:"initProcess",value:function(e,t){"hidden"!==e&&"password"!==e&&("text"!==e&&"textarea"!==t.nodeName||""!==t.value)&&(this.isRadioCbox(t)&&!0!==t.checked?this.previousSelected=!1:this.createInputEvent(e))}},{key:"getNodeName",value:function(e){if(!e)return"";var t="";return e.labels&&0<e.labels.length&&(t=e.labels[0].textContent||e.labels[0].innerText),t||!e.getAttribute("data-text")||this.isSecret(e)||(t=e.getAttribute("data-text")),t||(t=e.name||e.nodeName)&&(t=t.toLowerCase(),e.type&&(t+='[type="'+e.type.toLowerCase()+'"]')),t}},{key:"processCurrElem",value:function(){"hidden"!==this.getInputType()&&"password"!==this.getInputType()&&this.createInputEvent(this.getInputType())}},{key:"getCursorPosition",value:function(e){e=e||this.iNode;var t={rFirst:0,dLast:0};try{t.rFirst=e.selectionStart||0,t.dLast=e.selectionEnd||0}catch(e){}return t.bCurrent=t.dLast,t.comp=1,t}},{key:"updateCursorData",value:function(e){e=e||this.iNode;var t=this.getCursorPosition(e),i=!1;if(this.previousCursorPos||(i=!0),i||this.previousCursorPos.rFirst!==t.rFirst||this.previousCursorPos.dLast!==t.dLast){var n={zNodeName:this.getNodeName(e),"bCursor:hIndex":config.compress(t),comp:1,wNodePath:this.eventWriter.updateNodeDict(globalCacheObj.getNodeXPath(e))};this.eventWriter.append(EventType.InputPosT(),n,this.rcProcessor)}this.previousCursorPos=t}},{key:"_createRadioCB",value:function(e){var t=this.iNode.checked;t&&(e.aSelected=t,this.eventWriter.append(EventType.FormInputT(),e,this.rcProcessor),this.previousSelected=t)}},{key:"_createTextArea",value:function(e){e.uValue=this.iNode.value||"",e["rWidth:yHeight"]={w:parseInt(dom.getStyle(this.iNode,this.rcProcessor.getWinObj(),"width")),h:parseInt(dom.getStyle(this.iNode,this.rcProcessor.getWinObj(),"height"))},this.eventWriter.append(EventType.FormInputT(),e,this.rcProcessor)}},{key:"_createSelect",value:function(e){var t=[];Array.apply(null,this.iNode.options).forEach(function(e){t.push({uVal:e.value,jKey:e.text,comp:1})}),e["rWidth:yHeight"]={w:this.iNode.offsetWidth,h:this.iNode.offsetHeight},e["rSelected:hIndex"]=this.iNode.options.selectedIndex,e.nOptions=t.map(function(e){return config.compress(e)}),this.previousElInnerText=this.iNode.innerHTML,this.eventWriter.append(EventType.FormInputT(),e,this.rcProcessor)}},{key:"createInputEvent",value:function(e){var t={jNodeName:this.getNodeName(this.iNode),sInputType:e,wNodePath:this.eventWriter.updateNodeDict(globalCacheObj.getNodeXPath(this.iNode)),uValue:"",comp:1};switch(e){case"radio":case"checkbox":this._createRadioCB(t);break;case"textarea":this._createTextArea(t);break;case"select":this._createSelect(t);break;default:t.uValue="password"!==e&&this.iNode.value||"",this.eventWriter.append(EventType.FormInputT(),t,this.rcProcessor)}}}]),s}(),PIIHandler=function(){function e(){classCallCheck(this,e),this.piiMarkerStart="arMaskedContentStart",this.piiMarkerEnd="arMaskedContentEnd",this.piiMarkerPrefix="arMaskedContent",this.maskClassName=constants.pii.maskingClassName,this.defaultMaskCSSSelectors="."+constants.pii.maskingClassName,this.maskedAttributes=constants.pii.maskingAttributes,this.maskElementWithStyle=["input","textarea"],this.parseConfig()}return createClass(e,[{key:"parseConfig",value:function(){this.rules=config.getBaseBlockedEls(),this.rules||(this.rules={}),this.rules[".*"]?this.rules[".*"]+=","+this.defaultMaskCSSSelectors:this.rules[".*"]=this.defaultMaskCSSSelectors,!1===config.getConfig("keepInputs","record")&&(this.rules[".*"]+=", input[type=text], input[type=email],input[type=password],input[type=tel],textarea,input[type=date],input[type=datetime-local],input[type=week],input[type=email],input[type=number],input[type=search]")}},{key:"tag",value:function(){var e=this.getPIISelectors();0<e.length&&this.tagStatic(e)}},{key:"hasClass",value:function(e,t){return e.classList?e.classList.contains(t):!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}},{key:"addCssCls",value:function(e,t){e.classList?e.classList.add(t):this.hasClass(e,t)||(e.className+=" "+t)}},{key:"getPIISelectors",value:function(){var e=[];if(0===Object.keys(this.rules).length)return e;var t=window.location.href||"";for(var i in this.rules){new RegExp(i,"i").test(t)&&e.push(this.rules[i])}return e}},{key:"removeClass",value:function(e,t){if(e.classList)e.classList.remove(t);else if(this.hasClass(e,t)){var i=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(i," ")}}},{key:"isTagged",value:function(e){var t=e.parentNode;if(!t)return!1;for(var i=0;i<t.childNodes.length;i++){var n=t.childNodes[i];if(0<i&&n===t.childNodes[i]){var r=t.childNodes[i-1];if(r.data&&-1<r.data.indexOf(this.piiMarkerPrefix))return!0}}return!1}},{key:"isTaggedDynamic",value:function(e){return!(!e.nextSibling||8!==e.nextSibling.nodeType)&&(e.nextSibling.data&&-1<e.nextSibling.data.indexOf(this.piiMarkerEnd))}},{key:"maskAttribute",value:function(t){if(t&&(this.maskedAttributes.forEach(function(e){t.getAttribute(e)&&t.setAttribute(e,"")}),t.attributes))for(var e=0;e<t.attributes.length;e++){var i=t.attributes[e].name;i&&/data-*/.test(i)&&t.setAttribute(i,"")}}},{key:"updateBoundingRect",value:function(e){var t=this.getPIISelectors();if(0===t.length)return!1;for(var i=e.querySelectorAll(t.join(",")),n=0;n<i.length;n++){var r=i[n];if("input"!==r.tagName.toLowerCase()){var s=this.getBoundingRect(r);this.addMaskAttribute(r,s)}}}},{key:"tagStatic",value:function(e){var s=this,t=window.document.querySelectorAll(e.join(","));[].forEach.call(t,function(e,t){for(var i=e.querySelectorAll("input[type=text], textarea"),n=i.length-1;0<=n;n--){var r=i[n];s.addCssCls(r,s.maskClassName)}})}},{key:"tagDynamic",value:function(e){var t=this.getPIISelectors();if(0===t.length)return"false";for(var i=document.querySelectorAll(t.join(",")),n=0;n<i.length;n++){var r=i[n];if(PIIUtils.containedBy(e,r)||r===e)return"skip";if(PIIUtils.containedBy(r,e))return"true"}return"false"}},{key:"processPII",value:function(e,t){var i=e,n=null;return t?n=new RegExp(".+","mig"):0<=e.indexOf(this.piiMarkerStart)&&(n=new RegExp("\x3c!--(\\W)*"+this.piiMarkerStart+"[\\w\\W]*?"+this.piiMarkerEnd+"(\\W)*--\x3e","mig")),n&&(i=PIIUtils.replaceWithMask(e,n)),i}},{key:"removeComments",value:function(e){var t=this;if(/<!--/gim.test(e)){var i=new RegExp("(\x3c!--)[\\w\\W]*?(--\x3e)","mig");return PIIUtils.replaceWithMask(e,i,function(e){return e[0].indexOf("arHiddenBlock")<0&&e[0].indexOf(t.piiMarkerPrefix)<0?"":e[0]})}return e}},{key:"removeJS",value:function(e){if(!e)return"";if(e.indexOf("script")<0)return e;for(var t=RegExp("(<script[^>]*?>)[\\s\\S]*?(<\/script>)","gim"),i="",n=e.length,r=0,s=t.exec(e);_.isDefined(s);){var a=s.index,o=s[0],c=s[1].replace("src=","au_src="),l=s[2];i=(i+=e.substring(r,a))+c+l,r=a+o.length,s=t.exec(e)}return i+=e.substring(r,n)}},{key:"addMaskAttribute",value:function(e,t){e.setAttribute(this.maskClassName,t)}},{key:"cloneAttributes",value:function(e,t){for(var i=void 0,n=Array.prototype.slice.call(t.attributes);i=n.pop();)if(!_.inArray(i.nodeName,this.maskedAttributes)&&!/data-*/.test(i.nodeName))try{e.setAttribute(i.nodeName,i.nodeValue)}catch(e){}}},{key:"processHiddenElement",value:function(e,t){for(var i=e.querySelectorAll('input[type="hidden"]'),n=0;n<i.length;n++){var r=i[n],s=r.tagName,a=document.createElement(s);this.cloneAttributes(a,r),r.parentNode.insertBefore(a,r),r.parentNode.removeChild(r)}}},{key:"processMaskElement",value:function(e,t){var i=this.getPIISelectors();if(0!==i.length){for(var n=t.querySelectorAll(i.join(",")),r=0;r<n.length;r++){var s=n[r],a=this.getBoundingRect(s);this.addMaskAttribute(s,a),this.addCssCls(s,this.maskClassName)}for(var o=e.querySelectorAll(i.join(",")),c=0;c<o.length;c++){var l=o[c],u=l.tagName,h=document.createElement(u);n[c].getAttribute(this.maskClassName)&&h.setAttribute(this.maskClassName,n[c].getAttribute(this.maskClassName)),this.cloneAttributes(h,l),this.addCssCls(h,this.maskClassName),l.parentNode.insertBefore(h,l),l.parentNode.removeChild(l)}}}},{key:"processAttribute",value:function(e,t){if(constants.pii.ignoreAttributes&&0!==constants.pii.ignoreAttributes.length){var i=constants.pii.ignoreAttributes.map(function(e){return"["+e+"]"}).join(",");e.querySelectorAll(i).forEach(function(t){try{constants.pii.ignoreAttributes.forEach(function(e){return t.removeAttribute(e)})}catch(e){}})}}},{key:"isAttributeProcessRequired",value:function(e){if(!constants.pii.ignoreAttributes||0===constants.pii.ignoreAttributes.length)return!1;var t=constants.pii.ignoreAttributes.map(function(e){return"["+e+"]"}).join(","),i=e.querySelectorAll(t);return i&&0<i.length}},{key:"getBoundingRect",value:function(e){var t=getComputedStyle(e,!1),i=null;if(t){i="width:"+t.width+";height:"+t.height+";margin:"+t.margin+";position:"+t.position+";display:"+t.display+";"}else{var n=e.getBoundingClientRect();i="width:"+Math.floor(n.width)+"px;height:"+Math.floor(n.height)+"px;"}return i}}]),e}(),PIIUtils=function(){function a(){classCallCheck(this,a)}return createClass(a,null,[{key:"replaceWithMask",value:function(e,t,i){var n=t.exec(e),r="",s=0;for(i=i||a.maskStr;_.isDefined(n);){r+=e.substring(s,n.index),r+=i(n),s=n.index+n[0].length,n=t.exec(e)}return r+=e.substring(s,e.length)}},{key:"maskStr",value:function(e){var t=e instanceof Array?e[0]:e||"";if(0<t.length){return t.replace(/(>)|(&[^\s;]*;)|(<[^<>]*?>)|(<)|\w/g,function(e,t,i,n){return i||n||"*"}).replace(/&((?!nbsp| |amp).)*?;/g,"*")}return""}},{key:"containedBy",value:function(e,t){return t.contains?e!==t&&t.contains(e):!!(16&t.compareDocumentPosition(e))}}]),a}(),globalPIIHandler=null;function getPIIHandler(){return globalPIIHandler||(globalPIIHandler=new PIIHandler),globalPIIHandler}var StyledComponent=function(){function e(){classCallCheck(this,e)}return createClass(e,[{key:"getInnerRule",value:function(e){var t=e.querySelectorAll("style[data-styled-components]")[0];if(!t||0!==t.innerHTML.length&&t._arB||!t.sheet)return"";t._arB=!0;for(var i=t.sheet.cssRules||t.sheet.rules,n="",r=0;r<i.length;r++)n+=i[r].cssText;return n}},{key:"process",value:function(e,t){var i=this.getInnerRule(t),n=e.querySelectorAll("style[data-styled-components]")[0];n&&(n.innerHTML=i)}}]),e}(),styledComponentHandler=null;function getStyledComponentHandler(){return styledComponentHandler||(styledComponentHandler=new StyledComponent),styledComponentHandler}var DomSerialize=function(){function e(){classCallCheck(this,e)}return createClass(e,[{key:"serialize",value:function(e,t){this.doc=e.document;var i=null;try{i=this.doc.querySelectorAll("html")[0].cloneNode(!0),getPIIHandler().processMaskElement(i,this.doc),getPIIHandler().processHiddenElement(i,this.doc),getPIIHandler().processAttribute(i,this.doc),getStyledComponentHandler().process(i,this.doc),getLinkIdHandler().process()}catch(e){logger.log("serialize error: ",e),i=this.doc.querySelectorAll("html")[0]}return this.handleDomHTML(this._getDocTag()+i.outerHTML,t)}},{key:"handleDomHTML",value:function(e,t){e||(e=""),e=getPIIHandler().removeComments(e),e=getPIIHandler().removeJS(e);var i=globalDataCache.getObject(e,t,"kl");return i.id?i:null}},{key:"getDocType",value:function(){return this._getDocTag()}},{key:"_getDocTag",value:function(){var e="<!DOCTYPE html>";try{window.XMLSerializer&&(e=(new XMLSerializer).serializeToString(window.document.doctype),logger.log("doctype:"+e))}catch(e){}return e}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();function getUrlObject(e){var t=document.createElement("a");return t.href=e,t}var MAX_VALUE_LENGTH=1024,attributeMap={message:"message",fileLocation:"fileLocation",fileRelativeLocation:"fileRelativeLocation",lineNo:"lineno",columnNo:"colno"},lastTrackedError={};function handleJSError(i,e){var n={};if(!i)return n;var r=void 0;return e.attribute.forEach(function(e){var t=attributeMap[e.value];t&&(r=getJSErrorAttribute(t,i)),r&&(n[e.name]=r)}),n=checkAndSetData(n)}function checkAndSetData(e){for(var t=Object.keys(e),i=0;i<t.length;i++){var n=t[i];if(e[n]&&0<e[n].indexOf("auryc.lib"))return null;if(e[n]!==lastTrackedError[n])return lastTrackedError=e}return null}function getJSErrorAttribute(e,t){return"message"===e?trimLength((t.error?t.error.message:t.message)||""):"fileLocation"===e?getFileLocation(t):"fileRelativeLocation"===e?getFileRelativeLocation(t):"lineno"===e||"colno"===e?""+t[e]:void 0}function getFileLocation(e){var t=(e.filename||"<Unknown>")+":"+e.lineno+":"+e.colno;if(t.length>MAX_VALUE_LENGTH){var i=t.length-MAX_VALUE_LENGTH;t=t.subStr(i)}return t}function getFileRelativeLocation(e){var t=(getUrlObject(e.filename).pathname||"<Unknown>")+":"+e.lineno+":"+e.colno;if(t.length>MAX_VALUE_LENGTH){var i=t.length-MAX_VALUE_LENGTH;t=t.subStr(i)}return t}function trimLength(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:MAX_VALUE_LENGTH;return(e||"").substr(t,i)}function getRegEx(e){return e instanceof Array||(e=[e]),new RegExp(e[0])}function getObjectProperty(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"";return e&&t?"location"===e?getLocationPropertyValue(t)||i:"localStorage"===e||"sessionStorage"===e?getStoragePropertyValue(e,t)||i:"cookie"===e?getCookieValue(t)||i:"variable"===e?_.get(window,t,i):_.get(window[e],t,i):i}function getLocationPropertyValue(e){var t=e.split("."),i=t[0];return"search"===i?2===t.length?brUtils.getQueryParam(window.location.search||"",t[1]):window.location.search:"hash"===i?2===t.length?brUtils.getHashParam(window.location.hash||"",t[1]):window.location.hash:window.location[i]}function getCookieValue(e){if(_.isString(e))return Cookie.Get(e);if(_.isArray(e)){if(1===e.length)return Cookie.Get(e[0]);var t=Cookie.Parse(e[0]);return _.get(t,e.slice(1))}return null}function getStoragePropertyValue(e,t){if(_.isString(t)&&(t=[t]),!_.isArray(t)||0===t.length)return null;var i=t[0],n=window[e][i];if(n&&(n=decodeURIComponent(n)),1===t.length)return n;try{var r=JSON.parse(n);return _.get(r,t.slice(1))}catch(e){return null}}var propertyHandlerMap={aurycJSErrorHanlder:handleJSError};function getPropertyHandler(e){var t=void 0;return e&&(t="function"==typeof e?e:propertyHandlerMap[e]),t=t||defaultPropertyHandler}function defaultPropertyHandler(e,i){var t=void 0,n=void 0,r={};if(i.attribute)if(i.attribute instanceof Array)_.each(i.attribute,function(e){var t=selectValue(n=e.value);1===t.length?r[e.name]=t[0]:("userProperty"!==i.dataType&&"sessionProperty"!==i.dataType||(t="currency"===n.type||"number"===n.type?t.reduce(function(e,t){return e+t},0):t.join(",")),r[e.name]=t)});else{var s=selectValue(n=i,!1);0<s.length&&(t=s[0])}else t=!0;return t&&(r[i.name||"_default_"]=t),r}function selectValue(r){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],s=[],i=getBlcokedElements(),t=[].concat(toConsumableArray(document.querySelectorAll(r.cssSelector))).filter(function(t){return!i.some(function(e){return e.contains(t)})});return t.length&&(e||(t=[t[0]]),t.forEach(function(e,t){if(!1===r.visible||e.offsetParent){var i=e[r.attribute]||e.getAttribute(r.attribute);if("string"==typeof i&&(i=i.trim())&&r.pattern){var n=getRegEx(r.pattern);"currency"===r.type&&(i=i.replace(",","")),i=(i.match(n)||[])[0]}"currency"===r.type||"number"===r.type?(i?i*=1:i=0,acceptValue(i,r)&&s.push(i)):i&&acceptValue(i,r)&&s.push(i)}})),s}function acceptValue(e,t){if(!t.ignore)return!0;var i=t.ignore;if(void 0!==i.value&&i.value===e)return!1;if(void 0!==i.pattern){var n=getRegEx(i.pattern);if(e.match(n))return!1}return!0}function getBlcokedElements(){var e=config.getBaseBlockedEls();return e&&e[".*"]?[].concat(toConsumableArray(document.querySelectorAll(e[".*"]))):[]}function sendCustomData(s,a){var e="string"==typeof s.dataType?[s.dataType]:s.dataType,o=function(e){window.aurycBehaviorAPI.track(e.name,e.attributes||{})};_.each(e,function(e){var t=void 0,i=void 0;if("userProperty"===e)t=window.aurycBehaviorAPI.addUserProperties,0<Object.keys(a).length&&(i=a);else if("sessionProperty"===e)t=window.aurycBehaviorAPI.addSessionProperties,0<Object.keys(a).length&&(i=a);else if("identity"===e)t=window.aurycBehaviorAPI.identify,i=a[s.name||"_default_"];else if("customEvent"===e){t=o;var n={},r={};_.each(Object.keys(a),function(e){a[e]instanceof Array?n[e]=a[e]:r[e]=a[e]}),i=[],0<Object.keys(r).length&&i.push({name:s.name,attributes:r}),_.each(Object.keys(n),function(t){var e=n[t];_.each(e,function(e){i.push({name:s.name,attributes:defineProperty$2({},t,e)})})}),i.length||(i=null)}t&&i&&(i instanceof Array?_.each(i,function(e){_setDataValue(t,e)}):_setDataValue(t,i))})}var attempts=0;function _setDataValue(e,t){window.auryc&&e?e.call(window.aurycBehaviorAPI,t):window.aurycReadyCb?window.aurycReadyCb.push(function(){window.auryc&&e&&e.call(window.aurycBehaviorAPI,t)}):attempts++<=5&&window.setTimeout(function(){_setDataValue(e,t)},2e3)}function handleObjectProperty(e,n){var r={};return n&&n.attribute&&n.object&&(!n.attribute instanceof Array&&(n.attribute=[n.attribute]),_.each(n.attribute,function(e){var t=e.value,i=selectValue$1(n.object,t,e.name);(i||0===i)&&(r[e.name]=i)})),r}function selectValue$1(e,t){var i=void 0,n="";if(_.isString(t)||_.isArray(t))i=t;else{if(!_.isObject(t)||!t.attribute)return"";i=t.attribute}try{n=(getObjectProperty(e,i)+"").trim()}catch(e){return""}if(!n)return"";if(!_.isObject(t))return n;if(t.pattern){var r=getRegEx(t.pattern);"currency"===t.type&&(n=n.replace(",","")),n=(n.match(r)||[])[0]}return"currency"!==t.type&&"number"!==t.type||(n?n*=1:n=0),n}function processCustomDataRule(n,e){var t=e.properties;_.each(t,function(e){if(e.object){var t=handleObjectProperty(n,e);null!==t&&sendCustomData(e,t)}else{var i=getPropertyHandler(e.handler)(n,e);null!==i&&sendCustomData(e,i)}})}function getEventHandler(t,i){var n=arguments;return 0<=i.timeout?function(e){setTimeout(function(){return processCustomDataRule(n,t)},i.timeout)}:(t.eventHandler||(t.eventHandler=function(e){processCustomDataRule(e,t)}),t.eventHandler)}function setupCutomDataCollection(){var e=getConfig$1();e&&collectCustomData(e)}function collectCustomData(e,t,i){_.each(e,function(e){!contextMatch(e.context)||t&&!e.dynamic||_processCustomDataRules(e)})}function _processCustomDataRules(r){var e=r.triggers;e?_.each(e,function(t){if(t.event){var e=[];if(t.object&&window[t.object])e.push(window[t.object]);else if(t.cssSelector){var i=document.querySelectorAll(t.cssSelector);if(!i.length)return void(r.dynamic=!0);e=[].slice.call(i)}var n=getEventHandler(r,t);_.each(e,function(e){e.addEventListener(t.event,n)})}}):processCustomDataRule(null,r)}function getConfig$1(){return config.getConfig("userProperties","behavior")}function contextMatch(e){if(!e)return!0;var t=e.url,i=e.cssSelector,n=objectWithoutProperties(e,["url","cssSelector"]);if(!t&&!i)return!0;if(t&&window.location.href.toLowerCase().indexOf(t.toLowerCase())<0)return!1;if(i){var r=void 0;try{if(!(r=document.querySelectorAll(i)).length)return!1}catch(e){return!1}var s=r[0];if(n)for(var a=Object.keys(n),o=0;o<a.length;o++){var c=a[o];if(!s[c]||n[c]&&s[c].indexOf(n[c])<0)return!1}}return!0}var userProperty={setupCutomDataCollection:setupCutomDataCollection,collectCustomData:collectCustomData},RcDomChangeMonitor=function(){function t(e){classCallCheck(this,t),this.processor=e,this.customDataDefs=[],this.eventWriter=EventWriter.getInstance(),this.setupCustomConfig(),this.isMutationBlackList()?logger.log("NOT set up mutations"):this.registerMutationEvents(this.processor),this.mutNodeIdx=0,this.blocked=!1,this.mutsToProcess={},this.duplicateStyle={}}return createClass(t,[{key:"delayedProcess",value:function(e,t,i,n,r){var s=this;if(e.nodeType!==Node.ELEMENT_NODE&&(e=e.parentNode),("style"===i||"class"===i)&&r)if(this.duplicateStyle[r]&&_.isArray(this.duplicateStyle[r])){if(_.inArray(n,this.duplicateStyle[r]))return;this.duplicateStyle[r].push(n)}else this.duplicateStyle[r]=[];e._arMutProp||(e._arMutProp="_"+this.mutNodeIdx++),this.mutsToProcess[e._arMutProp+(i?i.toLowerCase():"")]={delayedFn:t,node:e},this.blocked||(this.blocked=!0,setTimeout(function(){for(var e in s.mutsToProcess){var t=s.mutsToProcess[e];t.delayedFn.call(s,t.node),delete e._arMutProp}s.mutsToProcess={},s.duplicateStyle={},s.blocked=!1},constants.record.throttler.DOM_MUT_DELAY))}},{key:"isMutationBlackList",value:function(){var e=getInstance(),t=config.getConfig("perf_blacklist","record")||{},i=t.urls||[],n=(t.browser_cutoff||{})[e.browser.name];if(n&&e.browser.version<n)for(var r=0;r<i.length;r++)if(-1!==window.location.href.indexOf(i[r]))return!0;return!1}},{key:"isProcessingAttr",value:function(e,t,i,n){return!(!e||!t)&&(i!==n&&(("style"!==t||!n||-1===n.indexOf("display: none")||!i||-1===i.indexOf("display: none"))&&(!(-1<t.indexOf("data-")||-1<t.indexOf("aria-"))&&("tabindex"!==t&&(!(2<=t.length&&"on"===t.substr(0,2))&&(("value"!==t||!dom.isPIINode(e))&&(!_.inArray(t,constants.record.mutatationConfig.ignoreAttrList)&&(!_.inArray((e.nodeName||"").toLowerCase(),constants.record.mutatationConfig.ignoreNodeContentsList)&&(("value"!==t||e.nodeType!==Node.ELEMENT_NODE||"input"!==e.nodeName.toLowerCase()||"hidden"!==e.type)&&("id"!==t||null!==n))))))))))}},{key:"processAttrMutEvent",value:function(e,t){var i=this,n=e.target.getAttribute(e.attributeName),r=e.oldValue,s=e.attributeName,a=e.target;if(this.isProcessingAttr(a,s,r,n)){var o={};o.k=s,o.v=n;var c=this.eventWriter.updateNodeDict(globalCacheObj.getNodeXPath(a,s));o.x=c;this.delayedProcess(a,function(){if("class"!==s&&"style"!==s||getPIIHandler().updateBoundingRect(a),"style"===s){var e=a.style||a.getAttribute("style");e&&(o.v=_.isDefined(e.cssText)?e.cssText:"")}else"disabled"===s&&(o.v=""===n);i.eventWriter.append(EventType.PropChangeT(),o,t),"src"===s&&a.tagName&&"iframe"===a.tagName.toLowerCase()&&a.parentNode&&a.parentNode.nodeType===Node.ELEMENT_NODE&&(a._arB=!1,i.processor.notifyDomUpdated(a.parentNode))},s,n,c)}}},{key:"registerMutationEvents",value:function(t){var i=this;this.mutProcessor=new MutationObserver(function(e){e.forEach(function(e){"attributes"===e.type?i.processAttrMutEvent(e,t):"childList"===e.type?i.handleChildCharMut({target:e.target},t):"characterData"===e.type&&e.target.nodeType===Node.TEXT_NODE&&i.handleChildCharMut({target:e.target},t)})}),this.mutProcessor.observe(t.getDocObj(),{attributes:!0,attributeOldValue:!0,childList:!0,subtree:!0,characterData:!0})}},{key:"setupCustomConfig",value:function(){config.getConfig("userProperties","behavior")&&(this.customDataDefs=config.getConfig("userProperties","behavior"))}},{key:"handleChildCharMut",value:function(e,o){var c=this,l=e.target,t=l.tagName?l.tagName.toLowerCase():"";t===constants.record.tags.SELECT&&l._arIM?this.delayedProcess(l,function(){l._arIM.processCurrElem()}):l.nodeType===Node.ELEMENT_NODE&&(l.getAttribute("_ar_hide_")||_.inArray(t,constants.record.mutatationConfig.ignoreNodeContentsList))||(this.delayedProcess(l,function(){if(l){l.nodeType!==Node.ELEMENT_NODE&&(l=l.parentNode);var e=globalCacheObj.getNodeXPath(l);if(!(e[0].indexOf("html")<0)){var t=getPIIHandler().tagDynamic(l),i=void 0;getLinkIdHandler().process();var n=l.nodeName.toLowerCase();if("true"===t){var r=l.cloneNode(!0);getPIIHandler().processMaskElement(r,o.getDocObj()),getPIIHandler().processHiddenElement(r,o.getDocObj()),getPIIHandler().processAttribute(r,o.getDocObj()),i="body"===n?DomSerialize.getInstance().handleDomHTML(r.outerHTML,e):DomSerialize.getInstance().handleDomHTML(r.innerHTML,e)}else if("false"===t){var s=l;getPIIHandler().isAttributeProcessRequired(o.getDocObj())&&(s=l.cloneNode(!0),getPIIHandler().processAttribute(s,o.getDocObj())),i="body"===n?DomSerialize.getInstance().handleDomHTML(s.outerHTML,e):DomSerialize.getInstance().handleDomHTML(s.innerHTML,e)}else if("skip"===t)return;if(i){var a={};a.dom=i,a.x=c.eventWriter.updateNodeDict(e),a.v="",c.eventWriter.append(EventType.MutNodeTextT(),a,o),c.processor.notifyDomUpdated(l)}}}}),this.customDataDefs.length&&userProperty.collectCustomData(this.customDataDefs,!0,l))}}]),t}(),AjaxProxy=function(){function e(t){classCallCheck(this,e),window._orginalXhr=window._orginalXhr||XMLHttpRequest,this.config=t;var g=this;XMLHttpRequest=function(){for(var e in this.xhr=new window._orginalXhr,this.xhr){var t="";try{t=_typeof(this.xhr[e])}catch(e){console.log("e",e)}"function"===t?this[e]=g._proxy(e,this.xhr):Object.defineProperty(this,e,{get:g.getFactory(e,this.xhr),set:g.setFactory(e,this.xhr)})}},window.fetch&&(window._orginalFetch=window.fetch,window.fetch=function(e,c){var l,u,h;return null==c&&(c={headers:{}}),c.url=e,h=null,u=[t.before],l=[t.after],new Promise(function(i,t){var n,r,s,a,o;r=function(){return c.headers&&(c.headers=new Headers(c.headers)),h||(h=new Request(c.url,c)),g.mergeObjects(c,h)},s=function(e){var t;return l.length?2===(t=l.shift()).length?(t(r(),e),s(e)):3===t.length?t(r(),e,s):s(e):i(e)},n=function(e){var t;if(void 0!==e)return t=new Response(e.body||e.text,e),i(t),void s(t);a()},a=function(){var e;if(u.length)return 1===(e=u.shift()).length?n(e(c)):2===e.length?e(r(),n):void 0;o()},o=function(){return window._orginalFetch(r()).then(function(e){return s(e)}).catch(function(e){return s(e),t(e)})},a()})})}return createClass(e,[{key:"getFactory",value:function(e,t){var i=this;return function(){return i.hasOwnProperty(e+"_")?i[e+"_"]:t[e]}}},{key:"setFactory",value:function(t,i){var n=this,r=constants.ajax_proxy.readOnlyAttr;return function(e){n.config[t]?i[t]=function(){n.config[t](i),e&&e.apply(i,arguments)}:_.inArray(t,r)?n[t+"_"]=e:i[t]=e}}},{key:"_proxy",value:function(t,i){var n=this;return function(){var e=[].slice.call(arguments);if(!n.config[t]||!n.config[t].call(n,e,i))return i[t].apply(i,e)}}},{key:"depricatedProp",value:function(e){return"returnValue"===e||"totalSize"===e||"position"===e}},{key:"mergeObjects",value:function(e,t){var i;for(i in e)if(e[i],!this.depricatedProp(i))try{t[i]=e[i]}catch(e){}return t}},{key:"suspend",value:function(){window._orginalXhr&&(XMLHttpRequest=window._orginalXhr,window._orginalXhr=void 0),window._orginalFetch&&(window.fetch=window._orginalFetch,window._orginalFetch=void 0)}}]),e}(),RcEventMonitor=function(){function t(e){classCallCheck(this,t),this.processor=e,this.eventWriter=EventWriter.getInstance(),this.eventGenerator=EventGenerator.getInstance(),this.startEventMonitoring(),this.addPassiveScrollElem(),this.viewChageHandler(),this.ajaxProxyHandler(),this.trackCssDynamicChanges()}return createClass(t,[{key:"trackResize",value:function(){var e=this;_.addEventListener(this.processor.getWinObj(),"resize",_.throttle(function(){return e.getSizes},constants.record.throttler.RESIZE)),_.addEventListener(this.processor.getWinObj(),"orientationchange",function(){return setTimeout(function(){return e.getSizes},constants.record.throttler.ORIENTATION_CHANGE)})}},{key:"startEventMonitoring",value:function(){var e=this;this.inputElems=this.handleFormInputs(this.processor.getBody()),_.addEventListener(this.processor.getDocObj(),"click",function(){return e.serializeInput(e.processor,e.inputElems)}),this.hammer=null,this.pinchEventArr=[],this.mobileCapture=this.initMobileCapture(this.processor.getDocObj()),this.monitorPointingDevice(this.mobileCapture),this.trackResize(),this.trackScroll(),setTimeout(function(){return new RcDomChangeMonitor(e.processor)})}},{key:"addPassiveScrollElem",value:function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("testPassive",null,t),window.removeEventListener("testPassive",null,t)}catch(e){}var i=this,n=brUtils.isInternetExp();_.addEventListener(this.processor.getDocObj(),"scroll",_.throttle(function(e){var t=e.target||e.srcElement;t&&"#document"!==t.nodeName&&"body"!==t.nodeName&&"number"==typeof t.scrollTop&&i.eventWriter.append(EventType.SclInNodeT(),{x:i.eventWriter.updateNodeDict(globalCacheObj.getNodeXPath(t)),ps:{x:t.scrollLeft,y:t.scrollTop}},i.processor)},constants.record.throttler.SCROLL_INTERVAL),e?{capture:!0,passive:!0}:n)}},{key:"trackCssDynamicChanges",value:function(){var t=this;this.beforeHandler("insertRule",CSSStyleSheet.prototype,_.throttle(function(e){t.captureModifyRuleEvent(t.processor)},200,{leading:!1,trailing:!0})),this.beforeHandler("deleteRule",CSSStyleSheet.prototype,_.throttle(function(e){t.captureModifyRuleEvent(t.processor)},200,{leading:!1,trailing:!0}))}},{key:"captureModifyRuleEvent",value:function(e){var t=e.getDocObj(),i=getStyledComponentHandler().getInnerRule(t);if(i&&0<i.length){var n=t.querySelectorAll("style[data-styled-components]")[0],r=globalCacheObj.getNodeXPath(n),s=DomSerialize.getInstance().handleDomHTML(i,r);this.eventWriter.append(EventType.MutNodeTextT(),{x:this.eventWriter.updateNodeDict(r),v:"",dom:s},e)}}},{key:"beforeHandler",value:function(e,t,i){if(!t||"function"!=typeof t[e])return null;var n=t[e];t[e]=function(){try{i.apply(this,arguments)}catch(e){}return n.apply(this,arguments)}}},{key:"groupStatus",value:function(e){return 200<=e&&e<300?"20x":300<=e&&e<400?"30x":400<=e&&e<500?"40x":500<=e&&e<600?"50x":"others"}},{key:"groupLatencyGroup",value:function(e){if(e<500)return"<500ms";if(500<=e&&e<1e3)return"500ms - 1s";if(1e3<=e&&e<3e3)return"1s - 3s";if(e<constants.storage.MAX_LATENCY){var t=Math.floor(e/constants.storage.LATENCY_BUCKET_WIDTH),i=constants.storage.LATENCY_BUCKET_WIDTH/1e3;return t*i+"s - "+(t+1)*i+"s"}return">"+Math.floor(constants.storage.MAX_LATENCY/1e3)+"s"}},{key:"processApiCall",value:function(e){var t=e.responseURL||e._responseURL;if(t&&urls.isAjaxProxyEnabled(t)){var i={statusCode:""+e.status,url:t?t.substr(0,constants.storage.AJAX_URL_LIMIT):"",exactLatency:_.now()-e._latency,latency:this.groupLatencyGroup(_.now()-e._latency),statusCodeGroup:this.groupStatus(e.status),method:e._method||constants.ajax_proxy.type.xhr},n=urls.getLocation(t);n&&(n.domain&&(i.domain=n.domain.substr(0,constants.storage.AJAX_URL_LIMIT)),n.path&&(i.path=n.path.substr(0,constants.storage.AJAX_URL_LIMIT)),n.query&&(i.query=n.query.substr(0,constants.storage.AJAX_URL_LIMIT)),n.hash&&(i.hash=n.hash.substr(0,constants.storage.AJAX_URL_LIMIT))),e._processed=!0;var r=config.getEventSamplingRate("ajax");this.eventWriter.samplingEvent(r)&&this.eventWriter.append(EventType.CustomEventT(),{k:"api_call",v:JSON.stringify(i)})}}},{key:"ajaxProxyHandler",value:function(){var a=this;if(config.isAjaxProxyEnabled())new AjaxProxy({onreadystatechange:function(e){4===e.readyState&&a.processApiCall(e)},open:function(e,t){t._latency=_.now(),t._processed=!1,t._responseURL=e[1]},onload:function(e){(e.responseURL||e._responseURL)&&!e._processed&&a.processApiCall(e)},before:function(e){e._latency=_.now()},after:function(e,t,i){t||i(t);var n=t&&t.headers&&t.headers.get("content-type")||"",r={status:t.status,responseURL:t.url?t.url.substr(0,constants.storage.AJAX_URL_LIMIT):"",_latency:e._latency,_method:constants.ajax_proxy.type.fetch},s={status:t.status,statusText:t.statusText,ok:t.ok,headers:t.headers};if(-1!==n.indexOf("application/json"))try{t.text().then(function(e){r.responseText=e;var t=new Response(e,s);i(t),a.processApiCall(r)}).catch(function(e){i(t),a.processApiCall(r)})}catch(e){i(t),a.processApiCall(r)}else-1!==n.indexOf("application/octet-stream")||-1!==n.indexOf("application/python-pickle")||-1!==n.indexOf("image/jpeg")?t.blob().then(function(e){r.responseText="blob size: "+e.size,i(new Response(e,s)),a.processApiCall(r)}):-1!==n.indexOf("text/plain")?t.text().then(function(e){r.responseText=e,i(new Response(e,s)),a.processApiCall(r)}):(i(t),a.processApiCall(r))}})}},{key:"viewChageHandler",value:function(){var n=this,r=this.processor.getDocObj(),s=brUtils.visibilityEventPrefix(),a=_.isObject(history.state)&&history.state&&history.state.title||document.title,o=globalSessionTracker.getSessionMetadata().viewId;if(_.addEventListener(r,s+"visibilitychange",function(){if(!globalSessionTracker.getSessionMetadata().isOver){var e="hidden"===r[(""===s?"v":s+"V")+"isibilityState"],t=1,i=EventType.ViewChangeT();e&&(t=2),n.eventWriter.append(i,{k:"vc",v:{sid:o,status:t,url:location.href,title:a}},n.processor)}}),brUtils.canUseVisibilityChange())_.addEventListener(r,s+"visibilitychange",function(){"hidden"===r[(""===s?"v":s+"V")+"isibilityState"]&&(logger.log("visibility hidden. commit data",!0),n.eventWriter.syncToServerAndPersist(getInstance().isPhoneOrTablet()))});else{var e=getInstance().isPhoneOrTablet()?"unload":"beforeunload";_.addEventListener(this.processor.getWinObj(),e,function(){logger.log("befoerunload fires. commit",!0),n.eventWriter.syncToServerAndPersist(!0)})}brUtils.isSafari()&&getInstance().isPhoneOrTablet()&&_.addEventListener(this.processor.getWinObj(),"pagehide",function(){logger.log("pagehid fires.commit data",!0),n.eventWriter.syncToServerAndPersist(!1)}),_.addEventListener(this.processor.getWinObj(),"mouseout",function(e){var t=(e=e||n.eventWriter.getWinObj().event).relatedTarget||e.toElement,i=void 0;try{t&&(i=t.nodeName)}catch(e){}(!t||i&&"HTML"===i)&&n.eventWriter.syncToServerAndPersist(!0)})}},{key:"initMobileCapture",value:function(e){return this.hammer||(this.hammer=new hammer(e,{touchAction:"auto"}),this.hammer.get("pan").set({direction:hammer.DIRECTION_ALL}),this.hammer.get("pinch").set({enable:!0})),this.hammer}},{key:"getSizes",value:function(){var e=dom.getSize(this.processor.getWinObj()),t=this.processor.doc,i=dom.getDocSize(t),n={w:i.width,h:i.height},r=0;if(getInstance().isPhoneOrTablet()){var s=e;if(e=n,n=s,0!==(r=window.orientation)){if(n.w<n.h){var a=n.w;n.w=n.h,n.h=a}if(e.w<e.h){var o=e.w;e.w=e.h,e.h=o}}else if(n.w>n.h){var c=n.w;n.w=n.h,n.h=c}}return 0<n.w&&0<n.h&&0<e.w&&0<e.h&&!_.disableEvent(EventType.WindowDimT())&&this.eventWriter.append(EventType.WindowDimT(),{st:r,m:getInstance().isPhoneOrTablet(),sz:e,avs:n},this.processor,constants.record.timeOffset.WIN_SIZE),0<i.height&&0<i.width&&!_.disableEvent(EventType.HTMLDimT())&&this.eventWriter.append(EventType.HTMLDimT(),{sz:{w:i.width,h:i.height}},this.processor,constants.record.timeOffset.WIN_SIZE+10),i}},{key:"serializeInput",value:function(e,t){e&&t&&setTimeout(function(){t.forEach(function(e){e.hasChanged()&&_.isDefined(e.iNode)&&"select"!==e.iNode.nodeName.toLowerCase()&&(e.previousIptVal=e.iNode.value,e.processCurrElem())})},constants.record.throttler.SERIALIZE_INPUT_DELAY)}},{key:"getMobileType",value:function(e){switch(e){case"tap":return EventType.TapT();case"press":return EventType.PressT();case"swipe":case"pan":return EventType.SwipeT();case"pinch":return EventType.PinchT();default:return null}}},{key:"captureResize",value:function(e){var t=this.getSizes(),i={zi:{cw:window.innerWidth,ch:window.innerHeight,w:t.width,h:t.height},ps:brUtils.getScroll(e.getWinObj())};this.eventWriter.append(EventType.ResizeT(),i,e)}},{key:"captureMobileEvent",value:function(e,t){var i=brUtils.getScroll(e.getWinObj()),n={x:t.center.x,y:t.center.y},r=brUtils.getWinSize(e.getWinObj()),s=dom.getSize(e.getWinObj());if("pinchin"===t.type||"pinchout"===t.type)t.type="pinch";else if("pan"===t.type)0===n.x&&0===n.y?(n.x=dom.getPosition(t.target,e.getWinObj()).x,n.y=dom.getPosition(t.target,e.getWinObj()).y,n.x<s.w/4&&(n.x=s.w/2)):(n.x+=i.x,n.y+=i.y);else{var a=s.w/r.w,o=s.h/r.h;n.x+=i.x*a,n.y+=i.y*o}var c=this.getMobileType(t.type);if(!c)return null;if(!n||0!==n.x&&!n.x||0!==n.y&&!n.y)return null;var l="";c===EventType.PinchT()&&(this.captureResize(e),l="pinchin"===t.additionalEvent?0:1);var u=-1;t.target&&(u=this.eventWriter.updateNodeDict(globalCacheObj.getNodeXPath(t.target)));var h=this.eventGenerator.getEvent(t.srcEvent,constants.events.CLICKTRACKER);if(h){var g={ps:n,v:h.v,source:h.source,x:u};if(c===EventType.SwipeT())return g.d=t.direction,g.ag=t.angle.toFixed(2),g.s=t.distance.toFixed(2),void(_.inArray(g.d,[2,4,8,16])&&this.eventWriter.append(c,g,e));c===EventType.PinchT()&&(g.e=l,g.d=t.direction,g.ag=t.angle.toFixed(2),g.s=t.distance.toFixed(2)),logger.log("XXX. Captured tap "+g.i,!0),this.eventWriter.append(c,g,e)}}},{key:"handleMouseEvent",value:function(e,t,i){var n={};if(t&&(e.delayed||t.getTopMostFrameProc().hasMouse()||(this.eventWriter.append(EventType.MouseLeaveEntryT(),{v:1},t),t.getTopMostFrameProc().mouseEnter()),t.getTopMostFrameProc().hasMouse())){i=i||EventType.MouseMoveT();var r=-1,s=e.target||e.srcElement||e.originalTarget;if(s&&(r=this.eventWriter.updateNodeDict(globalCacheObj.getNodeXPath(s))),i===EventType.MouseClickT()||i===EventType.MouseMoveT()){var a="number"==typeof e.clientX?e.clientX:e.screenX,o="number"==typeof e.clientY?e.clientY:e.screenY,c=brUtils.getScroll(t.getWinObj());if("number"==typeof a?(n.x=a+c.x,n.y=o+c.y,this.prevPos={x:a,y:o}):this.prevPos?(n.x=this.prevPos.x||0+c.x,n.y=this.prevPos.y||0+c.y):(n.x=c.x,n.y=c.y),t.parentFrameProc){var l=t.getWinObj().frameElement,u=dom.getPosInTopFrame(l,dom.getTopLevelWin(l));n.x=a+u.x,n.y=o+u.y}var h=null;(h=i===EventType.MouseClickT()?this.eventGenerator.getEvent(e,constants.events.CLICKTRACKER,{position:n}):{ps:n})&&(h.x=r,this.eventWriter.append(i,h,t))}else this.eventWriter.append(i,{ps:this.eventGenerator.getPosition(e),x:r},t)}}},{key:"sendPinchEvent",value:function(e){var t=this.pinchEventArr.length;if(1<t){var i=this.pinchEventArr[t-2],n="";n="pinchout"===i.additionalEvent?"pinchout":"pinchin",(i=this.pinchEventArr[0]).additionalEvent=n,i.center.x+=e.x,i.center.y+=e.y,this.captureMobileEvent(this.processor,i),this.pinchEventArr=[]}}},{key:"trackMobileActions",value:function(e){var i=this;e.on("tap press",function(e){i.captureMobileEvent(i.processor,e)}),e.on("pan",_.throttle(function(e){i.captureMobileEvent(i.processor,e)},constants.record.throttler.WIN_EVENT_THROTTLE,{leading:!0,trailing:!1})),e.on("pinchstart pinchin pinchout",function(e){if("pinchstart"===e.type){var t=brUtils.getScroll(i.processor.getWinObj());i.pinchEventArr=[],setTimeout(function(){i.sendPinchEvent(t)},constants.record.throttler.WIN_EVENT_THROTTLE)}i.pinchEventArr.push(e)})}},{key:"trackDesktopActions",value:function(){var t=this;_.addEventListener(this.processor.getWinObj(),"mousemove",_.throttle(function(e){return t.handleMouseEvent(e,t.processor,EventType.MouseMoveT())},constants.record.throttler.MOUSE_MOVE_INTERVAL)),_.addEventListener(this.processor.getDocObj(),"mousedown",function(e){t.handleMouseEvent(e,t.processor,EventType.MouseClickT())})}},{key:"trackScroll",value:function(){var r=this;_.addEventListener(this.processor.getWinObj(),"scroll",_.throttle(function(e){if(r.processor.isTopMostProc())if(getInstance().isPhoneOrTablet()){var t=dom.getDocSize(r.processor.getDocObj()),i={w:t.width,h:t.height},n={zi:i=_extends({},i,{cw:window.innerWidth,ch:window.innerHeight}),ps:brUtils.getScroll(r.processor.getWinObj())};r.eventWriter.append(EventType.ResizeT(),n,r.processor)}else r.handleMouseEvent(e,r.processor,EventType.MouseMoveT()),r.eventWriter.append(EventType.SclWindowT(),{ps:brUtils.getScroll(r.processor.getWinObj())},r.processor)},constants.record.throttler.WIN_EVENT_THROTTLE))}},{key:"getRelatedTarget",value:function(e,t){return e.relatedTarget?e.relatedTarget:"to"===t?e.toElement||null:"from"===t&&e.fromElement||null}},{key:"trackMouseEnterLeave",value:function(){var n=this;this.processor.mouseEnter(),_.addEventListener(this.processor.getDocObj(),"mouseover",function(e){n.processor.hasMouse()||n.getRelatedTarget(e||n.processor.getWinObj().event,"from")||(n.eventWriter.append(EventType.MouseLeaveEntryT(),{v:1},n.processor),n.processor.mouseEnter())}),_.addEventListener(this.processor.getDocObj(),"mouseout",function(e){var t=n.getRelatedTarget(e||n.processor.getWinObj().event,"to"),i=t&&"HTML"===t.nodeName;!n.processor.hasMouse()||t&&!i||(n.eventWriter.append(EventType.MouseLeaveEntryT(),{v:0},n.processor),n.processor.mouseOut())})}},{key:"monitorPointingDevice",value:function(e){getInstance().isPhoneOrTablet()?this.trackMobileActions(e):this.trackDesktopActions(),this.processor.isTopMostProc()&&this.trackMouseEnterLeave()}},{key:"seriaCalBack",value:function(t){setTimeout(function(){for(var e=0;e<t.length;e++)t[e].processCurrElem()},1)}},{key:"handleFormInputs",value:function(e){var i=this;if(e){var t=e.querySelectorAll(constants.record.form.inputTypes);if(t&&0!==t.length)return this.inputElems=this.inputElems||[],t.forEach(function(t){dom.isPIINode(t)||(t._arIM?i.inputElems.filter(function(e){return e.iNode===t&&e.hasChanged()}).forEach(function(e){return e.processCurrElem()}):(i.inputElems.push(new RcInputMonitor(i.processor,t)),"reset"===t.getAttribute("type")&&_.addEventListener(t,"click",function(){return i.seriaCalBack(i.inputElems)})))}),this.inputElems}}}]),t}(),ReplayProcessor=function(){function n(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(classCallCheck(this,n),this.childrenProc=[],this.currWindow=e,this.myXPath=t,i)return this.parentFrameProc=i,this.myFullPath=this.myXPath.concat(this.parentFrameProc.getProcXPath()),void this.initCapture();this.myFullPath=this.myXPath,this.parentFrameProc=null,this.eventWriter=EventWriter.getInstance(),this.initEventHandling(),globalDataCache.clearCache(),this.mIn=!1}return createClass(n,[{key:"trackPV",value:function(e,t){var i=void 0;i=t.basicProps?t.basicProps.currentTime:window.aurycLoadedTime?Math.max(_.now(),window.aurycLoadedTime):_.now();var n=brUtils.getScreenResolution();t&&!_.disableEvent(EventType.PVT())&&this.getEventWriter().append(EventType.PVT(),_.extend({},t,{r:"W3C",l:config.getConfig("layout","record")||"",m:e.isPhoneOrTablet(),url:t.content,t:t.name,dtm:i,ofs:(new Date).getTimezoneOffset(),sz:{w:n.w,h:n.h},f:document.referrer.toString()})),this.getEventWriter().logVisibilityChange(i),this.initSize()}},{key:"mouseEnter",value:function(){this.mIn=!0}},{key:"mouseOut",value:function(){this.mIn=!1}},{key:"hasMouse",value:function(){return!0===this.mIn}},{key:"addChildProc",value:function(e){this.childrenProc.push(e)}},{key:"initEventHandling",value:function(){var i=this;AurycPubSub.addListener(constants.events.PAGEVIEWTRIGGER,function(e){i.newPage(!0,e),userProperty.setupCutomDataCollection()}),AurycPubSub.addListener(constants.events.FEEDBACKTRIGGER,function(e){logger.log("addListener replay FEEDBACKTRIGGER",e);var t={p:e.eventProperties.formid,et:e.eventProperties.et};i.getEventWriter().append(EventType.CustomEventT(),{k:"feedback",v:JSON.stringify(t),source:locationInfo()})});var t=config.getEventSamplingRate("jsError");AurycPubSub.addListener(constants.events.TRACKCUSTOMEVENT,function(e){(logger.log("addListener replay TRACKCUSTOMEVENT",e),"js_error"===e.eventName&&e.eventProperties)?i.getEventWriter().samplingEvent(t)&&(i.getEventWriter().append(EventType.CustomEventT(),{k:e.eventName,v:JSON.stringify(e.eventProperties),source:locationInfo()}),i.eventWriter.append(EventType.JSExceptionT(),{v:e.eventProperties.error_message+", "+e.eventProperties.relative_error_loc+", "+(e.eventProperties.error_lineNo||0)})):i.getEventWriter().append(EventType.CustomEventT(),{k:e.eventName,v:JSON.stringify(e.eventProperties),source:locationInfo()})})}},{key:"getEventWriter",value:function(){return this.parentFrameProc?this.parentFrameProc.getEventWriter():this.eventWriter}},{key:"getBody",value:function(){return this.currWindow.document.body}},{key:"getBodyHTML",value:function(){return this.getBody().innerHTML}},{key:"getWinObj",value:function(){return this.currWindow}},{key:"logUrlChangeEvent",value:function(e){var t=e.basicProps;_.isDefined(t)&&t.url&&config.isSPAEnabled()&&this.newPage(!0,e)}},{key:"newPage",value:function(e,t){globalDataCache.clearCache(),e&&(this.getEventWriter().resetState(),this.getEventWriter().resetDomPathCache()),this.trackPV(getInstance(),t),this.generateHTML(!0,t),this.initCapture()}},{key:"initSize",value:function(){var e=dom.getSize(this.currWindow),t=0,i=this.getEventWriter(),n=dom.getDocSize(this.getDocObj()),r={w:n.width,h:n.height};if(this.cachedDocSize=n,getInstance().isPhoneOrTablet()){var s=e;e=r,r=s,t=window.orientation}i.append(EventType.WindowDimT(),{sz:e,avs:r,v:t,m:getInstance().isPhoneOrTablet()},i.updateNodeDict(this.getProcXPath())),0<n.width&&0<n.height&&!_.disableEvent(EventType.HTMLDimT())&&(i.append(EventType.HTMLDimT(),{sz:{w:n.width,h:n.height}},i.updateNodeDict(this.getProcXPath())),i.updateNodeDict(this.getProcXPath())),i.append(EventType.SclWindowT(),{ps:brUtils.getScroll(this.currWindow)},i.updateNodeDict(this.getProcXPath()))}},{key:"trackDocSizeChange",value:function(){var e=dom.getDocSize(this.getDocObj());if(e)if(this.cachedDocSize){if(this.cachedDocSize.width===e.width&&this.cachedDocSize.height===e.height)return;this.cachedDocSize=e,this.getEventWriter().append(EventType.HTMLDimT(),{sz:{w:e.width,h:e.height}},this)}else this.cachedDocSize=e,this.getEventWriter().append(EventType.HTMLDimT(),{sz:{w:e.width,h:e.height}},this)}},{key:"getProcXPath",value:function(){return this.myFullPath}},{key:"getDocObj",value:function(){return this.currWindow.document}},{key:"setReady",value:function(){this.getEventWriter().setReady()}},{key:"setNotReady",value:function(){this.getEventWriter().setNotReady()}},{key:"getTopMostFrameProc",value:function(){return this.parentFrameProc?this.parentFrameProc.getTopMostFrameProc():this}},{key:"isTopMostProc",value:function(){return this.getTopMostFrameProc()===this}},{key:"isTopMostWindow",value:function(){return this.currWindow===this.currWindow.top}},{key:"getPerfLantecy",value:function(){var e=_.now(),t=Math.min(_.get(window,"performance.timing.responseStart",e),window.aurycLoadedTime),i=Math.max(_.get(window,"performance.timing.responseEnd",e),window.aurycLoadedTime);return Math.min(constants.time.MAX_LOAD_TIME,Math.max(constants.time.MIN_DOMLOAD_TIME,i-t))}},{key:"generateHTML",value:function(e,t){var i=this.getEventWriter();if(i&&this.getBody()){var n=globalCacheObj.getNodeXPath(this.getBody()),r=this.isTopMostWindow()&&!e?globalDataCache.getObject(this.getBodyHTML(),n).id:null;getPIIHandler().tag();var s=_.get(t,"basicProps.currentTime",globalSessionTracker.getPVStartTS()),a={"cD:nO:lM":DomSerialize.getInstance().serialize(this.currWindow,this.getProcXPath()),comp:1,"hId:cId":r,"sCurr:kTime":s,"tLoc:qHref:k":this.currWindow.location.href.toString(),jType:DomSerialize.getInstance().getDocType(),"sTime:cLat":this.getPerfLantecy()};_.disableEvent(EventType.HTMLTextT())||i.append(EventType.HTMLTextT(),a,i.updateNodeDict(this.getProcXPath()))}}},{key:"notifyDomUpdated",value:function(e){this.domUpdatedEvent.publishTopic(e)}},{key:"initCapture",value:function(){var t=this;this.rcEventMonitor||(this.domUpdatedEvent=new PubSubTopic,this.rcEventMonitor=new RcEventMonitor(this,getInstance()),this.domUpdatedEvent.addListener(function(e){e=e||t.currWindow.document.body,t.rcFrame&&t.rcFrame.handleIframe(t,e),t.rcEventMonitor.handleFormInputs(e),t.trackDocSizeChange()}),this.rcFrame=RcFrame.getInstance(),this.rcFrame.handleIframe(this))}}],[{key:"getInstance",value:function(e){return n.instance||(n.instance=new n(e)),n.instance}}]),n}(),RcController=function(){function t(e){classCallCheck(this,t),this.winobj=e,this.rcProcessor=null}return createClass(t,[{key:"init",value:function(e){this.rcProcessor=ReplayProcessor.getInstance(this.winobj),e&&this.rcProcessor.setReady()}},{key:"setReady",value:function(){this.rcProcessor&&this.rcProcessor.setReady()}},{key:"pause",value:function(){return this.rcProcessor=ReplayProcessor.getInstance(this.winobj),this.rcProcessor.getEventWriter().pause()}},{key:"resume",value:function(){return this.rcProcessor=ReplayProcessor.getInstance(this.winobj),this.rcProcessor.getEventWriter().resume()}}],[{key:"getInstance",value:function(e){return t.instance||(t.instance=new t(e)),t.instance}}]),t}();function styleInject(e,t){void 0===t&&(t={});var i=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===i&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}}var css$1='@charset "UTF-8";@font-face{font-family:FontAwesome;font-weight:400;font-style:normal;src:url(//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/fonts/fontawesome-webfont.eot);src:url(//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/fonts/fontawesome-webfont.eot#iefix) format("embedded-opentype"),url(//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/fonts/fontawesome-webfont.ttf) format("truetype"),url(//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/fonts/fontawesome-webfont.woff) format("woff"),url(//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/fonts/fontawesome-webfont.woff2) format("woff2"),url(//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/fonts/fontawesome-webfont.svg#fontawesomeregular) format("svg")}@font-face{font-family:Open Sans;font-style:normal;font-weight:400;src:local("Open Sans Regular"),local("OpenSans-Regular"),url(https://fonts.gstatic.com/s/opensans/v15/mem8YaGs126MiZpBA-UFVZ0e.ttf) format("truetype")}@font-face{font-family:Open Sans;font-style:normal;font-weight:600;src:local("Open Sans SemiBold"),local("OpenSans-SemiBold"),url(https://fonts.gstatic.com/s/opensans/v15/mem5YaGs126MiZpBA-UNirkOUuhs.ttf) format("truetype")}.auryc-feedback *{font-family:Open Sans,sans-serif!important;float:none!important;text-transform:none!important;height:auto}.auryc-feedback{display:block;font-size:10px!important;line-height:1.599!important;padding:2em!important;text-align:left!important;border-radius:5px!important;resize:both!important}.auryc-fbmodal-wrapper,.auryc-feedback{font-family:Open Sans,sans-serif!important;color:#4a4a4a}.auryc-fbmodal-wrapper{display:block;position:fixed!important;z-index:2147483647!important;width:100%!important;height:100%!important;left:0!important;top:0!important;padding:0!important;margin:0!important;display:table}.auryc-fbmodal-bground{opacity:0!important}.auryc-fbmodal-bground,.auryc-fbmodal-bground-enabled{width:100%!important;height:100%!important;left:0!important;top:0!important;padding:0!important;margin:0!important;position:fixed!important;z-index:900!important}.auryc-fbmodal-bground-enabled{opacity:.79!important;-webkit-transition:opacity .4s!important;transition:opacity .4s!important;background:#292d33}.auryc-fbmodal-container{width:100%!important;height:100%!important;left:0!important;top:0!important;position:fixed!important;overflow:scroll!important;padding:0!important;margin:0!important;z-index:2147483647!important}.auryc-fbmodal-content{display:block;font-size:18px!important;margin:0 auto 100px!important;text-align:left!important;padding:9.5px!important;height:100%!important;width:calc(99vw - 19px)!important;-webkit-font-smoothing:antialiased!important;-moz-osx-font-smoothing:grayscale!important}@media (min-width:480px){.auryc-fbmodal-content{max-width:540px!important}}.auryc-fbmodal-body{display:block;opacity:0!important;width:100%!important}.auryc-fbmodal-body-enabled{background:#fff;-webkit-box-shadow:0 0 39px 0 rgba(0,0,0,.3)!important;box-shadow:0 0 39px 0 rgba(0,0,0,.3)!important;display:block;border-radius:4.9px!important;opacity:1!important;-webkit-transition:opacity .4s ease!important;transition:opacity .4s ease!important;width:100%!important;text-align:center!important}.auryc-fbmodal-head{opacity:0!important}.auryc-fbmodal-head,.auryc-fbmodal-head-enabled{width:100%!important;display:block;clear:both!important}.auryc-fbmodal-head-enabled{opacity:1!important;-webkit-transition:opacity .4s ease!important;transition:opacity .4s ease!important}.auryc-fb-modal-closebtn{top:14px!important;left:-14px!important;width:20px!important;height:20px!important;float:right!important;opacity:.49!important;position:relative!important}.auryc-fb-modal-closebtn:hover{cursor:pointer!important;opacity:1!important}#auryc-feedback-canvas{margin-top:15px!important;position:relative!important;text-align:right!important;width:100%!important}.auryc-feedback-fbquestiongroup{display:none}.auryc-feedback-fbquestiongroup-shown{display:block}#auryc-feedback-tab.auryc-feedback-tab-loc-br-horizontal{margin-right:.59em!important;left:auto!important;right:0!important;position:fixed!important;top:auto!important;display:block;-webkit-box-sizing:border-box!important;box-sizing:border-box!important;bottom:.59em;overflow:hidden!important}#auryc-feedback-tab.auryc-feedback-tab-loc-br-horizontal .auryc-feedback-tab-label{padding-left:.29em!important}#auryc-feedback-tab.auryc-feedback-tab-loc-br{margin-right:.29em!important;left:auto!important;right:0!important;top:auto!important;bottom:.59em;-webkit-transform:rotate(-90deg) translate(100%,22%)!important;transform:rotate(-90deg) translate(100%,22%)!important;-webkit-transform-origin:100% 100%!important;transform-origin:100% 100%!important;border-radius:5px 5px 0 0!important;-webkit-box-shadow:0 -2px 4px rgba(0,0,0,.1)!important;box-shadow:0 -2px 4px rgba(0,0,0,.1)!important}#auryc-feedback-tab.auryc-feedback-tab-loc-bl-horizontal{margin-right:.59em!important;position:fixed!important;right:auto!important;-webkit-box-sizing:border-box!important;box-sizing:border-box!important;overflow:hidden!important;margin-left:.59em!important;top:auto!important;display:block;bottom:1.19em!important}#auryc-feedback-tab.auryc-feedback-tab-loc-bl-horizontal .auryc-feedback-tab-label{padding-right:.29em!important;padding-left:.29em!important}#auryc-feedback-tab.auryc-feedback-tab-loc-bl{right:auto!important;margin-left:.59em!important;top:auto!important;bottom:1.2em!important;-webkit-transform:translate(-8%,100%) rotate(-90deg)!important;transform:translate(-8%,100%) rotate(-90deg)!important;-webkit-transform-origin:0 0!important;transform-origin:0 0!important;border-radius:0 0 5px 5px!important;-webkit-box-shadow:0 -2px 4px rgba(0,0,0,.1)!important;box-shadow:0 -2px 4px rgba(0,0,0,.1)!important}#auryc-feedback-tab.auryc-feedback-tab-loc-tr-horizontal{margin-right:.59em!important;position:fixed!important;left:auto!important;right:0!important;top:.59em!important;-webkit-box-sizing:border-box!important;box-sizing:border-box!important;overflow:hidden!important;margin-left:.59em!important;display:block;bottom:auto!important}#auryc-feedback-tab.auryc-feedback-tab-loc-tr-horizontal .auryc-feedback-tab-label{padding-left:.29em!important}#auryc-feedback-tab.auryc-feedback-tab-loc-tr{-webkit-transform:rotate(-90deg) translateY(-78%)!important;transform:rotate(-90deg) translateY(-78%)!important;-webkit-transform-origin:100% 0!important;transform-origin:100% 0!important;border-radius:5px 5px 0 0!important;-webkit-box-shadow:0 -2px 4px rgba(0,0,0,.1)!important;box-shadow:0 -2px 4px rgba(0,0,0,.1)!important;left:auto!important;right:0!important;top:.59em!important;position:fixed!important;margin-right:.29em!important}#auryc-feedback-tab.auryc-feedback-tab-loc-tr .auryc-feedback-tab-label:before{content:"";font-family:fontawesome!important;padding-left:5px!important}#auryc-feedback-tab.auryc-feedback-tab-loc-tl-horizontal{position:fixed!important;left:0!important;right:auto!important;top:.59em!important;-webkit-box-sizing:border-box!important;box-sizing:border-box!important;overflow:hidden!important;margin-left:.59em!important;display:block;bottom:auto!important}#auryc-feedback-tab.auryc-feedback-tab-loc-tl-horizontal .auryc-feedback-tab-label{padding-right:.29em!important;padding-left:.29em!important}#auryc-feedback-tab.auryc-feedback-tab-loc-tl{-webkit-transform:rotate(-90deg) translate(-100%,-22%)!important;transform:rotate(-90deg) translate(-100%,-22%)!important;-webkit-transform-origin:0 0!important;transform-origin:0 0!important;border-radius:0 0 5px 5px!important;-webkit-box-shadow:0 -2px 4px rgba(0,0,0,.1)!important;box-shadow:0 -2px 4px rgba(0,0,0,.1)!important;right:auto!important;margin-left:.29em!important;top:.59em!important}#auryc-feedback-tab.auryc-feedback-tab-loc-cl-horizontal{position:fixed!important;left:0!important;right:auto!important;top:50%!important;-webkit-box-sizing:border-box!important;box-sizing:border-box!important;overflow:hidden!important;margin-left:.59em!important;display:block;bottom:auto!important}#auryc-feedback-tab.auryc-feedback-tab-loc-cl-horizontal .auryc-feedback-tab-label{padding-right:.29em!important;padding-left:.29em!important}#auryc-feedback-tab.auryc-feedback-tab-loc-cl{right:auto!important;margin-left:.29em!important;top:50%!important;-webkit-transform:rotate(-90deg) translate(-50%,-22%)!important;transform:rotate(-90deg) translate(-50%,-22%)!important;-webkit-transform-origin:0 0!important;transform-origin:0 0!important;border-radius:0 0 5px 5px!important;-webkit-box-shadow:0 -2px 4px rgba(0,0,0,.1)!important;box-shadow:0 -2px 4px rgba(0,0,0,.1)!important}#auryc-feedback-tab.auryc-feedback-tab-loc-cr-horizontal{position:fixed!important;left:auto!important;right:0!important;top:50%!important;-webkit-box-sizing:border-box!important;box-sizing:border-box!important;overflow:hidden!important;margin-left:.59em!important;display:block;bottom:auto!important}#auryc-feedback-tab.auryc-feedback-tab-loc-cr-horizontal .auryc-feedback-tab-label{padding-left:.29em!important}#auryc-feedback-tab.auryc-feedback-tab-loc-cr{-webkit-transform:rotate(-90deg) translate(50%,-78%)!important;transform:rotate(-90deg) translate(50%,-78%)!important;-webkit-transform-origin:100% 0!important;transform-origin:100% 0!important;border-radius:5px 5px 0 0!important;-webkit-box-shadow:0 -2px 4px rgba(0,0,0,.1)!important;box-shadow:0 -2px 4px rgba(0,0,0,.1)!important;position:fixed!important;left:auto!important;right:0!important;top:50%!important;-webkit-box-sizing:border-box!important;box-sizing:border-box!important;overflow:hidden!important;margin-right:.29em!important;display:block;bottom:auto!important}.auryc-fb-validation-msg-section{font-family:Open Sans,sans-serif!important;font-size:14px!important;color:#fc6a56;border-radius:.49em!important;margin-bottom:.49em!important;margin-top:2em!important;display:none;text-align:left!important}#auryc-feedback-tab{position:fixed!important;top:0!important;left:0!important;display:block;background:#692893;opacity:.85!important;cursor:pointer!important;-webkit-box-sizing:border-box!important;box-sizing:border-box!important;z-index:2147483647!important;font-size:80%!important;-webkit-font-smoothing:antialiased!important;-moz-osx-font-smoothing:grayscale!important}.auryc-feedback-tab-label{font-family:Open Sans,sans-serif!important;color:#fff;font-size:13px!important;z-index:5!important;font-weight:600!important;line-height:30px!important;letter-spacing:.1px!important}.auryc-feedback div,.auryc-feedback fieldset,.auryc-feedback h1,.auryc-feedback h2,.auryc-feedback img,.auryc-feedback label,.auryc-feedback p,.auryc-feedback span{margin:0!important;font:inherit!important;padding:0!important;border:0!important;vertical-align:baseline!important}#auryc-feedback-tab.auryc-feedback-tab-dt-desktop,#auryc-feedback-tab.auryc-feedback-tab-dt-tablet{height:30px!important;display:block;border-radius:100px;-webkit-box-shadow:0 1px 2px 1px rgba(41,46,63,.26)!important;box-shadow:0 1px 2px 1px rgba(41,46,63,.26)!important;padding:0 12px!important;overflow:hidden!important}#auryc-feedback-tab.auryc-feedback-tab-dt-smartphone{width:40px!important;height:40px!important;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center!important;-ms-flex-align:center!important;align-items:center!important;-webkit-box-pack:center!important;-ms-flex-pack:center!important;justify-content:center!important;background:#2f8cff;border-radius:50%!important;cursor:pointer!important;fill:#fff;-webkit-box-shadow:0 1px 5px rgba(0,0,0,.06),0 2px 30px rgba(0,0,0,.12)!important;box-shadow:0 1px 5px rgba(0,0,0,.06),0 2px 30px rgba(0,0,0,.12)!important;bottom:40px;margin-right:10px}@media print{#auryc-feedback-tab.auryc-feedback-tab-dt-desktop,#auryc-feedback-tab.auryc-feedback-tab-dt-tablet{display:none!important}}.auryc-feedback-spinner{display:block;top:1!important;left:1!important;position:absolute!important;z-index:2147483647!important}.auryc-feedback ::-webkit-input-placeholder{font-style:italic!important}.auryc-feedback :-moz-placeholder,.auryc-feedback ::-moz-placeholder{font-style:italic!important}.auryc-feedback :-ms-input-placeholder{font-style:italic!important}.auryc-fbmodal-body-selection{color:#4a4a4a;text-align:left!important;padding:25px 15px 15px!important}.auryc-fbmodal-body-selection .auryc-fbmodal-body-selection_title{font-size:18px!important;font-weight:600!important;line-height:24px!important}.auryc-fbmodal-body-selection .auryc-feedback-general,.auryc-fbmodal-body-selection .auryc-feedback-screenshot{background-color:#f6f6f6;border:1px solid #cfcfcf;border-radius:3px!important;-webkit-box-sizing:border-box!important;box-sizing:border-box!important;cursor:default!important;display:table;margin-top:10px!important;padding:5px!important;white-space:nowrap!important;width:100%!important}.auryc-fbmodal-body-selection .auryc-feedback-general .auryc-feedback_option_row,.auryc-fbmodal-body-selection .auryc-feedback-screenshot .auryc-feedback_option_row{display:table-row;height:60px!important}.auryc-fbmodal-body-selection .auryc-feedback-general .auryc-feedback_option_column,.auryc-fbmodal-body-selection .auryc-feedback-screenshot .auryc-feedback_option_column{display:table-cell;vertical-align:middle!important}.auryc-fbmodal-body-selection .auryc-feedback-general .auryc-feedback-selection__label1,.auryc-fbmodal-body-selection .auryc-feedback-screenshot .auryc-feedback-selection__label1{font-size:16px!important;font-weight:600!important;line-height:22px!important}.auryc-fbmodal-body-selection .auryc-feedback-general .auryc-feedback-selection__label2,.auryc-fbmodal-body-selection .auryc-feedback-screenshot .auryc-feedback-selection__label2{font-size:14px!important;font-weight:400!important;line-height:19px!important;white-space:normal!important}.auryc-fbmodal-body-selection .auryc-feedback-general .auryc-feedback-selection__labels,.auryc-fbmodal-body-selection .auryc-feedback-screenshot .auryc-feedback-selection__labels{padding-left:5px!important;vertical-align:middle!important}.auryc-fbmodal-body-selection .auryc-feedback-general .auryc-feedback_option_image,.auryc-fbmodal-body-selection .auryc-feedback-screenshot .auryc-feedback_option_image{width:50px!important}.auryc-fbmodal-body-selection .auryc-feedback-general img,.auryc-fbmodal-body-selection .auryc-feedback-screenshot img{vertical-align:middle!important;padding:0 5px!important}.auryc-fbmodal-body-selection .auryc-feedback-general:hover,.auryc-fbmodal-body-selection .auryc-feedback-screenshot:hover{background-color:#e4ecfc!important}div [dataType=auryc-fbq]>p{display:block;font-size:14px!important;text-align:center!important;font-weight:400!important;color:#4a4a4a;letter-spacing:0!important}.auryc-fbmodal-body-fbform,.auryc-fbmodal-body-selection{display:none}@media (min-width:1024px){.auryc-feedback{text-align:left!important}.auryc-feedback .auryc-fb-starrating-field{font-size:15px!important}}.auryc-feedback .auryc-feedback-fbform-headtag{font-family:light,Open Sans,sans-serif!important;margin-bottom:10px!important;line-height:1.2!important;color:#4a4a4a;letter-spacing:-.1px!important}.auryc-feedback .auryc-feedback-fbform-headtag-h1{font-size:25px!important;font-family:Open Sans,sans-serif!important;font-weight:400!important;text-align:center!important;width:inherit!important;text-transform:none!important}.auryc-feedback .auryc-feedback-fbform-headtag-h2{font-size:2.4em!important}.auryc-feedback .auryc-feedback-fblabel p{font-weight:600!important;font-size:14px!important;color:#4a4a4a;letter-spacing:0!important}.auryc-feedback p{font-size:1.2em!important;line-height:1.2!important;margin-bottom:.2em!important}.auryc-feedback .auryc-feedback-title-section{font-family:Open Sans,sans-serif!important;text-align:center!important;font-size:14px!important;margin-bottom:20px!important}.auryc-feedback .auryc-feedback-title-section .auryc-feedback-fblogo{height:3.49em!important;margin:0 auto 1.7em!important;display:block;max-height:144px!important;width:auto!important}.auryc-feedback .auryc-fb-starrating-field{width:96%!important;color:#cfcfcf!important;display:block;margin:0 auto!important;text-align:center!important;text-indent:0!important;white-space:nowrap!important}.auryc-feedback .auryc-fb-starrating-field label{color:#cfcfcf;float:none!important;height:auto!important}.auryc-fbmodal-body-fbform-enabled{display:block}#post-fb-resp-button{display:inline-block;background:#22c6f3;border:.9px solid #20c8f7;border-radius:2.9px!important;padding:.02em 4.49em!important;color:#555;resize:none!important;width:199px!important;height:35px!important;margin-top:19px!important;font-size:14px!important}.auryc-feedback .auryc-starrating-section{margin-bottom:.49em!important;font-size:18px!important;display:block;margin-top:10px!important}div[dataType=auryc-fbq]{display:block;margin-top:10px!important}.auryc-feedback-fbquestion,.auryc-feedback-fbquestion-dropdown{display:block}.auryc-feedback .auryc-feedback-fblabel{display:block;text-align:center!important;font-size:12px!important;font-family:Open Sans,sans-serif!important;color:#4a4a4a;font-weight:600!important;margin-bottom:0!important;float:none!important;height:auto!important}.auryc-feedback div[dataType=auryc-feedback-checkbox]>label,.auryc-feedback div[dataType=auryc-feedback-radio]>label{border:1px solid #979797!important;border-radius:3px!important}.auryc-feedback .auryc-feedback-fbemail,.auryc-feedback div[dataType=auryc-feedback-checkbox]>label,.auryc-feedback div[dataType=auryc-feedback-radio]>label{position:relative!important;background:#fff!important;width:100%!important;font-size:1.4em!important;resize:none!important;padding:.49em!important;-webkit-box-sizing:border-box!important;box-sizing:border-box!important;text-align:left!important;-webkit-appearance:none!important;-moz-appearance:none!important;-ms-appearance:none!important;-o-appearance:none!important;appearance:none!important}.auryc-feedback .auryc-feedback-fbemail{border:none!important;outline:none!important;border-bottom:1px solid #838aa4!important;border-radius:0!important}.auryc-feedback .auryc-feedback-question-textarea{position:relative!important;border-radius:3px!important;background:#fff!important;width:100%!important;font-size:1.4em!important;resize:none!important;padding:.49em!important;-webkit-box-sizing:border-box!important;box-sizing:border-box!important;text-align:left!important;-webkit-appearance:none!important;-moz-appearance:none!important;-ms-appearance:none!important;-o-appearance:none!important;appearance:none!important;height:54px!important;border:1px solid #d0d7e6!important}.auryc-feedback .auryc-feedback-fbtarea{display:block;position:relative!important;margin:0!important;text-align:right!important}.auryc-feedback .auryc-feedback-fbtarea .auryc-feedback-fbctrl{padding-bottom:1.2em!important;margin:0!important;max-width:100%!important}.auryc-feedback .auryc-feedback-question-dropdown-choose,.auryc-feedback .auryc-feedback-question-select-choose{position:relative!important;border-radius:none!important;background:#fff!important;width:100%!important;font-size:1.4em!important;resize:none!important;padding:.49em!important;-webkit-box-sizing:border-box!important;box-sizing:border-box!important;text-align:left!important;-webkit-appearance:none!important;-moz-appearance:none!important;-ms-appearance:none!important;-o-appearance:none!important;appearance:none!important;border:none!important;outline:none!important;color:#313943!important}.auryc-feedback .auryc-feedback-footer-section{display:block;position:relative!important;text-align:center!important}.auryc-feedback .auryc-feedback-footer-section .auryc-fbmodal-footer{background:inherit!important;position:relative!important;left:1px!important;display:table;font-size:10px!important;color:#4a4a4a!important;letter-spacing:-.35px!important;z-index:3!important;width:100%!important}.auryc-fbmodal-footer span{display:inline}.auryc-feedback .auryc-feedback-footer-section .auryc-fbmodal-footer img{display:inline;position:relative!important;top:-1px!important;left:1px!important;vertical-align:middle!important}.auryc-feedback .auryc-feedback-question-dropdown-choose:after,.auryc-feedback .auryc-feedback-question-select-choose:after{position:absolute!important;top:30%!important;right:1em!important;content:"";padding-left:5px!important;color:inherit!important;pointer-events:none!important;font-family:FontAwesome!important;line-height:1!important;-moz-osx-font-smoothing:grayscale!important;font-weight:400!important;font-stretch:normal!important;-webkit-font-feature-settings:normal!important;font-feature-settings:normal!important;font-variant:normal!important;font-size:inherit!important;text-rendering:auto!important;-webkit-font-smoothing:antialiased!important}.auryc-feedback .auryc-feedback-question-dropdown-choose .auryc-fb-dropdown-selector,.auryc-feedback .auryc-feedback-question-select-choose .auryc-fb-question-selector,.auryc-feedback .auryc-feedback-question-select-choose .auryc-fb-questiongroup-selector{position:absolute!important;left:0!important;top:0!important;width:100%!important;text-transform:none!important;cursor:pointer!important;font-size:14px!important;border:1px solid #d0d7e6!important;border-radius:3px!important;background:#fff!important;padding:4px!important;font-weight:600!important;color:#292e3f!important;-webkit-appearance:none!important;-moz-appearance:none!important;-ms-appearance:none!important;-o-appearance:none!important;appearance:none!important},.auryc-fb-question-selector::-ms-expand,.auryc-fb-questiongroup-selector::-ms-expand{display:none}.auryc-fb-questiongroup-selector:focus .auryc-fb-question-selector:focus{-webkit-box-shadow:0 0 1px 1px #23c6f5!important;box-shadow:0 0 1px 1px #23c6f5!important}.auryc-feedback .auryc-close-btn{width:222px!important;height:36px!important;position:relative!important;padding:.29em 1.9em!important;font-family:Open Sans,sans-serif!important;font-size:18px!important;line-height:0!important;text-align:center!important;color:#555!important;font-weight:400!important;display:inline-block;overflow:hidden!important;text-overflow:ellipsis!important;white-space:nowrap!important;border-radius:0!important;background-color:#464c55;border:1px solid #464c55;cursor:pointer!important;outline:0!important;margin:0 auto!important}.auryc-feedback .auryc-feedback-select-button{font-family:Open Sans,sans-serif!important;font-size:14px!important;font-weight:400!important;color:#4a4a4a!important;text-align:left!important}.auryc-feedback .post-fb-resp-button{padding:.49em .6999em!important;line-height:1.618!important;width:100%!important}.auryc-feedback .auryc-feedback-btn,.auryc-feedback .post-fb-resp-button{display:inline-block;overflow:hidden!important;text-overflow:ellipsis!important;white-space:nowrap!important;border-radius:0!important;background-color:#464c55;border:1px solid #464c55;cursor:pointer!important;color:#fff;font-size:1.7em!important;text-align:center!important;outline:0!important;font-weight:400!important;-webkit-transition:all .14s ease!important;transition:all .14s ease!important;margin:0 auto!important}.auryc-feedback .auryc-feedback-btn{padding:.49em .69999em!important;line-height:1.599!important}.auryc-feedback .auryc-fb-starrating-field .auryc-fb-starrating-field-staricon{font-size:6em!important;cursor:pointer!important;border:0!important}.auryc-feedback .auryc-fb-starrating-field .auryc-fb-starrating-field-staricon:before{font-family:Open Sans,sans-serif!important;content:""}.auryc-feedback .auryc-fb-starrating-field--disabled{color:#eaebec!important}.auryc-feedback .auryc-fb-starrating-field--disabled .auryc-fb-starrating-field-staricon{cursor:default!important;border:0!important}.auryc-feedback .auryc-fb-starrating-field input[type=radio]{display:none}.auryc-feedback input[type=text],.auryc-feedback textarea{font-family:Open Sans,sans-serif!important;height:100%!important;float:none!important;height:auto!important}.auryc-feedback .auryc-fb-starrating-field .auryc-fb-starrating-field-staricon:before,.auryc-feedback .auryc-fb-starrating-field label:before,.auryc-feedback .auryc-feedback-checkbox:before,.auryc-feedback .auryc-feedback-radio:before{font-family:FontAwesome!important;line-height:1!important;font-style:normal!important;font-weight:400!important;font-stretch:normal!important;-webkit-font-feature-settings:normal!important;font-feature-settings:normal!important;font-variant:normal!important;font-size:inherit!important;text-rendering:auto!important;-webkit-font-smoothing:antialiased!important;-moz-osx-font-smoothing:grayscale!important}.auryc-feedback .auryc-fb-starrating-field input.auryc-fb-starrating-field-staricon+label{padding:0!important;font-size:2em!important;cursor:pointer!important;display:inline;margin:0!important;border:0!important}.auryc-feedback .auryc-fb-starrating-field label:before{-webkit-transition:color .15s ease!important;transition:color .15s ease!important;content:"";background:0 0!important;height:auto!important;width:auto!important;top:0!important}.auryc-feedback .auryc-fb-starrating-field input.auryc-fb-starrating-field-staricon:checked+label:before{content:"";color:#ffaf40;background:0 0!important}.auryc-feedback .auryc-fb-starrating-field label.auryc-ratings-chosen:before{color:#ffaf40;content:""}.auryc-feedback .auryc-nps__container{border:1px solid #f6f7f9!important;border-radius:5px!important;padding:10px 0!important;background-color:transparent!important}@media (max-width:360px) and (orientation:portrait){.auryc-feedback .auryc-nps__container{padding:10px 0 0!important}}.auryc-feedback .auryc-nps__container .nps-rating{padding:10px 10px 0!important;margin:auto auto 10px!important;min-height:35px!important;text-align:justify!important}.auryc-feedback .auryc-nps__container .nps-rating .nps-rating__labels{display:block}.auryc-feedback .auryc-nps__container .nps-rating .nps_rating_left_label,.auryc-feedback .auryc-nps__container .nps-rating .nps_rating_right_label{font-size:12px;color:#838aa4}.auryc-feedback .auryc-nps__container .nps-rating .nps_rating_left_label{float:left!important}.auryc-feedback .auryc-nps__container .nps-rating .nps_rating_right_label{float:right!important}.auryc-feedback .auryc-nps__container .nps-rating .nps-rating__badges{display:block;text-align:center!important;min-height:30px!important}.auryc-feedback .auryc-nps__container .nps-rating .nps-rating__badges label{padding:0!important;cursor:pointer!important;display:inline;margin:0!important;border:0!important}.auryc-feedback .auryc-nps__container .nps-rating .nps-rating__badges label:before{display:none}.auryc-feedback .auryc-nps__container .nps-rating .nps-rating__badges label:hover{color:#fff;background-color:#23c6f5}.auryc-feedback .auryc-nps__container .nps-rating .nps-rating__badges .nps-rating__badge{border-radius:50%!important;width:28px!important;padding:2px!important;font-size:12px!important;line-height:1em!important;position:relative!important;background:#f6f7f9;border:1px solid #d0d7e6;display:inline-block;-webkit-box-sizing:border-box!important;box-sizing:border-box!important}.auryc-feedback .auryc-nps__container .nps-rating .nps-rating__badges .aurycNpsRatingChecked,.auryc-feedback .auryc-nps__container .nps-rating .nps-rating__badges input[type=radio]:checked+label{color:#fff;background-color:#23c6f5}.auryc-feedback .auryc-nps__container .nps-rating .nps-rating__badges .nps-rating__badge .nps-rating__height_fix{margin-top:100%!important}.auryc-feedback .auryc-nps__container .nps-rating .nps-rating__badges .nps-rating__badge .nps-rating__num{position:absolute!important;left:0!important;top:50%!important;height:100%!important;width:100%!important;text-align:center!important;margin-top:-6px!important}.auryc-feedback .auryc-nps__container .nps-rating .nps-rating__badges .stretch{width:100%!important;display:inline-block;font-size:0!important;line-height:0!important;padding:0!important;margin:0!important;height:0!important}.auryc-feedback .auryc-nps__container .nps-rating .nps-rating__badges input[type=radio]{display:none}@media (max-width:420px) and (orientation:portrait){.auryc-feedback .auryc-nps__container .nps-rating .nps-rating__badges .nps-rating__badge{width:20px!important}}.auryc-feedback .auryc-feedback-checkbox,.auryc-feedback .auryc-feedback-radio{text-align:left!important;display:block;cursor:pointer!important}.auryc-feedback .auryc-feedback-checkbox:nth-child(1n+2),.auryc-feedback .auryc-feedback-radio:nth-child(1n+2){margin-top:.49em!important}.auryc-feedback .auryc-feedback-checkbox input,.auryc-feedback .auryc-feedback-radio input{display:none}.auryc-feedback .auryc-feedback-checkbox:before{content:"";padding-left:.29em!important;padding-right:.29em!important;color:inherit;opacity:.3}.auryc-feedback .auryc-feedback-checkbox.aurycChecked:before{content:"";opacity:1;color:#23c6f5}.auryc-feedback .auryc-feedback-radio:before{padding-left:.29em!important;padding-right:.29em!important;color:inherit;opacity:.3;content:"\\f10c"}.auryc-feedback .auryc-feedback-radio.aurycChecked:before{content:"\\f111";opacity:1;color:#23c6f5}.aurycIsRequired{color:#ff4c88!important}';styleInject(css$1);var css$3='.fb-desktop .auryc-feedback div[dataType=auryc-feedback-checkbox]>label,.fb-desktop .auryc-feedback div[dataType=auryc-feedback-radio]>label{border:0!important;vertical-align:middle!important}.auryc-feedback .auryc-feedback-title-section .auryc-feedback-fblogo{margin:0 0 20px!important}.fb-desktop .auryc-feedback h1{font-weight:600!important;font-size:18px!important;color:#292e3f!important;text-align:left!important}.fb-desktop .auryc-feedback p{font-size:13px!important;color:#505673!important;text-align:left!important}.fb-desktop .auryc-feedback .required-label{color:#ff4c88!important}.fb-desktop .auryc-feedback .auryc-feedback-fblabel{text-align:left!important;font-weight:600!important;font-size:12px!important;color:#292e3f!important}.fb-desktop .auryc-feedback .auryc-feedback-fblabel.aurycIsRequired{color:#ff4c88!important}.fb-desktop .auryc-feedback .auryc-fb-starrating-field{text-align:left!important}.fb-desktop .auryc-feedback .auryc-fb-starrating-field label{color:#d0d7e6!important}.fb-desktop .auryc-feedback .auryc-nps__container{background:transparent!important;border:transparent!important}.fb-desktop .auryc-feedback .auryc-nps__container .nps-rating .nps-rating__badges{display:-webkit-box!important;display:-ms-flexbox!important;display:flex!important;text-align:left!important;min-height:30px!important;-webkit-box-pack:justify!important;-ms-flex-pack:justify!important;justify-content:space-between!important;-ms-flex-flow:wrap!important;flex-flow:wrap!important}.fb-desktop .auryc-feedback .auryc-nps__container .nps-rating .nps-rating__badges .nps-rating__badge{border-radius:4px!important}.fb-desktop .auryc-feedback .auryc-feedback-radio:before{content:"\\f1db"!important;font-size:18px!important;opacity:1!important;padding-left:4px!important;padding-right:4px!important}.fb-desktop .auryc-feedback .auryc-feedback-radio.aurycCheckedOverride:before{border:1px solid #000!important;border-radius:12px!important;content:"\\f111"!important;font-size:14px!important;margin:3px!important;padding:1px 2px!important;opacity:1!important}.fb-desktop .auryc-feedback .auryc-feedback-checkbox:before{content:"\\f096";font-size:20px!important;padding-left:4px!important;padding-right:4px!important;opacity:1!important}.auryc-feedback .auryc-feedback-checkbox.aurycCheckedOverride:before{padding-left:3px!important;padding-right:3px!important}.fb-desktop .auryc-feedback .auryc-feedback-checkbox,.fb-desktop .auryc-feedback .auryc-feedback-radio{display:inline!important;outline:none!important;padding:0!important}';styleInject(css$3);var Event=function(){function t(e){classCallCheck(this,t),this.event=new PubSubTopic,this.listener=new e(this.handleEvent.bind(this))}return createClass(t,[{key:"addListener",value:function(){this.event.addListener.apply(this.event,arguments),0<this.event.listeners.length&&this.listener.start()}},{key:"handleEvent",value:function(){this.event.publishTopic()}}]),t}(),NavigationListener=function(){function t(e){classCallCheck(this,t),this.handleEvent=e,this.started=!1}return createClass(t,[{key:"start",value:function(){this.started||history.pushState&&window.addEventListener&&(this.originalPushState=history.pushState,history.pushState=function(e,t){this.originalPushState.apply(history,arguments),this.handleEvent()}.bind(this),this.originalReplaceState=history.replaceState,history.replaceState=function(e,t){this.originalReplaceState.apply(history,arguments),this.handleEvent()}.bind(this),window.addEventListener("popstate",this.handleEvent),this.started=!0)}},{key:"stop",value:function(){this.started&&(history.pushState=this.originalPushState,history.replaceState=this.originalReplaceState,window.removeEventListener("popstate",this.handleEvent),this.originalPushState=null,this.originalReplaceState=null,this.started=!1)}}]),t}(),unloadListener=function(){function t(e){classCallCheck(this,t),this.handleEvent=e,this.started=!1}return createClass(t,[{key:"start",value:function(){this.started||(addDomEvent(window,"unload",this.handleEvent),this.started=!0)}},{key:"stop",value:function(){this.started&&(removeDomEvent(window,"unload",this.handleEvent),this.started=!1)}}]),t}(),navigationEvent=new Event(NavigationListener),unloadEvent=new Event(unloadListener),baseIcon='\n    <svg width="13px" height="14px" viewBox="0 0 10 11" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <g id="Icon" stroke="none" fill-rule="evenodd">\n            <path d="M8.88888889,2.26638076 C8.88888889,1.64053699 8.3914275,1.13319038 7.77777778,1.13319038 L2.22222222,1.13319038 C1.6085725,1.13319038 1.11111111,1.64053699 1.11111111,2.26638076 L1.11111111,6.11922804 C1.11111111,6.7450718 1.6085725,7.25241842 2.22222222,7.25241842 L7.89678531,7.25241842 L8.88888889,8.26423642 L8.88888889,2.26638076 Z M2.22222222,8.3856088 C0.994922778,8.3856088 1.44364238e-13,7.37091557 1.44364238e-13,6.11922804 L0,2.26638076 C0,1.01469323 0.994922778,0 2.22222222,0 L7.77777778,0 C9.00507722,0 10,1.01469323 10,2.26638076 L10,11 L7.43654802,8.3856088 L2.22222222,8.3856088 Z" id="Rectangle-Copy-18"></path>\n        </g>\n    </svg>',FBTab=function(){function n(e,t){classCallCheck(this,n),this.fbVisible=!1,this.chatVisible=!1,this.fbTabEl=null,this.clicked=!1,this.cfg=e,this.cfg.badgeTemplate?this.fbTabEl=this.setupTabTemplate(e):this.fbTabEl=this.setupRegularTab(e);var i=e.badgeTemplate&&e.chat?this.fbTabEl.querySelectorAll("#auryc-feedback-tab")[0]:this.fbTabEl;this.setupInteractions(i,e,t)}return createClass(n,[{key:"setupInteractions",value:function(e,t,i){addDomEvent(e,"click",function(){i&&i(t)}),addDomEvent(e,"keydown",function(e){13===e.which&&(e.target.click(),e.stopPropagation(),e.preventDefault(),i(t))})}},{key:"setupTabTemplate",value:function(e){var t=this,i=encoder.decodeBase64(this.cfg.badgeTemplate),n=document.createElement("div");return n.innerHTML=i,(n=n.firstChild).querySelectorAll(".auryc-feedback-tab-label")[0].innerHTML=e.label,this.cfg.chat&&setTimeout(function(){t.handleChat(e,5)},0),n}},{key:"setupRegularTab",value:function(e){var t=getInstance(),i="",n="";i=t.isPhone()?(e.fontColor&&_.isValidColor(e.fontColor)&&(n='style="fill:'+e.fontColor+';position:relative;line-height:17px;display:flex"'),"<div "+n+">"+baseIcon+"</div>"):(e.fontColor&&_.isValidColor(e.fontColor)&&(n='style="fill:'+e.fontColor+";color:"+e.fontColor+'"'),'<span class="auryc-feedback-tab-label" '+n+">"+baseIcon+" "+e.label+"</span>");var r=document.createElement("div");r=toDomNode('<div id="auryc-feedback-tab" tabindex="0" style="">'+i+"</div>");var s=this.getLocationCss(t.isPhone()?"bottomright":e.fblocation);return r.addCssCls("auryc-feedback-tab-dt-"+t.getDT().toLowerCase()),"horizontal"===e.fbdirection||t.isPhone()?r.addCssCls("auryc-feedback-tab-loc-"+s+"-horizontal"):r.addCssCls("auryc-feedback-tab-loc-"+s),e.backgroundColor&&_.isValidColor(e.backgroundColor)&&r.css({backgroundColor:e.backgroundColor}),r}},{key:"getLocationCss",value:function(e){switch(e){case"bottomright":return"br";case"bottomleft":return"bl";case"middleleft":return"cl";case"middleright":return"cr";case"topright":return"tr";case"topleft":return"tl"}}},{key:"getFBTabDomNode",value:function(){return this.fbTabEl}},{key:"render",value:function(e){e&&document.body.appendChild(this.getFBTabDomNode()),this.cfg.preview?(this.cfg.badgeTemplate&&this.setChatVisible(!0),this.setVisible(!0)):this.setVisible(!1),this.applyCustomProperties(this.cfg)}},{key:"setClicked",value:function(){this.clicked=!0,this.setFeedbackVisible(!1)}},{key:"setFeedbackVisible",value:function(e){var t=(e=e&&!this.clicked)?"block":"none",i=void 0;if((i=0<=this.fbTabEl.id.indexOf("auryc-feedback-tab")?[this.fbTabEl]:this.fbTabEl.sel("#auryc-feedback-tab"))&&0<i.length){var n=toDomNode(i[0]);n.css({display:t}),(this.fbVisible=e)?this.setVisible(e):(1===this.fbTabEl.children.length&&this.fbTabEl.children[0]===n&&this.setVisible(!1),this.chatVisible||this.setVisible(!1))}}},{key:"setChatVisible",value:function(e){var t=e?"":"none",i=this.fbTabEl.sel("__aurycChat");if(i&&0<i.length){var n=toDomNode(i[0]);n.css({display:t}),(this.chatVisible=e)?this.setVisible(e):(1===this.fbTabEl.children.length&&this.fbTabEl.children[0]===n&&this.setVisible(!1),this.fbVisible||this.setVisible(!1))}}},{key:"setVisible",value:function(e){if(this.cfg.chat)this.fbVisible=e;else{var t=e?"":"none";this.fbTabEl.css({display:t})}}},{key:"remove",value:function(){this.fbTabEl.parentNode&&this.fbTabEl.parentNode.removeChild(this.fbTabEl)}},{key:"removeModal",value:function(){var e=document.querySelectorAll(".auryc-fb-modal-closebtn");0<e.length&&e[0].click()}},{key:"removeFeedback",value:function(){var e=this.fbTabEl.sel(".auryc-feedback-tab-label");if(e&&0<e.length){var t=toDomNode(e[0]);1===this.fbTabEl.children.length&&this.fbTabEl.children[0]===t?this.remove():this.fbTabEl.removeChild(t)}}},{key:"handleChat",value:function(e,t){if("olark"===e.chat.vendor){void 0===t&&(t=5);var i=this;if("function"!=typeof olark){if(t<=0)return;return void setTimeout(function(){i.handleChat(e,--t)},1e3)}olark("api.box.onShrink",function(){}),olark("api.box.onExpand",function(){})}}},{key:"applyCustomProperties",value:function(e){var i=getInstance();if(e.customProperties&&(e.customProperties.badge||e.customProperties.fbTab))for(var t=e.customProperties.badge||e.customProperties.fbTab,n=0;n<t.length;n++){var r=t[n];if(c(r.context))try{var s=r.cssSelector;-1<s.toLowerCase().indexOf("._aurycbadge")&&s.toLowerCase().indexOf("#auryc-feedback-tab")<0&&(s+=",#auryc-feedback-tab");for(var a=document.querySelectorAll(s),o=0;o<a.length;o++){l(a[o],r.properties)}}catch(e){logger.log(e)}}function c(t){if(!t)return!0;var e=[];return!(e="string"==typeof t.deviceType?[t.deviceType]:t.deviceType)||0===e.length||e.some(function(e){return e.toLowerCase()===i.getDT().toLowerCase()||"mobilephone"===t.deviceType.toLowerCase()&&i.isPhone()})}function l(e,t){for(var i=Object.keys(t),n=0;n<i.length;n++){var r=i[n],s=t[r];"style"===r?e.style.cssText+=s:e[r]=s}}}}]),n}(),FeedbackAPI=function(){function e(){classCallCheck(this,e),this.stg=DataLayer.getInstance(constants.symbols.PERMANENT,"feedback"),this.feedbackEnabled=new PubSubTopic}return createClass(e,[{key:"setFeedbackEnabled",value:function(e){this.stg.setByKey("enabled",e),this.feedbackEnabled.publishTopic(e)}},{key:"getFeedbackEnabled",value:function(){return!1!==this.stg.getByKey("enabled")}},{key:"makePublic",value:function(e,t,i){_.isDefined(e)&&(window.auryc||(window.aurycFeedbackAPI={}),window.aurycFeedbackAPI=e,t&&i&&this.defineExternalLaunch(t,i))}},{key:"defineExternalLaunch",value:function(s,a){var o=this;window.launchAurycFeedback=function(t,e,i){if(o.getFeedbackEnabled()&&!(s.instances.length<1)){var n=s.instances.filter(function(e){return!0!==e.disabled}).filter(function(e){return!t||e.projectId===t}),r=0<n.length?n[0]:null;r?a.hasPopup()?e&&(r.launchedFromTimer=i,a.initialize(r)):(r.launchedFromTimer=i,a.initialize(r)):console.log("No enabled feedback is found"+(t?" for feedback "+t:""))}}}}]),e}(),feedbackAPI=new FeedbackAPI,TTF_TOKEN_DELIMITER=":",stg=DataLayer.getInstance(constants.symbols.PERMANENT,"feedback"),Trigger=function(){function i(e,t){classCallCheck(this,i),this.config=e,this.criteria=t,this.fbTab=null,this.enabled=!0,this.delayedPopupTimer=!1,this.siteId=config.getConfig("siteid"),this.fbTabClicked=new PubSubTopic,this.setupFBTab()}return createClass(i,[{key:"disable",value:function(){this.enabled=!1,this.fbTab&&(this.fbTab.removeFeedback(),this.fbTab.removeModal())}},{key:"setEnabled",value:function(e){this.enabled=!!e,this.fbTab&&(this.enabled?this.setupFBTab():this.fbTab.setFeedbackVisible(!1))}},{key:"setupFBTab",value:function(){this.renderFBTab(),this.setupDelayedPopup(this.config),this.setupExitPopup(this.config)}},{key:"renderFBTab",value:function(){var e=this;this.fbTab=new FBTab(this.config,function(){return e.fbTabClicked.publishTopic()}),this.fbTab.render(!0),this.displayFBTab(!0)}},{key:"displayFBTab",value:function(e){var n=this.fbTab,t=this.config,i=function(){var e=brUtils.getScroll(window),t=brUtils.getWinSize(window),i=Math.min(t.h/4,(document.body.scrollHeight-t.h)/4);feedbackAPI.getFeedbackEnabled()&&n.setFeedbackVisible(e.y>i)};if(void 0!==t.projectId&&!1!==t.showBadge&&feedbackAPI.getFeedbackEnabled()||(e=!1),"D"===t.triggerbehavior)this.delayFBTabTimer&&clearTimeout(this.delayFBTabTimer),e&&(this.delayFBTabTimer=setTimeout(function(){feedbackAPI.getFeedbackEnabled()&&n.setFeedbackVisible(!0)},1e3*t.triggerdelayseconds));else if("T"===t.triggerbehavior||"S"===t.triggerbehavior)if(e){var r=brUtils.getWinSize(window);document.body.scrollHeight<=r.h?n.setFeedbackVisible(!0):brUtils.addDomEvent(window,"scroll",i)}else brUtils.removeDomEvent(window,"scroll",i),n.setFeedbackVisible(!1);else n.setFeedbackVisible(e)}},{key:"isPopupEnabled",value:function(e){return e.disabled?(logger.warn("Feedback is not enabled in config for project "+e.projectId),!1):!!this.criteria.isDelayedPopupActive(e)||(logger.warn("deplayed popup is not active in this session for project "+e.projectId),!1)}},{key:"setupDelayedPopup",value:function(e){if(!this.hasDelayedPopup(e))return!1;this.startTimer(this.siteId,e.projectId);var t=this;return unloadEvent.addListener(function(){t.handlePageUnload()}),!0}},{key:"setupExitPopup",value:function(e){var n=this;!brUtils.getInstance().isPhoneOrTablet()&&this.hasExitPopup(e)&&brUtils.addDomEvent(document,"mouseout",function(e){var t=e.relatedTarget;if((!t||t!==document&&!dom.nodeBelongsTo(t,document))&&e.clientY<10){var i=n.config;if(n.criteria.isFeedbackShown(i)||!feedbackAPI.getFeedbackEnabled())return!1;window.launchAurycFeedback(i.projectId,!1,!0)}})}},{key:"setup",value:function(e){if(!this.hasDelayedPopup(e))return!1;this.startTimer(this.siteId,e.projectId);var t=this;return unloadEvent.addListener(function(){t.handlePageUnload()}),!0}},{key:"handlePageUnload",value:function(){this.suspendTimer(this.siteId,this.config.projectId)}},{key:"handleTimeout",value:function(){var e=this.config,t=this.siteId;this.criteria.isDelayedPopupActive(e)&&null!==this.getTimeRemain(t,e.projectId)&&(this.setTimeRemain(t,e.projectId,null),window.launchAurycFeedback(e.projectId,!1,!0))}},{key:"handleNavigation",value:function(e){var t=this.config;this.fbTab&&this.displayFBTab(e),this.hasDelayedPopup(t)&&(this.suspendTimer(this.siteId,t.projectId),e&&this.startTimer(this.siteId,t.projectId))}},{key:"hasDelayedPopup",value:function(e){return e.popupDelayEnabled?!!this.isPopupEnabled(e)&&(logger.warn("delayed popup is enabled for project "+e.projectId+", delay: "+e.popupDelaySeconds+" seconds"),!0):(logger.warn("delayed popup is not enabled in config for project "+e.projectId),!1)}},{key:"hasExitPopup",value:function(e){return!(!e.exitPopupEnabled||!this.isPopupEnabled(e))&&(logger.warn("exit popup is enabled for project "+e.projectId),!0)}},{key:"startTimer",value:function(e,t){if(!this.criteria.isFeedbackShown(this.config)){this.delayedPopupTimer&&clearTimeout(this.delayedPopupTimer);var i=this.getTimeRemain(e,t);i||0===i||(i=1e3*this.config.popupDelaySeconds,this.setTimeRemain(e,t,i));var n=this;this.startTime=(new Date).getTime(),this.delayedPopupTimer=setTimeout(function(){n.handleTimeout()},i)}}},{key:"suspendTimer",value:function(e,t){var i=(new Date).getTime()-this.startTime,n=this.getTimeRemain(e,t);if(null!==n){var r=i<n?n-i:0;this.setTimeRemain(e,t,r)}this.delayedPopupTimer&&clearTimeout(this.delayedPopupTimer),this.delayedPopupTimer=null}},{key:"getTimeRemain",value:function(e,t){var i=globalSessionTracker.getSessionMetadata();if(i.isOver)return null;var n=stg.getByKey("TTF_"+e+"_"+t);if(!n)return null;var r=n.split(TTF_TOKEN_DELIMITER);return r[0]!==i.sessionId?null:1*r[1]}},{key:"setTimeRemain",value:function(e,t,i){var n="TTF_"+e+"_"+t;if(null!==i){var r=globalSessionTracker.getSessionMetadata();if(r.isOver)return null;var s=r.sessionId+TTF_TOKEN_DELIMITER+i;stg.setByKey(n,s)}else stg.removeByKey(n)}}]),i}(),FBModel=function(){function t(e){classCallCheck(this,t),this.starsRatings=!1,this.npsRatings="unknown",this.formType=null,this.questionGroup=null,this.fbConfig=e,this.feedbackDef=null,this.htmlElem=null,this.submitting=!1}return createClass(t,[{key:"getDefaultData",value:function(){return"CI6MywibmFtZSI6IkRhbmdkYW5nIFN1cnZleSAyMDE2IiwiZGVzY3JpcHRpb24iOiJ0ZXN0IGZvciBkYW5nZGFuZyIsImxhbmd1YWdlQ29kZSI6bnVsbCwic2l0ZUtleSI6IjEtbHl5dGVzdDFzcG9ydGNvbSIsImNyZWF0ZWREYXRlIjoiMjAxNy0xMi0xOVQxMjoyNjo1MCIsImNyZWF0ZWRVc2VySWQiOjEsImRlbGV0ZWQiOnRydWUsImxhc3RVcGRhdGVEYXRlIjoiMjAxNy0xMi0xOVQxMzoyNToxMyIsImVuYWJsZWQiOmZhbHNlLCJmb3JtQ29uZmlnIjoie1wiYmFja2dyb3VuZENvbG9yXCI6XCIjMTIxNTFBXCIsXCJmb250Q29sb3JcIjpcIiNGRkZGRkZcIixcInRyaWdnZXJiZWhhdmlvclwiOlwiSVwiLFwiYnJhbmRcIjpcInNob3dcIixcInRyaWdnZXJkZWxheXNlY29uZHNcIjpcIjEwXCIsXCJ0cmlnZ2VyaGFsZndheWRvd25wYWdlXCI6ZmFsc2UsXCJ0YXJnZXRpbmdkZXZpY2VkZXNrdG9wXCI6dHJ1ZSxcInRhcmdldGluZ2RldmljZW1vYmlsZVwiOnRydWUsXCJ0cmlnZ2VycGFnZWZpbHRlclwiOlwiQVwiLFwiZmlsdGVycGFnZXNcIjpbXCJcIl0sXCJmaWx0ZXJwYWdlc0luY2x1ZGVcIjpbXCJcIl0sXCJmYmRpcmVjdGlvblwiOlwiaG9yaXpvbnRhbFwiLFwidGFyZ2V0aW5nY2FwXCI6XCIxMDBcIixcInBvcHVwRGVsYXlFbmFibGVkXCI6ZmFsc2UsXCJwb3B1cERlbGF5U2Vjb25kc1wiOlwiMzBcIixcInNwZWNpZmljRm9ybUVuYWJsZVwiOmZhbHNlLFwic3VydmV5VGhyb3R0bGVzXCI6e1wiY29va2llXCI6XCJhdXJ5Yy5mYnRcIixcImFiYW5kb25lZFwiOjcsXCJzdWJtaXR0ZWRcIjo5MCxcInNhbXBsaW5nXCI6MTAwfSxcImZlZWRiYWNrSWRcIjpcIjM0OTlcIixcImljb25cIjpcImFzcGFyazEwMC5wbmdcIixcImRlbGF5XCI6MCxcInRlbXBsYXRlXCI6XCJkZWZhdWx0XCIsXCJsYWJlbFwiOlwiT3B0aW9uUXVlc3Rpb25GZWVkQmFja1wiLFwiZmJsb2NhdGlvblwiOlwibWlkZGxlcmlnaHRcIixcInBvcHVwXCI6ZmFsc2UsXCJkaXNhYmxlZFwiOmZhbHNlLFwiZmJhbmltYXRlXCI6ZmFsc2UsXCJmYmZpeGVkXCI6ZmFsc2UsXCJzYXZlZFwiOlwiXCIsXCJ0b3BpY3NcIjpbe1wib3JkZXJcIjoxLFwiaWRcIjpcIjcyMThcIixcImFuc3dlcklkXCI6XCJDQU8wMDg0Nzg0QTAwMVwiLFwid2hpdGVsaXN0QWN0aXZlXCI6ZmFsc2UsXCJ3aGl0ZWxpc3REYXRhXCI6XCJcIixcInRvcGljVGV4dFwiOlwiTmV3IFF1ZXN0aW9uIEdyb3VwIDFcIn1dfSIsImZlZWRiYWNrVGl0bGUiOiJGZWVkYmFjayBTdXJ2ZXkiLCJsb2dvUGljIjoiaHR0cHM6Ly9mYi1sb2dvLnVzZXJ0eS5jb20vMTQ0N2Y3Y2FjYmJhNzBjNDFjZDRlZDkyMDA3ZDdjMmMvY2MtbG9nby5zdmciLCJwcm9sb2d1ZVRleHQiOiI8aDE+Q2xpY2sgaGVyZSB0byBlbnRlciBzdXJ2ZXkgVGl0bGU8L2gxPjxwPkNsaWNrIGhlcmUgdG8gdHlwZSBXZWxjb21lIE1lc3NhZ2U8L3A+IiwiZXBpbG9ndWVUZXh0IjoiPGgxPldlIEFwcHJlY2lhdGUgWW91ciBGZWVkYmFjazwvaDE+PHA+WW91ciBmZWVkYmFjayB3aWxsIGhlbHAgdXMgaW1wcm92ZTwvcD4iLCJ0b3BpY1F1ZXN0aW9uSWQiOiIxNTEzNjU3NjEwMjA4IiwicmF0aW5nUXVlc3Rpb25JZCI6IjE1MTM2NTc2MTAwOTUiLCJucHNRdWVzdGlvbklkIjoiMTUxMzY1NzYxMDE3NCIsInRvcGljR3JvdXBJZCI6ImM1ZmQ2ZjFiMTM0NTRiMjA5ZjlhYzdlZGVlM2Y4N2YxIiwicHVibGlzaGVkVmVyc2lvbiI6bnVsbCwicHVibGlzaGVkRGF0ZSI6bnVsbCwicXVlc3Rpb25zIjpbeyJpZCI6IjE1MTM2NTc2MTAxNzQiLCJmZWVkYmFja0lkIjozLCJxdWVzdGlvblRleHQiOiJIb3cgbGlrZWx5IGFyZSB5b3UgdG8gcmVjb21tZW5kIFRlc3QgQ29tcGFueSB0byBhIGZyaWVuZCBvciBjb2xsZWFndWU/IiwicmVxdWlyZWQiOnRydWUsIm51bWVyaWMiOnRydWUsInF1ZXN0aW9uVHlwZSI6Ik5QUyIsInF1ZXN0aW9uR3JvdXBJZCI6bnVsbCwicGFyZW50UXVlc3Rpb25JZCI6bnVsbCwicGFyZW50QW5zd2VySWQiOm51bGwsInF1ZXN0aW9uT3JkZXIiOjEsInF1ZXN0aW9uTGFiZWwiOm51bGwsImhpZGRlbiI6ZmFsc2UsIm1pblNjYWxlIjpudWxsLCJtYXhTY2FsZSI6bnVsbCwiYW5zd2VycyI6W3siaWQiOiIxNTEzNjU3NjEwMTc0QTAwMSIsImZlZWRiYWNrSWQiOjMsInF1ZXN0aW9uSWQiOiIxNTEzNjU3NjEwMTc0IiwibGFiZWwiOiJOb3QgQXQgQWxsIExpa2VseSIsInZhbHVlIjowLCJkaXNwbGF5T3JkZXIiOjEsImRpc3BsYXlMYWJlbCI6ZmFsc2UsImRpc3BsYXlWYWx1ZSI6dHJ1ZSwiaXNEZWZhdWx0IjpudWxsfSx7ImlkIjoiMTUxMzY1NzYxMDE3NEEwMDIiLCJmZWVkYmFja0lkIjozLCJxdWVzdGlvbklkIjoiMTUxMzY1NzYxMDE3NCIsImxhYmVsIjpudWxsLCJ2YWx1ZSI6MSwiZGlzcGxheU9yZGVyIjoyLCJkaXNwbGF5TGFiZWwiOmZhbHNlLCJkaXNwbGF5VmFsdWUiOnRydWUsImlzRGVmYXVsdCI6bnVsbH0seyJpZCI6IjE1MTM2NTc2MTAxNzRBMDAzIiwiZmVlZGJhY2tJZCI6MywicXVlc3Rpb25JZCI6IjE1MTM2NTc2MTAxNzQiLCJsYWJlbCI6bnVsbCwidmFsdWUiOjIsImRpc3BsYXlPcmRlciI6MywiZGlzcGxheUxhYmVsIjpmYWxzZSwiZGlzcGxheVZhbHVlIjp0cnVlLCJpc0RlZmF1bHQiOm51bGx9LHsiaWQiOiIxNTEzNjU3NjEwMTc0QTAwNCIsImZlZWRiYWNrSWQiOjMsInF1ZXN0aW9uSWQiOiIxNTEzNjU3NjEwMTc0IiwibGFiZWwiOm51bGwsInZhbHVlIjozLCJkaXNwbGF5T3JkZXIiOjQsImRpc3BsYXlMYWJlbCI6ZmFsc2UsImRpc3BsYXlWYWx1ZSI6dHJ1ZSwiaXNEZWZhdWx0IjpudWxsfSx7ImlkIjoiMTUxMzY1NzYxMDE3NEEwMDUiLCJmZWVkYmFja0lkIjozLCJxdWVzdGlvbklkIjoiMTUxMzY1NzYxMDE3NCIsImxhYmVsIjpudWxsLCJ2YWx1ZSI6NCwiZGlzcGxheU9yZGVyIjo1LCJkaXNwbGF5TGFiZWwiOmZhbHNlLCJkaXNwbGF5VmFsdWUiOnRydWUsImlzRGVmYXVsdCI6bnVsbH0seyJpZCI6IjE1MTM2NTc2MTAxNzRBMDA2IiwiZmVlZGJhY2tJZCI6MywicXVlc3Rpb25JZCI6IjE1MTM2NTc2MTAxNzQiLCJsYWJlbCI6bnVsbCwidmFsdWUiOjUsImRpc3BsYXlPcmRlciI6NiwiZGlzcGxheUxhYmVsIjpmYWxzZSwiZGlzcGxheVZhbHVlIjp0cnVlLCJpc0RlZmF1bHQiOm51bGx9LHsiaWQiOiIxNTEzNjU3NjEwMTc0QTAwNyIsImZlZWRiYWNrSWQiOjMsInF1ZXN0aW9uSWQiOiIxNTEzNjU3NjEwMTc0IiwibGFiZWwiOm51bGwsInZhbHVlIjo2LCJkaXNwbGF5T3JkZXIiOjcsImRpc3BsYXlMYWJlbCI6ZmFsc2UsImRpc3BsYXlWYWx1ZSI6dHJ1ZSwiaXNEZWZhdWx0IjpudWxsfSx7ImlkIjoiMTUxMzY1NzYxMDE3NEEwMDgiLCJmZWVkYmFja0lkIjozLCJxdWVzdGlvbklkIjoiMTUxMzY1NzYxMDE3NCIsImxhYmVsIjpudWxsLCJ2YWx1ZSI6NywiZGlzcGxheU9yZGVyIjo4LCJkaXNwbGF5TGFiZWwiOmZhbHNlLCJkaXNwbGF5VmFsdWUiOnRydWUsImlzRGVmYXVsdCI6bnVsbH0seyJpZCI6IjE1MTM2NTc2MTAxNzRBMDA5IiwiZmVlZGJhY2tJZCI6MywicXVlc3Rpb25JZCI6IjE1MTM2NTc2MTAxNzQiLCJsYWJlbCI6bnVsbCwidmFsdWUiOjgsImRpc3BsYXlPcmRlciI6OSwiZGlzcGxheUxhYmVsIjpmYWxzZSwiZGlzcGxheVZhbHVlIjp0cnVlLCJpc0RlZmF1bHQiOm51bGx9LHsiaWQiOiIxNTEzNjU3NjEwMTc0QTAxMCIsImZlZWRiYWNrSWQiOjMsInF1ZXN0aW9uSWQiOiIxNTEzNjU3NjEwMTc0IiwibGFiZWwiOm51bGwsInZhbHVlIjo5LCJkaXNwbGF5T3JkZXIiOjEwLCJkaXNwbGF5TGFiZWwiOmZhbHNlLCJkaXNwbGF5VmFsdWUiOnRydWUsImlzRGVmYXVsdCI6bnVsbH0seyJpZCI6IjE1MTM2NTc2MTAxNzRBMDExIiwiZmVlZGJhY2tJZCI6MywicXVlc3Rpb25JZCI6IjE1MTM2NTc2MTAxNzQiLCJsYWJlbCI6IkV4dHJlbWVseSBMaWtlbHkiLCJ2YWx1ZSI6MTAsImRpc3BsYXlPcmRlciI6MTEsImRpc3BsYXlMYWJlbCI6ZmFsc2UsImRpc3BsYXlWYWx1ZSI6dHJ1ZSwiaXNEZWZhdWx0IjpudWxsfV19LHsiaWQiOiIxNTEzNjU3NjEwMDk1IiwiZmVlZGJhY2tJZCI6MywicXVlc3Rpb25UZXh0IjoiUGxlYXNlIHJhdGUgeW91ciBleHBlcmllbmNlIG9uIG91ciB3ZWJzaXRlIiwicmVxdWlyZWQiOnRydWUsIm51bWVyaWMiOnRydWUsInF1ZXN0aW9uVHlwZSI6IlNDQUxFRCIsInF1ZXN0aW9uR3JvdXBJZCI6bnVsbCwicGFyZW50UXVlc3Rpb25JZCI6bnVsbCwicGFyZW50QW5zd2VySWQiOm51bGwsInF1ZXN0aW9uT3JkZXIiOjIsInF1ZXN0aW9uTGFiZWwiOm51bGwsImhpZGRlbiI6ZmFsc2UsIm1pblNjYWxlIjpudWxsLCJtYXhTY2FsZSI6bnVsbCwiYW5zd2VycyI6W3siaWQiOiIxNTEzNjU3NjEwMDk1QTAwMSIsImZlZWRiYWNrSWQiOjMsInF1ZXN0aW9uSWQiOiIxNTEzNjU3NjEwMDk1IiwibGFiZWwiOm51bGwsInZhbHVlIjoxLCJkaXNwbGF5T3JkZXIiOjEsImRpc3BsYXlMYWJlbCI6ZmFsc2UsImRpc3BsYXlWYWx1ZSI6dHJ1ZSwiaXNEZWZhdWx0IjpudWxsfSx7ImlkIjoiMTUxMzY1NzYxMDA5NUEwMDIiLCJmZWVkYmFja0lkIjozLCJxdWVzdGlvbklkIjoiMTUxMzY1NzYxMDA5NSIsImxhYmVsIjpudWxsLCJ2YWx1ZSI6MiwiZGlzcGxheU9yZGVyIjoyLCJkaXNwbGF5TGFiZWwiOmZhbHNlLCJkaXNwbGF5VmFsdWUiOnRydWUsImlzRGVmYXVsdCI6bnVsbH0seyJpZCI6IjE1MTM2NTc2MTAwOTVBMDAzIiwiZmVlZGJhY2tJZCI6MywicXVlc3Rpb25JZCI6IjE1MTM2NTc2MTAwOTUiLCJsYWJlbCI6bnVsbCwidmFsdWUiOjMsImRpc3BsYXlPcmRlciI6MywiZGlzcGxheUxhYmVsIjpmYWxzZSwiZGlzcGxheVZhbHVlIjp0cnVlLCJpc0RlZmF1bHQiOm51bGx9LHsiaWQiOiIxNTEzNjU3NjEwMDk1QTAwNCIsImZlZWRiYWNrSWQiOjMsInF1ZXN0aW9uSWQiOiIxNTEzNjU3NjEwMDk1IiwibGFiZWwiOm51bGwsInZhbHVlIjo0LCJkaXNwbGF5T3JkZXIiOjQsImRpc3BsYXlMYWJlbCI6ZmFsc2UsImRpc3BsYXlWYWx1ZSI6dHJ1ZSwiaXNEZWZhdWx0IjpudWxsfSx7ImlkIjoiMTUxMzY1NzYxMDA5NUEwMDUiLCJmZWVkYmFja0lkIjozLCJxdWVzdGlvbklkIjoiMTUxMzY1NzYxMDA5NSIsImxhYmVsIjpudWxsLCJ2YWx1ZSI6NSwiZGlzcGxheU9yZGVyIjo1LCJkaXNwbGF5TGFiZWwiOmZhbHNlLCJkaXNwbGF5VmFsdWUiOnRydWUsImlzRGVmYXVsdCI6bnVsbH1dfSx7ImlkIjoiMTUxMzY1NzYxMDIwOCIsImZlZWRiYWNrSWQiOjMsInF1ZXN0aW9uVGV4dCI6IldoYXQgaXMgeW91ciBmZWVkYmFjayByZWdhcmRpbmc/IiwicmVxdWlyZWQiOnRydWUsIm51bWVyaWMiOmZhbHNlLCJxdWVzdGlvblR5cGUiOiJEUk9QX0RPV04iLCJxdWVzdGlvbkdyb3VwSWQiOiJjNWZkNmYxYjEzNDU0YjIwOWY5YWM3ZWRlZTNmODdmMSIsInBhcmVudFF1ZXN0aW9uSWQiOm51bGwsInBhcmVudEFuc3dlcklkIjpudWxsLCJxdWVzdGlvbk9yZGVyIjozLCJxdWVzdGlvbkxhYmVsIjpudWxsLCJoaWRkZW4iOmZhbHNlLCJtaW5TY2FsZSI6bnVsbCwibWF4U2NhbGUiOm51bGwsImFuc3dlcnMiOlt7ImlkIjoiMTUxMzY1NzYxMDIwOEEwMDIiLCJmZWVkYmFja0lkIjozLCJxdWVzdGlvbklkIjoiMTUxMzY1NzYxMDIwOCIsImxhYmVsIjoibmV3IHRvcGljMSIsInZhbHVlIjoyLCJkaXNwbGF5T3JkZXIiOjEsImRpc3BsYXlMYWJlbCI6dHJ1ZSwiZGlzcGxheVZhbHVlIjpmYWxzZSwiaXNEZWZhdWx0IjpudWxsfSx7ImlkIjoiMTUxMzY1NzYxMDIwOEEwMDMiLCJmZWVkYmFja0lkIjozLCJxdWVzdGlvbklkIjoiMTUxMzY1NzYxMDIwOCIsImxhYmVsIjoibmV3IHRvcGljMiIsInZhbHVlIjozLCJkaXNwbGF5T3JkZXIiOjIsImRpc3BsYXlMYWJlbCI6dHJ1ZSwiZGlzcGxheVZhbHVlIjpmYWxzZSwiaXNEZWZhdWx0IjpudWxsfV19XSwidG9waWNzIjpbeyJpZCI6NiwiZmVlZGJhY2tJZCI6MywidG9waWNBbnN3ZXJJZCI6IjE1MTM2NTc2MTAyMDhBMDAyIiwidG9waWNUZXh0IjoibmV3IHRvcGljMSIsInRvcGljT3JkZXIiOjEsInRvcGljVmFsdWUiOjIsInF1ZXN0aW9ucyI6W3siaWQiOiIxNTEzNjYxMTEzMjExIiwiZmVlZGJhY2tJZCI6MywicXVlc3Rpb25UZXh0IjoiRG8geW91IHdhbnQgdG8gZWF0PyIsInJlcXVpcmVkIjp0cnVlLCJudW1lcmljIjpmYWxzZSwicXVlc3Rpb25UeXBlIjoiUkFESU9fQlVUVE9OIiwicXVlc3Rpb25Hcm91cElkIjoiYzVmZDZmMWIxMzQ1NGIyMDlmOWFjN2VkZWUzZjg3ZjEiLCJwYXJlbnRRdWVzdGlvbklkIjoiMTUxMzY1NzYxMDIwOCIsInBhcmVudEFuc3dlcklkIjoiMTUxMzY1NzYxMDIwOEEwMDIiLCJxdWVzdGlvbk9yZGVyIjo1LCJxdWVzdGlvbkxhYmVsIjpudWxsLCJoaWRkZW4iOmZhbHNlLCJtaW5TY2FsZSI6bnVsbCwibWF4U2NhbGUiOm51bGwsImFuc3dlcnMiOlt7ImlkIjoiMTUxMzY2MTExMzIxMUEwMDEiLCJmZWVkYmFja0lkIjozLCJxdWVzdGlvbklkIjoiMTUxMzY2MTExMzIxMSIsImxhYmVsIjoiWWVzIiwidmFsdWUiOjEsImRpc3BsYXlPcmRlciI6MSwiZGlzcGxheUxhYmVsIjp0cnVlLCJkaXNwbGF5VmFsdWUiOmZhbHNlLCJpc0RlZmF1bHQiOm51bGx9LHsiaWQiOiIxNTEzNjYxMTEzMjExQTAwMiIsImZlZWRiYWNrSWQiOjMsInF1ZXN0aW9uSWQiOiIxNTEzNjYxMTEzMjExIiwibGFiZWwiOiJObyIsInZhbHVlIjoyLCJkaXNwbGF5T3JkZXIiOjIsImRpc3BsYXlMYWJlbCI6dHJ1ZSwiZGlzcGxheVZhbHVlIjpmYWxzZSwiaXNEZWZhdWx0IjpudWxsfV19LHsiaWQiOiIxNTEzNjYxMTEzMjIzIiwiZmVlZGJhY2tJZCI6MywicXVlc3Rpb25UZXh0IjoiSG93IG9sZCBhcmUgeW91PyIsInJlcXVpcmVkIjp0cnVlLCJudW1lcmljIjpmYWxzZSwicXVlc3Rpb25UeXBlIjoiUkFESU9fQlVUVE9OIiwicXVlc3Rpb25Hcm91cElkIjoiYzVmZDZmMWIxMzQ1NGIyMDlmOWFjN2VkZWUzZjg3ZjEiLCJwYXJlbnRRdWVzdGlvbklkIjoiMTUxMzY1NzYxMDIwOCIsInBhcmVudEFuc3dlcklkIjoiMTUxMzY1NzYxMDIwOEEwMDIiLCJxdWVzdGlvbk9yZGVyIjo2LCJxdWVzdGlvbkxhYmVsIjpudWxsLCJoaWRkZW4iOmZhbHNlLCJtaW5TY2FsZSI6bnVsbCwibWF4U2NhbGUiOm51bGwsImFuc3dlcnMiOlt7ImlkIjoiMTUxMzY2MTExMzIyM0EwMDEiLCJmZWVkYmFja0lkIjozLCJxdWVzdGlvbklkIjoiMTUxMzY2MTExMzIyMyIsImxhYmVsIjoiPDUiLCJ2YWx1ZSI6MSwiZGlzcGxheU9yZGVyIjoxLCJkaXNwbGF5TGFiZWwiOnRydWUsImRpc3BsYXlWYWx1ZSI6ZmFsc2UsImlzRGVmYXVsdCI6bnVsbH0seyJpZCI6IjE1MTM2NjExMTMyMjNBMDAyIiwiZmVlZGJhY2tJZCI6MywicXVlc3Rpb25JZCI6IjE1MTM2NjExMTMyMjMiLCJsYWJlbCI6IjV+MTAiLCJ2YWx1ZSI6MiwiZGlzcGxheU9yZGVyIjoyLCJkaXNwbGF5TGFiZWwiOnRydWUsImRpc3BsYXlWYWx1ZSI6ZmFsc2UsImlzRGVmYXVsdCI6bnVsbH0seyJpZCI6IjE1MTM2NjExMTMyMjNBMDAzIiwiZmVlZGJhY2tJZCI6MywicXVlc3Rpb25JZCI6IjE1MTM2NjExMTMyMjMiLCJsYWJlbCI6Ij4xMCIsInZhbHVlIjozLCJkaXNwbGF5T3JkZXIiOjEwLCJkaXNwbGF5TGFiZWwiOnRydWUsImRpc3BsYXlWYWx1ZSI6ZmFsc2UsImlzRGVmYXVsdCI6bnVsbH1dfSx7ImlkIjoiMTUxMzY2MTExMzMzMyIsImZlZWRiYWNrSWQiOjMsInF1ZXN0aW9uVGV4dCI6IlBsZWFzZSBlbnRlciB5b3VyIGNvbW1lbnRzIiwicmVxdWlyZWQiOmZhbHNlLCJudW1lcmljIjpmYWxzZSwicXVlc3Rpb25UeXBlIjoiT1BFTkVORCIsInF1ZXN0aW9uR3JvdXBJZCI6ImM1ZmQ2ZjFiMTM0NTRiMjA5ZjlhYzdlZGVlM2Y4N2YxIiwicGFyZW50UXVlc3Rpb25JZCI6IjE1MTM2NTc2MTAyMDgiLCJwYXJlbnRBbnN3ZXJJZCI6IjE1MTM2NTc2MTAyMDhBMDAyIiwicXVlc3Rpb25PcmRlciI6NywicXVlc3Rpb25MYWJlbCI6bnVsbCwiaGlkZGVuIjpmYWxzZSwibWluU2NhbGUiOm51bGwsIm1heFNjYWxlIjpudWxsfV19LHsiaWQiOjcsImZlZWRiYWNrSWQiOjMsInRvcGljQW5zd2VySWQiOiIxNTEzNjU3NjEwMjA4QTAwMyIsInRvcGljVGV4dCI6Im5ldyB0b3BpYzIiLCJ0b3BpY09yZGVyIjoyLCJ0b3BpY1ZhbHVlIjozLCJxdWVzdGlvbnMiOlt7ImlkIjoiMTUxMzY2MTExMzIzNiIsImZlZWRiYWNrSWQiOjMsInF1ZXN0aW9uVGV4dCI6IkRvIHlvdSBsaWtlIG1lPyIsInJlcXVpcmVkIjp0cnVlLCJudW1lcmljIjpmYWxzZSwicXVlc3Rpb25UeXBlIjoiUkFESU9fQlVUVE9OIiwicXVlc3Rpb25Hcm91cElkIjoiYzVmZDZmMWIxMzQ1NGIyMDlmOWFjN2VkZWUzZjg3ZjEiLCJwYXJlbnRRdWVzdGlvbklkIjoiMTUxMzY1NzYxMDIwOCIsInBhcmVudEFuc3dlcklkIjoiMTUxMzY1NzYxMDIwOEEwMDMiLCJxdWVzdGlvbk9yZGVyIjo3LCJxdWVzdGlvbkxhYmVsIjpudWxsLCJoaWRkZW4iOmZhbHNlLCJtaW5TY2FsZSI6bnVsbCwibWF4U2NhbGUiOm51bGwsImFuc3dlcnMiOlt7ImlkIjoiMTUxMzY2MTExMzIzNkEwMDEiLCJmZWVkYmFja0lkIjozLCJxdWVzdGlvbklkIjoiMTUxMzY2MTExMzIzNiIsImxhYmVsIjoiWWVzIiwidmFsdWUiOjEsImRpc3BsYXlPcmRlciI6MSwiZGlzcGxheUxhYmVsIjp0cnVlLCJkaXNwbGF5VmFsdWUiOmZhbHNlLCJpc0RlZmF1bHQiOm51bGx9LHsiaWQiOiIxNTEzNjYxMTEzMjM2QTAwMiIsImZlZWRiYWNrSWQiOjMsInF1ZXN0aW9uSWQiOiIxNTEzNjYxMTEzMjM2IiwibGFiZWwiOiJObyIsInZhbHVlIjoyLCJkaXNwbGF5T3JkZXIiOjIsImRpc3BsYXlMYWJlbCI6dHJ1ZSwiZGlzcGxheVZhbHVlIjpmYWxzZSwiaXNEZWZhdWx0IjpudWxsfV19XX1dLCJleHRyYUluZm8iOnsicmF0aW5nIjoiUGxlYXNlIHByb3ZpZGUgYSBiYXNpYyByYXRpbmciLCJjaG9vc2UiOiJDaG9vc2XigKYiLCJzdWJtaXQiOiJTdWJtaXQiLCJvayI6Ik9LIiwiZW1haWxlbXB0eSI6IkVtYWlsIGNhbm5vdCBiZSBlbXB0eSIsImVtYWlsdmFsaWQiOiJQbGVhc2UgZW50ZXIgYSB2YWxpZCBlbWFpbCBhZGRyZXNzIiwibnBzWmVybyI6Ik5vdCBBdCBBbGwgTGlrZWx5IiwibnBzVGVuIjoiRXh0cmVtZWx5IExpa2VseSIsInlvdXJBbnN3ZXIiOiJZb3VyIEFuc3dlciIsInBvd2VyZWRCeSI6IlBvd2VyZWQgYnkiLCJsZWZ0IjoiJHtOVU19IGNoYXJhY3RlcnMgbGVmdCJ9fQ==eyJpZ"}},{key:"setupFBDoneHandler",value:function(e){this.fbDoneFn=e}},{key:"hasRequiredQuestions",value:function(e){for(var t=0;t<e.fb.questions.length;t++)if(e.fb.questions[t].required&&!e.fb.questions[t].hidden)return!0;for(var i=0;i<e.topics.length;i++)for(var n=e.topics[i].questions,r=0;r<n.length;r++)if(n[r].required&&!n[r].hidden)return!0;return!1}},{key:"processFeedbackData",value:function(e,t){var i=function(e,t){return e.questionOrder-t.questionOrder},n=function(e,t){return e.displayOrder-t.displayOrder},r=function(e){return!e.hidden};e.mainQ=e.fb.questions.filter(r).sort(i).map(function(e){return e.answers=e.answers.sort(n),e}),e.topics=e.fb.topics.sort(function(e,t){return e.topicOrder-t.topicOrder});for(var s=0;s<e.topics.length;s++)e.topics[s].questions=e.topics[s].questions.filter(r).sort(i).map(function(e){return e.answers&&(e.answers=e.answers.sort(n)),e});e.hasRequiredQuestions=this.hasRequiredQuestions(e),e.formConfig=JSON.parse(e.fb.formConfig),e.extraInfo=e.meta["ext-info"],e.meta=e.meta.info,e.logoPic=e.meta.logo1graphic,e.feedbackTitle=e.meta.surveytitle,e.prologueText=e.meta.prologuetext,this.feedbackDef=e,t&&t(e)}},{key:"getFeedbackData",value:function(n){var r=this;this.feedbackReqTimer=setTimeout(function(){var e=encoder.decodeBase64(r.getDefaultData());r.processFeedbackData(e,n)},5e3);var s=function(e){clearTimeout(r.feedbackReqTimer)},e={fid:this.fbConfig.mid,version:this.fbConfig.version||"1",type:"fb"};asyncReq({type:"GET",url:(this.fbConfig.urlOverride||config.getConfig("fb_view_url","base"))+"?"+buildQuery("",e),onSuccess:function(t){clearTimeout(r.feedbackReqTimer);try{var e=encoder.decodeBase64(t);if(_.isEmpty(e))logger.log("empty feedback json"),s(t);else{var i=JSON.parse(e);r.processFeedbackData(i,n)}}catch(e){logger.warn("Unable to parse feedback definition: "+e),s(t)}},onFailure:s,contentType:"application/json"})}},{key:"getResponseSummary",value:function(){var e=this.npsRatings;return e=0<=e&&e<=6?"detractors":6<e&&e<=8?"passives":8<e?"promoters":"unknown",{starRating:this.starsRatings,npsResponse:e,formType:this.formType,formName:this.fbConfig.label,questionGroup:this.questionGroup}}},{key:"getCBAnswers",value:function(e,t,i){for(var n=[],r=toDomNode(e).sel("input"),s=0;s<r.length;s++){var a=r[s].getAttribute(constants.css.FB_QID);r[s].checked&&n.push({questionId:t,answerId:a,required:i})}return 0===n.length&&n.push({questionId:t,required:i}),n}},{key:"handleSingleNonCB",value:function(e,t,i){var n={},r=toDomNode(e).sel("select"),s=toDomNode(e).sel("input"),a=toDomNode(e).sel("textarea");if(1<=a.length){var o=a[0].value.replace(/\s+/g," ");n.answerText=o.length>=constants.css.TEXT_LIMIT?o.substr(0,constants.css.TEXT_LIMIT-1):o}else if(1<=s.length){var c=s[0],l=c.getAttribute("type");if(l===constants.css.HIDDEN.toLowerCase())n.answerId=c.value;else if(l!==constants.css.RADIO.toLowerCase())n.answerText=c.value;else for(var u=0;u<s.length;u++)s[u].checked&&(n.answerId=s[u].value,toDomNode(e).className.trim()===constants.css.FB_QUESTION&&5===s.length&&(this.starsRatings=u+1),"auryc-nps__container auryc-feedback-fbquestion"===toDomNode(e).className.trim()&&11===s.length&&(this.npsRatings=u))}else if(1<=r.length){var h=r[0];1<=h.selectedIndex&&(n.answerId=h.value,this.questionGroup=h.options[h.selectedIndex].value,n.answerId&&1<=n.answerId.length||(n.skip=!0))}return n.questionId=t,n.required=i,n}},{key:"getIdentity",value:function(){var e=DataLayer.getInstance(constants.symbols.PERMANENT);return e&&e.getUserProp(constants.events.IDENTITYVALUE)}},{key:"assembleResponse",value:function(){var t=this;this.starsRatings=!1,this.npsRatings="unknown",this.questionGroup=null;var e=globalSessionTracker.getSessionMetadata();if(!e.isOver){var i={siteKey:config.getSiteid(),mid:this.fbConfig.mid||this.fbConfig.fid,globalId:e.sessionId,sessionId:e.viewId,url:window.location.href},n=this.getIdentity();n&&0<n.length&&(i.identity=n),this.fbConfig.version?i.version=this.fbConfig.version:i.version&&delete i.version;var r=[];if(1===this.feedbackDef.topics.length){var s=void 0;this.feedbackDef.topics[0].questions.forEach(function(e){e.parentAnswerId===t.feedbackDef.topics[0].topicAnswerId&&(s=e.parentQuestionId)}),r.push({questionId:s,answerId:this.feedbackDef.topics[0].topicAnswerId})}for(var a='.auryc-feedback-fbquestiongroup-shown div[dataType="auryc-fbq"], .'+constants.css.FB_QUESTION,o=this.htmlElem.sel(a),c=0;c<o.length;c++){var l=o[c],u=l.getAttribute(constants.css.FB_QID),h=l.getAttribute(constants.css.FB_QTYPE),g=l.getAttribute(constants.css.REQUIRED);if(h===constants.css.CHECKBOX){var d=this.getCBAnswers(l,u,g);d&&0<d.length&&(r=r.concat(d))}else{var p=this.handleSingleNonCB(l,u,g);!0!==p.skip&&r.push(p)}}i.responses=r;var f=this.htmlElem.sel("#auryc-feedback-canvas canvas")[0];if(f)try{i.image=f.toDataURL("image/png").replace("image/png","image/octet-stream")}catch(e){logger.log(e)}for(var y=this.feedbackDef.fb.topicQuestionId,m=!0,b=i.responses,I={},v=0;v<b.length;v++)"true"===b[v].required&&(b[v].answerId||b[v].answerText&&b[v].answerText.trim()||(I[b[v].questionId]=!0));if("{}"!==JSON.stringify(I)){for(var A=0;A<o.length;A++){var C=o[A],S=C.getAttribute(constants.css.FB_QID);toDomNode(C.querySelectorAll(".auryc-feedback-fblabel")[0]).removeCssCls("aurycIsRequired"),I[S]&&toDomNode(C.querySelectorAll(".auryc-feedback-fblabel")[0]).addCssCls("aurycIsRequired")}return"notValid"}for(var w=0;w<b.length;w++)if(b[w].questionId!==y&&(b[w].answerId||b[w].answerText&&b[w].answerText.trim())){m=!1;break}return m?null:i=JSON.stringify(i)}}},{key:"submitFeedbackResponse",value:function(){var t=this;if(!this.fbConfig.preview){var e=this.assembleResponse();if("notValid"!==e){if(!e)return this.submitted=!1,void(this.fbDoneFn&&this.fbDoneFn());if(!this.submitting){asyncReq({type:"POST",url:config.getConfig("fb_submit_url","base"),data:encoder.encodeBase64(e),onSuccess:function(e){t.submitted=!0,AurycPubSub.publish(constants.events.FEEDBACKTRACKER,{eventType:constants.events.CUSTOM_EVENT,eventName:"Feedback Submitted",tagName:"FeedbackSubmitted",eventProperties:_.extend({formid:t.fbConfig.projectId,name:"Feedback Submitted",respid:JSON.parse(e).respondentId,et:"submitted"},t.getResponseSummary())}),t.fbDoneFn&&t.fbDoneFn()},contentType:"application/json"})}this.submitting=!0}else this.submitted=!1}}},{key:"render",value:function(e,t){var i=this;t=toDomNode(t),this.htmlElem=t,this.modalElem=e,this.setupSelectionMode(t),["TopicSelector","Nps","OpenEnd","Selects","Stars","Emails"].forEach(function(e){i["handle"+e](t)});var n=this.createTempStyle()||"aurycChecked";this.handleCheckableInputs(t,"checkbox",n),this.handleCheckableInputs(t,"radio",n),this.canShowScreenshot()?(toDomNode(this.htmlElem.sel(".auryc-fbmodal-body-selection")[0]).addCssCls("fb-enabled"),toDomNode(this.htmlElem.sel(".auryc-fbmodal-body-fbform")[0]).removeCssCls("fb-enabled"),this.modalElem.htmlElem.addCssCls("formSelection"),this.modalElem.enableFBFormUI(!0)):this.showFeedback()}},{key:"isValid",value:function(){var e=this.htmlElem.sel(".auryc-visible--fbtopic")[0];if(e)for(var t=e.sel(".auryc-fb-validation-msg-section"),i=0;i<t.length;i++)if("none"!==toDomNode(t[i]).getStyle("display"))return!1;return!0}},{key:"showValidationMessage",value:function(e,t){if(e){var i=toDomNode(e.sel(".auryc-fb-validation-msg-section")[0]);t?i.css({display:"block"}):i.css({display:"none"})}}},{key:"handleEmails",value:function(e){e=toDomNode(e);for(var r=this,t=e.sel(".auryc-feedback-email"),i=0;i<t.length;i++){addDomEvent(toDomNode(t[i]).sel("input")[0],"blur",n)}function n(e){var t=e.target||e.srcElement,i="";t.getAttribute("required")&&_.isEmpty(t.value)?i=r.feedbackDef.extraInfo.emailempty||r.feedbackDef.ext.emailempty:_.isEmpty(t.value)||_.isEmail(t.value)||(i=r.feedbackDef.extraInfo.emailvalid||r.feedbackDef.ext.emailvalid);var n=toDomNode(t.parentElement);n.sel(".auryc-fb-validation-msg-section")[0].innerHTML=i,r.showValidationMessage(n,0<i.length)}}},{key:"handleOpenEnd",value:function(e){var t=function(e){var t,i=e.srcElement||e.target;if(constants.css.TEXT_LIMIT-i.value.replace(/\s+/g," ").length-1<0&&(((t=e.keyCode)<37||41<t)&&8!==t&&16!==t))return e.preventDefault(),!1},i=function(e){var t=e.srcElement||e.target,i=constants.css.TEXT_LIMIT-t.value.replace(/\s+/g," ").length;if(toDomNode(t.parentNode).sel(".auryc-feedback-text-remaining")[0].innerHTML=Math.max(0,i),i<0)return t.value=t.value.substr(0,i+t.value.length),!1},n=toDomNode(e).sel("."+constants.css.FB_TEXTAREA);try{for(var r=0;r<n.length;r++){var s=toDomNode(n[r]).sel("textarea")[0];addDomEvent(s,"keydown",t),addDomEvent(s,"keyup",i),addDomEvent(s,"blur",i)}}catch(e){}}},{key:"updateSelects",value:function(e){var t=toDomNode(e).sel("."+constants.css.FB_QB_CHOOSE);[].forEach.call(t,function(e){var t=toDomNode(e),i=t.sel(constants.css.SELECT)[0];0<t.offsetHeight&&toDomNode(i).css({height:t.offsetHeight+constants.css.PX})})}},{key:"handleSelects",value:function(e){var t=this,i=toDomNode(e).sel("."+constants.css.FB_QB_CHOOSE);this.updateUIFn=function(){return t.updateSelects(toDomNode(e))},[].forEach.call(i,function(e){var i,n,t=toDomNode(e),r=t.sel("select")[0],s=t.sel("div.auryc-feedback-select-button")[0];toDomNode(r).css({height:t.offsetHeight+"px"}),addDomEvent(r,"change",(i=s,n=r,function(e){var t=toDomNode(n).sel("option")[n.selectedIndex];i.innerHTML=t.innerHTML}))})}},{key:"updateFBUI",value:function(){this.updateUIFn&&this.updateUIFn()}},{key:"optionSelect",value:function(){return function(e){13===(e.keyCode?e.keyCode:e.which)&&(e.target.click(),e.stopPropagation(),e.preventDefault())}}},{key:"createTempStyle",value:function(){var e="aurycCheckedOverride";if(this.fbConfig.backgroundColor&&_.isValidColor(this.fbConfig.backgroundColor)){var t=this.fbConfig.backgroundColor,i=document.createElement("style");i.type="text/css";var n=".auryc-feedback .auryc-feedback-checkbox."+e+":before { color: "+t+";content: '\\f14a'; opacity: 1.0; } .auryc-feedback .auryc-feedback-radio."+e+":before { color: "+t+";content: '\\f111'; opacity: 1.0; } ";i.styleSheet?i.styleSheet.cssText=n:i.appendChild(document.createTextNode(n)),document.getElementsByTagName("head")[0].appendChild(i)}else e=null;return e}},{key:"handleCheckableElemsCheckUncheck",value:function(e,t,i){return function(){e.querySelectorAll("label").forEach(function(e){(e=toDomNode(e)).querySelectorAll("input[type="+t+"]")[0].checked?e.addCssCls(i):e.removeCssCls(i)})}}},{key:"handleCheckableInputs",value:function(e,i,n){var r=this;e.querySelectorAll('[dataType="auryc-feedback-'+i+'"]').forEach(function(t){addDomEvent(t=toDomNode(t),"keydown",r.optionSelect()),t.querySelectorAll("input[type="+i+"]").forEach(function(e){addDomEvent(e,"change",r.handleCheckableElemsCheckUncheck(t,i,n))})})}},{key:"handleNps",value:function(e){var t=(e=toDomNode(e)).sel(".nps-rating__badges"),a="";this.fbConfig.backgroundColor&&_.isValidColor(this.fbConfig.backgroundColor)&&(a=this.fbConfig.backgroundColor);var o="";this.fbConfig.fontColor&&_.isValidColor(this.fbConfig.fontColor)&&(o=this.fbConfig.fontColor);for(var i=function(n,r){return function(e){for(var t=e.target||e.srcElement||e.originalTarget,i=0;i<n.length;i++)n[i]!==t&&n[i]!==t.parentNode||r[i].checked||(toDomNode(n[i]).style.backgroundColor=a,toDomNode(n[i]).style.color=o)}},n=function(n,r){return function(e){for(var t=e.target||e.srcElement||e.originalTarget,i=0;i<n.length;i++)n[i]!==t&&n[i]!==t.parentNode||r[i].checked||(toDomNode(n[i]).style.backgroundColor="",toDomNode(n[i]).style.color="")}},r=function(n,r){return function(e){for(var t=e.target||e.srcElement||e.originalTarget,i=0;i<n.length;i++)n[i]===t||n[i]===t.parentNode?(toDomNode(n[i]).addCssCls("aurycNpsRatingChecked"),toDomNode(n[i]).style.backgroundColor=a,toDomNode(n[i]).style.color=o,r[i].checked=!0):(toDomNode(n[i]).removeCssCls("aurycNpsRatingChecked"),toDomNode(n[i]).style.backgroundColor="",toDomNode(n[i]).style.color="",r[i].checked=!1)}},s=function(e,t,i){for(var n=0;n<t.length;n++){var r=t[n],s=e[n];toDomNode(s).addCssCls("auryc-ratings-chosen"),r.checked=n===c?(toDomNode(s).addCssCls("aurycNpsRatingChecked"),toDomNode(s).style.backgroundColor=a,toDomNode(s).style.color=o,!0):(toDomNode(s).removeCssCls("aurycNpsRatingChecked"),toDomNode(s).style.backgroundColor="",toDomNode(s).style.color="",!1)}i.stopPropagation(),i.preventDefault()},c=0,l=function(t,i){return function(e){switch(e.which){case 37:-1===--c&&(c=t.length-1),s(t,i,e);break;case 39:++c===t.length&&(c=0),s(t,i,e)}}},u=0;u<t.length;u++){var h=toDomNode(t[u]),g=h.sel("label"),d=h.sel("input");addDomEvent(h,"keydown",l(g,d));for(var p=0;p<g.length;p++)addDomEvent(g[p],"mouseenter",i(g,d)),addDomEvent(g[p],"mouseleave",n(g,d)),addDomEvent(g[p],"click",r(g,d))}}},{key:"handleStars",value:function(e){var t=(e=toDomNode(e)).sel("fieldset.auryc-fb-starrating-field"),l=function(e){for(var t=0;t<e.length;t++)toDomNode(e[t]).removeCssCls("auryc-ratings-chosen")},s=function(e,t,i,n){l(t);for(var r=0;r<i.length;r++){var s=i[r];if(toDomNode(t[r]).addCssCls("auryc-ratings-chosen"),r===a){s.checked=!0;break}}e.addCssCls("sr-rating-set"),n.stopPropagation(),n.preventDefault()},a=0;[].forEach.call(t,function(t,e){var i,n,r,o=(t=toDomNode(t)).sel("label"),c=t.sel("input");addDomEvent(t,"keydown",(i=t,n=o,r=c,function(e){switch(e.which){case 37:-1==--a&&(a=n.length-1),s(i,n,r,e);break;case 39:++a===n.length&&(a=0),s(i,n,r,e)}})),[].forEach.call(c,function(e){var r,s,a;addDomEvent(e,"click",(r=t,s=o,a=c,function(e){var t=e.target||e.srcElement||e.originalTarget;l(s);for(var i=0;i<a.length;i++){var n=a[i];if(toDomNode(s[i]).addCssCls("auryc-ratings-chosen"),n===t){t.checked=!0;break}}r.addCssCls("sr-rating-set"),setTimeout(function(){return toDomNode(r).removeCssCls("sr-rating-set")},150)}))})})}},{key:"disableDefault",value:function(e){e&&e.preventDefault&&e.preventDefault()}},{key:"showTopic",value:function(e,t,i){var n=i.value,r=t.sel(".auryc-feedback-fbquestiongroup-shown");[].forEach.call(r,function(e){toDomNode(e).replaceCssCls("auryc-feedback-fbquestiongroup-shown","auryc-feedback-fbquestiongroup")});try{toDomNode(document.getElementById("topk_"+n)).replaceCssCls("auryc-feedback-fbquestiongroup","auryc-feedback-fbquestiongroup-shown"),e.topic=n}catch(e){}this.updateFBUI()}},{key:"handleTopicSelector",value:function(t){var i=this,n=t.sel("."+constants.css.FB_TOPIC_SEL)[0],r=this;n&&addDomEvent(n,"change",function(e){r.showTopic(r,t,n),i.disableDefault(e)}),1===this.feedbackDef.topics.length&&(toDomNode(document.getElementById("topk_"+this.feedbackDef.topics[0].topicAnswerId)).replaceCssCls("auryc-feedback-fbquestiongroup","auryc-feedback-fbquestiongroup-shown"),this.updateSelects(t))}},{key:"setupSelectionMode",value:function(e){var t=this;this.submitted=!1,addDomEvent(e.querySelectorAll(".auryc-feedback-screenshot")[0],"click",function(e){return t.takeScreenshot(),t.disableDefault(e),!1}),addDomEvent(e.querySelectorAll(".auryc-feedback-general")[0],"click",function(e){return t.showFeedback(),t.disableDefault(e),!1}),[].forEach.call(e.querySelectorAll(".auryc-feedback-title-section h1"),function(e){toDomNode(e).addCssCls(constants.css.HEADING_H1)}),addDomEvent(document.getElementById("post-fb-resp-button"),"click",function(e){return!t.submitted&&t.isValid()&&t.submitFeedbackResponse(),t.disableDefault(e),!1})}},{key:"takeScreenshot",value:function(){this.modalElem.htmlElem.removeCssCls("formSelection");ScreenShot.mark("Click on any part of this page you would like to give feedback about.",this.updateScreenshot.bind(this),this.modalElem),this.modalElem.enableFBFormUI(!1),this.formType="screenshot"}},{key:"canShowScreenshot",value:function(){return!0!==this.fbConfig.specificFormEnable&&window.location.hash.indexOf("screenshot"),!1}},{key:"updateScreenshot",value:function(e){var t=this.htmlElem.sel("#auryc-feedback-canvas")[0];t.innerHTML="",t.appendChild(e.canvas),document.getElementById(e.answerDomId).click(),document.getElementById("post-fb-resp-button").click()}},{key:"showFeedback",value:function(){toDomNode(this.htmlElem.sel(".auryc-fbmodal-body-selection")[0]).removeCssCls("fb-enabled"),toDomNode(this.htmlElem.sel(".auryc-fbmodal-body-fbform")[0]).replaceCssCls("auryc-fbmodal-body-fbform","auryc-fbmodal-body-fbform-enabled"),this.modalElem.getModalContainerDomNode().removeCssCls("formSelection"),this.modalElem.enableFBFormUI(!0),this.formType="feedbackform"}}]),t}(),cache={},Templater=function(){function n(){classCallCheck(this,n)}return createClass(n,null,[{key:"tmpl",value:function(e,t){var i=/\W/.test(e)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+e.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):cache[e]=cache[e]||n.tmpl(document.getElementById(e).innerHTML);return t?i(t):i}},{key:"instantiate",value:function(e,t){return n.tmpl(e,t)}}]),n}(),FBView=function(){function n(e,t,i){classCallCheck(this,n),this.model=e,this.cfg=e.fbConfig,this.browser=getInstance(),this.bodyOverflowStyle=null,this.bodyScrollTop=0,this.spinnerNode=null,e.fbConfig.launchedFromTimer||this.init(),this.isFbSubmitted=!1,this.fbCanceledFn=i,this.fbFormTmpl=this.getTemplateContent(constants.symbols.FEEDBACKCONTENT,this.cfg.deviceType),this.tyTmpl=this.getTemplateContent(constants.symbols.FBTHANKYOU),this.handleFBInteractions(e,t,i)}return createClass(n,[{key:"initSpinner",value:function(){this.spinnerNode=toDomNode('<img src="data:image/gif;base64,R0lGODlhKAAoAPYAAP7+/s3Nzf39/c7OztbW1u3t7eTk5Ovr6+Dg4PX19dDQ0Ofn5/Pz897e3tPT0/v7++Hh4dHR0fr6+urq6vz8/Nvb2/j4+PDw8NjY2Pn5+c/Pz9TU1O/v7/f399LS0tfX1+7u7vb29uXl5ePj4/T09Ojo6Nzc3Obm5tra2nh4ePHx8fLy8mZmZqWlpRISEtnZ2YeHh9XV1VpaWpmZmQwMDAMDAwYGBpaWliQkJGlpaTMzM8PDwzAwMDw8PN/f3+np6UtLSwkJCbS0tN3d3RsbGw8PD+Li4ioqKuzs7B4eHq6urhgYGDY2Nqurq0hISJycnHJycsnJyY2NjYSEhLe3t3t7e1FRUWNjY8DAwD8/P35+fi0tLSEhIbGxsTk5OaioqE5OTr29vYGBgScnJ5+fn8bGxpCQkEJCQmBgYHV1dRUVFbq6ulRUVIqKipOTk29vb11dXWxsbFdXV0VFRaKiogAAAMzMzP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFCgB3ACH+IFJlc2l6ZWQgd2l0aCBlemdpZi5jb20gR0lGIG1ha2VyACwAAAAAKAAoAAAH/4B3goOEhYRehomKi4o6dUyMkZKEdXVyk5h3HgEOhpVOhjJ1YJmEAXZ2nnU9hkt1PKWDDqgehZWwhGeVcLGDGqgYlHU4hFeVrL2CMagKwkuEjjVxyYMKqBuDlUGDYJVAmdiGL6gDg0nngy51RIlwyIQeqBGGEagfiaJ1VoZONXUyhWahstOJkIJ7itB8I2SFSKU6LAzFGDBQQ4xkVsY81IFmUbyBzTLFYfJwDJtJ1lDFchhkTikCA8JlAuNlGrWbOHPKGshTA7VfPFF1+hjUjs9kQIt62FAU1dFeSYN2ihHhQ4wNERRoeBprq4IIG2J8iHBRp9mzkwhoKJjJg4IXpYPqqSw1cJ4kgcxKYYjK1hDMgQMIJHNA0angQkwH9r2j4HCiD7Xg8ZQpKGVkQnIdE0q8+I5cysoQEhpnp5wgr4MGPi6L8lpqOwEGfbycbJmdkILIEQIajFrh3rmNEiKQdzCtQk4LpWRd6lQq5LcNneLalqAheYaY0tZ5HO2iX9S9K6cWCAAh+QQFCgB3ACwSAAAAFgAWAAAHU4B3CneEhYaHhxp2GoiNiHZ2Ho6ThJARlJOQg5iNkIycj4ugoQOjh5ABpoYDrKqur7CxsrO0tbaER3W6u3VWoLm8u0CcwMG9nFtqYzpAcnFAcHeBACH5BAUKAHcALBcAAgAOAB0AAAdbgHeCg4SFgxt2DoaFAXYai4MKdnYxkHcEkwqWdxqTGJYekx6bk3abiImbl6Oqra6vsLGys7S1totgZ2+qRHVFTpZvXnXEXHKWVlvEdTxolmBLy2ybc8THmyzOgQAh+QQFCgB3ACwXAAkADgAdAAAHXIB3goOEdwQRhYkRdnYbiYIejIwEiQ4DkhoxhRgaknYOj3eSiKF3HgoYpaqrrK2ur7CxsrO0dzlOqzJ1dVarLnVEq0C7YKs6dTVxqle7PatZu3CrS3U8q3J1QLWBACH5BAUKAHcALBIAEgAWABYAAAdLgHeCg4SCGnaIiXYOhY2GiooejoWHkIiMk4MaGgoRGzEfETGZpKWmp6ipqqusra6DOrGtdXVBs3VLtzi3PLc9t063cq06dUyuXq6BACH5BAUKAHcALAkAFwAcAA8AAAdegHeCg4SFhoeIiYIeCi+Kj4R2khGQjxgakpIOlYoOA5kaBIVZV5yLmXYbg2d1dSymghGSqndQrVuwgx8xgz2tcrmGaK09wYZHdTVvxoRWrWDMhEx1XNGEYDTQ1tuHgQAh+QQFCgB3ACwCABcAHAAPAAAHXoB3goOEhYaHhlc6coiNh2d1dWOOlHdWRJF1WZWIV1uZR1echzKZOFajgh8ehD11NkCpght2dg6EMjmyg7V2u4getay/hhq1GMSFBLUKyYUKtTHOhAF2GtODtMPYg4EAIfkEBQoAdwAsAAASABUAFgAAB0yAd1Z1hIV1OHeJiot3QIaGiIyMg4+EkZKLcEBxckA6Y2pjmKOkpaanqKmqq6ytrq+jGhoKrXZ2AbV2A7kavLm0rLYRuR6tGna9rbSBACH5BAUKAHcALAIACQAOAB0AAAdbgHdwd4SFhoRWdUFzh4dsdZBjbI2FcFuQdTqDlHdWaphZnIRZkDiihGhbMqesra6vsLGys7S1tAoErBF2drmcL7wDpwq8G6IxvAqnA7wYog68HqcBvKwedg6zgQAh+QQFCgB3ACwCAAIADgAdAAAHW4B3goOEhYZAamCGhUx1XIuEVnV1ipCCOnU1b5Z3aJM9nHc9k3KcUJNboWeTOaFeV6GxsrO0tba3uLm5BBoOnBF2wZAOwcEKhgQDxQMEhhvFdr6LCsEeoTEfoYEAIfkEBQoAdwAsAAAAABUAFgAAB1WAd4KDhIWEXoaJhjp1TIqPd3V1cpCKkk6ViZI9mYaSPJ2FkjihhJJLpYOSQamCSa+tsbKztLW2t4UOdru8dhqVHr29v5AbwrzEkDERHzEbEQoayYqBACH5BAUKAHcALAIAAgAcAA8AAAdagHeCg4SFhoeIiYgydWCKj4RLdTyQkGd1dXCVileYPZuKOnU1caCIYJhAgxumhC51RIMednYRrYx1VoMOtLQOpmiqhDEDvRoxrYazvQrJhgq9zoYEA6zS14WBADs=" class="auryc-feedback-spinner" id="auryc-feedback-spinner" style="width:40px !important;height:40px !important;">')}},{key:"getTemplateContent",value:function(e,t){t&&"desktop"===t.toLowerCase()&&(e=constants.symbols.FEEDBACKCONTENT_DESKTOP);var i=window[e];return encoder.decodeBase64(i)}},{key:"getModalDomNode",value:function(){return this.modalInnerContent}},{key:"getModalContainerDomNode",value:function(){return this.rootNode}},{key:"handleFBInteractions",value:function(t,e,i){var n=this;t.getFeedbackData(function(e){n.fbmodel=e,t.fbConfig.launchedFromTimer&&n.init(),n.renderFB()});t.setupFBDoneHandler(function(){n.modalInnerContent.replaceCssCls("auryc-fbmodal-body","auryc-fbmodal-body-enabled"),n.isFbSubmitted=!0,n.displayTYPage(),e&&e()})}},{key:"adjustSpinnerPos",value:function(){var e=getWinSize(window),t=this.getModalContainerDomNode();t.appendChild(this.spinnerNode);var i=t.offsetWidth-this.spinnerNode.offsetWidth,n={};n[constants.css.TOP]=(e.h-this.spinnerNode.offsetHeight)/2+constants.css.PX,n[constants.css.LEFT]=i/2+constants.css.PX,this.spinnerNode.css(n)}},{key:"removeSpinner",value:function(){this.spinnerNode&&this.spinnerNode.parentNode&&(this.spinnerNode.parentNode.removeChild(this.spinnerNode),this.spinnerNode=null)}},{key:"addSpinner",value:function(){this.removeSpinner(),this.initSpinner(),this.adjustSpinnerPos()}},{key:"hideMyself",value:function(e){this.rootNode.parentNode&&this.rootNode.parentNode.removeChild(this.rootNode),this.enableBodyOverflow(!0,e)}},{key:"trackAbandoned",value:function(){AurycPubSub.publish(constants.events.FEEDBACKTRACKER,{eventType:constants.events.CUSTOM_EVENT,eventName:"Feedback Abandoned",tagName:"FeedbackAbandoned",eventProperties:{formid:this.cfg.projectId,name:"Feedback Abandoned",et:"abandoned"}})}},{key:"trackAbandonEvents",value:function(t){var i=this;addDomEvent(t,"click",function(e){e.target===t&&(i.isFbSubmitted||(i.trackAbandoned(i),i.fbCanceledFn&&i.fbCanceledFn()),i.hideMyself())})}},{key:"displayTYPage",value:function(){var e=this;this.getModalDomNode().innerHTML=Templater.instantiate(this.tyTmpl,this.fbmodel),this.adjustModalPos();var t=this.getModalDomNode().sel(".auryc-close-btn")[0];t&&(t.focus(),addDomEvent(t,"click",function(){e.hideMyself()}))}},{key:"init",value:function(){var t=this,e=document.createElement("div");e.innerHTML='<div class="auryc-fbmodal-wrapper" style="height:'+getMaxWinHeight()+'">\n      <div class="auryc-fbmodal-bground"></div>\n      <div class="auryc-fbmodal-container">\n        <div class="auryc-fbmodal-content">\n          <div class="auryc-fbmodal-head">\n            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAAAXNSR0IArs4c6QAAAhpJREFUWAntmLFuwjAQhkkjMYD6HBUSA2ufoBsbYugjdGnnTh068xQdKFIrsfEEfYIi8RwVqCpE6f0oZzkmiS/2DQxYAnO5+L+Pi+P40ulcWnMGEtc9Ho+vsyx76vV6r4vFInP9GvZkMkl3u91zmqaz5XL5Y2te2UYBs8rz/GW73b5hoO3X+A1NaCMG/fEVYtq6JkMWzK11wrzf799rZYphSH/KMZIk+aJM3XGmTIZwmYjahsGYqVamqmAQADERG7/RDBDmDNnz49HyVzRUHUwRZl7EPppmjqzX63w0Gn3u9/sb8gzLTJ0hjsOP8xxfo+mDcaeEAYKqNlRbGDCUgDShQmAqgTSgQmFqgWKgYmAagUKgYmEQ0yyMMOqaJBDGYs2izix6lp54gRUBQdgHVQSPgoGGGAgne6BwitvEmeGBJ7c9O6p6zzrlDmkNA4FWQBgghAqCgb55lsE4h9Y6Q8J5FPzsawUkhOFEB0GJgTww2LZ80yd6lyAC8sFgC9Htdj80ti5eIAkMtrieu098+RqBpDA8aTSgaoHawmhBVQKFwmhAnQDFwsRClYC0YGKgDJA2TCiUeZah1iaR6P0Mg9g9lgWsVXSssu4rYh+HGCAU/ihrbSEIuHWT4xebdVBFKT1jodIGzanv1WA4GHp7arh1PfxmDsHYbDZ/g8HgnertX8rMo9ZLBmhz48XzcDhkdFUe+CUD+y+9LwP/zXFjLMMtVtQAAAAASUVORK5CYII=" class="auryc-fb-modal-closebtn" tabindex="0">\n          </div>\n          <div class="auryc-fbmodal-body"></div>\n        </div>\n        </div>\n    </div>',e=e.firstChild,this.rootNode=addDomMethods(e),this.headElem=addDomMethods(e.querySelectorAll(".auryc-fbmodal-head")[0]),this.modalInnerContent=addDomMethods(e.querySelectorAll(".auryc-fbmodal-body")[0]),document.body.appendChild(e),this.enableBodyOverflow(!1,window),addDomEvent(e.querySelectorAll(".auryc-fb-modal-closebtn")[0],"click",function(){return t.handleClose()}),addDomEvent(document,"keydown",function(e){27===e.which&&(t.handleClose(),e.stopPropagation(),e.preventDefault())}),this.cfg.launchedFromTimer||this.addSpinner();var i=e.querySelectorAll(".auryc-fbmodal-bground")[0];-1===i.className.indexOf("enabled")&&(i.className="auryc-fbmodal-bground-enabled",i.focus()),this.trackAbandonEvents(e.querySelectorAll("."+constants.css.FBMODAL_CONTAINER)[0])}},{key:"enableBodyOverflow",value:function(e){var t=toDomNode(window.document.body);e?this.bodyOverflowStyle&&(t.css(this.bodyOverflowStyle),this.browser.isPhoneOrTablet()&&(t.scrollTop=this.bodyScrollTop),this.bodyOverflowStyle=null,this.bodyScrollTop=0):(this.bodyOverflowStyle||(this.bodyOverflowStyle={overflow:t.style.overflow},this.browser.isPhoneOrTablet()&&(this.bodyOverflowStyle.position=t.getStyle("position"),this.bodyScrollTop=t.scrollTop)),t.css({overflow:"hidden"}),this.browser.isPhoneOrTablet()&&setTimeout(function(){t.css({position:"fixed"})},200))}},{key:"renderFB",value:function(){this.isFbSubmitted=!1,this.cfg.preview||AurycPubSub.publish(constants.events.FEEDBACKTRACKER,{eventType:constants.events.CUSTOM_EVENT,eventName:"Feedback Started",tagName:"FeedbackStarted",eventProperties:{formid:this.cfg.projectId,name:"Feedback Started",et:"started"}}),this.removeSpinner(),this.headElem.replaceCssCls("auryc-fbmodal-head","auryc-fbmodal-head-enabled"),this.cfg&&(this.cfg.fontColor&&_.isValidColor(this.cfg.fontColor)&&(this.fbmodel.formConfig.btnFontColor=this.cfg.fontColor),this.cfg.backgroundColor&&_.isValidColor(this.cfg.backgroundColor)&&(this.fbmodel.formConfig.btnBackgroundColor=this.cfg.backgroundColor));var e=Templater.instantiate(this.fbFormTmpl,this.fbmodel);this.modalInnerContent.innerHTML=e,this.model.render(this,this.modalInnerContent)}},{key:"adjustModalPos",value:function(){this.browser.isPhoneOrTablet()||addDomMethods(this.rootNode.querySelectorAll(".auryc-fbmodal-content")[0]).css({marginTop:Math.max(0,(getWinSize(window).h-this.modalInnerContent.offsetHeight-50)/2)+"px"})}},{key:"enableFBFormUI",value:function(e){this.enableBodyOverflow(!e),this.rootNode.style.display=e?"":"none",e&&(this.adjustModalPos(),this.modalInnerContent.replaceCssCls("auryc-fbmodal-body","auryc-fbmodal-body-enabled"),this.model.updateFBUI())}},{key:"handleClose",value:function(){this.cfg.preview||(this.trackAbandoned(this),this.fbCanceledFn&&this.fbCanceledFn()),this.hideMyself()}}]),n}(),ScreenShot$1=function(){function e(){classCallCheck(this,e)}return createClass(e,[{key:"mark",value:function(){}}]),e}(),PopupController=function(){function e(){classCallCheck(this,e),this.popups=[],this.cookie=null}return createClass(e,[{key:"getPopup",value:function(e){for(var t=this.popups.length,i=0;i<t;i++){var n=this.popups[i];if(n.cfg.uid===e)return n}return!1}},{key:"setCookie",value:function(e,t){var i={path:"/",domain:getRootDomain(window.location.hostname),encode:!0};if(e){var n=new Date,r=t||90,s=n.getTime()+24*r*60*60*1e3;n.setTime(s),i.expires=n.toUTCString(),this.cookie=new Cookie(i),this.cookie.setVal(e,s)}else logger.error("throttle cookie is not defined")}},{key:"hasPopup",value:function(){return 0<this.popups.length}},{key:"initialize",value:function(i,e){var n=this;i.deviceType=i.deviceType||getInstance().features.deviceType;var t=this.getPopup(i.uid);t=new PopupUI(i,function(){if(i.launchedFromTimer){var e=i.feedbackThrottles&&i.feedbackThrottles.submitted||90,t=i.feedbackThrottles&&i.feedbackThrottles.cookie||"auryc.fbt";n.setCookie(t,e)}},function(){if(i.launchedFromTimer){var e=i.feedbackThrottles&&i.feedbackThrottles.abandoned||7,t=i.feedbackThrottles&&i.feedbackThrottles.cookie||"auryc.fbt";n.setCookie(t,e)}}),this.popups.push(t),e&&i.trigger&&i.trigger.fbTab&&i.trigger.fbTab.setClicked()}}]),e}(),PopupUI=function e(t,i,n){classCallCheck(this,e),this.cfg=t,this.fbView=new FBView(new FBModel(this.cfg),i,n)},globalPopupController=new PopupController,Preview=function(){function i(){classCallCheck(this,i);var e=window.location.hash;if(this.previewmode=!!getHashParam(e,"previewmode")&&getHashParam(e,"previewmode").toLowerCase(),this.previewfbTabmode=getHashParam(e,"previewbadgemode")?getHashParam(e,"previewbadgemode").toLowerCase():!!getHashParam(e,"previewfbtabmode")&&getHashParam(e,"previewfbtabmode"),this.previewfbTabmode){var t=getHashParam(e,"cfg");this.config=t?JSON.parse(t):{}}else this.previewmode&&(this.mid=getHashParam(e,"mid"),this.backgroundColor=getHashParam(e,"backgroundColor"),this.fontColor=getHashParam(e,"fontColor"),this.url=getHashParam(e,"datauri"))}return createClass(i,[{key:"showFeedback",value:function(){var e={urlOverride:this.url,preview:!0,backgroundColor:this.backgroundColor,mid:this.mid,fontColor:this.fontColor,deviceType:this.previewmode};globalPopupController.initialize(e)}},{key:"initFBTab",value:function(){new FBTab(_extends({},this.config,{preview:!0})).render(!0)}},{key:"displayFBTab",value:function(){var e=this,t=this.config;t.delay&&0<t.delay?setTimeout(function(){return e.initFBTab()},t.delay):this.initFBTab()}}]),i}(),Criteria=function(){function e(){classCallCheck(this,e),this.sessionStorage=DataLayer.getInstance(constants.symbols.SESSION)}return createClass(e,[{key:"isConfigInstanceActive",value:function(e,t){var i=getInstance();if(e.disabled)return!1;if(100*Math.random()>=e.targetingcap)return!1;if(!(i.isPhoneOrTablet()&&e.targetingdevicemobile||!i.isPhoneOrTablet()&&e.targetingdevicedesktop))return!1;if("A"!==e.triggerpagefilter){var n="string"==typeof e.filterpages?e.filterpages.split(","):e.filterpages||[],r="string"==typeof e.filterpagesInclude?e.filterpagesInclude.split(","):e.filterpagesInclude||[];if("I"===e.triggerpagefilter&&!containsUrl(t,r))return!1;if("E"===e.triggerpagefilter&&containsUrl(t,n))return!1}return!0}},{key:"isDelayedPopupActive",value:function(e){if(this.isFeedbackShown(e))return!1;var t=!1,i=e.feedbackThrottles;if(i){var n=i.sampling;if(void 0===n)return t;if(0===n)t=!1;else{var r="auryc.fbt."+(e.projectId||"1"),s=this.sessionStorage.getByKey(r);if(s)t="t"===s;else t=100*Math.random()<n,this.sessionStorage.setByKey(r,t?"t":"f")}}else t=!0;return t}},{key:"isFeedbackShown",value:function(e){var t=e&&e.feedbackThrottles&&e.feedbackThrottles.cookie||"auryc.fbt";return!!Cookie.Get(t)}}]),e}();function initTemplate(){window[constants.symbols.FEEDBACKCONTENT]="iBjbGFzcz0iYXVyeWMtZmJtb2RhbC1ib2R5LXNlbGVjdGlvbiI-CiAgPGRpdiBjbGFzcz0iYXVyeWMtZmJtb2RhbC1ib2R5LXNlbGVjdGlvbl90aXRsZSI-SG93IHdvdWxkIHlvdSBsaWtlIHRvIGdpdmUgZmVlZGJhY2s_PC9kaXY-CiAgPGRpdiBjbGFzcz0iYXVyeWMtZmVlZGJhY2stc2NyZWVuc2hvdCI-CiAgICA8ZGl2IGNsYXNzPSJhdXJ5Yy1mZWVkYmFja19vcHRpb25fcm93Ij4KICAgICAgPGRpdiBjbGFzcz0iYXVyeWMtZmVlZGJhY2tfb3B0aW9uX2NvbHVtbiBhdXJ5Yy1mZWVkYmFja19vcHRpb25faW1hZ2UiPgogICAgICAgIDxpbWcgc3JjPSJkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUNVQUFBQWdDQVlBQUFDVlU3R3dBQUFCZkVsRVFWUllSKzJYcTI2RVVCQ0d6NkFRS0ZiMVNWcUJhcXE0R0lJc21GNDA0UVc2ZlFHQzdzV1FTb0xob3BwVmlQWko2bEFJRk5NYzBtMEkzZTZXeTFsSXczRW5oSm52L1A4d1p3QXl3d1V6WkNJTDFGOWRXWlRxckpRc3kwaGZTdE8wVm8vRm51TzQremlPMTRmZ3Z1MWpBYkh2a1B2QTVsdFRiWlVPeWN2NitjNzZZWkcweThHUFp0Ly9nT3B5aXI3V2RzbXgxRlN6YjAzV3B4QVJORTI3UnNRclJEeWxJQUR3RGdEUFVSUTlBVUI5aTdRWE0vdDBYVDhweS9LRkVITCtpeW9ibnVjdnd6RDhPQW9VVlVoUmxGY0t0RnF0MERSTjhEeXZ6bTNiTnZGOUgvTThwNEpza2lTNWFDdkdwRStwcW5wVFZkV0RLSXJvdWk0SWdrQU13NmloZ2lBZ1JWRVF4M0ZxTUk3amJ1TTRmbXlxeFFSS1VaUTNXa05VRlVtUzZueE5LTHJQc294UTlXaU5KVWx5OWdOcXJBbWhidy9iV1ZPcXFxNnJxcm9iT2t1TkNqVldzRzJjVWV3YkcycVdoZDVzQ2ZRTHRDeHIrcFpBbFIvY1BNZTJieHR2MERYRENxb1p0L1Bvc2tCOS9WZE9OcnIwdGU4VFkvZEg2bENVcjNZQUFBQUFTVVZPUks1Q1lJST0iPjwvaW1nPgogICAgICA8L2Rpdj4KICAgICAgPGRpdiBjbGFzcz0iYXVyeWMtZmVlZGJhY2tfb3B0aW9uX2NvbHVtbiBhdXJ5Yy1mZWVkYmFjay1zZWxlY3Rpb25fX2xhYmVscyI-CiAgICAgICAgPGRpdiBjbGFzcz0iYXVyeWMtZmVlZGJhY2stc2VsZWN0aW9uX19sYWJlbDEiPlNlbGVjdCBTZWN0aW9uPC9kaXY-CiAgICAgICAgPGRpdiBjbGFzcz0iYXVyeWMtZmVlZGJhY2stc2VsZWN0aW9uX19sYWJlbDIiPlNlbGVjdCBhIHNlY3Rpb24gb2YgdGhpcyBwYWdlIG9uIHdoaWNoIHRvIGdpdmUgZmVlZGJhY2suPC9kaXY-CiAgICAgIDwvZGl2PgogICAgPC9kaXY-CiAgPC9kaXY-CiAgPGRpdiBjbGFzcz0iYXVyeWMtZmVlZGJhY2stZ2VuZXJhbCI-CiAgICA8ZGl2IGNsYXNzPSJhdXJ5Yy1mZWVkYmFja19vcHRpb25fcm93Ij4KICAgICAgPGRpdiBjbGFzcz0iYXVyeWMtZmVlZGJhY2tfb3B0aW9uX2NvbHVtbiBhdXJ5Yy1mZWVkYmFja19vcHRpb25faW1hZ2UiPgogICAgICAgIDxpbWcgc3JjPSJkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUNBQUFBQWdDQVlBQUFCemVucjBBQUFBL1VsRVFWUllSKzJYUFE2Q1FCQ0ZaeVJhY0FQMVBGcnNTa25wT2JTeXNOSnpXRkxpVU9oOVBBS0ZCc2RzUVVJSVlSYVdaR095VzdMejg4M2piVEVJbmc5Sy9kTTBYWlJsZVFhQVBUT3ZwSGh6ajRndkFMakZjWHpLc3V6ZGx5TUNhSzB2ekh5d2FkeU9RY1FyRVIyZEFKUlNacG9sSXU2SWlHeEF0TmFhbWU5R0NTSmFEd1pRU25FN3FTZ0tVYTFtam0yTnpxTE5aRVQ4TXZOc2pBSUE4QUdBZVEzV05VUXZnRW1Zd2dQMVFLTUFwbmdGVGdBMnBwTmlBa0JRd0ZtQkpFa2VWVlZ0SkxNMTc2TW9ldVo1dmpYZi9oOWd5T1Jkc2M0S0JJQmd3dUFCN3dvRUUzci9CUUhBbXdLdWpXMldHM0V4bVJMQ2VpK1lzcWxVNndmVGUwQXdVVXZKQkFBQUFBQkpSVTVFcmtKZ2dnPT0iPjwvaW1nPgogICAgICA8L2Rpdj4KICAgICAgPGRpdiBjbGFzcz0iYXVyeWMtZmVlZGJhY2tfb3B0aW9uX2NvbHVtbiBhdXJ5Yy1mZWVkYmFjay1zZWxlY3Rpb25fX2xhYmVscyI-CiAgICAgICAgPGRpdiBjbGFzcz0iYXVyeWMtZmVlZGJhY2stc2VsZWN0aW9uX19sYWJlbDEiPkZlZWRiYWNrIEZvcm08L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSJhdXJ5Yy1mZWVkYmFjay1zZWxlY3Rpb25fX2xhYmVsMiI-RmlsbCBvdXQgb3VyIGdlbmVyYWwgZmVlZGJhY2sgZm9ybS48L2Rpdj4KICAgICAgPC9kaXY-CiAgICA8L2Rpdj4KICA8L2Rpdj4KPC9kaXY-CjwlCiAgdmFyIHBvd2VyZWRCeSA9ICdQb3dlcmVkIGJ5JzsKICB2YXIgeW91ckFuc3dlciA9ICdZb3VyIEFuc3dlcic7CiAgdmFyIGxlZnRMYWJlbCA9ICc8c3BhbiBjbGFzcz0iYXVyeWMtZmVlZGJhY2stdGV4dC1yZW1haW5pbmciPjEsMDAwPC9zcGFuPiBDaGFyYWN0ZXJzIExlZnQnOwogIGlmIChleHRyYUluZm8ueW91ckFuc3dlcikgewogICAgeW91ckFuc3dlciA9IGV4dHJhSW5mby55b3VyQW5zd2VyOwogICAgcG93ZXJlZEJ5ID0gZXh0cmFJbmZvLnBvd2VyZWRCeTsKICAgIGxlZnRMYWJlbCA9IGV4dHJhSW5mby5sZWZ0LnJlcGxhY2UoL1wkXHtOVU1cfS8sICc8c3BhbiBjbGFzcz0iYXVyeWMtZmVlZGJhY2stdGV4dC1yZW1haW5pbmciPjEsMDAwPC9zcGFuPicpOwogIH0KICU-CjxkaXYgY2xhc3M9ImF1cnljLWZibW9kYWwtYm9keS1mYmZvcm0iPgogIDxkaXYgY2xhc3M9ImF1cnljLWZlZWRiYWNrIj4KICAgICAgPGRpdiBkYXRhVHlwZT0iYXVyeWMtZmJxIiBjbGFzcz0iYXVyeWMtZmVlZGJhY2stdGl0bGUtc2VjdGlvbiI-CiAgICAgICAgICA8JSBpZiAobG9nb1BpYykgeyAlPgogICAgICAgICAgICAgIDxpbWcgc3JjPSI8JT1sb2dvUGljJT4iIGNsYXNzPSJhdXJ5Yy1mZWVkYmFjay1mYmxvZ28iLz4KICAgICAgICAgIDwlIH0gJT4KICAgICAgICAgIDwlIGlmIChmZWVkYmFja1RpdGxlKSB7ICU-CiAgICAgICAgICAgICAgPGgxPjwlPSBmZWVkYmFja1RpdGxlICU-PC9oMT4KICAgICAgICAgIDwlIH0gJT4KICAgICAgICAgIDwlIGlmIChwcm9sb2d1ZVRleHQpIHsgJT4KICAgICAgICAgICAgICA8JSBpZiAocHJvbG9ndWVUZXh0LmluZGV4T2YoJ2gxJykgPT09IC0xKSB7ICU-CiAgICAgICAgICAgICAgICAgIDxwPjwlPSBwcm9sb2d1ZVRleHQgJT48L3A-CiAgICAgICAgICAgICAgPCUgfSBlbHNlIHsgJT4KICAgICAgICAgICAgICAgICAgPCU9IHByb2xvZ3VlVGV4dCAlPgogICAgICAgICAgICAgIDwlIH0gJT4KICAgICAgICAgIDwlIH0gJT4KICAgICAgICAgIDwlIGlmIChoYXNSZXF1aXJlZFF1ZXN0aW9ucykgeyAlPgogICAgICAgICAgICA8cCBzdHlsZT0iY29sb3I6I0ZGNEM4ODsiPipSZXF1aXJlZCBGaWVsZHM8L3A-CiAgICAgICAgICA8JSB9ICU-CgogICAgICA8L2Rpdj4KICAgICAgPCUgZm9yICh2YXIgbXFpID0gMDsgbXFpIDwgbWFpblEubGVuZ3RoOyBtcWkrKykgewogICAgICAgICAgdmFyIGN1clEgPSBtYWluUVttcWldOwogICAgICAgICAgdmFyIHJlcUZvbnQgPSBjdXJRLnJlcXVpcmVkID8gJyonIDogJyc7CiAgICAgICAgICBpZiAoY3VyUS5xdWVzdGlvblR5cGUgIT09ICdEUk9QX0RPV04nIHx8IGN1clEuYW5zd2Vycy5sZW5ndGggPiAwKSB7ICU-CiAgICAgIDxkaXYgZGF0YVR5cGU9ImF1cnljLWZicSIgY2xhc3M9IjwlIGlmIChjdXJRLnF1ZXN0aW9uVHlwZSA9PT0gJ1NDQUxFRCcpIHsgJT5hdXJ5Yy1zdGFycmF0aW5nLXNlY3Rpb248JSB9ICU-IiAgIHJlcXVpcmVkPSI8JT0gY3VyUS5yZXF1aXJlZCAlPiIgICAgICAgIHF1ZXN0aW9uaWQ9IjwlPSBjdXJRLmlkICU-Ij4KICAgICAgICAgIDwlIGlmIChjdXJRLnF1ZXN0aW9uVHlwZSA9PT0gJ1NDQUxFRCcpIHsgJT4KICAgICAgICAgIDxkaXYgY2xhc3M9ImF1cnljLWZlZWRiYWNrLWZicXVlc3Rpb24iIHF1ZXN0aW9uaWQ9IjwlPSBjdXJRLmlkICU-IiByZXF1aXJlZD0iPCU9IGN1clEucmVxdWlyZWQgJT4iPgogICAgICAgICAgICA8bGFiZWwgY2xhc3M9ImF1cnljLWZlZWRiYWNrLWZibGFiZWwiPjwlPSBjdXJRLnF1ZXN0aW9uVGV4dCAlPjxmb250IGNvbG9yPSIjRkY0Qzg4Ij48JT0gcmVxRm9udCAlPjwvZm9udD48L2xhYmVsPgogICAgICAgICAgICA8ZmllbGRzZXQgY2xhc3M9ImF1cnljLWZiLXN0YXJyYXRpbmctZmllbGQiIHF1ZXN0aW9uaWQ9IjwlPWN1clEuaWQlPiIgcmVxdWlyZWQ9IjwlPSBjdXJRLnJlcXVpcmVkICU-Ij4KICAgICAgICAgICAgICA8JSBmb3IgKHZhciBhdGkgPSAwOyBhdGkgPCBjdXJRLmFuc3dlcnMubGVuZ3RoOyBhdGkrKykgewogICAgICAgICAgICAgICAgICB2YXIgYW5zID0gY3VyUS5hbnN3ZXJzW2F0aV07ICU-CiAgICAgICAgICAgICAgPGlucHV0IG5hbWU9InNyXzwlPWN1clEuaWQlPiIgaWQ9InNyXzwlPSBjdXJRLmlkICU-XzwlPWFucy5pZCU-IiB2YWx1ZT0iPCU9YW5zLmlkJT4iCiAgICAgICAgICAgICAgICAgICAgIHF1ZXN0aW9uaWQ9IjwlPWN1clEuaWQlPiIgdHlwZT0icmFkaW8iCiAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkPSI8JT0gY3VyUS5yZXF1aXJlZCAlPiIKICAgICAgICAgICAgICAgICAgICAgY2xhc3M9ImF1cnljLWZiLXN0YXJyYXRpbmctZmllbGQtc3Rhcmljb24iCiAgICAgICAgICAgICAgICAgICAgIHZhbHVlPSI8JT1hbnMudmFsdWUlPiIvPgogICAgICAgICAgICAgICAgPCUgaWYgKGF0aSA9PT0gMCkgeyAlPgogICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9InNyXzwlPWN1clEuaWQlPl88JT1hbnMuaWQlPiIgdGFiaW5kZXg9IjwlPSBhdGkgJT4iPjxzcGFuIHN0eWxlPSJkaXNwbGF5OiBub25lIj48JT1hbnMudmFsdWUlPjwvc3Bhbj48L2xhYmVsPgogICAgICAgICAgICAgICAgPCUgfSBlbHNlIHslPgogICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9InNyXzwlPWN1clEuaWQlPl88JT1hbnMuaWQlPiI-PHNwYW4gc3R5bGU9ImRpc3BsYXk6IG5vbmUiPjwlPWFucy52YWx1ZSU-PC9zcGFuPjwvbGFiZWw-CiAgICAgICAgICAgICAgICA8JSB9ICU-CiAgICAgICAgICAgICAgPCUgfSAlPgogICAgICAgICAgICA8L2ZpZWxkc2V0PgogICAgICAgICAgPC9kaXY-CiAgICAgICAgICA8JSB9ICU-CiAgICAgICAgICA8JSBpZiAoY3VyUS5xdWVzdGlvblR5cGUgPT09ICdOUFMnKSB7ICU-CiAgICAgICAgICA8ZGl2IGNsYXNzPSJhdXJ5Yy1ucHNfX2NvbnRhaW5lciBhdXJ5Yy1mZWVkYmFjay1mYnF1ZXN0aW9uIiBxdWVzdGlvbmlkPSI8JT0gY3VyUS5pZCAlPiIgcmVxdWlyZWQ9IjwlPSBjdXJRLnJlcXVpcmVkICU-Ij4KICAgICAgICAgICAgPGxhYmVsIGNsYXNzPSJhdXJ5Yy1mZWVkYmFjay1mYmxhYmVsIj48JT0gY3VyUS5xdWVzdGlvblRleHQgJT48Zm9udCBjb2xvcj0iI0ZGNEM4OCI-PCU9IHJlcUZvbnQgJT48L2ZvbnQ-PC9sYWJlbD4KICAgICAgICAgICAgPGZpZWxkc2V0IGNsYXNzPSJucHMtcmF0aW5nIiBxdWVzdGlvbmlkPSI8JT0gY3VyUS5pZCAlPiIgcmVxdWlyZWQ9IjwlPSBjdXJRLnJlcXVpcmVkICU-Ij4KICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJucHMtcmF0aW5nX19iYWRnZXMiPgogICAgICAgICAgICAgICAgPCUgZm9yICh2YXIgYXRpID0gMDsgYXRpIDwgY3VyUS5hbnN3ZXJzLmxlbmd0aDsgYXRpKyspIHsKICAgICAgICAgICAgICAgICAgICB2YXIgYW5zID0gY3VyUS5hbnN3ZXJzW2F0aV07ICU-CiAgICAgICAgICAgICAgICA8aW5wdXQgbmFtZT0ibnBzXzwlPSBjdXJRLmlkICU-IiBpZD0ibnBzXzwlPSBjdXJRLmlkICU-XzwlPSBhbnMuaWQgJT4iCiAgICAgICAgICAgICAgICAgICAgICAgcXVlc3Rpb25pZD0iPCU9IGN1clEuaWQgJT4iIHR5cGU9InJhZGlvIgogICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkPSI8JT0gY3VyUS5yZXF1aXJlZCAlPiIKICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT0iPCU9IGFucy5pZCAlPiIvPgogICAgICAgICAgICAgICAgPCUgaWYgKGF0aSA9PT0gMCkgeyAlPgogICAgICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzcz0ibnBzLXJhdGluZ19fYmFkZ2UiIGZvcj0ibnBzXzwlPSBjdXJRLmlkICU-XzwlPSBhbnMuaWQgJT4iIHRhYmluZGV4PSI8JT0gYXRpICU-Ij4KICAgICAgICAgICAgICAgIDwlIH0gZWxzZSB7JT4KICAgICAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9Im5wcy1yYXRpbmdfX2JhZGdlIiBmb3I9Im5wc188JT0gY3VyUS5pZCAlPl88JT0gYW5zLmlkICU-Ij4KICAgICAgICAgICAgICAgIDwlIH0gJT4KICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibnBzLXJhdGluZ19faGVpZ2h0X2ZpeCI-PC9kaXY-CiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im5wcy1yYXRpbmdfX251bSI-PCU9YXRpJT48L2Rpdj4KICAgICAgICAgICAgICAgIDwvbGFiZWw-CiAgICAgICAgICAgICAgICA8JSB9ICU-CiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ic3RyZXRjaCIvPgogICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im5wcy1yYXRpbmdfX2xhYmVscyI-CiAgICAgICAgICAgICAgICA8JQogICAgICAgICAgICAgICAgICB2YXIgbnBzWmVybyA9IGN1clEuYW5zd2Vyc1swXS5sYmw7CiAgICAgICAgICAgICAgICAgIHZhciBucHNUZW4gPSBjdXJRLmFuc3dlcnNbY3VyUS5hbnN3ZXJzLmxlbmd0aC0xXS5sYmw7CiAgICAgICAgICAgICAgICAgIGlmIChleHRyYUluZm8ubnBzWmVybykgewogICAgICAgICAgICAgICAgICAgIG5wc1plcm8gPSBleHRyYUluZm8ubnBzWmVybzsKICAgICAgICAgICAgICAgICAgICBucHNUZW4gPSBleHRyYUluZm8ubnBzVGVuOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgJT4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im5wc19yYXRpbmdfbGVmdF9sYWJlbCI-PCU9IG5wc1plcm8gJT48L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im5wc19yYXRpbmdfcmlnaHRfbGFiZWwiPjwlPSBucHNUZW4gJT48L2Rpdj4KICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPC9maWVsZHNldD4KICAgICAgICAgIDwvZGl2PgogICAgICAgICAgPCUgfSAlPgogICAgICAgICAgPCUgaWYgKGN1clEucXVlc3Rpb25UeXBlID09PSAnRFJPUF9ET1dOJyApIHsgJT4KICAgICAgICAgICAgPCUgaWYgKGN1clEuYW5zd2Vycy5sZW5ndGggPiAxKSB7ICU-CiAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iYXVyeWMtZmVlZGJhY2stZmJxdWVzdGlvbiIgc3R5bGU9InBhZGRpbmctYm90dG9tOiA1cHggIWltcG9ydGFudCIgcXVlc3Rpb25pZD0iPCU9IGN1clEuaWQgJT4iIHJlcXVpcmVkPSI8JT0gY3VyUS5yZXF1aXJlZCAlPiI-CiAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9ImF1cnljLWZlZWRiYWNrLWZibGFiZWwiPjwlPSBjdXJRLnF1ZXN0aW9uVGV4dCAlPjwvbGFiZWw-CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJhdXJ5Yy1mZWVkYmFjay1xdWVzdGlvbi1zZWxlY3QtY2hvb3NlIiBxdWVzdGlvbmlkPSI8JT0gY3VyUS5pZCAlPiIgcmVxdWlyZWQ9IjwlPSBjdXJRLnJlcXVpcmVkICU-Ij4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJhdXJ5Yy1mZWVkYmFjay1zZWxlY3QtYnV0dG9uIj4KICAgICAgICAgICAgICAgICAgICAgICAgPCUgaWYgKGN1clEuYW5zd2Vycy5sZW5ndGggPiAxKSB7ICU-CiAgICAgICAgICAgICAgICAgICAgICAgIDwlPSBleHRyYUluZm8uY2hvb3NlICU-CiAgICAgICAgICAgICAgICAgICAgICAgIDwlIH0gZWxzZSB7ICU-CiAgICAgICAgICAgICAgICAgICAgICAgIDwlPSBjdXJRLmFuc3dlcnNbMF0ubGFiZWwgJT4KICAgICAgICAgICAgICAgICAgICAgICAgPCUgfSAlPgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgIDxzZWxlY3QgaWQ9InNfPCU9IGN1clEuaWQgJT4iIGNsYXNzPSJhdXJ5Yy1mYi1xdWVzdGlvbmdyb3VwLXNlbGVjdG9yIiB0YWJpbmRleD0iMCI-CiAgICAgICAgICAgICAgICAgICAgICAgIDwlIGlmIChjdXJRLmFuc3dlcnMubGVuZ3RoID4gMSkgeyAlPgogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uPjwlPSBleHRyYUluZm8uY2hvb3NlICU-PC9vcHRpb24-CiAgICAgICAgICAgICAgICAgICAgICAgIDwlIH0gJT4KICAgICAgICAgICAgICAgICAgICAgICAgPCUgZm9yICh2YXIgYXRpcSA9IDA7IGF0aXEgPCBjdXJRLmFuc3dlcnMubGVuZ3RoOyBhdGlxKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhbnMgPSBjdXJRLmFuc3dlcnNbYXRpcV07ICU-CiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IjwlPSBhbnMuaWQgJT4iPjwlPSBhbnMubGFiZWwgJT48L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgPCUgfSAlPgogICAgICAgICAgICAgICAgICAgIDwvc2VsZWN0PgogICAgICAgICAgICAgICAgPC9kaXY-CiAgICAgICAgICAgICAgPC9kaXY-CiAgICAgICAgICAgIDwlIH0gJT4KICAgICAgICAgICAgPCUgZm9yICh2YXIgdHBpID0gMDsgdHBpIDwgdG9waWNzLmxlbmd0aDsgdHBpKyspIHsKICAgICAgICAgICAgICAgIHZhciB0b3BrID0gdG9waWNzW3RwaV07ICU-CiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImF1cnljLWZlZWRiYWNrLWZicXVlc3Rpb25ncm91cCIgaWQ9InRvcGtfPCU9IHRvcGsudG9waWNBbnN3ZXJJZCAlPiI-CiAgICAgICAgICAgICAgICA8JSBmb3IgKHZhciBxaSA9IDA7IHFpIDwgdG9way5xdWVzdGlvbnMubGVuZ3RoOyBxaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHEgPSB0b3BrLnF1ZXN0aW9uc1txaV07CiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcUZvbnQgPSBxLnJlcXVpcmVkID8gJyonIDogJyc7ICU-CiAgICAgICAgICAgICAgPGRpdiBkYXRhVHlwZT0iYXVyeWMtZmJxIiBjbGFzcz0iPCUgaWYgKHEucXVlc3Rpb25UeXBlID09PSAnU0NBTEVEJykgeyU-YXVyeWMtc3RhcnJhdGluZy1zZWN0aW9uPCUgfSU-IiBpZD0iYXVyeWNxXzwlPSBxLmlkICU-IgogICAgICAgICAgICAgICAgICAgIHF1ZXN0aW9uaWQ9IjwlPSBxLmlkICU-IiByZXF1aXJlZD0iPCU9IHEucmVxdWlyZWQgJT4iIGRhdGEtcXVlc3Rpb24tdHlwZT0iPCU9IHEucXVlc3Rpb25UeXBlICU-Ij4KICAgICAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9ImF1cnljLWZlZWRiYWNrLWZibGFiZWwiIHN0eWxlPSJ0ZXh0LWFsaWduOiBsZWZ0ICFpbXBvcnRhbnQ7cGFkZGluZy1ib3R0b206NXB4ICFpbXBvcnRhbnQ7IiBmb3I9ImF1cnljX29iajwlPSBxLmlkICU-IiBkYXRhLXF1ZXN0aW9udHlwZT0iXzwlPSBxLnF1ZXN0aW9uVHlwZSAlPiI-PCU9IHEucXVlc3Rpb25UZXh0ICU-PGZvbnQgY29sb3I9IiNGRjRDODgiPjwlPSByZXFGb250ICU-PC9mb250PjwvbGFiZWw-CiAgICAgICAgICAgICAgICAgICAgPCUgaWYgKHEucXVlc3Rpb25UeXBlID09PSAnQ0hFQ0tCT1gnKSB7ICU-CiAgICAgICAgICAgICAgICAgICAgPGRpdiBkYXRhVHlwZT0iYXVyeWMtZmVlZGJhY2stY2hlY2tib3giPgogICAgICAgICAgICAgICAgICAgICAgICA8JSBmb3IgKHZhciBhbnNpID0gMDsgYW5zaSA8IHEuYW5zd2Vycy5sZW5ndGg7IGFuc2krKykgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYW5zID0gcS5hbnN3ZXJzW2Fuc2ldOyAlPgogICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJfPCU9IGFucy5pZCAlPiIgY2xhc3M9ImF1cnljLWZlZWRiYWNrLWNoZWNrYm94IiBzdHlsZT0idGV4dC1hbGlnbjogbGVmdDsiIHRhYmluZGV4PSIwIj48aW5wdXQgdHlwZT0iY2hlY2tib3giIHZhbHVlPSI8JT0gYW5zLnZhbHVlICU-IiBxdWVzdGlvbmlkPSI8JT0gYW5zLmlkICU-IiBpZD0iXzwlPSBhbnMuaWQgJT4iIHRhYmluZGV4PSIwIi8-PCU9IGFucy5sYWJlbCAlPjwvbGFiZWw-CiAgICAgICAgICAgICAgICAgICAgICAgIDwlIH0gJT4KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8JSB9ICU-CiAgICAgICAgICAgICAgICAgICAgPCUgaWYgKHEucXVlc3Rpb25UeXBlID09ICdSQURJT19CVVRUT04nKSB7ICU-CiAgICAgICAgICAgICAgICAgICAgPGRpdiBkYXRhVHlwZT0iYXVyeWMtZmVlZGJhY2stcmFkaW8iPgogICAgICAgICAgICAgICAgICAgICAgICA8JSBmb3IgKHZhciBhbnNpID0gMDsgYW5zaSA8IHEuYW5zd2Vycy5sZW5ndGg7IGFuc2krKykgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYW5zID0gcS5hbnN3ZXJzW2Fuc2ldOyAlPgogICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJfPCU9IGFucy5pZCAlPiIgY2xhc3M9ImF1cnljLWZlZWRiYWNrLXJhZGlvIiB0YWJpbmRleD0iMCI-PGlucHV0IHR5cGU9InJhZGlvIiBuYW1lPSJhdXJ5Y3JkXzwlPSBxLmlkICU-IiB2YWx1ZT0iPCU9IGFucy5pZCAlPiIgbGFiZWw9IjwlPSBlbmNvZGVVUklDb21wb25lbnQoYW5zLmxhYmVsKSAlPiIgaWQ9Il88JT0gYW5zLmlkICU-IiBxdWVzdGlvbmlkPSI8JT0gcS5pZCAlPiIvPjwlPSBhbnMubGFiZWwgJT48L2xhYmVsPgogICAgICAgICAgICAgICAgICAgICAgICA8JSB9ICU-CiAgICAgICAgICAgICAgICAgICAgPC9kaXY-CiAgICAgICAgICAgICAgICAgICAgPCUgfSAlPgogICAgICAgICAgICAgICAgICAgIDwlIGlmIChxLnF1ZXN0aW9uVHlwZSA9PT0gJ09QRU5FTkQnKSB7ICU-CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iYXVyeWMtZmVlZGJhY2stZmJ0YXJlYSI-CiAgICAgICAgICAgICAgICAgICAgICAgIDx0ZXh0YXJlYSBpZD0iYXVyeWNfb2JqPCU9IHEuaWQgJT4iCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzcz0iYXVyeWMtZmVlZGJhY2stcXVlc3Rpb24tdGV4dGFyZWEiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPSI8JT0geW91ckFuc3dlciAlPiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXJ5Y21heGxlbmd0aD0iMTAwMCIgdGFiaW5kZXg9IjAiPjwvdGV4dGFyZWE-CiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJhdXJ5Yy1mZWVkYmFja19jb3VudFdyYXBwZXIiPiA8JT0gbGVmdExhYmVsICU-PC9zcGFuPgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgIDwlIH0gJT4KICAgICAgICAgICAgICAgICAgICA8JSBpZiAocS5xdWVzdGlvblR5cGUgPT09ICdDT05UQUNUX0lORk8nKSB7ICU-CiAgICAgICAgICAgICAgICAgICAgPCEtLSBUZXh0IGlucHV0IC0tPgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImF1cnljLWZlZWRiYWNrLXRleHQgYXVyeWMtZmVlZGJhY2stZW1haWwiPgogICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgaWQ9InNyXzwlPSBxLmlkICU-IiBjbGFzcz0iYXVyeWMtZmVlZGJhY2stZmJlbWFpbCIgdGFiaW5kZXg9IjAiIHR5cGU9InRleHQiIDwlIGlmICgxKSB7ICU-cmVxdWlyZWQ8JSB9ICU-Lz4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iYXVyeWMtZmItdmFsaWRhdGlvbi1tc2ctc2VjdGlvbiI-PC9kaXY-CiAgICAgICAgICAgICAgICAgICAgPC9kaXY-CiAgICAgICAgICAgICAgICAgICAgPCUgfSAlPgogICAgICAgICAgICAgICAgICAgIDwlIGlmIChxLnF1ZXN0aW9uVHlwZSA9PT0gJ0RST1BfRE9XTicgKSB7ICU-CiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Ii5hdXJ5Yy1mZWVkYmFjay1mYnF1ZXN0aW9uLWRyb3Bkb3duIiBzdHlsZT0icGFkZGluZy1ib3R0b206IDVweCAhaW1wb3J0YW50IiBxdWVzdGlvbmlkPSI8JT0gcS5pZCAlPiIgcmVxdWlyZWQ9IjwlPSBxLnJlcXVpcmVkICU-Ij4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImF1cnljLWZlZWRiYWNrLXF1ZXN0aW9uLXNlbGVjdC1jaG9vc2UiIHF1ZXN0aW9uaWQ9IjwlPSBxLmlkICU-IiByZXF1aXJlZD0iPCU9IHEucmVxdWlyZWQgJT4iPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImF1cnljLWZlZWRiYWNrLXNlbGVjdC1idXR0b24iPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8JT0gZXh0cmFJbmZvLmNob29zZSAlPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzZWxlY3QgaWQ9InNfPCU9IHEuaWQgJT4iIGNsYXNzPSJhdXJ5Yy1mYi1xdWVzdGlvbi1zZWxlY3RvciIgdGFiaW5kZXg9IjAiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uPjwlPSBleHRyYUluZm8uY2hvb3NlICU-PC9vcHRpb24-CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwlIGZvciAodmFyIGF0aXEgPSAwOyBhdGlxIDwgcS5hbnN3ZXJzLmxlbmd0aDsgYXRpcSsrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYW5zID0gcS5hbnN3ZXJzW2F0aXFdOyAlPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSI8JT0gYW5zLmlkICU-Ij4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwlPSBhbnMubGFiZWwgJT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9vcHRpb24-CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwlIH0gJT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NlbGVjdD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8JSB9ICU-CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDwlIH0gJT4KICAgICAgICAgICAgPC9kaXY-CiAgICAgICAgICAgIDwlIH0gJT4KICAgICAgICAgIDwlIH0gJT4KICAgICAgPC9kaXY-CiAgICAgIDwlIH0gJT4KICAgICAgPCUgfSAlPgoKICAgICAgPGRpdiBjbGFzcz0iYXVyeWMtZmVlZGJhY2stZm9vdGVyLXNlY3Rpb24iPgogICAgICAgIDwlIHZhciBidG5UZXh0ID0gIiI7ICU-CiAgICAgICAgICAgIDwlIGlmIChmb3JtQ29uZmlnLmJ0bkZvbnRDb2xvcikgeyAlPgogICAgICAgICAgICAgICAgPCUgYnRuVGV4dCA9ICI8c3BhbiBzdHlsZT1cImNvbG9yOiIgKyBmb3JtQ29uZmlnLmJ0bkZvbnRDb2xvciArICJcIj4iICsgZXh0cmFJbmZvLnN1Ym1pdCArICI8L3NwYW4-IjsgJT4KICAgICAgICAgICAgPCUgfSBlbHNlIHsgJT4KICAgICAgICAgICAgICAgIDwlIGJ0blRleHQgPSBleHRyYUluZm8uc3VibWl0OyAlPgogICAgICAgIDwlIH0gJT4KICAgICAgICAgICAgPCUgaWYgKGZvcm1Db25maWcuYnRuQmFja2dyb3VuZENvbG9yKSB7ICU-CiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJwb3N0LWZiLXJlc3AtYnV0dG9uIgogICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT0iYmFja2dyb3VuZDogPCU9Zm9ybUNvbmZpZy5idG5CYWNrZ3JvdW5kQ29sb3IlPjsgYm9yZGVyOiAxcHggc29saWQgPCU9Zm9ybUNvbmZpZy5idG5CYWNrZ3JvdW5kQ29sb3IlPiIKICAgICAgICAgICAgICAgICAgICAgICAgaWQ9InBvc3QtZmItcmVzcC1idXR0b24iIHRhYmluZGV4PSIwIj4KICAgICAgICAgICAgICAgICAgICA8JT0gYnRuVGV4dCAlPgogICAgICAgICAgICAgICAgPC9idXR0b24-CiAgICAgICAgICAgIDwlIH0gZWxzZSB7ICU-CiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJwb3N0LWZiLXJlc3AtYnV0dG9uIiBpZD0icG9zdC1mYi1yZXNwLWJ1dHRvbiIgdGFiaW5kZXg9IjAiPgogICAgICAgICAgICAgICAgICAgIDwlPSBidG5UZXh0ICU-CiAgICAgICAgICAgICAgICA8L2J1dHRvbj4KICAgICAgICAgICAgPCUgfSAlPgogICAgICAgIDxkaXYgaWQ9ImF1cnljLWZlZWRiYWNrLWNhbnZhcyI-CiAgICAgICAgICA8ZGl2IGNsYXNzPSJhdXJ5Yy1mYm1vZGFsLWZvb3RlciI-PHNwYW4-PCU9IHBvd2VyZWRCeSAlPjwvc3Bhbj4gPGltZyBzcmM9Imh0dHBzOi8vczMtdXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vYXVyeWMtcHVibGljL2RhcmstbG9nby5zdmciIGFsdD0iQXVyeWMiIHN0eWxlPSJ3aWR0aDo2MHB4ICFpbXBvcnRhbnQ7aGVpZ2h0OjIwcHggIWltcG9ydGFudDsiPjwvZGl2PgogICAgICAgIDwvZGl2PgogICAgICA8L2Rpdj4KICA8L2Rpdj4KPC9kaXY-Cg==PGRpd",window[constants.symbols.FEEDBACKCONTENT_DESKTOP]="iBjbGFzcz0iYXVyeWMtZmJtb2RhbC1ib2R5LXNlbGVjdGlvbiI-CiAgPGRpdiBjbGFzcz0iYXVyeWMtZmJtb2RhbC1ib2R5LXNlbGVjdGlvbl90aXRsZSI-SG93IHdvdWxkIHlvdSBsaWtlIHRvIGdpdmUgZmVlZGJhY2s_PC9kaXY-CiAgPGRpdiBjbGFzcz0iYXVyeWMtZmVlZGJhY2stc2NyZWVuc2hvdCI-CiAgICA8ZGl2IGNsYXNzPSJhdXJ5Yy1mZWVkYmFja19vcHRpb25fcm93Ij4KICAgICAgPGRpdiBjbGFzcz0iYXVyeWMtZmVlZGJhY2tfb3B0aW9uX2NvbHVtbiBhdXJ5Yy1mZWVkYmFja19vcHRpb25faW1hZ2UiPgogICAgICAgIDxpbWcgc3JjPSJkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUNVQUFBQWdDQVlBQUFDVlU3R3dBQUFCZkVsRVFWUllSKzJYcTI2RVVCQ0d6NkFRS0ZiMVNWcUJhcXE0R0lJc21GNDA0UVc2ZlFHQzdzV1FTb0xob3BwVmlQWko2bEFJRk5NYzBtMEkzZTZXeTFsSXczRW5oSm52L1A4d1p3QXl3d1V6WkNJTDFGOWRXWlRxckpRc3kwaGZTdE8wVm8vRm51TzQremlPMTRmZ3Z1MWpBYkh2a1B2QTVsdFRiWlVPeWN2NitjNzZZWkcweThHUFp0Ly9nT3B5aXI3V2RzbXgxRlN6YjAzV3B4QVJORTI3UnNRclJEeWxJQUR3RGdEUFVSUTlBVUI5aTdRWE0vdDBYVDhweS9LRkVITCtpeW9ibnVjdnd6RDhPQW9VVlVoUmxGY0t0RnF0MERSTjhEeXZ6bTNiTnZGOUgvTThwNEpza2lTNWFDdkdwRStwcW5wVFZkV0RLSXJvdWk0SWdrQU13NmloZ2lBZ1JWRVF4M0ZxTUk3amJ1TTRmbXlxeFFSS1VaUTNXa05VRlVtUzZueE5LTHJQc294UTlXaU5KVWx5OWdOcXJBbWhidy9iV1ZPcXFxNnJxcm9iT2t1TkNqVldzRzJjVWV3YkcycVdoZDVzQ2ZRTHRDeHIrcFpBbFIvY1BNZTJieHR2MERYRENxb1p0L1Bvc2tCOS9WZE9OcnIwdGU4VFkvZEg2bENVcjNZQUFBQUFTVVZPUks1Q1lJST0iPjwvaW1nPgogICAgICA8L2Rpdj4KICAgICAgPGRpdiBjbGFzcz0iYXVyeWMtZmVlZGJhY2tfb3B0aW9uX2NvbHVtbiBhdXJ5Yy1mZWVkYmFjay1zZWxlY3Rpb25fX2xhYmVscyI-CiAgICAgICAgPGRpdiBjbGFzcz0iYXVyeWMtZmVlZGJhY2stc2VsZWN0aW9uX19sYWJlbDEiPlNlbGVjdCBTZWN0aW9uPC9kaXY-CiAgICAgICAgPGRpdiBjbGFzcz0iYXVyeWMtZmVlZGJhY2stc2VsZWN0aW9uX19sYWJlbDIiPlNlbGVjdCBhIHNlY3Rpb24gb2YgdGhpcyBwYWdlIG9uIHdoaWNoIHRvIGdpdmUgZmVlZGJhY2suPC9kaXY-CiAgICAgIDwvZGl2PgogICAgPC9kaXY-CiAgPC9kaXY-CiAgPGRpdiBjbGFzcz0iYXVyeWMtZmVlZGJhY2stZ2VuZXJhbCI-CiAgICA8ZGl2IGNsYXNzPSJhdXJ5Yy1mZWVkYmFja19vcHRpb25fcm93Ij4KICAgICAgPGRpdiBjbGFzcz0iYXVyeWMtZmVlZGJhY2tfb3B0aW9uX2NvbHVtbiBhdXJ5Yy1mZWVkYmFja19vcHRpb25faW1hZ2UiPgogICAgICAgIDxpbWcgc3JjPSJkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUNBQUFBQWdDQVlBQUFCemVucjBBQUFBL1VsRVFWUllSKzJYUFE2Q1FCQ0ZaeVJhY0FQMVBGcnNTa25wT2JTeXNOSnpXRkxpVU9oOVBBS0ZCc2RzUVVJSVlSYVdaR095VzdMejg4M2piVEVJbmc5Sy9kTTBYWlJsZVFhQVBUT3ZwSGh6ajRndkFMakZjWHpLc3V6ZGx5TUNhSzB2ekh5d2FkeU9RY1FyRVIyZEFKUlNacG9sSXU2SWlHeEF0TmFhbWU5R0NTSmFEd1pRU25FN3FTZ0tVYTFtam0yTnpxTE5aRVQ4TXZOc2pBSUE4QUdBZVEzV05VUXZnRW1Zd2dQMVFLTUFwbmdGVGdBMnBwTmlBa0JRd0ZtQkpFa2VWVlZ0SkxNMTc2TW9ldVo1dmpYZi9oOWd5T1Jkc2M0S0JJQmd3dUFCN3dvRUUzci9CUUhBbXdLdWpXMldHM0V4bVJMQ2VpK1lzcWxVNndmVGUwQXdVVXZKQkFBQUFBQkpSVTVFcmtKZ2dnPT0iPjwvaW1nPgogICAgICA8L2Rpdj4KICAgICAgPGRpdiBjbGFzcz0iYXVyeWMtZmVlZGJhY2tfb3B0aW9uX2NvbHVtbiBhdXJ5Yy1mZWVkYmFjay1zZWxlY3Rpb25fX2xhYmVscyI-CiAgICAgICAgPGRpdiBjbGFzcz0iYXVyeWMtZmVlZGJhY2stc2VsZWN0aW9uX19sYWJlbDEiPkZlZWRiYWNrIEZvcm08L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSJhdXJ5Yy1mZWVkYmFjay1zZWxlY3Rpb25fX2xhYmVsMiI-RmlsbCBvdXQgb3VyIGdlbmVyYWwgZmVlZGJhY2sgZm9ybS48L2Rpdj4KICAgICAgPC9kaXY-CiAgICA8L2Rpdj4KICA8L2Rpdj4KPC9kaXY-CjwlCiAgdmFyIHBvd2VyZWRCeSA9ICdQb3dlcmVkIGJ5JzsKICB2YXIgeW91ckFuc3dlciA9ICdZb3VyIEFuc3dlcic7CiAgdmFyIGxlZnRMYWJlbCA9ICc8c3BhbiBjbGFzcz0iYXVyeWMtZmVlZGJhY2stdGV4dC1yZW1haW5pbmciPjEsMDAwPC9zcGFuPiBDaGFyYWN0ZXJzIExlZnQnOwogIGlmIChleHRyYUluZm8ueW91ckFuc3dlcikgewogICAgeW91ckFuc3dlciA9IGV4dHJhSW5mby55b3VyQW5zd2VyOwogICAgcG93ZXJlZEJ5ID0gZXh0cmFJbmZvLnBvd2VyZWRCeTsKICAgIGxlZnRMYWJlbCA9IGV4dHJhSW5mby5sZWZ0LnJlcGxhY2UoL1wkXHtOVU1cfS8sICc8c3BhbiBjbGFzcz0iYXVyeWMtZmVlZGJhY2stdGV4dC1yZW1haW5pbmciPjEsMDAwPC9zcGFuPicpOwogIH0KICU-CjxkaXYgY2xhc3M9ImF1cnljLWZibW9kYWwtYm9keS1mYmZvcm0gZmItZGVza3RvcCI-CiAgPGRpdiBjbGFzcz0iYXVyeWMtZmVlZGJhY2siPgogICAgICA8ZGl2IGRhdGFUeXBlPSJhdXJ5Yy1mYnEiIGNsYXNzPSJhdXJ5Yy1mZWVkYmFjay10aXRsZS1zZWN0aW9uIj4KICAgICAgICAgIDwlIGlmIChsb2dvUGljKSB7ICU-CiAgICAgICAgICAgICAgPGltZyBzcmM9IjwlPWxvZ29QaWMlPiIgY2xhc3M9ImF1cnljLWZlZWRiYWNrLWZibG9nbyIvPgogICAgICAgICAgPCUgfSAlPgogICAgICAgICAgPCUgaWYgKGZlZWRiYWNrVGl0bGUpIHsgJT4KICAgICAgICAgICAgICA8aDE-PCU9IGZlZWRiYWNrVGl0bGUgJT48L2gxPgogICAgICAgICAgPCUgfSAlPgogICAgICAgICAgPCUgaWYgKHByb2xvZ3VlVGV4dCkgeyAlPgogICAgICAgICAgICAgIDwlIGlmIChwcm9sb2d1ZVRleHQuaW5kZXhPZignaDEnKSA9PT0gLTEpIHsgJT4KICAgICAgICAgICAgICAgICAgPHA-PCU9IHByb2xvZ3VlVGV4dCAlPjwvcD4KICAgICAgICAgICAgICA8JSB9IGVsc2UgeyAlPgogICAgICAgICAgICAgICAgICA8JT0gcHJvbG9ndWVUZXh0ICU-CiAgICAgICAgICAgICAgPCUgfSAlPgogICAgICAgICAgPCUgfSAlPgogICAgICAgICAgPCUgaWYgKGhhc1JlcXVpcmVkUXVlc3Rpb25zKSB7ICU-CiAgICAgICAgICAgIDxwIGNsYXNzPSJyZXF1aXJlZC1sYWJlbCIiPipSZXF1aXJlZCBGaWVsZHM8L3A-CiAgICAgICAgICA8JSB9ICU-CgogICAgICA8L2Rpdj4KICAgICAgPCUgZm9yICh2YXIgbXFpID0gMDsgbXFpIDwgbWFpblEubGVuZ3RoOyBtcWkrKykgewogICAgICAgICAgdmFyIGN1clEgPSBtYWluUVttcWldOwogICAgICAgICAgdmFyIHJlcUZvbnQgPSBjdXJRLnJlcXVpcmVkID8gJyonIDogJyc7CiAgICAgICAgICBpZiAoY3VyUS5xdWVzdGlvblR5cGUgIT09ICdEUk9QX0RPV04nIHx8IGN1clEuYW5zd2Vycy5sZW5ndGggPiAwKSB7ICU-CiAgICAgIDxkaXYgZGF0YVR5cGU9ImF1cnljLWZicSIgY2xhc3M9IjwlIGlmIChjdXJRLnF1ZXN0aW9uVHlwZSA9PT0gJ1NDQUxFRCcpIHsgJT5hdXJ5Yy1zdGFycmF0aW5nLXNlY3Rpb248JSB9ICU-IiAgIHJlcXVpcmVkPSI8JT0gY3VyUS5yZXF1aXJlZCAlPiIgICAgICAgIHF1ZXN0aW9uaWQ9IjwlPSBjdXJRLmlkICU-Ij4KICAgICAgICAgIDwlIGlmIChjdXJRLnF1ZXN0aW9uVHlwZSA9PT0gJ1NDQUxFRCcpIHsgJT4KICAgICAgICAgIDxkaXYgY2xhc3M9ImF1cnljLWZlZWRiYWNrLWZicXVlc3Rpb24iIHF1ZXN0aW9uaWQ9IjwlPSBjdXJRLmlkICU-IiByZXF1aXJlZD0iPCU9IGN1clEucmVxdWlyZWQgJT4iPgogICAgICAgICAgICA8bGFiZWwgY2xhc3M9ImF1cnljLWZlZWRiYWNrLWZibGFiZWwiPjwlPSBjdXJRLnF1ZXN0aW9uVGV4dCAlPjxmb250IGNvbG9yPSIjRkY0Qzg4Ij48JT0gcmVxRm9udCAlPjwvZm9udD48L2xhYmVsPgogICAgICAgICAgICA8ZmllbGRzZXQgY2xhc3M9ImF1cnljLWZiLXN0YXJyYXRpbmctZmllbGQiIHF1ZXN0aW9uaWQ9IjwlPWN1clEuaWQlPiIgcmVxdWlyZWQ9IjwlPSBjdXJRLnJlcXVpcmVkICU-Ij4KICAgICAgICAgICAgICA8JSBmb3IgKHZhciBhdGkgPSAwOyBhdGkgPCBjdXJRLmFuc3dlcnMubGVuZ3RoOyBhdGkrKykgewogICAgICAgICAgICAgICAgICB2YXIgYW5zID0gY3VyUS5hbnN3ZXJzW2F0aV07ICU-CiAgICAgICAgICAgICAgPGlucHV0IG5hbWU9InNyXzwlPWN1clEuaWQlPiIgaWQ9InNyXzwlPSBjdXJRLmlkICU-XzwlPWFucy5pZCU-IiB2YWx1ZT0iPCU9YW5zLmlkJT4iCiAgICAgICAgICAgICAgICAgICAgIHF1ZXN0aW9uaWQ9IjwlPWN1clEuaWQlPiIgdHlwZT0icmFkaW8iCiAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkPSI8JT0gY3VyUS5yZXF1aXJlZCAlPiIKICAgICAgICAgICAgICAgICAgICAgY2xhc3M9ImF1cnljLWZiLXN0YXJyYXRpbmctZmllbGQtc3Rhcmljb24iCiAgICAgICAgICAgICAgICAgICAgIHZhbHVlPSI8JT1hbnMudmFsdWUlPiIvPgogICAgICAgICAgICAgICAgPCUgaWYgKGF0aSA9PT0gMCkgeyAlPgogICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9InNyXzwlPWN1clEuaWQlPl88JT1hbnMuaWQlPiIgdGFiaW5kZXg9IjwlPSBhdGkgJT4iPjxzcGFuIHN0eWxlPSJkaXNwbGF5OiBub25lIj48JT1hbnMudmFsdWUlPjwvc3Bhbj48L2xhYmVsPgogICAgICAgICAgICAgICAgPCUgfSBlbHNlIHslPgogICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9InNyXzwlPWN1clEuaWQlPl88JT1hbnMuaWQlPiI-PHNwYW4gc3R5bGU9ImRpc3BsYXk6IG5vbmUiPjwlPWFucy52YWx1ZSU-PC9zcGFuPjwvbGFiZWw-CiAgICAgICAgICAgICAgICA8JSB9ICU-CiAgICAgICAgICAgICAgPCUgfSAlPgogICAgICAgICAgICA8L2ZpZWxkc2V0PgogICAgICAgICAgPC9kaXY-CiAgICAgICAgICA8JSB9ICU-CiAgICAgICAgICA8JSBpZiAoY3VyUS5xdWVzdGlvblR5cGUgPT09ICdOUFMnKSB7ICU-CiAgICAgICAgICA8ZGl2IGNsYXNzPSJhdXJ5Yy1ucHNfX2NvbnRhaW5lciBhdXJ5Yy1mZWVkYmFjay1mYnF1ZXN0aW9uIiBxdWVzdGlvbmlkPSI8JT0gY3VyUS5pZCAlPiIgcmVxdWlyZWQ9IjwlPSBjdXJRLnJlcXVpcmVkICU-Ij4KICAgICAgICAgICAgPGxhYmVsIGNsYXNzPSJhdXJ5Yy1mZWVkYmFjay1mYmxhYmVsIj48JT0gY3VyUS5xdWVzdGlvblRleHQgJT48Zm9udCBjb2xvcj0iI0ZGNEM4OCI-PCU9IHJlcUZvbnQgJT48L2ZvbnQ-PC9sYWJlbD4KICAgICAgICAgICAgPGZpZWxkc2V0IGNsYXNzPSJucHMtcmF0aW5nIiBxdWVzdGlvbmlkPSI8JT0gY3VyUS5pZCAlPiIgcmVxdWlyZWQ9IjwlPSBjdXJRLnJlcXVpcmVkICU-Ij4KICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJucHMtcmF0aW5nX19iYWRnZXMiPgogICAgICAgICAgICAgICAgPCUgZm9yICh2YXIgYXRpID0gMDsgYXRpIDwgY3VyUS5hbnN3ZXJzLmxlbmd0aDsgYXRpKyspIHsKICAgICAgICAgICAgICAgICAgICB2YXIgYW5zID0gY3VyUS5hbnN3ZXJzW2F0aV07ICU-CiAgICAgICAgICAgICAgICA8aW5wdXQgbmFtZT0ibnBzXzwlPSBjdXJRLmlkICU-IiBpZD0ibnBzXzwlPSBjdXJRLmlkICU-XzwlPSBhbnMuaWQgJT4iCiAgICAgICAgICAgICAgICAgICAgICAgcXVlc3Rpb25pZD0iPCU9IGN1clEuaWQgJT4iIHR5cGU9InJhZGlvIgogICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkPSI8JT0gY3VyUS5yZXF1aXJlZCAlPiIKICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT0iPCU9IGFucy5pZCAlPiIvPgogICAgICAgICAgICAgICAgPCUgaWYgKGF0aSA9PT0gMCkgeyAlPgogICAgICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzcz0ibnBzLXJhdGluZ19fYmFkZ2UiIGZvcj0ibnBzXzwlPSBjdXJRLmlkICU-XzwlPSBhbnMuaWQgJT4iIHRhYmluZGV4PSI8JT0gYXRpICU-Ij4KICAgICAgICAgICAgICAgIDwlIH0gZWxzZSB7JT4KICAgICAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9Im5wcy1yYXRpbmdfX2JhZGdlIiBmb3I9Im5wc188JT0gY3VyUS5pZCAlPl88JT0gYW5zLmlkICU-Ij4KICAgICAgICAgICAgICAgIDwlIH0gJT4KICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibnBzLXJhdGluZ19faGVpZ2h0X2ZpeCI-PC9kaXY-CiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im5wcy1yYXRpbmdfX251bSI-PCU9YXRpJT48L2Rpdj4KICAgICAgICAgICAgICAgIDwvbGFiZWw-CiAgICAgICAgICAgICAgICA8JSB9ICU-CiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ic3RyZXRjaCIvPgogICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im5wcy1yYXRpbmdfX2xhYmVscyI-CiAgICAgICAgICAgICAgICA8JQogICAgICAgICAgICAgICAgICB2YXIgbnBzWmVybyA9IGN1clEuYW5zd2Vyc1swXS5sYmw7CiAgICAgICAgICAgICAgICAgIHZhciBucHNUZW4gPSBjdXJRLmFuc3dlcnNbY3VyUS5hbnN3ZXJzLmxlbmd0aC0xXS5sYmw7CiAgICAgICAgICAgICAgICAgIGlmIChleHRyYUluZm8ubnBzWmVybykgewogICAgICAgICAgICAgICAgICAgIG5wc1plcm8gPSBleHRyYUluZm8ubnBzWmVybzsKICAgICAgICAgICAgICAgICAgICBucHNUZW4gPSBleHRyYUluZm8ubnBzVGVuOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgJT4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im5wc19yYXRpbmdfbGVmdF9sYWJlbCI-PCU9IG5wc1plcm8gJT48L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im5wc19yYXRpbmdfcmlnaHRfbGFiZWwiPjwlPSBucHNUZW4gJT48L2Rpdj4KICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPC9maWVsZHNldD4KICAgICAgICAgIDwvZGl2PgogICAgICAgICAgPCUgfSAlPgogICAgICAgICAgPCUgaWYgKGN1clEucXVlc3Rpb25UeXBlID09PSAnRFJPUF9ET1dOJyApIHsgJT4KICAgICAgICAgICAgPCUgaWYgKGN1clEuYW5zd2Vycy5sZW5ndGggPiAxKSB7ICU-CiAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iYXVyeWMtZmVlZGJhY2stZmJxdWVzdGlvbiIgc3R5bGU9InBhZGRpbmctYm90dG9tOiA1cHggIWltcG9ydGFudCIgcXVlc3Rpb25pZD0iPCU9IGN1clEuaWQgJT4iIHJlcXVpcmVkPSI8JT0gY3VyUS5yZXF1aXJlZCAlPiI-CiAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9ImF1cnljLWZlZWRiYWNrLWZibGFiZWwiPjwlPSBjdXJRLnF1ZXN0aW9uVGV4dCAlPjwvbGFiZWw-CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJhdXJ5Yy1mZWVkYmFjay1xdWVzdGlvbi1zZWxlY3QtY2hvb3NlIiBxdWVzdGlvbmlkPSI8JT0gY3VyUS5pZCAlPiIgcmVxdWlyZWQ9IjwlPSBjdXJRLnJlcXVpcmVkICU-Ij4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJhdXJ5Yy1mZWVkYmFjay1zZWxlY3QtYnV0dG9uIj4KICAgICAgICAgICAgICAgICAgICAgICAgPCUgaWYgKGN1clEuYW5zd2Vycy5sZW5ndGggPiAxKSB7ICU-CiAgICAgICAgICAgICAgICAgICAgICAgIDwlPSBleHRyYUluZm8uY2hvb3NlICU-CiAgICAgICAgICAgICAgICAgICAgICAgIDwlIH0gZWxzZSB7ICU-CiAgICAgICAgICAgICAgICAgICAgICAgIDwlPSBjdXJRLmFuc3dlcnNbMF0ubGFiZWwgJT4KICAgICAgICAgICAgICAgICAgICAgICAgPCUgfSAlPgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgIDxzZWxlY3QgaWQ9InNfPCU9IGN1clEuaWQgJT4iIGNsYXNzPSJhdXJ5Yy1mYi1xdWVzdGlvbmdyb3VwLXNlbGVjdG9yIiB0YWJpbmRleD0iMCI-CiAgICAgICAgICAgICAgICAgICAgICAgIDwlIGlmIChjdXJRLmFuc3dlcnMubGVuZ3RoID4gMSkgeyAlPgogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uPjwlPSBleHRyYUluZm8uY2hvb3NlICU-PC9vcHRpb24-CiAgICAgICAgICAgICAgICAgICAgICAgIDwlIH0gJT4KICAgICAgICAgICAgICAgICAgICAgICAgPCUgZm9yICh2YXIgYXRpcSA9IDA7IGF0aXEgPCBjdXJRLmFuc3dlcnMubGVuZ3RoOyBhdGlxKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhbnMgPSBjdXJRLmFuc3dlcnNbYXRpcV07ICU-CiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IjwlPSBhbnMuaWQgJT4iPjwlPSBhbnMubGFiZWwgJT48L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgPCUgfSAlPgogICAgICAgICAgICAgICAgICAgIDwvc2VsZWN0PgogICAgICAgICAgICAgICAgPC9kaXY-CiAgICAgICAgICAgICAgPC9kaXY-CiAgICAgICAgICAgIDwlIH0gJT4KICAgICAgICAgICAgPCUgZm9yICh2YXIgdHBpID0gMDsgdHBpIDwgdG9waWNzLmxlbmd0aDsgdHBpKyspIHsKICAgICAgICAgICAgICAgIHZhciB0b3BrID0gdG9waWNzW3RwaV07ICU-CiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImF1cnljLWZlZWRiYWNrLWZicXVlc3Rpb25ncm91cCIgaWQ9InRvcGtfPCU9IHRvcGsudG9waWNBbnN3ZXJJZCAlPiI-CiAgICAgICAgICAgICAgICA8JSBmb3IgKHZhciBxaSA9IDA7IHFpIDwgdG9way5xdWVzdGlvbnMubGVuZ3RoOyBxaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHEgPSB0b3BrLnF1ZXN0aW9uc1txaV07CiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcUZvbnQgPSBxLnJlcXVpcmVkID8gJyonIDogJyc7ICU-CiAgICAgICAgICAgICAgPGRpdiBkYXRhVHlwZT0iYXVyeWMtZmJxIiBjbGFzcz0iPCUgaWYgKHEucXVlc3Rpb25UeXBlID09PSAnU0NBTEVEJykgeyU-YXVyeWMtc3RhcnJhdGluZy1zZWN0aW9uPCUgfSU-IiBpZD0iYXVyeWNxXzwlPSBxLmlkICU-IgogICAgICAgICAgICAgICAgICAgIHF1ZXN0aW9uaWQ9IjwlPSBxLmlkICU-IiByZXF1aXJlZD0iPCU9IHEucmVxdWlyZWQgJT4iIGRhdGEtcXVlc3Rpb24tdHlwZT0iPCU9IHEucXVlc3Rpb25UeXBlICU-Ij4KICAgICAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9ImF1cnljLWZlZWRiYWNrLWZibGFiZWwiIHN0eWxlPSJ0ZXh0LWFsaWduOiBsZWZ0ICFpbXBvcnRhbnQ7cGFkZGluZy1ib3R0b206NXB4ICFpbXBvcnRhbnQ7IiBmb3I9ImF1cnljX29iajwlPSBxLmlkICU-IiBkYXRhLXF1ZXN0aW9udHlwZT0iXzwlPSBxLnF1ZXN0aW9uVHlwZSAlPiI-PCU9IHEucXVlc3Rpb25UZXh0ICU-PGZvbnQgY29sb3I9IiNGRjRDODgiPjwlPSByZXFGb250ICU-PC9mb250PjwvbGFiZWw-CiAgICAgICAgICAgICAgICAgICAgPCUgaWYgKHEucXVlc3Rpb25UeXBlID09PSAnQ0hFQ0tCT1gnKSB7ICU-CiAgICAgICAgICAgICAgICAgICAgPGRpdiBkYXRhVHlwZT0iYXVyeWMtZmVlZGJhY2stY2hlY2tib3giPgogICAgICAgICAgICAgICAgICAgICAgICA8JSBmb3IgKHZhciBhbnNpID0gMDsgYW5zaSA8IHEuYW5zd2Vycy5sZW5ndGg7IGFuc2krKykgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYW5zID0gcS5hbnN3ZXJzW2Fuc2ldOyAlPgogICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJfPCU9IGFucy5pZCAlPiIgY2xhc3M9ImF1cnljLWZlZWRiYWNrLWNoZWNrYm94IiBzdHlsZT0idGV4dC1hbGlnbjogbGVmdDsiIHRhYmluZGV4PSIwIj48aW5wdXQgdHlwZT0iY2hlY2tib3giIHZhbHVlPSI8JT0gYW5zLnZhbHVlICU-IiBxdWVzdGlvbmlkPSI8JT0gYW5zLmlkICU-IiBpZD0iXzwlPSBhbnMuaWQgJT4iIHRhYmluZGV4PSIwIi8-PCU9IGFucy5sYWJlbCAlPjwvbGFiZWw-CiAgICAgICAgICAgICAgICAgICAgICAgIDwlIH0gJT4KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8JSB9ICU-CiAgICAgICAgICAgICAgICAgICAgPCUgaWYgKHEucXVlc3Rpb25UeXBlID09ICdSQURJT19CVVRUT04nKSB7ICU-CiAgICAgICAgICAgICAgICAgICAgPGRpdiBkYXRhVHlwZT0iYXVyeWMtZmVlZGJhY2stcmFkaW8iPgogICAgICAgICAgICAgICAgICAgICAgICA8JSBmb3IgKHZhciBhbnNpID0gMDsgYW5zaSA8IHEuYW5zd2Vycy5sZW5ndGg7IGFuc2krKykgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYW5zID0gcS5hbnN3ZXJzW2Fuc2ldOyAlPgogICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJfPCU9IGFucy5pZCAlPiIgY2xhc3M9ImF1cnljLWZlZWRiYWNrLXJhZGlvIiB0YWJpbmRleD0iMCI-PGlucHV0IHR5cGU9InJhZGlvIiBuYW1lPSJhdXJ5Y3JkXzwlPSBxLmlkICU-IiB2YWx1ZT0iPCU9IGFucy5pZCAlPiIgbGFiZWw9IjwlPSBlbmNvZGVVUklDb21wb25lbnQoYW5zLmxhYmVsKSAlPiIgaWQ9Il88JT0gYW5zLmlkICU-IiBxdWVzdGlvbmlkPSI8JT0gcS5pZCAlPiIvPjwlPSBhbnMubGFiZWwgJT48L2xhYmVsPgogICAgICAgICAgICAgICAgICAgICAgICA8JSB9ICU-CiAgICAgICAgICAgICAgICAgICAgPC9kaXY-CiAgICAgICAgICAgICAgICAgICAgPCUgfSAlPgogICAgICAgICAgICAgICAgICAgIDwlIGlmIChxLnF1ZXN0aW9uVHlwZSA9PT0gJ09QRU5FTkQnKSB7ICU-CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iYXVyeWMtZmVlZGJhY2stZmJ0YXJlYSI-CiAgICAgICAgICAgICAgICAgICAgICAgIDx0ZXh0YXJlYSBpZD0iYXVyeWNfb2JqPCU9IHEuaWQgJT4iCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzcz0iYXVyeWMtZmVlZGJhY2stcXVlc3Rpb24tdGV4dGFyZWEiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPSI8JT0geW91ckFuc3dlciAlPiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXJ5Y21heGxlbmd0aD0iMTAwMCIgdGFiaW5kZXg9IjAiPjwvdGV4dGFyZWE-CiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJhdXJ5Yy1mZWVkYmFja19jb3VudFdyYXBwZXIiPiA8JT0gbGVmdExhYmVsICU-PC9zcGFuPgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgIDwlIH0gJT4KICAgICAgICAgICAgICAgICAgICA8JSBpZiAocS5xdWVzdGlvblR5cGUgPT09ICdDT05UQUNUX0lORk8nKSB7ICU-CiAgICAgICAgICAgICAgICAgICAgPCEtLSBUZXh0IGlucHV0IC0tPgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImF1cnljLWZlZWRiYWNrLXRleHQgYXVyeWMtZmVlZGJhY2stZW1haWwiPgogICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgcGxhY2Vob2xkZXI9IkVtYWlsIiBpZD0ic3JfPCU9IHEuaWQgJT4iIGNsYXNzPSJhdXJ5Yy1mZWVkYmFjay1mYmVtYWlsIiB0YWJpbmRleD0iMCIgdHlwZT0idGV4dCIgPCUgaWYgKDEpIHsgJT5yZXF1aXJlZDwlIH0gJT4vPgogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJhdXJ5Yy1mYi12YWxpZGF0aW9uLW1zZy1zZWN0aW9uIj48L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8JSB9ICU-CiAgICAgICAgICAgICAgICAgICAgPCUgaWYgKHEucXVlc3Rpb25UeXBlID09PSAnRFJPUF9ET1dOJyApIHsgJT4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iLmF1cnljLWZlZWRiYWNrLWZicXVlc3Rpb24tZHJvcGRvd24iIHN0eWxlPSJwYWRkaW5nLWJvdHRvbTogNXB4ICFpbXBvcnRhbnQiIHF1ZXN0aW9uaWQ9IjwlPSBxLmlkICU-IiByZXF1aXJlZD0iPCU9IHEucmVxdWlyZWQgJT4iPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iYXVyeWMtZmVlZGJhY2stcXVlc3Rpb24tc2VsZWN0LWNob29zZSIgcXVlc3Rpb25pZD0iPCU9IHEuaWQgJT4iIHJlcXVpcmVkPSI8JT0gcS5yZXF1aXJlZCAlPiI-CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iYXVyeWMtZmVlZGJhY2stc2VsZWN0LWJ1dHRvbiI-CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwlPSBleHRyYUluZm8uY2hvb3NlICU-CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY-CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNlbGVjdCBpZD0ic188JT0gcS5pZCAlPiIgY2xhc3M9ImF1cnljLWZiLXF1ZXN0aW9uLXNlbGVjdG9yIiB0YWJpbmRleD0iMCI-CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24-PCU9IGV4dHJhSW5mby5jaG9vc2UgJT48L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPCUgZm9yICh2YXIgYXRpcSA9IDA7IGF0aXEgPCBxLmFuc3dlcnMubGVuZ3RoOyBhdGlxKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhbnMgPSBxLmFuc3dlcnNbYXRpcV07ICU-CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IjwlPSBhbnMuaWQgJT4iPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPCU9IGFucy5sYWJlbCAlPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPCUgfSAlPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc2VsZWN0PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY-CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgIDwlIH0gJT4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPCUgfSAlPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPCUgfSAlPgogICAgICAgICAgPCUgfSAlPgogICAgICA8L2Rpdj4KICAgICAgPCUgfSAlPgogICAgICA8JSB9ICU-CgogICAgICA8ZGl2IGNsYXNzPSJhdXJ5Yy1mZWVkYmFjay1mb290ZXItc2VjdGlvbiI-CiAgICAgICAgPCUgdmFyIGJ0blRleHQgPSAiIjsgJT4KICAgICAgICAgICAgPCUgaWYgKGZvcm1Db25maWcuYnRuRm9udENvbG9yKSB7ICU-CiAgICAgICAgICAgICAgICA8JSBidG5UZXh0ID0gIjxzcGFuIHN0eWxlPVwiY29sb3I6IiArIGZvcm1Db25maWcuYnRuRm9udENvbG9yICsgIlwiPiIgKyBleHRyYUluZm8uc3VibWl0ICsgIjwvc3Bhbj4iOyAlPgogICAgICAgICAgICA8JSB9IGVsc2UgeyAlPgogICAgICAgICAgICAgICAgPCUgYnRuVGV4dCA9IGV4dHJhSW5mby5zdWJtaXQ7ICU-CiAgICAgICAgPCUgfSAlPgogICAgICAgICAgICA8JSBpZiAoZm9ybUNvbmZpZy5idG5CYWNrZ3JvdW5kQ29sb3IpIHsgJT4KICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9InBvc3QtZmItcmVzcC1idXR0b24iCiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPSJiYWNrZ3JvdW5kOiA8JT1mb3JtQ29uZmlnLmJ0bkJhY2tncm91bmRDb2xvciU-OyBib3JkZXI6IDFweCBzb2xpZCA8JT1mb3JtQ29uZmlnLmJ0bkJhY2tncm91bmRDb2xvciU-IgogICAgICAgICAgICAgICAgICAgICAgICBpZD0icG9zdC1mYi1yZXNwLWJ1dHRvbiIgdGFiaW5kZXg9IjAiPgogICAgICAgICAgICAgICAgICAgIDwlPSBidG5UZXh0ICU-CiAgICAgICAgICAgICAgICA8L2J1dHRvbj4KICAgICAgICAgICAgPCUgfSBlbHNlIHsgJT4KICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9InBvc3QtZmItcmVzcC1idXR0b24iIGlkPSJwb3N0LWZiLXJlc3AtYnV0dG9uIiB0YWJpbmRleD0iMCI-CiAgICAgICAgICAgICAgICAgICAgPCU9IGJ0blRleHQgJT4KICAgICAgICAgICAgICAgIDwvYnV0dG9uPgogICAgICAgICAgICA8JSB9ICU-CiAgICAgICAgPGRpdiBpZD0iYXVyeWMtZmVlZGJhY2stY2FudmFzIj4KICAgICAgICAgIDxkaXYgY2xhc3M9ImF1cnljLWZibW9kYWwtZm9vdGVyIj48c3Bhbj48JT0gcG93ZXJlZEJ5ICU-PC9zcGFuPiA8aW1nIHNyYz0iaHR0cHM6Ly9zMy11cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9hdXJ5Yy1wdWJsaWMvZGFyay1sb2dvLnN2ZyIgYWx0PSJBdXJ5YyIgc3R5bGU9IndpZHRoOjYwcHggIWltcG9ydGFudDtoZWlnaHQ6MjBweCAhaW1wb3J0YW50OyI-PC9kaXY-CiAgICAgICAgPC9kaXY-CiAgICAgIDwvZGl2PgogIDwvZGl2Pgo8L2Rpdj4KPGRpd",window[constants.symbols.FBTHANKYOU]="iBjbGFzcz0iYXVyeWMtZmVlZGJhY2sgYXVyeWMtdGhhbmt5b3UtY29udGFpbmVyIj4KICAgIDxkaXYgZGF0YVR5cGU9ImF1cnljLWZicSIgY2xhc3M9ImF1cnljLWZlZWRiYWNrLXRpdGxlLXNlY3Rpb24iPgogICAgICAgIDwlIGlmIChtZXRhLmxvZ28xZ3JhcGhpYykgeyAlPgogICAgICAgIDxpbWcgc3JjPSI8JT0gbWV0YS5sb2dvMWdyYXBoaWMgJT4iIGNsYXNzPSJhdXJ5Yy1mZWVkYmFjay1mYmxvZ28iLz4KICAgICAgICA8JSB9ICU-CiAgICA8L2Rpdj4KICAgIDxkaXYgZGF0YVR5cGU9ImF1cnljLWZicSIgY2xhc3M9ImF1cnljLWZlZWRiYWNrLXRpdGxlLXNlY3Rpb24iPgogICAgICAgIDwlIGlmIChtZXRhLmVwaWxvZ3VldGV4dCAmJiBtZXRhLmVwaWxvZ3VldGV4dC5sZW5ndGggPiAxKSB7JT4KICAgICAgICAgICAgPCUgaWYgKG1ldGEuZXBpbG9ndWV0ZXh0LmluZGV4T2YoJ2gxJykgPT09IC0xKSB7JT4KICAgICAgICAgICAgICAgIDxoMSBjbGFzcz0iYXVyeWMtZmVlZGJhY2stZmJmb3JtLWhlYWR0YWcgYXVyeWMtZmVlZGJhY2stZmJmb3JtLWhlYWR0YWctaDEiPjwlPSBtZXRhLmVwaWxvZ3VldGV4dCAlPjwvaDE-CiAgICAgICAgICAgIDwlIH0gZWxzZSB7ICU-CiAgICAgICAgICAgICAgICA8JT0gbWV0YS5lcGlsb2d1ZXRleHQgJT4KICAgICAgICAgICAgPCUgfSAlPgogICAgICAgIDwlIH0gZWxzZSB7JT4KICAgICAgICAgICAgPGgxIGNsYXNzPSJhdXJ5Yy1mZWVkYmFjay1mYmZvcm0taGVhZHRhZyBhdXJ5Yy1mZWVkYmFjay1mYmZvcm0taGVhZHRhZy1oMSI-WW91ciBGZWVkYmFjayBIYXMgQmVlbiBTdWJtaXR0ZWQ8L2gxPgogICAgICAgIDwlIH0gJT4KICAgIDwvZGl2PgogICAgPCUgdmFyIGJ0blRleHQgPSAiIjsgJT4KICAgIDwlIGlmIChmb3JtQ29uZmlnLmJ0bkZvbnRDb2xvcikgeyAlPgogICAgICAgIDwlIGJ0blRleHQgPSAiPHNwYW4gc3R5bGU9XCJjb2xvcjoiICsgZm9ybUNvbmZpZy5idG5Gb250Q29sb3IgKyAiXCI-IiArIGV4dHJhSW5mby5vayArICI8L3NwYW4-IjsgJT4KICAgIDwlIH0gZWxzZSB7ICU-CiAgICAgICAgPCUgYnRuVGV4dCA9IGV4dHJhSW5mby5vazsgJT4KICAgIDwlIH0gJT4KICAgIDwlIGlmIChmb3JtQ29uZmlnLmJ0bkJhY2tncm91bmRDb2xvcikgeyAlPgogICAgICAgIDxkaXYgc3R5bGU9InRleHQtYWxpZ246IGNlbnRlciI-CiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImF1cnljLWNsb3NlLWJ0biIKICAgICAgICAgICAgICAgICAgICB0YWJpbmRleD0iMCIgYXV0b2ZvY3VzPSJhdXRvZm9jdXMiCiAgICAgICAgICAgICAgICAgICAgc3R5bGU9ImJhY2tncm91bmQ6IDwlPWZvcm1Db25maWcuYnRuQmFja2dyb3VuZENvbG9yJT47IGJvcmRlcjogMXB4IHNvbGlkIDwlPWZvcm1Db25maWcuYnRuQmFja2dyb3VuZENvbG9yJT4iPgogICAgICAgICAgICAgICAgPCU9IGJ0blRleHQgJT4KICAgICAgICAgICAgPC9idXR0b24-CiAgICAgICAgPGRpdj4KICAgIDwlIH0gZWxzZSB7ICU-CiAgICAgICAgPGRpdiBzdHlsZT0idGV4dC1hbGlnbjogY2VudGVyIj4KICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYXVyeWMtY2xvc2UtYnRuIgogICAgICAgICAgICAgICAgICAgIHRhYmluZGV4PSIwIiBhdXRvZm9jdXM9ImF1dG9mb2N1cyIKICAgICAgICAgICAgICAgICAgICBzdHlsZT0iYmFja2dyb3VuZDojMjNDNmY1OyBib3JkZXI6IDFweCBzb2xpZCAjMjNDNmY1Ij4KICAgICAgICAgICAgICAgIDwlPSBidG5UZXh0ICU-CiAgICAgICAgICAgIDwvYnV0dG9uPgogICAgICA8ZGl2PgogICAgPCUgfSAlPgoKPC9kaXY-Cg==PGRpd"}var FbModule=function(){function e(){classCallCheck(this,e)}return createClass(e,[{key:"setupFeedback",value:function(e){var t=this;this.setupProjects(e),navigationEvent.addListener(function(){t.setupProjects(e)})}},{key:"setupProjects",value:function(n){if(!globalSessionTracker.isCanceled()){this.feedbackCfg.instances.forEach(function(e){if(n.isConfigInstanceActive(e,window.location.href))if(e.trigger)e.trigger.handleNavigation(!0);else{var t=new Trigger(e,n);(e.trigger=t).fbTabClicked.addListener((i=e,function(){return globalPopupController.initialize(i,!0)}))}else e.trigger&&e.trigger.handleNavigation(!1);var i})}}},{key:"readyFn",value:function(){var e=this,t=window.location.hash,i=!!getHashParam(t,"previewmode"),n=!!getHashParam(t,"previewbadgemode")||!!getHashParam(t,"previewfbtabmode"),r=new Criteria;if(i||n){if(i)return void(new Preview).showFeedback();if(n)return void(new Preview).displayFBTab()}else feedbackAPI.makePublic(feedbackAPI,this.feedbackCfg,globalPopupController),feedbackAPI.feedbackEnabled.addListener(function(){return e.setupFeedback(r)}),this.setupFeedback(r)}},{key:"init",value:function(){if(config.isProductEnabled("feedback"))config.isVisualEditorMode()?logger.warn("fb: product disabled"):(initTemplate(),this.feedbackCfg=config.getProductConfig("feedback"),this.readyFn());else{logger.log("fb: product disabled");var e={isFBProductEnabled:function(){return!1}};feedbackAPI.makePublic(e)}}},{key:"pause",value:function(){this.feedbackCfg.instances.forEach(function(e){var t=e.trigger;t&&(t.disable(),t.delayFBTabTimer&&clearTimeout(t.delayFBTabTimer),t.delayedPopupTimer&&clearTimeout(t.delayedPopupTimer)),e.trigger=null})}},{key:"resume",value:function(){var t=!1;this.feedbackCfg.instances.forEach(function(e){e.trigger||(t=!0)}),t&&this.init()}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),ControllerApi=function(){function e(){classCallCheck(this,e)}return createClass(e,[{key:"pause",value:function(){this.rcController=RcController.getInstance(window),this.rcController.pause(),FbModule.getInstance().pause()}},{key:"resume",value:function(){this.rcController=RcController.getInstance(window),this.rcController.resume(),FbModule.getInstance().resume()}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),attempts$1=20;function checkAndSet(){if(logger.log("check and set called"),window.aurycBehaviorAPI&&window.aurycFeedbackAPI&&window.aurycRecordAPI){logger.log("expose public API"),window.auryc=new AurycPublicApi(window.aurycBehaviorAPI,window.aurycFeedbackAPI,window.aurycRecordAPI,new LinkidAPI,ControllerApi.getInstance());var e=window.aurycReadyCb,t=window.usertyReadyCb;if(e&&0<e.length)for(var i=e.length,n=0;n<i;n++)e[n]();if(t&&_.isArray(t))for(var r=t.length,s=0;s<r;s++)t[s]()}else 0<attempts$1&&(setTimeout(checkAndSet,250),attempts$1--)}function init$1(){logger.log("api domready"),config.isProductEnabled("behavior")?checkAndSet():logger.log("product disabled. Don't expose API")}var api={init:init$1};function isPlatformSupported(e,t,i){if(isInitialized())i&&i();else{var n=config.getConfig("browser_cutoff","base"),r=config.getConfig("platform_cutoff","base"),s=n[e.browser.name];if(s&&e.browser.version<s)i&&i();else{var a=r[e.os.name];a&&e.os.version<a?i&&i():t&&t()}}}function isInitialized(){return!!window.auryc}function isSupported(e,t){var i=getInstance();i.isAvail?isPlatformSupported(i,e,t):i.brAvailEvent.addListener(function(){isPlatformSupported(i,e,t)})}function checkExclusions(e,t){var i=(config.getConfig("excluded","behavior")||{}).urls||[],n=(constants.excluded||{}).urls||[],r=i.concat(n);if(r&&0<r.length){var s=window.location.href,a=r.filter(function(e){return-1<s.indexOf(e)});a&&0<a.length?t():e()}else e()}function init$2(e,t){logger.log("*** init called",!0),config.init(),checkExclusions(function(){return isSupported(e,t)},t)}var utils={init:init$2},IdentifyAPI=function(){function n(e,t,i){classCallCheck(this,n),this.product=e||"auryc",this.sessStg=t,this.persStg=i,this.errorMsg={badProp:"The property key or values are invalid",dupName:"The name has already been used. Please choose a different name",badIdentity:"The identity value is invalid"}}return createClass(n,[{key:"makePublic",value:function(e){_.isDefined(e)&&(window.auryc||(window.aurycBehaviorAPI={}),window.aurycBehaviorAPI=e)}},{key:"loadEventGroups",value:function(e){var t=this.sessStg.getByKey(this.getDefinedEventsStorKey());if(t)e(t);else{var i=this.getUbaApi()+"/eventgroup/?projectId="+config.getSiteid();this._postRequest({uri:i,type:"EVENTGROUP",callback:e})}}},{key:"getUbaApi",value:function(){var e=config.getConfig("uba_api_uri","base");return e=location.protocol+"//"+e}},{key:"getTokenUri",value:function(){var e=config.getConfig("token_uri","base");return e=location.protocol+"//"+e}},{key:"getDefinedEventsStorKey",value:function(){return"DE_"+config.getSiteid()}},{key:"tokenCallBack",value:function(e,t,i){if(t){var n={"Content-Type":"application/json","X-Authorized-Identity":config.getSiteid(),"X-Authorized-Token":t};this.sendRequest(i,n,"GET",e)}}},{key:"_postRequest",value:function(t,i){var e=config.getConfig("siteToken","base");if(e)this.tokenCallBack(i,e,t);else{var n={uri:this.getTokenUri()+"/"+config.getSiteid()+"/token",type:"TOKEN",callback:function(e){return this.tokenCallBack(i,e,t)}};this.sendRequest(n,null,"GET",i)}}},{key:"validateArrayType",value:function(e){if(!e||!_.isArray(e)||0===e.length)return!1;var t=_typeof(e[0]).toLowerCase();if("string"!==t&&"number"!==t&&"boolean"!==t)return!1;for(var i=0;i<e.length;i++)if(null===e[i]||_typeof(e[i])!==t||1024<t.length)return!1;return!0}},{key:"validateKey",value:function(e){return!!e&&"undefined"!==e&&e.length<=1024}},{key:"validateProps",value:function(e){for(var t in e){if(!this.validateKey(t))return!1;if(_.isArray(e[t]))return this.validateArrayType(e[t]);if(null===e[t]||void 0===e[t]||1024<e[t].length||"string"!=typeof e[t]&&"number"!=typeof e[t]&&"boolean"!=typeof e[t])return!1}return!0}},{key:"transformProps",value:function(e){for(var t in e)if(_.isArray(e[t])){20<e[t].length&&(e[t]=e[t].slice(0,20));for(var i=0;i<e[t].length;i++)"string"===_typeof(e[t][i]).toLowerCase()?e[t][i]=e[t][i].toLowerCase():e[t][i]=e[t][i];e[t]=JSON.stringify(e[t])}return e}},{key:"sendRequest",value:function(i,e,t,n){try{var r=window.XMLHttpRequest?new window.XMLHttpRequest:window.ActiveXObject?new window.ActiveXObject("Microsoft.XMLHTTP"):null;r.open(t,i.uri,!0);var s=this;for(var a in r.onreadystatechange=function(){if(4===this.readyState&&200===this.status)if("TOKEN"===i.type){if(r.responseText&&1<r.responseText.length){var e={siteToken:JSON.parse(r.responseText).siteToken};s.sessStg.setSessionByKey(constants.symbols.APITOKEN+"_"+config.getSiteid(),JSON.stringify(e),constants.storage.SCOPE.SESSION.BROWSER),i.callback&&"function"==typeof i.callback&&i.callback.call(s,r.responseText)}}else if("EVENTGROUP"===i.type&&r.responseText&&1<r.responseText.length){var t=JSON.parse(r.responseText);t=t.data.map(function(e,t){return{id:e.id,eventName:e.name,eventType:e.eventType,snapshotProperties:e.snapshotProperties,jsCriteria:e.jsCriteria}}),s.sessStg.setTabByKey(s.getDefinedEventsStorKey(),t),logger.log(s.getDefinedEventsStorKey(),t),i.callback&&"function"==typeof i.callback&&i.callback.call(s,t)}"USERIDENTIFY"===i.type&&(4===this.readyState&&200===this.status?r.responseText&&1<r.responseText.length&&i.callback&&"function"==typeof i.callback&&i.callback.call(s,r.responseText):4===this.readyState&&226===this.status&&i.callback&&"function"==typeof i.callback&&i.callback.call(s,226))},e)r.setRequestHeader(a,e[a]);n?r.send(JSON.stringify(n)):r.send()}catch(e){logger.log(e)}}},{key:"isBehaviorTrackingEnabled",value:function(){return!0}},{key:"identify",value:function(e){e&&0<e.length&&e.length<256&&0!==e&&1!==e&&-1!==e&&"nan"!==e&&"n/a"!==e&&"undefined"!==e&&"null"!==e&&"nil"!==e?(this.persStg.resetUserProp(),this.persStg.setUserProp(constants.events.IDENTITYVALUE,e),AurycPubSub.publish(constants.events.USERIDENTIFY,{identity:e})):console.error(this.errorMsg.badIdentity)}},{key:"addSessionProperties",value:function(e){if("object"===(void 0===e?"undefined":_typeof(e)))if(this.validateProps(e)){e=this.transformProps(e);var t=this.persStg.getByKey(constants.events.USERID)+constants.events.SESSIONPROP,i=localStorage.getItem(t);if(i&&JSON.stringify(e)===i)return void logger.log("session properties already set and identical to the new one. skip");var n=JSON.stringify(e);this.sessStg.getSize()+n.length<1024&&(logger.log("session properties not identical to the new one. call API"),localStorage.setItem(t,n)),AurycPubSub.publish(constants.events.USERIDENTIFY,{sessionProperties:e})}else console.error(this.errorMsg.badProp);else console.error(this.errorMsg.badProp)}},{key:"addInternalSessionProperties",value:function(e){if("object"===(void 0===e?"undefined":_typeof(e)))if(this.validateProps(e)){e=this.transformProps(e);var t=this.persStg.getByKey(constants.events.USERID)+constants.events.INTERNALSESSIONPROP,i=localStorage.getItem(t);if(i&&JSON.stringify(e)===i)return void logger.log("session properties already set and identical to the new one. skip");var n=JSON.stringify(e);this.sessStg.getSize()+n.length<1024&&(logger.log("session properties not identical to the new one. call API"),localStorage.setItem(t,n)),AurycPubSub.publish(constants.events.USERIDENTIFY,{internalSessionProperties:e})}else console.error(this.errorMsg.badProp);else console.error(this.errorMsg.badProp)}},{key:"addUserProperties",value:function(e){var t=this.persStg.getByKey(constants.events.USERID);if("object"===(void 0===e?"undefined":_typeof(e))&&t)if(this.validateProps(e)){e=this.transformProps(e);var i=null,n={};try{i=(n=JSON.parse(this.persStg.getUserProp(constants.events.USERPROP)))[t]}catch(e){}if(n[t]=e,i&&JSON.stringify(e)===JSON.stringify(i))return void logger.log("user properties already set and identical to the new one. skip");logger.log("user properties not identical to the new one. call API");var r=this.persStg.getStorageSize(),s=JSON.stringify(n),a=JSON.stringify(e);if(r+s.length<5120)this.persStg.setUserProp(constants.events.USERPROP,s);else if(a.length<1024){for(var o=Object.keys(n),c=0;c<o.length;c++)o[c]!==t&&delete n[o[c]];s=JSON.stringify(n),this.persStg.setUserProp(constants.events.USERPROP,s)}AurycPubSub.publish(constants.events.USERIDENTIFY,{userProperties:e})}else console.error(this.errorMsg.badProp);else console.error(this.errorMsg.badProp)}},{key:"track",value:function(n,r){var e=!0,t=!_.isEmpty(r);!n||1024<n.length?(e=!1,console.error(n)):t&&(e=this.validateProps(r));var i=function(e){for(var t=!0,i=0;i<e.length;i++)if(e[i].eventName===n&&"CUSTOM"!==e[i].eventType){t=!1;break}t?AurycPubSub.publish(constants.events.TRACKCUSTOMEVENT,{eventType:constants.events.CUSTOM_EVENT,eventName:n,eventProperties:r||{},currentTime:_.now()}):console.error(this.errorMsg.dupName)};if(e){r=this.transformProps(r);var s=config.getSiteid(),a=this.sessStg.getByKey(this.getDefinedEventsStorKey());if(a)i(a);else{var o=this.getUbaApi()+"/eventgroup/?projectId="+s;this._postRequest({uri:o,type:"EVENTGROUP",callback:i})}}else console.error(this.errorMsg.badProp)}},{key:"getSessionMetadata",value:function(){return globalSessionTracker.getSessionMetadata()}},{key:"endSession",value:function(){return globalSessionTracker.endSession(!0)}},{key:"clearUserCookie",value:function(e){var t=!0;e&&!this.persStg.getByKey(constants.events.IDENTITYVALUE)&&(logger.log("called clear user cookie but identity is null. skip"),t=!1),t&&(logger.log("clear user cookie"),globalSessionTracker.removeUser(),globalSessionTracker.renewSession())}}]),n}();function setup(){trackAdobeTT()}function getAdobeTTVar(){var e=config.getConfig("ABTest","behavior");if(e)return e.adobeTT}function getAdobeCNames(){var e=[],t=[],i=window.ttMETA;if(i&&_.isArray(i))for(var n=0;n<i.length;n++){var r=i[n];r.campaign&&""!==r.campaign&&(e.push(r.campaign),r.experience&&""!==r.experience&&t.push(r.campaign+"="+r.experience))}return{cNames:e,ceNames:t}}function instrument(e){var t=getAdobeCNames(),i={};e.campaign_var&&0<t.cNames.length&&(i[e.campaign_var]=t.cNames),e.campaign_exp_var&&0<t.ceNames.length&&(i[e.campaign_exp_var]=t.ceNames),_.isEmptyObject(i)||window.aurycBehaviorAPI.addUserProperties(i)}function trackAdobeTT(){var e=getAdobeTTVar();e&&!0===e.enabled&&(window.aurycBehaviorAPI&&window.aurycBehaviorAPI.addUserProperties?instrument(e):window.aurycReadyCb.push(function(){instrument(e)}))}var abtests={setup:setup,getAdobeTTVar:getAdobeTTVar,getAdobeCNames:getAdobeCNames,instrument:instrument,trackAdobeTT:trackAdobeTT};function setup$1(){var e=config.getConfig("sessionProperties","behavior");if(e&&_.isArray(e)){for(var t={},i=0;i<e.length;i++){var n=e[i];if(n.source&&"cookie"===n.source&&n.key&&n.prop){var r=Cookie.Get(n.key);null!==r&&(n.type&&("number"===n.type.toLowerCase()?r=+r:"boolean"===n.type.toLowerCase()&&(r=!!r)),t[n.prop]=r)}}addSessionProps(t)}}function addSessionProps(e){_.isEmptyObject(e)||(window.aurycBehaviorAPI&&window.aurycBehaviorAPI.addSessionProperties?window.aurycBehaviorAPI.addSessionProperties(e):window.aurycReadyCb.push(function(){window.aurycBehaviorAPI.addSessionProperties(e)}))}var sessionPropsAutoCapture={setup:setup$1,addSessionProps:addSessionProps};function setup$2(){var e=config.getConfig("integrations","behavior");_.isDefined(e)&&!0===e.rulai&&initRulai()}var attempts$2=5;function _trackRulaiSession(e){e?(_safeAddSessionProp({rulaiSessionId:[e]}),_safeAddUserProp({rulaiSessionIdForUser:[e]})):0<attempts$2--&&setTimeout(function(){_trackRulaiSession(e)},1e3)}function initRulai(){window.addEventListener("message",function(e){if(e.origin&&-1<e.origin.indexOf("console.rul.ai")&&e.data)try{var t=JSON.parse(e.data);"emitRulaiSession"===t.type?(t.sessionId?_safeTrackEvent("Rulai Chat Started",{sessionid:t.sessionid}):_safeTrackEvent("Rulai Chat Started"),_trackRulaiSession(t.sessionId)):"liveAgentConnected"===t.type&&_safeTrackEvent("Rulai Agent Connected")}catch(e){}},!1)}function _safeTrackEvent(e,t){window.auryc&&window.auryc.track?t?window.auryc.track(e,t):window.auryc.track(e):window.aurycReadyCb.push(function(){t?window.auryc.track(e,t):window.auryc.track(e)})}function _safeAddSessionProp(e){window.auryc&&window.auryc.addSessionProperties?window.auryc.addSessionProperties(e):window.aurycReadyCb.push(function(){window.auryc.addSessionProperties(e)})}function _safeAddUserProp(e){window.auryc&&window.auryc.addUserProperties?window.auryc.addUserProperties(e):window.aurycReadyCb.push(function(){window.auryc.addUserProperties(e)})}var extIntegration={setup:setup$2},UrlChangeTracker=function(){function t(e){classCallCheck(this,t),this.handler=e}return createClass(t,[{key:"init",value:function(){history.pushState&&window.addEventListener&&(this.path=this.getPath(),this.updateTrackerData=this.updateTrackerData.bind(this),this.originalPushState=history.pushState,history.pushState=function(e,t){e&&this.isObject(e)&&t&&(e.title=t),this.originalPushState.apply(history,arguments),this.updateTrackerData()}.bind(this),this.originalReplaceState=history.replaceState,history.replaceState=function(e,t){e&&this.isObject(e)&&t&&(e.title=t),this.originalReplaceState.apply(history,arguments),this.updateTrackerData()}.bind(this),window.addEventListener("popstate",this.updateTrackerData))}},{key:"updateTrackerData",value:function(n){n=!1!==n,setTimeout(function(){var e=this.path,t=this.getPath();if(e!=t&&this.shouldTrackUrlChange.call(this,t,e)){this.path=t;var i=this.isObject(history.state)&&history.state&&history.state.title||document.title;n&&(globalSessionTracker.incPV(),this.handler({path:this.path,title:i,url:this.path})())}}.bind(this),0)}},{key:"shouldTrackUrlChange",value:function(e,t){return e&&t}},{key:"remove",value:function(){window.removeEventListener("popstate",this.updateTrackerData),history.replaceState=this.originalReplaceState,history.pushState=this.originalPushState,this.path=null,this.updateTrackerData=null,this.originalReplaceState=null,this.originalPushState=null}},{key:"getPath",value:function(){return location.href}},{key:"isObject",value:function(e){return"object"==(void 0===e?"undefined":_typeof(e))}}]),t}(),EventProcessorFactory=function(){function t(e){classCallCheck(this,t),this.storKey=config.getSiteid()+"_rec",this.browser=getInstance(),this.stg=e,this.eventWriter=EventWriter.getInstance(this.stg,this.storKey),this.eventWriter.setReady(),this.eventProcessors={},this.eventGenerator=EventGenerator.getInstance(),this.setupEventProcessors()}return createClass(t,[{key:"getProcessor",value:function(e){return this.eventProcessors[e]}},{key:"setupEventProcessors",value:function(){this.eventProcessors[constants.events.CLICKTRACKER]=this.getClickEventProcessor(),this.eventProcessors[constants.events.PAGEVIEWTRACKER]=this.getPageViewProcessor(),this.eventProcessors[constants.events.FEEDBACKTRACKER]=this.getFeedbackEventProcessor(),this.eventProcessors[constants.events.USERIDENTIFY]=this.getIdentifyUserProcessor(),this.eventProcessors[constants.events.PINGTRIGGER]=this.getPingEventProcessor()}},{key:"getClickEventProcessor",value:function(){return function(e,t,i,n,r){if(e=Object.assign(e,r),AurycPubSub.findTopic(constants.events.CLICKTRIGGER))AurycPubSub.publish(constants.events.CLICKTRIGGER,e);else var s=setInterval(function(){AurycPubSub.publish(constants.events.CLICKTRIGGER,e)&&clearInterval(s)},100)}}},{key:"getPageViewProcessor",value:function(){var o=this;return function(e,t,i,n,r){var s=o.eventGenerator.getEvent(e,t,n,r);if(s)if(AurycPubSub.findTopic(constants.events.PAGEVIEWTRIGGER))AurycPubSub.publish(constants.events.PAGEVIEWTRIGGER,s);else var a=setInterval(function(){AurycPubSub.publish(constants.events.PAGEVIEWTRIGGER,s)&&clearInterval(a)},100)}}},{key:"getIdentifyUserProcessor",value:function(){var a=this.eventWriter;return function(e,t,i,n){if(!globalSessionTracker.getSessionMetadata().isOver){var r=EventType.IdentifyUserT(),s=globalSessionTracker.getSessionMetadata().userId;n.userProperties?(r=EventType.UserProfileT(),a.append(r,{userId:s,payload:n.userProperties})):n.sessionProperties?(r=EventType.SessionPropT(),a.append(r,{payload:n.sessionProperties})):n.internalSessionProperties?(r=EventType.InternalSessionPropT(),a.append(r,{payload:n.internalSessionProperties})):n.sessionMerge?(r=EventType.MergeSessionT(),a.append(r,{u:n.sessionMerge})):(logger.warn("Identify: "),logger.warn(n),a.append(r,_.extend({userId:s},n)))}}}},{key:"getPingEventProcessor",value:function(){var t=this.eventWriter;return function(e){t.ping()}}},{key:"getFeedbackEventProcessor",value:function(){var o=this,c=this.eventWriter;return function(e,t,i,n){var r=n.eventName;"Feedback Submitted"===r&&o.eventWriter.updateToCoBrowsing();var s=EventType.CustomEventT(),a={name:n.eventProperties.name,formId:n.eventProperties.formid,p:n.eventProperties.formid,et:n.eventProperties.et};n.eventProperties.respid&&(a.respid=n.eventProperties.respid),c.append(s,{k:r,v:JSON.stringify(a)})}}}]),t}(),EventManager=function(){function t(e){classCallCheck(this,t),this.stg=e,this.eventProcessorMap={},this.eventProcessorFactory=new EventProcessorFactory(e),this.setupPageviewHandler(e,constants.events.PAGEVIEWTRACKER),this.setupFeedbackHandler(e,constants.events.FEEDBACKTRACKER),config.isSPAEnabled()&&this.setupURLChangeHandler(e,constants.events.PAGEVIEWTRACKER),this.setupCustomerHandler(e,constants.events.PINGTRIGGER),this.setupCustomerHandler(e,constants.events.USERIDENTIFY)}return createClass(t,[{key:"getHandler",value:function(i,n,e,r){return function(t){e&&e.forEach(function(e){e(t,i,n,r)})}}},{key:"addEventProcessor",value:function(e,t){this.eventProcessorMap[e]||(this.eventProcessorMap[e]=[]),this.eventProcessorMap[e].push(t)}},{key:"setupEventHandler",value:function(t,i){var n=this;AurycPubSub.addListener(t,function(e){n.getHandler(t,i,n.eventProcessorMap[t],e).call(n,t,i,n.eventProcessorMap[t],e)})}},{key:"setupPageviewHandler",value:function(e,t){this.addEventProcessor(t,this.eventProcessorFactory.getProcessor(t)),this.setupEventHandler(t,e)}},{key:"setupURLChangeHandler",value:function(t,i){var n=this;new UrlChangeTracker(function(e){return function(){n.getHandler(i,t,n.eventProcessorMap[i],e).call(n,i,t,n.eventProcessorMap[i],e)}}).init()}},{key:"setupFeedbackHandler",value:function(e,t){this.addEventProcessor(t,this.eventProcessorFactory.getProcessor(t)),this.setupEventHandler(t,e)}},{key:"setupCustomerHandler",value:function(e,t){this.addEventProcessor(t,this.eventProcessorFactory.getProcessor(t)),this.setupEventHandler(t,e)}}],[{key:"setup",value:function(e){return this.instance||(this.instance=new t(e)),this.instance}}]),t}();function init$3(){if(config.isVisualEditorMode())return logger.warn("at: product disabled"),void(window.auryc=new LinkidAPI);var e=DataLayer.getInstance(constants.symbols.SESSION),t=DataLayer.getInstance(constants.symbols.PERMANENT);setupIdentifyAPI(e,t)&&(setupEventManager(e,t),abtests.setup(),extIntegration.setup(),sessionPropsAutoCapture.setup())}function setupIdentifyAPI(e,t){var i=new IdentifyAPI("",e,t);if(!config.isProductEnabled("behavior")||isFeedbackPreview()||config.isVisualEditorMode()){var n={isBehaviorTrackingEnabled:function(){return!1}};return i.makePublic(n),logger.warn("ubt: product disabled"),!1}return logger.log("ubt: product enabled"),logger.log("ubt: domReady"),config.isSnapshotEnabled()&&i.loadEventGroups(function(e){AurycSP.setEventGroups(e)}),i.makePublic(i),!0}function isFeedbackPreview(){var e=window.location.hash,t=!!getHashParam(e,"previewmode"),i=!!getHashParam(e,"previewbadgemode")||!!getHashParam(e,"previewfbtabmode");return t||i}function setupEventManager(e,t){EventManager.setup(e,document),globalSessionTracker.initSessionOrPV();var i=setInterval(function(){AurycPubSub.publish(constants.events.UBTINIT)&&clearInterval(i)},200)}var behavior={init:init$3};function inject(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};e.aurycRecordAPI||(e.aurycRecordAPI={}),i.isReplayProductEnabled=function(){return t},e.aurycRecordAPI=(t&&(i.getReplayUrl=function(e,t){try{var i=globalSessionTracker.getSessionMetadata().siteId,n=globalSessionTracker.getSessionMetadata().sessionId;if(e&&"function"==typeof e){var r="utm_source=integration"+(t?"&utm_medium="+t.substr(0,256):""),s=config.getConfig("replay_url")+i+":"+n+"&"+r;logger.log("playback url:"+s),e(s)}}catch(e){logger.warn("Exception in get replay url: ",e)}},i.getReplayUrlGA=function(e){try{i.getReplayUrl(e,"ga")}catch(e){logger.warn("Exception in get replay url: ",e)}},i.getReplayUrlNR=function(e){try{i.getReplayUrl(e,"nr")}catch(e){logger.warn("Exception in get replay url: ",e)}},i.getReplayUrlAdobe=function(e){try{i.getReplayUrl(e,"adobe")}catch(e){logger.warn("Exception in get replay url: ",e)}},i.getReplayUrlIntercom=function(e){try{i.getReplayUrl(e,"intercom")}catch(e){logger.warn("Exception in get replay url: ",e)}}),i)}var rcApi={inject:inject};function init$4(){if(!config.isProductEnabled("record"))return logger.warn("record product disabled"),void rcApi.inject(window,!1);logger.log("record product enabled"),AurycPubSub.addListener(constants.events.UBTINIT,function(){var e=RcController.getInstance(window);config.isVisualEditorMode()?e.init():(e.init(!0),rcApi.inject(window,!0))})}var record$1={init:init$4},sessionKeys={AurycHashKey:"_aurychash",AurycTimeZone:"_aurycTimeZone",TimeTraveling:"timeTraveling",AurycMode:"_aurycMode"};function getHashParam$2(e,t){var i=e.match(new RegExp(t+"=([^&]*)"));return i?i[1]:null}function loadScript(e,t){var i=document.createElement("script");i.type="text/javascript",i.charset="UTF-8",i.src=e,t&&(i.onload=t);var n=document.getElementsByTagName("script");0<n.length?n[0].parentNode.insertBefore(i,n[0]):document.head.appendChild(i)}function loadCss(e,t){var i=document.createElement("link");i.rel="stylesheet",i.type="text/css",i.charset="UTF-8",i.href=e,t&&(i.onload=t),document.head.appendChild(i)}function loadEventEditor(e){if(!window.aurycLoadEditor){var t=config.getConfig("editor_uri","base");loadCss(t+"/editor.css"),loadScript(t+"/editor.js",function(){window.aurycLoadEditor(e)}),getLinkIdHandler().process()}}function initEventEditor(e){if(Boolean.toString().indexOf("[native code]")<0){var t=document.createElement("iframe");document.documentElement.appendChild(t),window.Boolean=t.contentWindow.Boolean,document.documentElement.removeChild(t)}loadEventEditor({exitEditorMode:exitEditorMode,siteId:config.getConfig("siteid"),siteToken:config.getConfig("siteToken"),storage:e,timeZone:e.getByKey("_aurycTimeZone"),utils:{eventElements:{normalize:normalize,attrCode:attrCode}}})}function isMatchingSite(e,t){if(!e||!t)return!1;var i=config.getConfig("siteid"),n=config.getConfig("siteToken");return e===i&&t===n}function init$5(){try{var e,t={},i=window.location.hash;if(i&&"editor"===getHashParam$2(i,"mode")){var n,r,s,a=window.history.length;history.replaceState("",document.title,window.location.pathname+window.location.search);var o=getHashParam$2(i,"t"),c=encoder.decodeBase64(o||"");if(!c)return void console.log("siteId or siteToken does not exist");if(r=getHashParam$2(c,"siteId"),s=getHashParam$2(c,"siteToken"),n=getHashParam$2(c,"timeZone"),!isMatchingSite(r,s))return void console.log("siteId or siteToken does not match");n&&(t[sessionKeys.AurycTimeZone]=n);var l=getHashParam$2(i,"mode");t[sessionKeys.AurycHashKey]=l,t[sessionKeys.TimeTraveling]=a,t[sessionKeys.AurycMode]="edit",t[constants.linkid.editorHash]=o,initEventEditor(e=globalSessionTracker.setSessionValues(t))}else"editor"===(e=globalSessionTracker.getSession(sessionKeys)).getByKey(sessionKeys.AurycHashKey)&&initEventEditor(e)}catch(e){console.log(e)}}function exitEditorMode(){globalSessionTracker.setSessionValues(defineProperty$2({},sessionKeys.AurycHashKey,""))}var visualeditor={init:init$5};function initProducts(){logger.log("initializing products"),EventType.init(),behavior.init(),FbModule.getInstance().init(),record$1.init(),visualeditor.init(),api.init()}function fail(){logger.error("Auryc SDK is not initizlied")}function polyfill(){window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(e,t){t=t||window;for(var i=0;i<this.length;i++)e.call(t,this[i],i,this)}),Array.from||(Array.from=function(e){return[].slice.call(e)}),Array.prototype.find||(Array.prototype.find=function(e){if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,i=Object(this),n=i.length>>>0,r=arguments[1],s=0;s<n;s++)if(t=i[s],e.call(r,t,s,i))return t})}polyfill(),utils.init(initProducts,fail)}();
